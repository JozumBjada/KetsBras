(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    746235,      19949]
NotebookOptionsPosition[    684211,      18896]
NotebookOutlinePosition[    686764,      18953]
CellTagsIndexPosition[    686306,      18940]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Ukoly", "Subchapter",
 CellChangeTimes->{{3.703956545443726*^9, 
  3.703956547261867*^9}},ExpressionUUID->"d0b53b6d-e066-4f42-bbe1-\
4d391f7a3fdf"],

Cell[CellGroupData[{

Cell["partTr neumi pracovat s idket", "Item",
 CellChangeTimes->{{3.70302319314384*^9, 3.703023337343892*^9}, {
  3.704223529871832*^9, 3.7042235567928553`*^9}, {3.704226623628577*^9, 
  3.7042266830373077`*^9}, {3.7054804202979603`*^9, 3.705480430197392*^9}, {
  3.709217676693056*^9, 3.7092177429646187`*^9}, {3.7092177906322536`*^9, 
  3.709217802614715*^9}, {3.711651212260487*^9, 
  3.711651212260786*^9}},ExpressionUUID->"5bf424fb-f891-4ecf-95af-\
a1f9629d90cb"],

Cell["\<\
ve funkcich basisVectorQ, identifyBases a checkBasisTr je podpora tokenu \
idket udelana jen pro to, kdybych chtel udelat podporu tomuhle tokenu i ve \
funkcich partTr\
\>", "Subitem",
 CellChangeTimes->{{3.70302319314384*^9, 3.703023337343892*^9}, {
   3.704223529871832*^9, 3.7042235567928553`*^9}, {3.704226623628577*^9, 
   3.7042266830373077`*^9}, {3.7054804202979603`*^9, 3.705480430197392*^9}, {
   3.709217676693056*^9, 3.7092177429646187`*^9}, {3.7092177906322536`*^9, 
   3.709217802614715*^9}, 
   3.711651212928685*^9},ExpressionUUID->"8b7a10d6-e6f8-4c00-886a-\
817583a51d41"]
}, Open  ]],

Cell["at lze zadavat transformace tez pomoci Rules", "Item",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGAQAWIQHTZL5fSXaa8dtRi174JonmfWT+1mvnYUip/5AkT7
yX5JdwDSCwwT80H0k47OOUtmv3bkDDw2F0S36E4rPLrotaP6z8l1IPpMksxl
++WvHSUyIPT1qS5zM4H0omjLDSDaKc7lwOEDrx2tjLvOgegwhqsi34B0vd91
cRDN/W7nZ4+Drx1XdBz4CqK/7uk69hJIf1mhcApEJ6XlPQTRXHvWvQfROTXr
nJIuvXYUD5vlCaK9Oq+tMbny2tF7rfVGEN3Sy+wQCaRNc7eA6XkBf39HAemJ
oRD6QNO679z/XjtWtZv+BNEZlzMZY/+/dtR46M0GohfePF2/jPGN47mHEPqX
biYfA8sbx3eWEBoAw/ewSg==
  
  "],ExpressionUUID->"db9ce90a-bae4-4aea-aa58-ea924a9fe347"],

Cell["\<\
v partTr pro matice je nutno posefovat chovani ArrayFlatten, aby to udelalo z \
mnohadim. pole skutecne jen 2D matici\
\>", "Item",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGAQAWIQHTZL5fSXaa8dtRi174JonmfWT+1mvnYUip/5AkT7
yX5JdwDSCwwT80H0k47OOUtmv3bkDDw2F0S36E4rPLrotaP6z8l1IPpMksxl
++WvHSUyIPT1qS5zM4H0omjLDSDaKc7lwOEDrx2tjLvOgegwhqsi34B0vd91
cRDN/W7nZ4+Drx1XdBz4CqK/7uk69hJIf1mhcApEJ6XlPQTRXHvWvQfROTXr
nJIuvXYUD5vlCaK9Oq+tMbny2tF7rfVGEN3Sy+wQCaRNc7eA6XkBf39HAemJ
oRD6QNO679z/XjtWtZv+BNEZlzMZY/+/dtR46M0GohfePF2/jPGN47mHENpj
QS8fA8sbxzSpfUIgGgC+ha/h
  
  "],ExpressionUUID->"f71d7921-5705-464f-8dd0-0c4da978b8b4"],

Cell["\<\
dodelat funkcionalitu k $evaluateBasisProduct, respective je \
$evaluateBasisProduct vubec k necemu dobry?\
\>", "Item",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGAQBmIQHTZL5fSXaa8dtRi174JonmfWT+1mvnYUip/5AkT7
yX5JdwDSCwwT80H0k47OOUtmv3bkDDw2F0S36E4rPLrotaP6z8l1IPpMksxl
++WvHSUyIPT1qS5zM4H0omjLDSDaKc7lwOEDrx2tjLvOgegwhqsi34B0vd91
cRDN/W7nZ4+Drx1XdBz4CqK/7uk69hJIf1mhcApEJ6XlPQTRXHvWvQfROTXr
nJIuvXYUD5vlCaK9Oq+tMbny2tF7rfVGEN3Sy+wQCaRNc7eA6XkBf39HAemJ
oRD6QNO679z/XjtWtZv+BNHsG/wZY/8j6DmOgmXF7G8cT3hCaACqh6af
  
  "],ExpressionUUID->"42edc771-4486-4337-9287-3fe1bee3905e"],

Cell["\<\
(Ket[idket]\[CircleTimes]psip\[CircleTimes]Ket[idket])\[ConjugateTranspose]**(\
psip\[CircleTimes]psip) nedava spravny vysledek\
\>", "Item",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGAQBmIQHTZL5fSXaa8dtRi174JonmfWT+1mvnYUip/5AkT7
yX5JdwDSCwwT80H0k47OOUtmv3bkDDw2F0S36E4rPLrotaP6z8l1IPpMksxl
++WvHSUyIPT1qS5zM4H0omjLDSDaKc7lwOEDrx2tjLvOgegwhqsi34B0vd91
cRDN/W7nZ4+Drx1XdBz4CqK/7uk69hJIf1mhcApEJ6XlPQTRXHvWvQfROTXr
nJIuvXYUD5vlCaK9Oq+tMbny2tF7rfVGEN3Sy+wQCaRNc7eA6XkBf39HAemJ
oRD6QNO679z/XjtWtZv+BNHsG/wZY/8j6PX1KmXF7G8cVWbuBtMAsW+nWQ==

  "],ExpressionUUID->"75d99aa9-f193-445a-b6b7-3fa7b286d13b"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Na co si davat pozor", "Subchapter",
 CellChangeTimes->{{3.735207532064866*^9, 
  3.735207535915539*^9}},ExpressionUUID->"20f5accb-a5d8-42c6-b5b7-\
9417c1069edb"],

Cell["\<\
sjednotit format usage retezcu a pridat i seznam argumentu a navratovych \
hodnot stylem {res1, res2}=fun[arg1, arg2, arg3]\
\>", "Item",
 CellChangeTimes->{{3.70302319314384*^9, 3.703023337343892*^9}, {
  3.704223529871832*^9, 3.7042235567928553`*^9}, {3.704226623628577*^9, 
  3.7042266830373077`*^9}, {3.705480419637327*^9, 
  3.7054804196378202`*^9}},ExpressionUUID->"a1023c4a-d282-44c7-b0ba-\
60986afa70bb"],

Cell["pridat SyntaxInformation", "Item",
 CellChangeTimes->{{3.70302319314384*^9, 3.7030232783627*^9}, {
  3.7042264888215923`*^9, 3.704226525013748*^9}, {3.704226597530795*^9, 
  3.7042266106755466`*^9}, {3.7042276401472607`*^9, 3.704227767313158*^9}, {
  3.724953463248827*^9, 3.7249534682110662`*^9}, {3.735144638583798*^9, 
  3.735144638584723*^9}},ExpressionUUID->"9a2ddb8b-63e3-4656-8618-\
9111d70bbfca"],

Cell["\<\
vyplatilo by se udelat jednotny ramec pro nakladani s bazemi, abych nemusel \
pro kazdou procedurku zvlast delat pripady pro pojmenovane baze a explicitne \
specifikovane baze a Automatic\
\>", "Item",
 CellChangeTimes->{{3.70302319314384*^9, 3.703023337343892*^9}, {
  3.704223529871832*^9, 3.7042235567928553`*^9}, {3.704226623628577*^9, 
  3.7042266830373077`*^9}, {3.7054804202979603`*^9, 3.705480430197392*^9}, {
  3.709217676693056*^9, 3.709217780624164*^9}, {3.71156546488706*^9, 
  3.7115654648877068`*^9}, {3.711651050143291*^9, 3.7116512017924356`*^9}, {
  3.724942850136506*^9, 3.7249429643187532`*^9}, {3.725045926656291*^9, 
  3.725045950728332*^9}, {3.725215645810308*^9, 3.7252156620166817`*^9}, {
  3.725545012335566*^9, 3.725545041020624*^9}, {3.725545227449998*^9, 
  3.725545283522394*^9}},ExpressionUUID->"295c667d-9c5e-4364-986c-\
ca57de506a55"],

Cell["\<\
podobne by se vyplatilo udelat jednotny ramec pro specifikaci baze, abych \
nemusel pro kazdou procedurku osetrovat vsechny mozne chyby v zadavani bazi\
\>", "Item",
 CellChangeTimes->{{3.70302319314384*^9, 3.703023337343892*^9}, {
  3.704223529871832*^9, 3.7042235567928553`*^9}, {3.704226623628577*^9, 
  3.7042266830373077`*^9}, {3.7054804202979603`*^9, 3.705480430197392*^9}, {
  3.709217676693056*^9, 3.709217780624164*^9}, {3.71156546488706*^9, 
  3.7115654648877068`*^9}, {3.711651050143291*^9, 3.7116512017924356`*^9}, {
  3.724942850136506*^9, 3.7249429643187532`*^9}, {3.725045926656291*^9, 
  3.725045950728332*^9}, {3.725215645810308*^9, 3.7252156620166817`*^9}, {
  3.725545012335566*^9, 3.725545041020624*^9}, {3.725545227449998*^9, 
  3.725545341460454*^9}, {3.734180372714889*^9, 
  3.7341803727151537`*^9}},ExpressionUUID->"aa1e027c-ab49-42a0-9e10-\
80d3462f2ac3"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Snad hotove ukoly", "Subchapter",
 CellChangeTimes->{{3.757052752441549*^9, 
  3.757052755504365*^9}},ExpressionUUID->"258f1250-0869-4f11-a085-\
c9facd6e309b"],

Cell[CellGroupData[{

Cell["\<\
udelat neco jako factorKets ktera vytkne spolecne kety podsystemu pred cely \
vyraz -> implementovano pomoci factorKetsList, ale\
\>", "Item",
 CellChangeTimes->{{3.70302319314384*^9, 3.703023337343892*^9}, {
  3.704223529871832*^9, 3.7042235567928553`*^9}, {3.704226623628577*^9, 
  3.7042266830373077`*^9}, {3.7054804202979603`*^9, 3.705480430197392*^9}, {
  3.709217676693056*^9, 3.709217780624164*^9}, {3.71156546488706*^9, 
  3.7115654648877068`*^9}, {3.711651050143291*^9, 
  3.711651059402103*^9}},ExpressionUUID->"3ef78e35-6197-4f4f-80c6-\
c4d89df9f16d"],

Cell[CellGroupData[{

Cell["\<\
factorKetsList neumi \[OpenCurlyDoubleQuote]vytykat\[CloseCurlyDoubleQuote] \
kety podsystemu, ktere jsou uprostred jednotlivych scitancu v lin. comb. \
\>", "Subitem",
 CellChangeTimes->{{3.70302319314384*^9, 3.703023337343892*^9}, {
  3.704223529871832*^9, 3.7042235567928553`*^9}, {3.704226623628577*^9, 
  3.7042266830373077`*^9}, {3.7054804202979603`*^9, 3.705480430197392*^9}, {
  3.709217676693056*^9, 3.709217780624164*^9}, {3.71156546488706*^9, 
  3.7115654648877068`*^9}, {3.711651050143291*^9, 3.7116511224853573`*^9}, {
  3.757253076644091*^9, 
  3.7572530766460857`*^9}},ExpressionUUID->"26327439-eece-41c9-a8a3-\
843522db1cc2"],

Cell["\<\
tohle bych radeji neimplementoval a spis pridelal procedurku, ktera \
propermutuje jednotlive podsystemu ve vsech ketech ->implementovano pomoci \
permuteKets\
\>", "Subsubitem",
 CellChangeTimes->{{3.70302319314384*^9, 3.703023337343892*^9}, {
  3.704223529871832*^9, 3.7042235567928553`*^9}, {3.704226623628577*^9, 
  3.7042266830373077`*^9}, {3.7054804202979603`*^9, 3.705480430197392*^9}, {
  3.709217676693056*^9, 3.709217780624164*^9}, {3.71156546488706*^9, 
  3.7115654648877068`*^9}, {3.711651050143291*^9, 3.7116511224853573`*^9}, {
  3.7572530780603385`*^9, 3.7572531089407296`*^9}, {3.7573245493137183`*^9, 
  3.75732455624019*^9}},ExpressionUUID->"7ebe1380-5338-4447-8284-\
9b92675c7161"]
}, Open  ]],

Cell["\<\
uz lepsi, ale mocnina je asi stejne porad 1, a bylo by lepsi vracet i poradi \
specifikaci v ketu, tj. kolikaty to je podsystem\
\>", "Subitem",
 CellChangeTimes->{{3.70302319314384*^9, 3.703023337343892*^9}, {
  3.704223529871832*^9, 3.7042235567928553`*^9}, {3.704226623628577*^9, 
  3.7042266830373077`*^9}, {3.7054804202979603`*^9, 3.705480430197392*^9}, {
  3.709217676693056*^9, 3.709217780624164*^9}, {3.71156546488706*^9, 
  3.7115654648877068`*^9}, {3.711651050143291*^9, 3.7116512017924356`*^9}, {
  3.724942850136506*^9, 3.7249429643187532`*^9}, {3.725045926656291*^9, 
  3.725045950728332*^9}, {3.725215645092072*^9, 3.72521564517905*^9}, {
  3.725548419437379*^9, 3.725548425792747*^9}, {3.7573249053812246`*^9, 
  3.7573249181730075`*^9}, {3.7573313005883865`*^9, 3.757331395737858*^9}, {
  3.7573314630198765`*^9, 3.7573315281825666`*^9}, {3.7573321625615816`*^9, 
  3.7573321693095284`*^9}, {3.7576943635854263`*^9, 
  3.7576944128546667`*^9}},ExpressionUUID->"03400859-2228-4b43-9ad8-\
1015276ebe00"]
}, Open  ]],

Cell["\<\
AngleBracket, evaluateableScalProd a evaluateScalarProduct vyuzivaji \
memoizace, ale pro evaluateableScalProd to asi ani neni treba; overit a \
kdyztak vyhodit memoizaci u evaluateableScalProd\
\>", "Item",
 CellChangeTimes->{{3.70302319314384*^9, 3.7030232783627*^9}, {
  3.7042264888215923`*^9, 3.7042265833044167`*^9}, {3.70422753444095*^9, 
  3.704227627582062*^9}, {3.756832786472413*^9, 3.756832842267229*^9}, {
  3.7568329070320587`*^9, 
  3.7568329513316126`*^9}},ExpressionUUID->"80d9da1e-ec57-4b83-ae75-\
5d42ea6f8f47"],

Cell[CellGroupData[{

Cell["\<\
umoznit definovani vlastnich bazi, jako treba H/V baze - tohle se promitne \
asi jen pri vyhodnocovani skal. soucinu, tj. nutno jen upravit chovani \
AngleBracket, patrne postaci dodelat mezistupen, ktery overi konzistentnost \
vyrazu s AngleBracket a pak akorat vsechny symboly nahradi Integerama a \
interne se to uz vsechno dopocita; kdyby melo dojit ke skalarnimu soucinu \
vektoru z dvou bazi, ktere mezi sebou nemaji definovany vztah, tak se skal. \
soucin nevyhodnoti\
\>", "Item",
 CellChangeTimes->{{3.70302319314384*^9, 3.7030232783627*^9}, {
  3.7042264888215923`*^9, 3.704226525013748*^9}, {3.704226597530795*^9, 
  3.7042266106755466`*^9}, {3.7042276401472607`*^9, 3.704227767313158*^9}, {
  3.7249534624125137`*^9, 3.724953462413054*^9}, {3.756832760631504*^9, 
  3.756832760632539*^9}},ExpressionUUID->"2c8df846-e6b3-43b4-a9a1-\
ec8c93bd553f"],

Cell["\<\
implementovano, viz evaluateScalarProduct a $onBasesTransformations\
\>", "Subitem",
 CellChangeTimes->{{3.70302319314384*^9, 3.7030232783627*^9}, {
  3.7042264888215923`*^9, 3.704226525013748*^9}, {3.704226597530795*^9, 
  3.7042266106755466`*^9}, {3.7042276401472607`*^9, 3.704227767313158*^9}, {
  3.7249534624125137`*^9, 3.724953462413054*^9}, {3.756832762344959*^9, 
  3.756832782232746*^9}},ExpressionUUID->"eadedbba-51f0-4009-aa68-\
4bd0f185b8c7"]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
pridat moznost dvojiho zpusobu definovani nove baze: bud je nova baze \
vyjadrena pomoci prvku jiz definovane baze, a pak je nutno overit \
ortonormalitu a stejny pocet prvku obou bazi, anebo neni zadna vazba mezi \
novou a stavajicimi bazemi definovana a pak je nova baze chapana jako baze na \
jinem Hilb. prostoru\
\>", "Item",
 CellChangeTimes->{{3.70302319314384*^9, 3.7030232783627*^9}, {
  3.7042264888215923`*^9, 3.7042265833044167`*^9}, {3.70422753444095*^9, 
  3.704227627582062*^9}, {3.7568327426875496`*^9, 
  3.7568327426886697`*^9}},ExpressionUUID->"ca331ff7-791f-4bb3-b699-\
e7b66e5fa192"],

Cell["\<\
implementovano, viz evaluateScalarProduct a $onBasesTransformations; ale \
radsi jeste overit, ze transformacni matice prechodu je vlozena spravne vuci \
danemu poradi bazi, a ne jeji inverze\
\>", "Subitem",
 CellChangeTimes->{{3.70302319314384*^9, 3.7030232783627*^9}, {
  3.7042264888215923`*^9, 3.7042265833044167`*^9}, {3.70422753444095*^9, 
  3.704227627582062*^9}, {3.756832786472413*^9, 3.756832842267229*^9}, {
  3.7568329047052803`*^9, 
  3.7568329047063184`*^9}},ExpressionUUID->"1d319b96-f891-41a2-9e59-\
fb8af3674ad5"]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
umoznit snadny prevod z jedne baze do druhe; konkretne pak vyjadreni vektoru \
vyjadreneho v jedne bazi do baze druhe; k tomu by slo vyuzit replaceKet s \
notaci neco jako replaceKet[expr, \[OpenCurlyDoubleQuote]jmeno_baze_1\
\[CloseCurlyDoubleQuote]->\[CloseCurlyDoubleQuote]jmeno_baze_2\
\[CloseCurlyDoubleQuote],{podsystemy},specifickace], kdy by se vektory z baze \
1 nahradily jejich vyjadrenim v bazi 2\
\>", "Item",
 CellChangeTimes->{{3.70302319314384*^9, 3.703023337343892*^9}, {
  3.704223529164179*^9, 3.7042235291645107`*^9}, {3.7046467135461493`*^9, 
  3.704646796419841*^9}, {3.757071729206316*^9, 
  3.7570717292083073`*^9}},ExpressionUUID->"1361492b-a17c-4a04-ae31-\
a84ca85f8891"],

Cell["\<\
implementovano pomoci changeBasis, ale jen pro lin. kombinace Ketu\
\>", "Subitem",
 CellChangeTimes->{{3.70302319314384*^9, 3.703023337343892*^9}, {
  3.704223529164179*^9, 3.7042235291645107`*^9}, {3.7046467135461493`*^9, 
  3.704646796419841*^9}, {3.757071730808031*^9, 
  3.757071749677581*^9}},ExpressionUUID->"a72493ce-9d04-4761-8651-\
5c744803d751"]
}, Open  ]],

Cell["\<\
UDELAT NECO S idket, JE NUTNO HO DAT DO ZVLASTNI BAZE, ABY SKAL. SOUCIN \
FUNGOVAL SPRAVNE\
\>", "Item",
 CellChangeTimes->{{3.70302319314384*^9, 3.7030232783627*^9}, {
  3.7042264888215923`*^9, 3.704226525013748*^9}, {3.704226597530795*^9, 
  3.7042266106755466`*^9}, {3.7042276401472607`*^9, 3.704227767313158*^9}, {
  3.724953463248827*^9, 3.7249534682110662`*^9}, {3.735144639796858*^9, 
  3.7351446644837313`*^9}, {3.7570912940680623`*^9, 
  3.7570912940680623`*^9}},ExpressionUUID->"c30e5728-6a95-4645-a593-\
c3d9dd7923bc"],

Cell["moznost pracovat i s nekonecnerozmernymi bazemi", "Item",
 CellChangeTimes->{{3.70302319314384*^9, 3.703023337343892*^9}, {
  3.704223529871832*^9, 3.7042235567928553`*^9}, {3.704226623628577*^9, 
  3.7042266830373077`*^9}, {3.7054804202979603`*^9, 3.705480430197392*^9}, {
  3.709217675521987*^9, 
  3.7092176755223503`*^9}},ExpressionUUID->"38927028-0e15-43f5-9fdf-\
53fa75604d7b"],

Cell["\<\
zacal jsem delat novou verzi factorKetsList zalozenou na FactorList; JE TO \
ALE POTREBA DODELAT; jde o to, ze lin. komb. Ket[a,b,c...] se nahradi \
normalnim soucinem tvaru Hold[a,1] Hold[b,2] Hold[c,3]..., pak se na to \
zavola FactorList a vysledek se zase pretransformuje nazpet; problemy: \
symbolicke konstanty jsou chapany jako promenne, tj. je nutno osetrit pripad, \
kde dany sublist ve vysledku z FactorList neobsahuje Hold (snad \
implementovano); naopak, muze se stat, ze v sublistu je lin. komb. soucinu \
vice Hold, ne jen jednoho; tento pripad je tez nutno osetrit\
\>", "Item",
 CellChangeTimes->{{3.70302319314384*^9, 3.703023337343892*^9}, {
  3.704223529871832*^9, 3.7042235567928553`*^9}, {3.704226623628577*^9, 
  3.7042266830373077`*^9}, {3.7054804202979603`*^9, 3.705480430197392*^9}, {
  3.709217676693056*^9, 3.709217780624164*^9}, {3.71156546488706*^9, 
  3.7115654648877068`*^9}, {3.711651050143291*^9, 3.7116512017924356`*^9}, {
  3.724942850136506*^9, 3.7249429643187532`*^9}, {3.725045926656291*^9, 
  3.725045950728332*^9}, {3.725215645092072*^9, 3.72521564517905*^9}, {
  3.725548419437379*^9, 3.725548425792747*^9}, {3.7573249053812246`*^9, 
  3.7573249181730075`*^9}, {3.7573313005883865`*^9, 3.757331395737858*^9}, {
  3.7573314630198765`*^9, 3.7573315281825666`*^9}, {3.7573321625615816`*^9, 
  3.7573321693095284`*^9}, {3.7576943613285003`*^9, 
  3.75769436132946*^9}},ExpressionUUID->"135348d4-576c-4f89-bb30-\
9fc28cf0c2cd"],

Cell["at replaceKet a changeBasis tez umi pracovat s Ket**Bra", "Item",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGAQBWIQHTZL5fSXaa8dtRi174JonmfWT+1mvnYUip/5AkT7
yX5JdwDSCwwT80H0k47OOUtmv3bkDDw2F0S36E4rPLrotaP6z8l1IPpMksxl
++WvHSUyIPT1qS5zM4H0omjLDSDaKc7lwOEDrx2tjLvOgegwhqsi34B0vd91
cRDN/W7nZ4+Drx1XdBz4CqK/7uk69hJIf1mhcApEJ6XlPQTRXHvWvQfROTXr
nJIuvXYUD5vlCaK9Oq+tMbny2tF7rfVGEN3Sy+wQCaRNc7eA6XkBf39HAemJ
oRD6QNO679z/XjtWtZv+BNEZlzMZY/+/dtR46M0GomW+fqlfxvjGUSx9VgOI
9hET8loFpCfdFvEG0f+El7qfAdJsD7g9QDQAzre2bw==
  
  "],ExpressionUUID->"8b316a05-0699-4302-86ab-74eb8c7b1fb7"],

Cell["vytvorit inverzi factorKetsList? -> unfactorKetsList", "Item",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGAQBWIQHTZL5fSXaa8dtRi174JonmfWT+1mvnYUip/5AkT7
yX5JdwDSCwwT80H0k47OOUtmv3bkDDw2F0S36E4rPLrotaP6z8l1IPpMksxl
++WvHSUyIPT1qS5zM4H0omjLDSDaKc7lwOEDrx2tjLvOgegwhqsi34B0vd91
cRDN/W7nZ4+Drx1XdBz4CqK/7uk69hJIf1mhcApEJ6XlPQTRXHvWvQfROTXr
nJIuvXYUD5vlCaK9Oq+tMbny2tF7rfVGEN3Sy+wQCaRNc7eA6XkBf39HAemJ
oRD6QNO679z/XjtWtZv+BNEZlzMZY/+/dtR46M0GomW+fqlfxvjGUSx9VgOI
fraQ1WsVkBZZBaFXVHG2nQPSEs6FYBoA2wO2mQ==
  
  "],ExpressionUUID->"f0392353-8157-4a41-9983-345afef6a076"]
}, Closed]],

Cell[CellGroupData[{

Cell["Intro", "Subchapter",
 CellChangeTimes->{{3.703023147795459*^9, 3.703023148139522*^9}, {
  3.8717208787233706`*^9, 
  3.871720879226491*^9}},ExpressionUUID->"522ef950-0f50-43c3-b263-\
493f79d011b6"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"SetDirectory", "[", 
  RowBox[{"NotebookDirectory", "[", "]"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FileNames", "[", 
   RowBox[{"\"\<*.\>\"", "~~", 
    RowBox[{"\"\<nb\>\"", "|", "\"\<m\>\"", "|", "\"\<wl\>\""}]}], "]"}], "//",
   "Multicolumn"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.701262481513089*^9, 3.7012624968103533`*^9}, {
  3.8717209016181145`*^9, 
  3.8717209018275547`*^9}},ExpressionUUID->"0c3af534-d349-4b3b-b761-\
641003dff16a"],

Cell[BoxData["\<\"C:\\\\Users\\\\Jaroslav Kysela\\\\Dropbox\\\\wolfram appl\\\
\\code samples\\\\ketsbras\"\>"], "Output",
 CellChangeTimes->{{3.701262485462739*^9, 3.701262497169937*^9}, 
   3.70126286151132*^9, {3.7012630247129*^9, 3.701263032854834*^9}, 
   3.701263185377824*^9, 3.701263497933275*^9, 3.7012637086400833`*^9, 
   3.701264620327808*^9, 3.701265060297291*^9, {3.701265147787158*^9, 
   3.701265163695529*^9}, {3.7012652459096613`*^9, 3.70126525351018*^9}, 
   3.7012654060351963`*^9, {3.7012654670794897`*^9, 3.701265494529809*^9}, 
   3.701265634827076*^9, 3.7012661148897543`*^9, 3.701266247586279*^9, 
   3.701266445706109*^9, 3.7012671937325573`*^9, 3.701267263320695*^9, 
   3.70126809249765*^9, 3.701268547797801*^9, 3.701268644996167*^9, 
   3.7012687594641*^9, 3.701268941574407*^9, 3.7012693868137302`*^9, 
   3.7012696481922407`*^9, 3.701271293632298*^9, 3.701271460091701*^9, 
   3.7012717015062523`*^9, 3.701319934182025*^9, 3.701323335822525*^9, 
   3.7013245888949413`*^9, 3.701325197544569*^9, 3.7013253943598223`*^9, 
   3.701326905942863*^9, 3.701327737048662*^9, 3.7013279032204943`*^9, 
   3.701327981934362*^9, 3.701328046292583*^9, 3.70132816028446*^9, 
   3.701437789730605*^9, 3.701438116807229*^9, 3.701438185069345*^9, 
   3.7014407649908648`*^9, 3.701441364504274*^9, 3.7014414957655373`*^9, 
   3.701441602057395*^9, 3.701441869250832*^9, 3.701442918146261*^9, 
   3.701443192418119*^9, 3.701443229992621*^9, 3.70144378921101*^9, 
   3.7014438270933647`*^9, 3.701443870937931*^9, 3.7014533432654943`*^9, 
   3.702239055850005*^9, 3.702310899363638*^9, {3.702310978424844*^9, 
   3.702310990001443*^9}, {3.702311840487073*^9, 3.7023118721036863`*^9}, 
   3.7023121065542173`*^9, 3.702312419150024*^9, 3.702312692149032*^9, 
   3.702314700482563*^9, 3.702314898023486*^9, 3.702315520955522*^9, 
   3.7023159751409063`*^9, 3.702316115938293*^9, {3.702316316827834*^9, 
   3.702316336849681*^9}, 3.702316825480707*^9, 3.7023174021636066`*^9, 
   3.7023174724886427`*^9, 3.7023176802844257`*^9, 3.702317815259221*^9, 
   3.702318096050776*^9, {3.702318134867302*^9, 3.702318160440435*^9}, 
   3.702318369170442*^9, 3.7023185018187723`*^9, 3.702318775220954*^9, 
   3.702319139786631*^9, 3.702319194213052*^9, 3.702319445698319*^9, 
   3.702319725100477*^9, 3.7023198315691767`*^9, 3.702320119826193*^9, {
   3.7023201860541573`*^9, 3.702320212112499*^9}, 3.7023203797320023`*^9, 
   3.702320422001258*^9, 3.702320536934697*^9, 3.702320635116885*^9, 
   3.702322334447064*^9, 3.702322475333465*^9, {3.7023225335879593`*^9, 
   3.702322555791645*^9}, 3.70232284089362*^9, 3.702323404351643*^9, 
   3.7023234739530363`*^9, 3.702323508839612*^9, 3.702323555902893*^9, 
   3.7023236141184072`*^9, 3.702323724772735*^9, {3.702323825067745*^9, 
   3.7023238483883467`*^9}, 3.702323905493947*^9, 3.702323938898919*^9, 
   3.7023240951093388`*^9, 3.7023241311433277`*^9, 3.702325418843934*^9, 
   3.702396763651943*^9, 3.702398107488077*^9, {3.702398239235009*^9, 
   3.702398263664547*^9}, 3.702399079645438*^9, {3.7024005850949583`*^9, 
   3.702400614213461*^9}, 3.7024017172831984`*^9, 3.70240178750569*^9, 
   3.7024019131852922`*^9, 3.702402195711562*^9, 3.702402270567155*^9, 
   3.702402478581092*^9, 3.702402949642808*^9, 3.702403285433023*^9, 
   3.702405673299452*^9, 3.702406038000534*^9, 3.7024063149986687`*^9, 
   3.702406450038826*^9, 3.7024077862057467`*^9, 3.702408077411303*^9, 
   3.702408288360098*^9, 3.702408959750238*^9, 3.702408992800901*^9, 
   3.702409085051848*^9, 3.702409261028064*^9, 3.702409358984509*^9, 
   3.7024094028179197`*^9, 3.702409492551941*^9, 3.702409585307604*^9, {
   3.7024096202142553`*^9, 3.7024096481466837`*^9}, 3.7024100169170017`*^9, 
   3.70241030170754*^9, 3.7024113626562557`*^9, 3.702411448561141*^9, 
   3.702411493450293*^9, 3.703013618671831*^9, 3.703013653690362*^9, 
   3.703013729552246*^9, 3.7030137614128933`*^9, 3.703013826991551*^9, 
   3.70301427579839*^9, 3.703014512660759*^9, {3.703014547188076*^9, 
   3.703014575598844*^9}, 3.7030147698626223`*^9, 3.703014886900341*^9, 
   3.703015013597848*^9, 3.7030153046382627`*^9, {3.703015376305683*^9, 
   3.703015399059718*^9}, 3.703016831565331*^9, 3.703017147654738*^9, 
   3.703022695542441*^9, 3.703024082450534*^9, 3.7030245705387917`*^9, 
   3.703024703476975*^9, 3.703026246617057*^9, 3.70302739589835*^9, {
   3.703027668650448*^9, 3.703027691102441*^9}, 3.7030279249258966`*^9, 
   3.703028027066228*^9, 3.703028217960586*^9, 3.703028636315888*^9, 
   3.703160978469308*^9, 3.7033502608998213`*^9, 3.70335034727374*^9, 
   3.703350453461187*^9, 3.703350539125795*^9, 3.7033506798151197`*^9, {
   3.703350840395426*^9, 3.703350880070487*^9}, 3.703351041378832*^9, 
   3.703351133430064*^9, 3.7033512202114477`*^9, 3.7033512570591497`*^9, 
   3.70335136805256*^9, 3.703351903417307*^9, {3.70335547348525*^9, 
   3.703355484328673*^9}, {3.703357716540579*^9, 3.703357728209475*^9}, 
   3.703360673726193*^9, 3.703360871386497*^9, 3.7033614103264217`*^9, 
   3.703361460876647*^9, {3.703361736238892*^9, 3.703361748429159*^9}, {
   3.703361823799015*^9, 3.703361846581115*^9}, {3.703361899187826*^9, 
   3.703361918516026*^9}, 3.7033619692785254`*^9, 3.7033624284881144`*^9, 
   3.703362722026906*^9, 3.703362790131819*^9, 3.703362942711914*^9, {
   3.703364658522585*^9, 3.703364685863599*^9}, 3.703364759736747*^9, 
   3.703364810118257*^9, 3.703364925446686*^9, 3.703364979992161*^9, 
   3.703365230342873*^9, 3.703365272346278*^9, 3.703365326613669*^9, 
   3.703365378364694*^9, 3.703365443750183*^9, 3.703366662642108*^9, 
   3.70336672908568*^9, 3.703366848566958*^9, 3.703366956898705*^9, {
   3.703367421969983*^9, 3.703367447987001*^9}, 3.703367716434267*^9, 
   3.7033678822557497`*^9, 3.703957337692958*^9, 3.703957589864573*^9, 
   3.703958078179838*^9, 3.703958173615787*^9, 3.703958552093728*^9, 
   3.703958585187696*^9, 3.7039586968406153`*^9, 3.7039589516952133`*^9, 
   3.703959338928059*^9, 3.7039596233681507`*^9, 3.703959664107232*^9, {
   3.70395971096274*^9, 3.7039597345959473`*^9}, 3.7039602626112423`*^9, 
   3.70396098693356*^9, 3.704038418179652*^9, {3.704038466653532*^9, 
   3.704038478473542*^9}, 3.704039484559332*^9, 3.704039553525416*^9, 
   3.704040093611557*^9, 3.7040404440159388`*^9, 3.704040842691971*^9, 
   3.704041016952386*^9, 3.704041814004051*^9, 3.7040433920736437`*^9, 
   3.704044118410432*^9, 3.704045363260647*^9, 3.7040471524045277`*^9, 
   3.7040500944501877`*^9, 3.704129124580056*^9, 3.70413283816261*^9, {
   3.704132876387994*^9, 3.7041328837246523`*^9}, 3.7041339624823627`*^9, 
   3.704134057391577*^9, 3.704134126599579*^9, {3.704134168445416*^9, 
   3.704134193398831*^9}, 3.704134288300846*^9, 3.704134446186936*^9, 
   3.704215891741241*^9, {3.7042202764258127`*^9, 3.7042203245568933`*^9}, 
   3.704220448542735*^9, 3.7042204788566017`*^9, 3.704222433645522*^9, 
   3.704222598682384*^9, 3.704222794448749*^9, 3.704223051954275*^9, 
   3.704225960793873*^9, 3.704226156802949*^9, 3.7042272342163267`*^9, 
   3.704227284117223*^9, 3.704476721536092*^9, 3.7044799572141314`*^9, {
   3.704483036328772*^9, 3.704483058740675*^9}, 3.704483137562786*^9, 
   3.704483566587596*^9, {3.7044837199841557`*^9, 3.704483733064052*^9}, 
   3.704483984759389*^9, 3.704643117444551*^9, 3.704647093101716*^9, 
   3.704647666424069*^9, 3.704648107347002*^9, {3.704651107898466*^9, 
   3.704651129779297*^9}, 3.7046515415379457`*^9, 3.7046519610414343`*^9, 
   3.704652070647087*^9, 3.704652356401979*^9, 3.704652476460875*^9, 
   3.7046529507422657`*^9, 3.704653001048767*^9, 3.704653031519535*^9, {
   3.7046531159717617`*^9, 3.704653143246736*^9}, 3.70508070575285*^9, 
   3.705081067766191*^9, 3.705081176082204*^9, 3.705081208566943*^9, 
   3.705081241156641*^9, 3.7050812929236717`*^9, 3.705432705755783*^9, {
   3.705433392494882*^9, 3.705433410942564*^9}, 3.7054336714594793`*^9, 
   3.705437447351234*^9, 3.7054398978818293`*^9, 3.7054411397920322`*^9, 
   3.705441173244795*^9, 3.7054412152709713`*^9, 3.705441535287383*^9, 
   3.7054778904652147`*^9, 3.70547792928701*^9, 3.705479007238158*^9, 
   3.7091911107410994`*^9, 3.709191779517516*^9, 3.709191907506164*^9, 
   3.709192044447023*^9, 3.709193475309108*^9, 3.709193720724505*^9, 
   3.709194000645488*^9, 3.709194147096693*^9, 3.709194252747678*^9, 
   3.7091946537562447`*^9, 3.7091947025515223`*^9, 3.7091947406203213`*^9, 
   3.7091947955448503`*^9, 3.7091956502840643`*^9, 3.709196474148522*^9, {
   3.709196674717389*^9, 3.709196702850687*^9}, 3.709196825024313*^9, 
   3.709196882825643*^9, 3.7091995454503117`*^9, 3.709199606048593*^9, 
   3.709199638803553*^9, 3.709202605310601*^9, {3.709203729133547*^9, 
   3.709203748481688*^9}, 3.709204111060215*^9, 3.709204184648283*^9, 
   3.709204231096641*^9, 3.709204269261807*^9, 3.709204346079863*^9, 
   3.709204389414608*^9, 3.709204803765534*^9, 3.7092049152294292`*^9, 
   3.709205003039356*^9, {3.7092050901878*^9, 3.70920510756511*^9}, 
   3.7092056739919987`*^9, 3.7092057181830587`*^9, 3.7092058897885027`*^9, 
   3.709205923801032*^9, 3.70920710461583*^9, 3.709207137891211*^9, 
   3.709207216690073*^9, 3.709208033435976*^9, 3.709208117039716*^9, 
   3.709208174495192*^9, {3.709208236417109*^9, 3.709208244408739*^9}, {
   3.709208312592832*^9, 3.709208331067813*^9}, 3.709208374540491*^9, {
   3.709208574319418*^9, 3.709208596104538*^9}, 3.709208685989354*^9, {
   3.7092087244213448`*^9, 3.709208733432522*^9}, 3.7092088057684107`*^9, {
   3.7092088973287783`*^9, 3.709208913604075*^9}, 3.709209408273024*^9, 
   3.709209550875553*^9, 3.709209734242618*^9, 3.7092098717697783`*^9, 
   3.7092099483613157`*^9, {3.709210039051043*^9, 3.709210066927836*^9}, 
   3.709210115451336*^9, 3.7092102547932997`*^9, 3.7092103045117083`*^9, {
   3.7092103487693777`*^9, 3.709210366100205*^9}, {3.709210561081601*^9, 
   3.7092105698252497`*^9}, 3.709211605472577*^9, {3.709211733821327*^9, 
   3.7092117612826242`*^9}, 3.709211823401053*^9, 3.709211862717163*^9, 
   3.709211894714067*^9, 3.7092119617118692`*^9, {3.709212001141927*^9, 
   3.709212028656703*^9}, {3.709212205104445*^9, 3.709212236613216*^9}, {
   3.70921234535075*^9, 3.709212356141931*^9}, {3.709212421788213*^9, 
   3.709212444895853*^9}, 3.709212477705346*^9, 3.70921250963209*^9, 
   3.7092127050061493`*^9, 3.709212756635599*^9, {3.709212811531434*^9, 
   3.7092129170385447`*^9}, {3.709213257415345*^9, 3.70921326492553*^9}, {
   3.709213359683566*^9, 3.7092134162926397`*^9}, 3.709213513177539*^9, 
   3.70921481585854*^9, {3.709214871680615*^9, 3.709214880575139*^9}, 
   3.709214944707348*^9, 3.7092150251986303`*^9, 3.709216022808238*^9, 
   3.709216056514954*^9, 3.709216089580274*^9, 3.7092161506748133`*^9, 
   3.709216198763225*^9, 3.709216297096961*^9, {3.709216444350395*^9, 
   3.7092164682218313`*^9}, 3.709216624856348*^9, 3.709216846566945*^9, 
   3.709216913934071*^9, 3.709217188503049*^9, 3.709217318056975*^9, {
   3.7092174049483547`*^9, 3.709217418560813*^9}, 3.709217504248859*^9, 
   3.711559826592999*^9, 3.7115609628564663`*^9, 3.711562202194467*^9, 
   3.7115622534037733`*^9, {3.711565202985323*^9, 3.71156523140306*^9}, 
   3.71156540937717*^9, 3.7115666660421267`*^9, 3.711566727589839*^9, 
   3.7115668388586597`*^9, 3.7115669353403397`*^9, 3.711567813585005*^9, 
   3.711568966071793*^9, 3.711569004658009*^9, 3.71156912602343*^9, 
   3.711569537703927*^9, 3.7115696354185762`*^9, 3.711569715482274*^9, {
   3.711569788226561*^9, 3.711569807887097*^9}, 3.711569919521166*^9, 
   3.711570027255424*^9, 3.711570387873501*^9, 3.711571167941918*^9, 
   3.7115713632694263`*^9, 3.7115715032889023`*^9, 3.7115715613340397`*^9, 
   3.711571675191613*^9, 3.711571958868009*^9, 3.711572026420676*^9, 
   3.711573999978888*^9, 3.711574095407835*^9, 3.7115743295421352`*^9, 
   3.711574360638783*^9, 3.711574411042046*^9, 3.711574715044436*^9, 
   3.7116367718363132`*^9, 3.711651498353141*^9, 3.7133607887512703`*^9, 
   3.7133611973136177`*^9, 3.713373233640686*^9, 3.7133746726591253`*^9, 
   3.713803500713336*^9, 3.713805445455947*^9, 3.713806429458405*^9, 
   3.7138065029058027`*^9, 3.7138066026255608`*^9, 3.713806652102282*^9, 
   3.7138074015493383`*^9, 3.7138074367861147`*^9, {3.7138075301260653`*^9, 
   3.713807557482204*^9}, 3.7138079092291203`*^9, 3.713807977549861*^9, 
   3.713808020626295*^9, 3.7138083151794977`*^9, 3.7138083787225323`*^9, 
   3.71380861599303*^9, {3.713809543423645*^9, 3.713809568065455*^9}, 
   3.713809598639865*^9, 3.71380978283337*^9, 3.71380991795572*^9, 
   3.713810232052294*^9, {3.713810416157229*^9, 3.713810442436981*^9}, 
   3.7138111072872047`*^9, {3.713811822404484*^9, 3.713811837824028*^9}, 
   3.713811930255515*^9, {3.7138120572493668`*^9, 3.713812076046444*^9}, {
   3.7138122456908293`*^9, 3.7138122705122547`*^9}, 3.7138123785812607`*^9, 
   3.713812498892272*^9, {3.713812573785159*^9, 3.713812612975801*^9}, 
   3.7138127986223803`*^9, 3.713812942356614*^9, 3.7138142269479227`*^9, 
   3.7138149335195513`*^9, 3.7138150313366413`*^9, 3.7138155653799667`*^9, 
   3.713816058964003*^9, 3.71381612883856*^9, 3.713816337186285*^9, 
   3.721917190593629*^9, 3.724849709002183*^9, 3.724942672911696*^9, 
   3.72494327315403*^9, 3.724944125158931*^9, 3.724944889364151*^9, 
   3.7249505819423532`*^9, 3.7249579578355007`*^9, 3.724958545183641*^9, {
   3.725043919558916*^9, 3.7250439403292093`*^9}, {3.7250461487967653`*^9, 
   3.725046153278227*^9}, 3.725214277463949*^9, 3.7255377758647957`*^9, 
   3.725539164393716*^9, 3.725539543500698*^9, 3.725539655364109*^9, 
   3.725547772521099*^9, {3.734179775837922*^9, 3.734179776606503*^9}, 
   3.734879962895277*^9, {3.734880526121561*^9, 3.734880526795643*^9}, 
   3.7348805721581373`*^9, 3.734885253758501*^9, 3.73488530184727*^9, 
   3.7348854867733583`*^9, 3.734885528352448*^9, 3.734887349574387*^9, 
   3.734887689735485*^9, 3.734888074723276*^9, 3.73488930226855*^9, 
   3.7348893951942387`*^9, 3.7348894843534317`*^9, 3.734889746701206*^9, 
   3.734889902109717*^9, 3.7348900565646057`*^9, 3.7348903249861727`*^9, 
   3.734890478006572*^9, 3.734890637095893*^9, 3.7348906944832373`*^9, 
   3.7348907820911503`*^9, 3.734933089138384*^9, 3.7349331993255663`*^9, 
   3.734937254234972*^9, 3.734937414325219*^9, 3.734937688907125*^9, 
   3.734937762641877*^9, 3.73493795858855*^9, 3.735123406147338*^9, 
   3.7351237889118223`*^9, 3.735123893477111*^9, 3.735123931608548*^9, 
   3.735124143287709*^9, 3.7351242369025707`*^9, 3.7351243460784473`*^9, 
   3.735124718615597*^9, 3.7351253007844143`*^9, 3.7351262698294992`*^9, 
   3.735127305052744*^9, 3.735127719092594*^9, 3.735129585692606*^9, 
   3.735130539702219*^9, 3.735130664350465*^9, 3.7351308220191917`*^9, 
   3.735131969636698*^9, 3.735132450726083*^9, 3.7351324888302317`*^9, 
   3.735133746463089*^9, 3.7351360781851473`*^9, 3.735136762107602*^9, 
   3.7351385830330667`*^9, 3.735139209576503*^9, 3.7351403828102207`*^9, 
   3.735141233053132*^9, 3.735143035173807*^9, 3.735143564883132*^9, 
   3.735143685953539*^9, 3.735207474331012*^9, 3.7352077699656277`*^9, 
   3.735208963289366*^9, 3.735209967527864*^9, {3.756629602381092*^9, 
   3.756629603000434*^9}, 3.75665280356875*^9, 3.756654254644867*^9, 
   3.7568185148765717`*^9, 3.7568272840880127`*^9, 3.7568303632360888`*^9, 
   3.7568307377034173`*^9, 3.7568311056969085`*^9, 3.756831287915547*^9, 
   3.756831992225586*^9, 3.7568321185837297`*^9, 3.7568322240402403`*^9, 
   3.757066164602933*^9, 3.757068110467087*^9, 3.7570693330980215`*^9, 
   3.7570694002853765`*^9, 3.757088813708413*^9, 3.757090986540876*^9, 
   3.7571519709823446`*^9, 3.757156278281585*^9, 3.7571568897366734`*^9, 
   3.7571609388187666`*^9, 3.757161709617919*^9, 3.7571619099342794`*^9, 
   3.7571627309517517`*^9, 3.7572244341702557`*^9, 3.757224576515658*^9, 
   3.7572250473159175`*^9, 3.757225145786993*^9, 3.7572279910695963`*^9, 
   3.7572281695644703`*^9, 3.75722940022361*^9, 3.7572296773637085`*^9, 
   3.757230085617311*^9, 3.757231077512205*^9, 3.757238210497238*^9, 
   3.7572390171850753`*^9, 3.757239460379323*^9, 3.7572397333724732`*^9, 
   3.757243135519288*^9, 3.7572494595551844`*^9, 3.7572516688098593`*^9, 
   3.7572518414527216`*^9, 3.757317363473264*^9, 3.7573227872534795`*^9, 
   3.757322832380763*^9, 3.757323218200083*^9, 3.7573233038069067`*^9, 
   3.757323368076944*^9, 3.757323434877252*^9, 3.7573235737876625`*^9, 
   3.75733018275263*^9, 3.757330815858054*^9, 3.7573321922132616`*^9, 
   3.7576577963887424`*^9, 3.757693603038911*^9, 3.7577623527726374`*^9, 
   3.758021903541307*^9, 3.7580238176596785`*^9, 3.7580281613877335`*^9, 
   3.758028467309699*^9, 3.758031140955019*^9, 3.7580311779928923`*^9, 
   3.7580330019276905`*^9, 3.758033693006049*^9, 3.758033808693883*^9, 
   3.7580339287436543`*^9, 3.758034065964667*^9, 3.758034130096013*^9, 
   3.7580344363390865`*^9, 3.75803452969615*^9, 3.758034778936335*^9, 
   3.7588735165561914`*^9, 3.7588799555276656`*^9, 3.7588800064245143`*^9, 
   3.7588800515036306`*^9, 3.758880177976053*^9, 3.758880387341303*^9, 
   3.7588899526765842`*^9, 3.7588926050579605`*^9, 3.758910421624519*^9, 
   3.758910766332414*^9, 3.758910945562969*^9, 3.7589576158750834`*^9, 
   3.758960804532098*^9, 3.7589672639361615`*^9, 3.7589794396916976`*^9, 
   3.758981611586242*^9, 3.758982816222801*^9, 3.7589849792237062`*^9, 
   3.75903738492447*^9, 3.7590383000514755`*^9, 3.7590398605750637`*^9, 
   3.759041055024067*^9, 3.7590434811661935`*^9, 3.7590435313342*^9, 
   3.759057791004734*^9, 3.7601725444528265`*^9, {3.7601934442639074`*^9, 
   3.7601934613053446`*^9}, 3.7602511692135687`*^9, 3.760355422161255*^9, 
   3.7606831387148857`*^9, 3.7619999822091355`*^9, 3.762004449713338*^9, 
   3.762004670888139*^9, 3.7620047335613375`*^9, 3.762004943328583*^9, {
   3.762005048582882*^9, 3.7620050873984375`*^9}, 3.7621005110578833`*^9, 
   3.7625997572393885`*^9, 3.7626029510796156`*^9, 3.764079547372857*^9, 
   3.7953272731569986`*^9, 3.869225255331499*^9},
 CellLabel->"Out[1]=",ExpressionUUID->"0a1fea43-ae83-4e70-8d26-88b25f6ada1b"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"namepac", "=", "\"\<KetsBrasE\>\""}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.7570869156926594`*^9, 3.757086917875822*^9}, {
   3.757162704818084*^9, 3.757162705146207*^9}, {3.7572281472069645`*^9, 
   3.7572281476453524`*^9}, {3.7580237263384104`*^9, 3.7580237271183634`*^9}, 
   3.758957721597324*^9},
 CellLabel->"In[3]:=",ExpressionUUID->"d1222107-3209-416b-889b-c796e65aeb64"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"contextsymb", "=", 
   RowBox[{"Get", "[", 
    RowBox[{"namepac", "<>", "\"\<`\>\""}], "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.701262808731648*^9, 3.7012628141296463`*^9}, {
   3.701262875441284*^9, 3.701262883955488*^9}, 3.7012637131535063`*^9, {
   3.701267214232396*^9, 3.7012672154115877`*^9}, 3.7014381794969873`*^9, {
   3.7023118575439568`*^9, 3.702311857775771*^9}, {3.703014505696639*^9, 
   3.703014505905322*^9}, {3.7030240778028173`*^9, 3.7030240780914307`*^9}, 
   3.703362423871112*^9, 3.703957583216042*^9, 3.704044112726296*^9, 
   3.705432695588635*^9, 3.7091995992637243`*^9, 3.7115609583626833`*^9, 
   3.7133731837060747`*^9, {3.7138097734864473`*^9, 3.7138097739185038`*^9}, {
   3.724943224563416*^9, 3.724943224609151*^9}, 3.734879960860651*^9, {
   3.7348804275083237`*^9, 3.734880427663147*^9}, {3.757086872671708*^9, 
   3.7570869143589134`*^9}, {3.757224404806847*^9, 3.757224408808057*^9}, 
   3.757224563059413*^9},
 CellLabel->"In[4]:=",ExpressionUUID->"f61ec165-efff-45dd-abac-2cbf5664dab2"],

Cell[BoxData["\<\"For information on usage, see Information for any of the \
following symbols: idket, partTr, partTrSymb, partTrInt, toKet, fromKet, \
toKetBra, fromKetBra, linearCombinationQ, replaceKet, factorKetsList, \
kroneckerKetProducts, getSpecs, infiniteBasis, generateKets, getSpecs, \
onBases, addBasis, clearBasis, identifyBases, basisVectorQ, basisQ, Ket, Bra, \
Tr, Normalize, Norm, changeBasis, AngleBracket, $evaluateBasisProduct, \
infiniteBasisQ, addBasisTransformation, getInfiniteLabel, \
$onBasesTransformations, clearBasisTransformation, checkBasisTr, permuteKets, \
unfactorKetsList\"\>"], "Print",
 CellChangeTimes->{
  3.757323304141971*^9, 3.757323368391105*^9, 3.757323435433764*^9, 
   3.7573235743930435`*^9, 3.7573301833041544`*^9, 3.7573308165472116`*^9, 
   3.7573321925513563`*^9, 3.757657797119788*^9, 3.7576936036642427`*^9, 
   3.7577623533271565`*^9, 3.7580219041855984`*^9, 3.7580238185978975`*^9, 
   3.7580281620649223`*^9, 3.7580284682192926`*^9, 3.758031141675625*^9, 
   3.758031178699549*^9, 3.7580330027943726`*^9, 3.7580336937199802`*^9, 
   3.7580338093975134`*^9, 3.758033929610345*^9, 3.7580340665989685`*^9, 
   3.758034130888406*^9, 3.7580344370741267`*^9, 3.758034530810989*^9, 
   3.7580347800389395`*^9, 3.7588735172892303`*^9, 3.7588799688171153`*^9, 
   3.758880007262274*^9, 3.7588800643831778`*^9, 3.7588801907498856`*^9, 
   3.7588803876195655`*^9, 3.7588899662153664`*^9, 3.7588926184381685`*^9, 
   3.7589104219765773`*^9, 3.758910779259834*^9, 3.758910958816515*^9, 
   3.758957616431595*^9, 3.7589577268163443`*^9, 3.758960816729432*^9, 
   3.758967264800976*^9, 3.7589794403329787`*^9, 3.75898161211782*^9, 
   3.7589828295202303`*^9, 3.7589849924962044`*^9, 3.7590373855737314`*^9, 
   3.7590383003436933`*^9, 3.7590398738608017`*^9, 3.7590410679098177`*^9, 
   3.7590434814314294`*^9, 3.7590435435663047`*^9, 3.7590577915188813`*^9, 
   3.760172544949498*^9, {3.7601934446598487`*^9, 3.7601934616953287`*^9}, 
   3.760251169645419*^9, 3.760355422819496*^9, 3.7606831392694035`*^9, 
   3.761999982765743*^9, 3.762004450007126*^9, 3.762004671160367*^9, 
   3.762004733864542*^9, 3.762004943621806*^9, {3.762005048869073*^9, 
   3.7620050621119204`*^9}, 3.76200510189802*^9, 3.762100511570512*^9, 
   3.7625997577853637`*^9, 3.76260295202011*^9, 3.7640795483598995`*^9, 
   3.7953272747278605`*^9, 3.8692252563896694`*^9},
 CellLabel->
  "During evaluation of \
In[4]:=",ExpressionUUID->"4ceb7c3f-7ad2-499b-b05f-29895a851c0c"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"?", "KetsBras`*"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.703361370929175*^9, 3.703361383812524*^9}, {
  3.757086877795464*^9, 3.757086883869343*^9}},
 CellLabel->"In[5]:=",ExpressionUUID->"67ff6624-183f-4f80-9667-57011f4d5af0"],

Cell[BoxData[
 StyleBox[
  FrameBox[GridBox[{
     {
      DynamicModuleBox[{Typeset`open$$ = True}, 
       PaneSelectorBox[{False->
        ButtonBox[
         RowBox[{
          
          DynamicBox[FEPrivate`FrontEndResource[
           "FEBitmaps", "RightPointerOpener"]], " ", 
          StyleBox["KetsBras`", "InformationGridGroupHeader"]}],
         Appearance->None,
         BaseStyle->"InformationGridLink",
         ButtonFunction:>FEPrivate`Set[Typeset`open$$, True],
         Evaluator->Automatic,
         Method->"Preemptive"], True->
        PaneBox[GridBox[{
           {
            ButtonBox[
             RowBox[{
              
              DynamicBox[FEPrivate`FrontEndResource[
               "FEBitmaps", "DownPointerOpener"],
               ImageSizeCache->{10., {3., 7.}}], " ", 
              StyleBox["KetsBras`", "InformationGridGroupHeader"]}],
             Appearance->None,
             BaseStyle->"InformationGridLink",
             ButtonFunction:>FEPrivate`Set[Typeset`open$$, False],
             Evaluator->Automatic,
             Method->"Preemptive"]},
           {
            PaneBox[GridBox[{
               {
                ButtonBox[
                 StyleBox["addBasis", "InformationGridButton"],
                 Appearance->None,
                 BaseStyle->"InformationGridLink",
                 
                 ButtonData:>{
                  "Info-46b94111-a0da-4ef6-b3ae-f0c867d65b12", {
                   "addBasis", "KetsBras`"}, False},
                 ButtonNote->"KetsBras`",
                 Evaluator->Automatic], 
                ButtonBox[
                 StyleBox["clearBasis", "InformationGridButton"],
                 Appearance->None,
                 BaseStyle->"InformationGridLink",
                 
                 ButtonData:>{
                  "Info-46b94111-a0da-4ef6-b3ae-f0c867d65b12", {
                   "clearBasis", "KetsBras`"}, False},
                 ButtonNote->"KetsBras`",
                 Evaluator->Automatic], 
                ButtonBox[
                 StyleBox["getInfiniteLabel", "InformationGridButton"],
                 Appearance->None,
                 BaseStyle->"InformationGridLink",
                 
                 ButtonData:>{
                  "Info-46b94111-a0da-4ef6-b3ae-f0c867d65b12", {
                   "getInfiniteLabel", "KetsBras`"}, False},
                 ButtonNote->"KetsBras`",
                 Evaluator->Automatic], 
                ButtonBox[
                 StyleBox["k0", "InformationGridButton"],
                 Appearance->None,
                 BaseStyle->"InformationGridLink",
                 
                 ButtonData:>{
                  "Info-46b94111-a0da-4ef6-b3ae-f0c867d65b12", {
                   "k0", "KetsBras`"}, False},
                 ButtonNote->"KetsBras`",
                 Evaluator->Automatic], 
                ButtonBox[
                 StyleBox["kroneckerKetProducts", "InformationGridButton"],
                 Appearance->None,
                 BaseStyle->"InformationGridLink",
                 
                 ButtonData:>{
                  "Info-46b94111-a0da-4ef6-b3ae-f0c867d65b12", {
                   "kroneckerKetProducts", "KetsBras`"}, False},
                 ButtonNote->"KetsBras`",
                 Evaluator->Automatic], 
                ButtonBox[
                 StyleBox["permuteKets", "InformationGridButton"],
                 Appearance->None,
                 BaseStyle->"InformationGridLink",
                 
                 ButtonData:>{
                  "Info-46b94111-a0da-4ef6-b3ae-f0c867d65b12", {
                   "permuteKets", "KetsBras`"}, False},
                 ButtonNote->"KetsBras`",
                 Evaluator->Automatic], 
                ButtonBox[
                 StyleBox["toKet", "InformationGridButton"],
                 Appearance->None,
                 BaseStyle->"InformationGridLink",
                 
                 ButtonData:>{
                  "Info-46b94111-a0da-4ef6-b3ae-f0c867d65b12", {
                   "toKet", "KetsBras`"}, False},
                 ButtonNote->"KetsBras`",
                 Evaluator->Automatic]},
               {
                ButtonBox[
                 StyleBox["addBasisTransformation", "InformationGridButton"],
                 Appearance->None,
                 BaseStyle->"InformationGridLink",
                 
                 ButtonData:>{
                  "Info-46b94111-a0da-4ef6-b3ae-f0c867d65b12", {
                   "addBasisTransformation", "KetsBras`"}, False},
                 ButtonNote->"KetsBras`",
                 Evaluator->Automatic], 
                ButtonBox[
                 StyleBox["clearBasisTransformation", "InformationGridButton"],
                 
                 Appearance->None,
                 BaseStyle->"InformationGridLink",
                 
                 ButtonData:>{
                  "Info-46b94111-a0da-4ef6-b3ae-f0c867d65b12", {
                   "clearBasisTransformation", "KetsBras`"}, False},
                 ButtonNote->"KetsBras`",
                 Evaluator->Automatic], 
                ButtonBox[
                 StyleBox["getSpecs", "InformationGridButton"],
                 Appearance->None,
                 BaseStyle->"InformationGridLink",
                 
                 ButtonData:>{
                  "Info-46b94111-a0da-4ef6-b3ae-f0c867d65b12", {
                   "getSpecs", "KetsBras`"}, False},
                 ButtonNote->"KetsBras`",
                 Evaluator->Automatic], 
                ButtonBox[
                 StyleBox["k1", "InformationGridButton"],
                 Appearance->None,
                 BaseStyle->"InformationGridLink",
                 
                 ButtonData:>{
                  "Info-46b94111-a0da-4ef6-b3ae-f0c867d65b12", {
                   "k1", "KetsBras`"}, False},
                 ButtonNote->"KetsBras`",
                 Evaluator->Automatic], 
                ButtonBox[
                 StyleBox["linearCombinationQ", "InformationGridButton"],
                 Appearance->None,
                 BaseStyle->"InformationGridLink",
                 
                 ButtonData:>{
                  "Info-46b94111-a0da-4ef6-b3ae-f0c867d65b12", {
                   "linearCombinationQ", "KetsBras`"}, False},
                 ButtonNote->"KetsBras`",
                 Evaluator->Automatic], 
                ButtonBox[
                 StyleBox["phim", "InformationGridButton"],
                 Appearance->None,
                 BaseStyle->"InformationGridLink",
                 
                 ButtonData:>{
                  "Info-46b94111-a0da-4ef6-b3ae-f0c867d65b12", {
                   "phim", "KetsBras`"}, False},
                 ButtonNote->"KetsBras`",
                 Evaluator->Automatic], 
                ButtonBox[
                 StyleBox["toKetBra", "InformationGridButton"],
                 Appearance->None,
                 BaseStyle->"InformationGridLink",
                 
                 ButtonData:>{
                  "Info-46b94111-a0da-4ef6-b3ae-f0c867d65b12", {
                   "toKetBra", "KetsBras`"}, False},
                 ButtonNote->"KetsBras`",
                 Evaluator->Automatic]},
               {
                ButtonBox[
                 StyleBox["basisQ", "InformationGridButton"],
                 Appearance->None,
                 BaseStyle->"InformationGridLink",
                 
                 ButtonData:>{
                  "Info-46b94111-a0da-4ef6-b3ae-f0c867d65b12", {
                   "basisQ", "KetsBras`"}, False},
                 ButtonNote->"KetsBras`",
                 Evaluator->Automatic], 
                ButtonBox[
                 StyleBox["factorKetsList", "InformationGridButton"],
                 Appearance->None,
                 BaseStyle->"InformationGridLink",
                 
                 ButtonData:>{
                  "Info-46b94111-a0da-4ef6-b3ae-f0c867d65b12", {
                   "factorKetsList", "KetsBras`"}, False},
                 ButtonNote->"KetsBras`",
                 Evaluator->Automatic], 
                ButtonBox[
                 StyleBox["identifyBases", "InformationGridButton"],
                 Appearance->None,
                 BaseStyle->"InformationGridLink",
                 
                 ButtonData:>{
                  "Info-46b94111-a0da-4ef6-b3ae-f0c867d65b12", {
                   "identifyBases", "KetsBras`"}, False},
                 ButtonNote->"KetsBras`",
                 Evaluator->Automatic], 
                ButtonBox[
                 StyleBox["ka", "InformationGridButton"],
                 Appearance->None,
                 BaseStyle->"InformationGridLink",
                 
                 ButtonData:>{
                  "Info-46b94111-a0da-4ef6-b3ae-f0c867d65b12", {
                   "ka", "KetsBras`"}, False},
                 ButtonNote->"KetsBras`",
                 Evaluator->Automatic], 
                ButtonBox[
                 StyleBox["onBases", "InformationGridButton"],
                 Appearance->None,
                 BaseStyle->"InformationGridLink",
                 
                 ButtonData:>{
                  "Info-46b94111-a0da-4ef6-b3ae-f0c867d65b12", {
                   "onBases", "KetsBras`"}, False},
                 ButtonNote->"KetsBras`",
                 Evaluator->Automatic], 
                ButtonBox[
                 StyleBox["phip", "InformationGridButton"],
                 Appearance->None,
                 BaseStyle->"InformationGridLink",
                 
                 ButtonData:>{
                  "Info-46b94111-a0da-4ef6-b3ae-f0c867d65b12", {
                   "phip", "KetsBras`"}, False},
                 ButtonNote->"KetsBras`",
                 Evaluator->Automatic], 
                ButtonBox[
                 StyleBox["unfactorKetsList", "InformationGridButton"],
                 Appearance->None,
                 BaseStyle->"InformationGridLink",
                 
                 ButtonData:>{
                  "Info-46b94111-a0da-4ef6-b3ae-f0c867d65b12", {
                   "unfactorKetsList", "KetsBras`"}, False},
                 ButtonNote->"KetsBras`",
                 Evaluator->Automatic]},
               {
                ButtonBox[
                 StyleBox["basisVectorQ", "InformationGridButton"],
                 Appearance->None,
                 BaseStyle->"InformationGridLink",
                 
                 ButtonData:>{
                  "Info-46b94111-a0da-4ef6-b3ae-f0c867d65b12", {
                   "basisVectorQ", "KetsBras`"}, False},
                 ButtonNote->"KetsBras`",
                 Evaluator->Automatic], 
                ButtonBox[
                 StyleBox["fromKet", "InformationGridButton"],
                 Appearance->None,
                 BaseStyle->"InformationGridLink",
                 
                 ButtonData:>{
                  "Info-46b94111-a0da-4ef6-b3ae-f0c867d65b12", {
                   "fromKet", "KetsBras`"}, False},
                 ButtonNote->"KetsBras`",
                 Evaluator->Automatic], 
                ButtonBox[
                 StyleBox["idket", "InformationGridButton"],
                 Appearance->None,
                 BaseStyle->"InformationGridLink",
                 
                 ButtonData:>{
                  "Info-46b94111-a0da-4ef6-b3ae-f0c867d65b12", {
                   "idket", "KetsBras`"}, False},
                 ButtonNote->"KetsBras`",
                 Evaluator->Automatic], 
                ButtonBox[
                 StyleBox["kd", "InformationGridButton"],
                 Appearance->None,
                 BaseStyle->"InformationGridLink",
                 
                 ButtonData:>{
                  "Info-46b94111-a0da-4ef6-b3ae-f0c867d65b12", {
                   "kd", "KetsBras`"}, False},
                 ButtonNote->"KetsBras`",
                 Evaluator->Automatic], 
                ButtonBox[
                 StyleBox["partTr", "InformationGridButton"],
                 Appearance->None,
                 BaseStyle->"InformationGridLink",
                 
                 ButtonData:>{
                  "Info-46b94111-a0da-4ef6-b3ae-f0c867d65b12", {
                   "partTr", "KetsBras`"}, False},
                 ButtonNote->"KetsBras`",
                 Evaluator->Automatic], 
                ButtonBox[
                 StyleBox["psim", "InformationGridButton"],
                 Appearance->None,
                 BaseStyle->"InformationGridLink",
                 
                 ButtonData:>{
                  "Info-46b94111-a0da-4ef6-b3ae-f0c867d65b12", {
                   "psim", "KetsBras`"}, False},
                 ButtonNote->"KetsBras`",
                 Evaluator->Automatic], 
                ButtonBox[
                 StyleBox["$evaluateBasisProduct", "InformationGridButton"],
                 Appearance->None,
                 BaseStyle->"InformationGridLink",
                 
                 ButtonData:>{
                  "Info-46b94111-a0da-4ef6-b3ae-f0c867d65b12", {
                   "$evaluateBasisProduct", "KetsBras`"}, False},
                 ButtonNote->"KetsBras`",
                 Evaluator->Automatic]},
               {
                ButtonBox[
                 StyleBox["changeBasis", "InformationGridButton"],
                 Appearance->None,
                 BaseStyle->"InformationGridLink",
                 
                 ButtonData:>{
                  "Info-46b94111-a0da-4ef6-b3ae-f0c867d65b12", {
                   "changeBasis", "KetsBras`"}, False},
                 ButtonNote->"KetsBras`",
                 Evaluator->Automatic], 
                ButtonBox[
                 StyleBox["fromKetBra", "InformationGridButton"],
                 Appearance->None,
                 BaseStyle->"InformationGridLink",
                 
                 ButtonData:>{
                  "Info-46b94111-a0da-4ef6-b3ae-f0c867d65b12", {
                   "fromKetBra", "KetsBras`"}, False},
                 ButtonNote->"KetsBras`",
                 Evaluator->Automatic], 
                ButtonBox[
                 StyleBox["infiniteBasis", "InformationGridButton"],
                 Appearance->None,
                 BaseStyle->"InformationGridLink",
                 
                 ButtonData:>{
                  "Info-46b94111-a0da-4ef6-b3ae-f0c867d65b12", {
                   "infiniteBasis", "KetsBras`"}, False},
                 ButtonNote->"KetsBras`",
                 Evaluator->Automatic], 
                ButtonBox[
                 StyleBox["kl", "InformationGridButton"],
                 Appearance->None,
                 BaseStyle->"InformationGridLink",
                 
                 ButtonData:>{
                  "Info-46b94111-a0da-4ef6-b3ae-f0c867d65b12", {
                   "kl", "KetsBras`"}, False},
                 ButtonNote->"KetsBras`",
                 Evaluator->Automatic], 
                ButtonBox[
                 StyleBox["partTrInt", "InformationGridButton"],
                 Appearance->None,
                 BaseStyle->"InformationGridLink",
                 
                 ButtonData:>{
                  "Info-46b94111-a0da-4ef6-b3ae-f0c867d65b12", {
                   "partTrInt", "KetsBras`"}, False},
                 ButtonNote->"KetsBras`",
                 Evaluator->Automatic], 
                ButtonBox[
                 StyleBox["psip", "InformationGridButton"],
                 Appearance->None,
                 BaseStyle->"InformationGridLink",
                 
                 ButtonData:>{
                  "Info-46b94111-a0da-4ef6-b3ae-f0c867d65b12", {
                   "psip", "KetsBras`"}, False},
                 ButtonNote->"KetsBras`",
                 Evaluator->Automatic], 
                ButtonBox[
                 StyleBox["$onBasesTransformations", "InformationGridButton"],
                 
                 Appearance->None,
                 BaseStyle->"InformationGridLink",
                 
                 ButtonData:>{
                  "Info-46b94111-a0da-4ef6-b3ae-f0c867d65b12", {
                   "$onBasesTransformations", "KetsBras`"}, False},
                 ButtonNote->"KetsBras`",
                 Evaluator->Automatic]},
               {
                ButtonBox[
                 StyleBox["checkBasisTr", "InformationGridButton"],
                 Appearance->None,
                 BaseStyle->"InformationGridLink",
                 
                 ButtonData:>{
                  "Info-46b94111-a0da-4ef6-b3ae-f0c867d65b12", {
                   "checkBasisTr", "KetsBras`"}, False},
                 ButtonNote->"KetsBras`",
                 Evaluator->Automatic], 
                ButtonBox[
                 StyleBox["generateKets", "InformationGridButton"],
                 Appearance->None,
                 BaseStyle->"InformationGridLink",
                 
                 ButtonData:>{
                  "Info-46b94111-a0da-4ef6-b3ae-f0c867d65b12", {
                   "generateKets", "KetsBras`"}, False},
                 ButtonNote->"KetsBras`",
                 Evaluator->Automatic], 
                ButtonBox[
                 StyleBox["infiniteBasisQ", "InformationGridButton"],
                 Appearance->None,
                 BaseStyle->"InformationGridLink",
                 
                 ButtonData:>{
                  "Info-46b94111-a0da-4ef6-b3ae-f0c867d65b12", {
                   "infiniteBasisQ", "KetsBras`"}, False},
                 ButtonNote->"KetsBras`",
                 Evaluator->Automatic], 
                ButtonBox[
                 StyleBox["kr", "InformationGridButton"],
                 Appearance->None,
                 BaseStyle->"InformationGridLink",
                 
                 ButtonData:>{
                  "Info-46b94111-a0da-4ef6-b3ae-f0c867d65b12", {
                   "kr", "KetsBras`"}, False},
                 ButtonNote->"KetsBras`",
                 Evaluator->Automatic], 
                ButtonBox[
                 StyleBox["partTrSymb", "InformationGridButton"],
                 Appearance->None,
                 BaseStyle->"InformationGridLink",
                 
                 ButtonData:>{
                  "Info-46b94111-a0da-4ef6-b3ae-f0c867d65b12", {
                   "partTrSymb", "KetsBras`"}, False},
                 ButtonNote->"KetsBras`",
                 Evaluator->Automatic], 
                ButtonBox[
                 StyleBox["replaceKet", "InformationGridButton"],
                 Appearance->None,
                 BaseStyle->"InformationGridLink",
                 
                 ButtonData:>{
                  "Info-46b94111-a0da-4ef6-b3ae-f0c867d65b12", {
                   "replaceKet", "KetsBras`"}, False},
                 ButtonNote->"KetsBras`",
                 Evaluator->Automatic], ""}
              },
              DefaultBaseStyle->"Text",
              
              GridBoxAlignment->{
               "Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
              GridBoxItemSize->{"Columns" -> {{
                   Scaled[0.1357142857142857]}}}],
             ImageMargins->{{10, 0}, {0, 2}}]}
          },
          GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}}],
         FrameMargins->{{0, 0}, {8, 0}}]}, Dynamic[Typeset`open$$],
        ImageSize->Automatic]]}
    },
    GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
    GridBoxDividers->{"ColumnsIndexed" -> {{False}}, "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.5599999999999999]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.8]}, 
        Offset[0.2]}}],
   BaseStyle->"InformationTitleFrame"], "InformationGridPlain"]], "Output",
 CellChangeTimes->{3.7953272768947353`*^9, 3.8692252569182544`*^9},
 CellLabel->"Out[5]=",ExpressionUUID->"03980fbf-e48b-40a5-9059-8dee0ac79a22"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Tests", "Subchapter",
 CellChangeTimes->{{3.724944150579054*^9, 3.72494415164237*^9}, {
  3.8717209072821093`*^9, 
  3.871720907407771*^9}},ExpressionUUID->"97dcbe59-9af0-405a-b764-\
d960d343cd86"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"Get", "[", 
   RowBox[{"namepac", "<>", "\"\<`\>\""}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"addBasis", "[", 
  RowBox[{"\"\<comp\>\"", ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Ket", "[", "\"\<H\>\"", "]"}], ",", 
     RowBox[{"Ket", "[", "\"\<V\>\"", "]"}]}], "}"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"addBasis", "[", 
  RowBox[{"\"\<diag\>\"", ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Ket", "[", "\"\<D\>\"", "]"}], ",", 
     RowBox[{"Ket", "[", "\"\<A\>\"", "]"}]}], "}"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"addBasis", "[", 
  RowBox[{"\"\<circ\>\"", ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Ket", "[", "\"\<R\>\"", "]"}], ",", 
     RowBox[{"Ket", "[", "\"\<L\>\"", "]"}]}], "}"}]}], "]"}], "\n", 
 RowBox[{"addBasis", "[", 
  RowBox[{"\"\<coco\>\"", ",", 
   RowBox[{"infiniteBasis", "[", "g", "]"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"addBasis", "[", 
   RowBox[{"\"\<nono\>\"", ",", 
    RowBox[{"infiniteBasis", "[", "\"\<no\>\"", "]"}]}], "]"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"addBasis", "[", 
     RowBox[{"\"\<nono\>\"", ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Ket", "[", "aa", "]"}], ",", 
        RowBox[{"Ket", "[", "jj", "]"}], ",", 
        RowBox[{"Ket", "[", "uu", "]"}]}], "}"}]}], "]"}], 
    "\[IndentingNewLine]", 
    RowBox[{"addBasis", "[", 
     RowBox[{"\"\<bi\>\"", ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Ket", "[", "\"\<0\>\"", "]"}], ",", 
        RowBox[{"Ket", "[", "\"\<1\>\"", "]"}]}], "}"}]}], "]"}], 
    "\[IndentingNewLine]", 
    RowBox[{"addBasis", "[", 
     RowBox[{"\"\<coco\>\"", ",", 
      RowBox[{"infiniteBasis", "[", "g", "]"}]}], "]"}], 
    "\[IndentingNewLine]", 
    RowBox[{"addBasis", "[", 
     RowBox[{"\"\<fakecoco\>\"", ",", 
      RowBox[{"infiniteBasis", "[", "\"\<g\>\"", "]"}]}], "]"}], 
    "\[IndentingNewLine]", 
    RowBox[{"addBasis", "[", 
     RowBox[{"\"\<abc\>\"", ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Ket", "[", "\"\<a\>\"", "]"}], ",", 
        RowBox[{"Ket", "[", "\"\<b\>\"", "]"}], ",", 
        RowBox[{"Ket", "[", "\"\<c\>\"", "]"}], ",", 
        RowBox[{"Ket", "[", "\"\<d\>\"", "]"}]}], "}"}]}], "]"}], 
    "\[IndentingNewLine]", 
    RowBox[{"addBasis", "[", 
     RowBox[{"\"\<two\>\"", ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Ket", "[", 
         RowBox[{"{", 
          RowBox[{"1", ",", "1"}], "}"}], "]"}], ",", 
        RowBox[{"Ket", "[", 
         RowBox[{"{", 
          RowBox[{"2", ",", "1"}], "}"}], "]"}]}], "}"}]}], "]"}]}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"addBasisTransformation", "[", 
  RowBox[{"\"\<comp\>\"", ",", "\"\<diag\>\"", ",", 
   RowBox[{
    FractionBox["1", 
     SqrtBox["2"]], 
    RowBox[{"(", GridBox[{
       {"1", "1"},
       {"1", 
        RowBox[{"-", "1"}]}
      }], ")"}]}]}], "]"}], "\n", 
 RowBox[{"addBasisTransformation", "[", 
  RowBox[{"\"\<comp\>\"", ",", "\"\<circ\>\"", ",", 
   RowBox[{
    FractionBox["1", 
     SqrtBox["2"]], 
    RowBox[{"(", GridBox[{
       {"1", "I"},
       {"1", 
        RowBox[{"-", "I"}]}
      }], ")"}]}]}], "]"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.701262808731648*^9, 3.7012628141296463`*^9}, {
   3.701262875441284*^9, 3.701262883955488*^9}, 3.7012637131535063`*^9, {
   3.701267214232396*^9, 3.7012672154115877`*^9}, 3.7014381794969873`*^9, {
   3.7023118575439568`*^9, 3.702311857775771*^9}, {3.703014505696639*^9, 
   3.703014505905322*^9}, {3.7030240778028173`*^9, 3.7030240780914307`*^9}, 
   3.703362423871112*^9, 3.703957583216042*^9, 3.704044112726296*^9, 
   3.705432695588635*^9, 3.7091995992637243`*^9, 3.7115609583626833`*^9, 
   3.7133731837060747`*^9, {3.7138097734864473`*^9, 3.7138097739185038`*^9}, {
   3.724943224563416*^9, 3.724943224609151*^9}, 3.7249447934342012`*^9, {
   3.724945344628037*^9, 3.724945344767839*^9}, {3.7249511901691923`*^9, 
   3.72495121298682*^9}, {3.725542380169465*^9, 3.7255424024307747`*^9}, {
   3.734879965949986*^9, 3.734879966190078*^9}, {3.734880431484353*^9, 
   3.734880431639228*^9}, {3.734888105765256*^9, 3.73488812443934*^9}, {
   3.7348901063972473`*^9, 3.734890111570965*^9}, {3.735207434627379*^9, 
   3.735207483830862*^9}, {3.7568240160035524`*^9, 3.7568240669834433`*^9}, 
   3.756829307969902*^9, 3.7570869306697645`*^9, {3.757091205769281*^9, 
   3.7570912061103992`*^9}, {3.7570912478606434`*^9, 
   3.7570912544832897`*^9}, {3.7580294243178883`*^9, 3.758029425035968*^9}, {
   3.7589705404619484`*^9, 3.758970540505865*^9}},
 CellLabel->"In[6]:=",ExpressionUUID->"740e1e74-44bf-4ee9-9442-345eec41e2c3"],

Cell[BoxData["\<\"For information on usage, see Information for any of the \
following symbols: idket, partTr, partTrSymb, partTrInt, toKet, fromKet, \
toKetBra, fromKetBra, linearCombinationQ, replaceKet, factorKetsList, \
kroneckerKetProducts, getSpecs, infiniteBasis, generateKets, getSpecs, \
onBases, addBasis, clearBasis, identifyBases, basisVectorQ, basisQ, Ket, Bra, \
Tr, Normalize, Norm, changeBasis, AngleBracket, $evaluateBasisProduct, \
infiniteBasisQ, addBasisTransformation, getInfiniteLabel, \
$onBasesTransformations, clearBasisTransformation, checkBasisTr, permuteKets, \
unfactorKetsList\"\>"], "Print",
 CellChangeTimes->{
  3.758970565192979*^9, 3.7589712958010287`*^9, {3.758971969916811*^9, 
   3.7589720472531815`*^9}, 3.758972090551206*^9, 3.7589721274476967`*^9, 
   3.758973848089736*^9, 3.7589741668081813`*^9, {3.758979362616873*^9, 
   3.758979379233423*^9}, {3.758979440748867*^9, 3.7589794410420837`*^9}, 
   3.7589795172103305`*^9, 3.758979715892656*^9, {3.758981612401061*^9, 
   3.758981612594545*^9}, 3.7589826395743413`*^9, 3.7589827457174053`*^9, 
   3.758982794313409*^9, {3.758982829938113*^9, 3.7589828303440332`*^9}, {
   3.7589849928811736`*^9, 3.7589849931414766`*^9}, 3.7589850728412795`*^9, 
   3.7589855017848415`*^9, 3.7589857167807207`*^9, 3.759037385911827*^9, 
   3.7590378815220547`*^9, 3.7590383006458855`*^9, 3.7590386117057934`*^9, {
   3.7590386918703513`*^9, 3.759038713528412*^9}, 3.759039874252752*^9, 
   3.759039975003413*^9, 3.759040267052932*^9, 3.759040353421359*^9, 
   3.7590403889097624`*^9, 3.7590408408517137`*^9, 3.7590409592138405`*^9, 
   3.759041031414957*^9, 3.7590410682878036`*^9, 3.75904348174958*^9, {
   3.7590435223352427`*^9, 3.759043544485388*^9}, 3.7590438158569555`*^9, 
   3.7590577919028764`*^9, 3.7601725453075404`*^9, {3.760193445011058*^9, 
   3.7601934620425067`*^9}, 3.7602511702039213`*^9, 3.760355423258322*^9, 
   3.7606831395755844`*^9, 3.761999983112815*^9, 3.762004450367428*^9, 
   3.762004671488715*^9, 3.7620047342042685`*^9, 3.762004943978905*^9, {
   3.7620050492011847`*^9, 3.762005062478945*^9}, 3.7620051023298683`*^9, 
   3.762100511879198*^9, 3.762599758092557*^9, 3.762602952695302*^9, 
   3.764079549223931*^9, 3.7953272802728815`*^9, 3.869225257154621*^9},
 CellLabel->
  "During evaluation of \
In[6]:=",ExpressionUUID->"8d5d9e06-1432-4c57-9202-95f277c834c2"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"{", 
   RowBox[{"mat", ",", "bas1", ",", "bas2"}], "}"}], "=", 
  RowBox[{"fromKetBra", "[", 
   RowBox[{
    RowBox[{"\[Alpha]", 
     RowBox[{
      TemplateBox[{"\"V\""},
       "Ket"], "**", 
      TemplateBox[{"\"V\""},
       "Bra"]}]}], "+", 
    RowBox[{"2", " ", 
     RowBox[{
      TemplateBox[{"\"V\""},
       "Ket"], "**", 
      TemplateBox[{"\"V\""},
       "Bra"]}]}], "+", 
    RowBox[{"3", " ", 
     RowBox[{
      TemplateBox[{"\"V\""},
       "Ket"], "**", 
      TemplateBox[{"\"H\""},
       "Bra"]}]}], "+", 
    RowBox[{"4", " ", "\[Beta]", " ", 
     RowBox[{
      TemplateBox[{"\"V\""},
       "Ket"], "**", 
      TemplateBox[{"\"V\""},
       "Bra"]}]}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Normal", "[", "mat", "]"}], "//", "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.7572301773029313`*^9, 3.7572302590421467`*^9}, 
   3.757230442685651*^9, {3.7572305638457212`*^9, 3.7572305697277513`*^9}, {
   3.7572306441795588`*^9, 3.757230645965394*^9}, {3.757231171329432*^9, 
   3.7572311728198366`*^9}, {3.7572312100254*^9, 3.7572312101440845`*^9}},
 CellLabel->"In[15]:=",ExpressionUUID->"1aad7da6-d5dc-484a-92e0-45f23f79e76f"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   InterpretationBox[
    RowBox[{
     TagBox["SparseArray",
      "SummaryHead"], "[", 
     DynamicModuleBox[{Typeset`open$$ = False, Typeset`embedState$$ = 
      "Ready"}, 
      TemplateBox[{
        PaneSelectorBox[{False -> GridBox[{{
              PaneBox[
               ButtonBox[
                DynamicBox[
                 FEPrivate`FrontEndResource[
                 "FEBitmaps", "SquarePlusIconMedium"]], 
                ButtonFunction :> (Typeset`open$$ = True), Appearance -> None,
                 Evaluator -> Automatic, Method -> "Preemptive"], 
               Alignment -> {Center, Center}, ImageSize -> 
               Dynamic[{
                 Automatic, 
                  3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                   Magnification])}]], 
              GraphicsBox[
               
               RasterBox[{{{0.772061, 0.92462, 0.998703}, {0.5, 0., 0.}}, {{
                0.235431, 0.32765, 0.833291}, {0.235431, 0.32765, 
                0.833291}}}, {{0, 0}, {2, 2}}, {0, 1}], AspectRatio -> 1, 
               Axes -> False, Frame -> False, FrameLabel -> {None, None}, 
               FrameStyle -> Directive[
                 Opacity[0.5], 
                 Thickness[Tiny], 
                 RGBColor[0.368417, 0.506779, 0.709798]], 
               FrameTicks -> {{None, None}, {None, None}}, GridLinesStyle -> 
               Directive[
                 GrayLevel[0.5, 0.4]], ImageSize -> 
               Dynamic[{
                 Automatic, 
                  3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                   Magnification])}], 
               Method -> {
                "AxisPadding" -> Scaled[0.02], "DefaultBoundaryStyle" -> 
                 Automatic, 
                 "DefaultGraphicsInteraction" -> {
                  "Version" -> 1.2, "TrackMousePosition" -> {True, False}, 
                   "Effects" -> {
                    "Highlight" -> {"ratio" -> 2}, 
                    "HighlightPoint" -> {"ratio" -> 2}, 
                    "Droplines" -> {
                    "freeformCursorMode" -> True, 
                    "placement" -> {"x" -> "All", "y" -> "None"}}}}, 
                 "DefaultPlotStyle" -> Automatic, "DomainPadding" -> 
                 Scaled[0.02], "RangePadding" -> Scaled[0.05]}], 
              GridBox[{{
                 RowBox[{
                   TagBox[
                   "\"Specified elements: \"", "SummaryItemAnnotation"], 
                   "\[InvisibleSpace]", 
                   TagBox["2", "SummaryItem"]}]}, {
                 RowBox[{
                   TagBox["\"Dimensions: \"", "SummaryItemAnnotation"], 
                   "\[InvisibleSpace]", 
                   TagBox[
                    RowBox[{"{", 
                    RowBox[{"2", ",", "2"}], "}"}], "SummaryItem"]}]}}, 
               GridBoxAlignment -> {
                "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
               False, GridBoxItemSize -> {
                "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
               GridBoxSpacings -> {
                "Columns" -> {{2}}, "Rows" -> {{Automatic}}}, 
               BaseStyle -> {
                ShowStringCharacters -> False, NumberMarks -> False, 
                 PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
            GridBoxAlignment -> {"Rows" -> {{Top}}}, AutoDelete -> False, 
            GridBoxItemSize -> {
             "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
            BaselinePosition -> {1, 1}], True -> GridBox[{{
              PaneBox[
               ButtonBox[
                DynamicBox[
                 FEPrivate`FrontEndResource[
                 "FEBitmaps", "SquareMinusIconMedium"]], 
                ButtonFunction :> (Typeset`open$$ = False), Appearance -> 
                None, Evaluator -> Automatic, Method -> "Preemptive"], 
               Alignment -> {Center, Center}, ImageSize -> 
               Dynamic[{
                 Automatic, 
                  3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                   Magnification])}]], 
              GraphicsBox[
               
               RasterBox[{{{0.772061, 0.92462, 0.998703}, {0.5, 0., 0.}}, {{
                0.235431, 0.32765, 0.833291}, {0.235431, 0.32765, 
                0.833291}}}, {{0, 0}, {2, 2}}, {0, 1}], AspectRatio -> 1, 
               Axes -> False, Frame -> False, FrameLabel -> {None, None}, 
               FrameStyle -> Directive[
                 Opacity[0.5], 
                 Thickness[Tiny], 
                 RGBColor[0.368417, 0.506779, 0.709798]], 
               FrameTicks -> {{None, None}, {None, None}}, GridLinesStyle -> 
               Directive[
                 GrayLevel[0.5, 0.4]], ImageSize -> 
               Dynamic[{
                 Automatic, 
                  3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                   Magnification])}], 
               Method -> {
                "AxisPadding" -> Scaled[0.02], "DefaultBoundaryStyle" -> 
                 Automatic, 
                 "DefaultGraphicsInteraction" -> {
                  "Version" -> 1.2, "TrackMousePosition" -> {True, False}, 
                   "Effects" -> {
                    "Highlight" -> {"ratio" -> 2}, 
                    "HighlightPoint" -> {"ratio" -> 2}, 
                    "Droplines" -> {
                    "freeformCursorMode" -> True, 
                    "placement" -> {"x" -> "All", "y" -> "None"}}}}, 
                 "DefaultPlotStyle" -> Automatic, "DomainPadding" -> 
                 Scaled[0.02], "RangePadding" -> Scaled[0.05]}], 
              GridBox[{{
                 RowBox[{
                   TagBox[
                   "\"Specified elements: \"", "SummaryItemAnnotation"], 
                   "\[InvisibleSpace]", 
                   TagBox["2", "SummaryItem"]}]}, {
                 RowBox[{
                   TagBox["\"Dimensions: \"", "SummaryItemAnnotation"], 
                   "\[InvisibleSpace]", 
                   TagBox[
                    RowBox[{"{", 
                    RowBox[{"2", ",", "2"}], "}"}], "SummaryItem"]}]}, {
                 RowBox[{
                   TagBox["\"Default: \"", "SummaryItemAnnotation"], 
                   "\[InvisibleSpace]", 
                   TagBox["0", "SummaryItem"]}]}, {
                 RowBox[{
                   TagBox["\"Density: \"", "SummaryItemAnnotation"], 
                   "\[InvisibleSpace]", 
                   TagBox["0.5`", "SummaryItem"]}]}, {
                 RowBox[{
                   TagBox["\"Elements:\"", "SummaryItemAnnotation"], 
                   "\[InvisibleSpace]", 
                   TagBox["\"\"", "SummaryItem"]}]}, {
                 TagBox[
                  TagBox[
                   GridBox[{{
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"2", ",", "1"}], "}"}], "\[Rule]", 
                    StyleBox[
                    PaneBox[
                    "3", ContentPadding -> False, FrameMargins -> 0, 
                    StripOnInput -> True, BaselinePosition -> Baseline, 
                    ImageSize -> {{1, 300}, Automatic}], LineBreakWithin -> 
                    False]}]}, {
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"2", ",", "2"}], "}"}], "\[Rule]", 
                    StyleBox[
                    PaneBox[
                    RowBox[{"2", "+", "\[Alpha]", "+", 
                    RowBox[{"4", " ", "\[Beta]"}]}], ContentPadding -> False, 
                    FrameMargins -> 0, StripOnInput -> True, BaselinePosition -> 
                    Baseline, ImageSize -> {{1, 300}, Automatic}], 
                    LineBreakWithin -> False]}]}}, 
                    GridBoxAlignment -> {"Columns" -> {{Left}}}, 
                    DefaultBaseStyle -> "Column", 
                    GridBoxItemSize -> {
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}], 
                   "Column"], "SummaryItem"]}}, 
               GridBoxAlignment -> {
                "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
               False, GridBoxItemSize -> {
                "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
               GridBoxSpacings -> {
                "Columns" -> {{2}}, "Rows" -> {{Automatic}}}, 
               BaseStyle -> {
                ShowStringCharacters -> False, NumberMarks -> False, 
                 PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
            GridBoxAlignment -> {"Rows" -> {{Top}}}, AutoDelete -> False, 
            GridBoxItemSize -> {
             "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
            BaselinePosition -> {1, 1}]}, 
         Dynamic[Typeset`open$$], ImageSize -> Automatic]},
       "SummaryPanel"],
      DynamicModuleValues:>{}], "]"}],
    SparseArray[
    Automatic, {2, 2}, 0, {
     1, {{0, 0, 2}, {{1}, {2}}}, {
      3, 2 + $CellContext`\[Alpha] + 4 $CellContext`\[Beta]}}],
    Editable->False,
    SelectWithContents->True,
    Selectable->False], ",", 
   RowBox[{"{", 
    RowBox[{
     TemplateBox[{"\"H\""},
      "Ket"], ",", 
     TemplateBox[{"\"V\""},
      "Ket"]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     TemplateBox[{"\"H\""},
      "Ket"], ",", 
     TemplateBox[{"\"V\""},
      "Ket"]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.75904381702464*^9, 3.8692252839729*^9},
 CellLabel->"Out[15]=",ExpressionUUID->"0bf4224d-2874-491e-8183-e41d7ef41ae2"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "0"},
     {"3", 
      RowBox[{"2", "+", "\[Alpha]", "+", 
       RowBox[{"4", " ", "\[Beta]"}]}]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.75904381702464*^9, 3.8692252840397234`*^9},
 CellLabel->
  "Out[16]//MatrixForm=",ExpressionUUID->"849814cf-280e-4057-95a2-\
d8d34de20ac4"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"?", "fromKetBra"}]], "Input",
 CellChangeTimes->{{3.75904382556468*^9, 3.7590438397242007`*^9}},
 CellLabel->"In[17]:=",ExpressionUUID->"a55fb1b7-d949-4d51-a43e-0e9560d1c0b8"],

Cell[BoxData[
 InterpretationBox[
  StyleBox[
   FrameBox[
    DynamicModuleBox[{System`InformationDump`open$$ = False, 
     System`InformationDump`mouseOver$$ = False}, 
     PaneSelectorBox[{True->
      TagBox[GridBox[{
         {
          ItemBox[
           PaneBox[
            StyleBox["\<\" Symbol\"\>", "InformationTitleText",
             StripOnInput->False,
             BaseStyle -> None],
            FrameMargins->{{4, 0}, {-1, 1}}],
           BaseStyle->"InformationTitleBackground",
           StripOnInput->False], 
          ItemBox["\<\"\"\>",
           BaseStyle->"InformationTitleBackground",
           StripOnInput->False]},
         {
          ItemBox[
           PaneBox[
            
            StyleBox["\<\"fromKetBra[\\!\\(\\*FormBox[StyleBox[\\\"expr\\\", \
Italic, Rule[StripOnInput, False]], TraditionalForm]\\)_, \
\\!\\(\\*FormBox[StyleBox[\\\"outbasis\\\", Italic, Rule[StripOnInput, \
False]], TraditionalForm]\\)_, \\!\\(\\*FormBox[StyleBox[\\\"inbasis\\\", \
Italic, Rule[StripOnInput, False]], TraditionalForm]\\)_]: From operator \
expressed as \\!\\(\\*FormBox[StyleBox[\\\"expr\\\", Italic, \
Rule[StripOnInput, False]], TraditionalForm]\\) in terms of ketbras returns \
its matrix representation. Only operators acting on unipartite systems are \
allowed. The second and third arguments specify output and input bases in \
which the operator is expressed. If the third argument is omitted, it is \
taken to be identical to the second argument. If both, second and third, \
arguments are omitted, the input and output bases are inferred from \
\\!\\(\\*FormBox[StyleBox[\\\"expr\\\", Italic, Rule[StripOnInput, False]], \
TraditionalForm]\\). In such a case the minimum necessary number of basis \
vectors is chosen leading to a rectangular matrix, in general.\"\>", 
             "InformationUsageText",
             StripOnInput->False,
             LineSpacing->{1.5, 1.5, 3.}],
            FrameMargins->{{10, 10}, {8, 10}}],
           BaseStyle->"InformationUsageSubtitleBackground",
           StripOnInput->False], 
          ItemBox["\<\"\"\>",
           BaseStyle->"InformationUsageSubtitleBackground",
           StripOnInput->False]},
         {
          PaneBox[GridBox[{
             {
              
              DynamicModuleBox[{System`InformationDump`open$$ = {
               False, False, False, False, False, False, False, False, False, 
                False, False, False}}, 
               StyleBox[GridBox[{
                  {
                   TagBox[
                    TooltipBox[
                    StyleBox["\<\" Definitions\"\>", "InformationRowLabel",
                    StripOnInput->False],
                    "\"Definitions\"",
                    TooltipStyle->"TextStyling"],
                    Annotation[#, "Definitions", "Tooltip"]& ], GridBox[{
                    {
                    RowBox[{
                    RowBox[{"fromKetBra", "[", 
                    RowBox[{
                    "KetsBras`Private`expr_", ",", 
                    "KetsBras`Private`basis_"}], "]"}], ":=", 
                    RowBox[{"fromKetBra", "[", 
                    RowBox[{
                    "KetsBras`Private`expr", ",", "KetsBras`Private`basis", 
                    ",", "KetsBras`Private`basis"}], "]"}]}]},
                    {
                    RowBox[{
                    RowBox[{"fromKetBra", "[", 
                    RowBox[{"KetsBras`Private`expr_", ",", 
                    RowBox[{"KetsBras`Private`outbasis", ":", 
                    RowBox[{"\<\"Identify\"\>", "|", 
                    RowBox[{"{", "__Ket", "}"}]}], ":", "\<\"Identify\"\>"}], 
                    ",", 
                    RowBox[{"KetsBras`Private`inbasis", ":", 
                    RowBox[{"\<\"Identify\"\>", "|", 
                    RowBox[{"{", "__Ket", "}"}]}], 
                    ":", "\<\"Identify\"\>"}]}], "]"}], ":=", 
                    RowBox[{"Module", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    "KetsBras`Private`raw", ",", "KetsBras`Private`outspace", 
                    ",", "KetsBras`Private`inspace", ",", 
                    "KetsBras`Private`specs", ",", "KetsBras`Private`coefs", 
                    ",", "KetsBras`Private`locinbas", ",", 
                    "KetsBras`Private`locoutbas", ",", "KetsBras`Private`pos",
                     ",", "KetsBras`Private`outer", ",", 
                    "KetsBras`Private`absent", ",", "KetsBras`Private`mat", 
                    ",", "KetsBras`Private`locexpr"}], "}"}], ",", 
                    RowBox[{
                    RowBox[{"KetsBras`Private`locexpr", "=", 
                    RowBox[{"KetsBras`Private`parseKetBraSpecs", "[", 
                    RowBox[{"KetsBras`Private`expr", ",", "fromKet"}], 
                    "]"}]}], ";", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"KetsBras`Private`locexpr", "===", "$Failed"}], 
                    ",", 
                    RowBox[{"Return", "[", "]"}], ",", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    "KetsBras`Private`locexpr", ",", "KetsBras`Private`coefs",
                     ",", "KetsBras`Private`specs"}], "}"}], "=", 
                    "KetsBras`Private`locexpr"}]}], "]"}], ";", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"!", 
                    RowBox[{
                    "DuplicateFreeQ", "[", "KetsBras`Private`specs", "]"}]}], 
                    ",", 
                    RowBox[{
                    RowBox[{"Message", "[", 
                    StyleBox[
                    RowBox[{"fromKet", "::", "multterm"}], "MessageName"], 
                    "]"}], ";", 
                    RowBox[{"Return", "[", "]"}]}]}], "]"}], ";", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{"Union", "[", 
                    RowBox[{"Length", "/@", "KetsBras`Private`specs"}], "]"}],
                     "]"}], ">", "1"}], ",", 
                    RowBox[{
                    RowBox[{"Message", "[", 
                    StyleBox[
                    RowBox[{"fromKet", "::", "diffsub"}], "MessageName"], 
                    "]"}], ";", 
                    RowBox[{"Return", "[", "]"}]}]}], "]"}], ";", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    "KetsBras`Private`outspace", ",", 
                    "KetsBras`Private`inspace"}], "}"}], "=", 
                    RowBox[{
                    "Transpose", "[", "KetsBras`Private`specs", "]"}]}], ";", 
                    
                    RowBox[{"KetsBras`Private`locinbas", "=", 
                    RowBox[{"KetsBras`Private`createIdentifiedBasis", "[", 
                    RowBox[{
                    "KetsBras`Private`inbasis", ",", 
                    "KetsBras`Private`inspace", ",", "False", ",", 
                    "fromKetBra"}], "]"}]}], ";", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"KetsBras`Private`locinbas", "===", "Null"}], ",", 
                    RowBox[{"Return", "[", "]"}]}], "]"}], ";", 
                    RowBox[{"KetsBras`Private`locoutbas", "=", 
                    RowBox[{"KetsBras`Private`createIdentifiedBasis", "[", 
                    RowBox[{
                    "KetsBras`Private`outbasis", ",", 
                    "KetsBras`Private`outspace", ",", "False", ",", 
                    "fromKetBra"}], "]"}]}], ";", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"KetsBras`Private`locoutbas", "===", "Null"}], 
                    ",", 
                    RowBox[{"Return", "[", "]"}]}], "]"}], ";", 
                    RowBox[{"KetsBras`Private`outer", "=", 
                    RowBox[{"Outer", "[", 
                    RowBox[{
                    "List", ",", "KetsBras`Private`locoutbas", ",", 
                    "KetsBras`Private`locinbas"}], "]"}]}], ";", 
                    RowBox[{"KetsBras`Private`pos", "=", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"FirstPosition", "[", 
                    RowBox[{"KetsBras`Private`outer", ",", "#1"}], "]"}], 
                    "&"}], ")"}], "/@", "KetsBras`Private`specs"}]}], ";", 
                    RowBox[{"KetsBras`Private`absent", "=", 
                    RowBox[{"Flatten", "[", 
                    RowBox[{"Position", "[", 
                    RowBox[{"KetsBras`Private`pos", ",", "_Missing"}], "]"}], 
                    "]"}]}], ";", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"KetsBras`Private`absent", "\[NotEqual]", 
                    RowBox[{"{", "}"}]}], ",", 
                    RowBox[{
                    RowBox[{"KetsBras`Private`absent", "=", 
                    RowBox[{
                    "KetsBras`Private`specs", "\[LeftDoubleBracket]", 
                    "KetsBras`Private`absent", "\[RightDoubleBracket]"}]}], 
                    ";", 
                    RowBox[{"Message", "[", 
                    RowBox[{
                    StyleBox[
                    RowBox[{"fromKetBra", "::", "absent"}], "MessageName"], 
                    ",", 
                    RowBox[{"Apply", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"#1", "**", 
                    RowBox[{"ConjugateTranspose", "[", "#2", "]"}]}], "&"}], 
                    ",", "KetsBras`Private`absent", ",", 
                    RowBox[{"{", "1", "}"}]}], "]"}], ",", 
                    RowBox[{"Short", "[", "KetsBras`Private`locoutbas", "]"}],
                     ",", 
                    RowBox[{
                    "Short", "[", "KetsBras`Private`locinbas", "]"}]}], "]"}],
                     ";", 
                    RowBox[{"Return", "[", "]"}]}]}], "]"}], ";", 
                    RowBox[{"KetsBras`Private`mat", "=", 
                    RowBox[{"SparseArray", "[", 
                    RowBox[{
                    RowBox[{"{", "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    "Length", "[", "KetsBras`Private`locoutbas", "]"}], ",", 
                    RowBox[{"Length", "[", "KetsBras`Private`locinbas", 
                    "]"}]}], "}"}]}], "]"}]}], ";", 
                    RowBox[{"Apply", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"KetsBras`Private`mat", "\[LeftDoubleBracket]", 
                    RowBox[{"Sequence", "@@", "#1"}], 
                    "\[RightDoubleBracket]"}], "=", "#2"}], ")"}], "&"}], ",", 
                    RowBox[{"Transpose", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    "KetsBras`Private`pos", ",", "KetsBras`Private`coefs"}], 
                    "}"}], "]"}], ",", 
                    RowBox[{"{", "1", "}"}]}], "]"}], ";", 
                    RowBox[{"{", 
                    RowBox[{
                    "KetsBras`Private`mat", ",", "KetsBras`Private`locoutbas",
                     ",", "KetsBras`Private`locinbas"}], "}"}]}]}], "]"}]}]}
                    },
                    DefaultBaseStyle->"Column",
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}]},
                  {
                   TagBox[
                    TooltipBox[
                    
                    StyleBox["\<\" Default Definitions\"\>", 
                    "InformationRowLabel",
                    StripOnInput->False],
                    "\"DefaultValues\"",
                    TooltipStyle->"TextStyling"],
                    Annotation[#, "DefaultValues", "Tooltip"]& ], 
                   InterpretationBox[GridBox[{
                    {
                    RowBox[{
                    RowBox[{"SyntaxInformation", "[", "fromKetBra", "]"}], 
                    "=", 
                    RowBox[{"{", 
                    RowBox[{"\<\"ArgumentsPattern\"\>", "\[Rule]", 
                    RowBox[{"{", "__", "}"}]}], "}"}]}]}
                    },
                    BaselinePosition->{Baseline, {1, 1}},
                    GridBoxAlignment->{
                    "Columns" -> {{Left}}, "Rows" -> {{Baseline}}}],
                    
                    ColumnForm[{
                    SyntaxInformation[KetsBras`fromKetBra] = {
                    "ArgumentsPattern" -> {
                    BlankSequence[]}}}],
                    Editable->False]},
                  {
                   TagBox[
                    TooltipBox[
                    StyleBox["\<\" Full Name\"\>", "InformationRowLabel",
                    StripOnInput->False],
                    "\"FullName\"",
                    TooltipStyle->"TextStyling"],
                    
                    Annotation[#, "FullName", 
                    "Tooltip"]& ], "\<\"KetsBras`fromKetBra\"\>"}
                 },
                 AutoDelete->False,
                 GridBoxAlignment->{"Columns" -> {Right, Left}},
                 GridBoxDividers->None,
                 GridBoxItemSize->{"Columns" -> {Automatic, Automatic}},
                 GridBoxSpacings->{"Columns" -> {
                    Offset[0.27999999999999997`], {
                    Offset[0.5599999999999999]}, 
                    Offset[0.27999999999999997`]}, "Rows" -> {
                    Offset[0.2], {
                    Offset[0.8]}, 
                    Offset[0.2]}}], "DialogStyle",
                StripOnInput->False],
               DynamicModuleValues:>{}]}
            },
            DefaultBaseStyle->"Column",
            GridBoxAlignment->{"Columns" -> {{Left}}},
            GridBoxDividers->{"Columns" -> {{False}}, "Rows" -> {{False}}},
            
            GridBoxItemSize->{
             "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}},
            GridBoxSpacings->{"Columns" -> {
                Offset[0.27999999999999997`], {
                 Offset[0.5599999999999999]}, 
                Offset[0.27999999999999997`]}, "Rows" -> {
                Offset[0.2], {
                 Offset[3.6]}, 
                Offset[0.2]}}],
           FrameMargins->6], ""},
         {
          ItemBox[
           TagBox[
            ButtonBox[
             PaneSelectorBox[{False->
              
              DynamicBox[FEPrivate`FrontEndResource[
               "FEBitmaps", "UpPointerOpener"]], True->
              
              DynamicBox[FEPrivate`FrontEndResource[
               "FEBitmaps", "UpPointerOpenerHot"]]}, Dynamic[
              System`InformationDump`mouseOver$$]],
             Alignment->Left,
             Appearance->{"Default" -> None},
             
             ButtonFunction:>FEPrivate`Set[
              System`InformationDump`open$$, False],
             Evaluator->Automatic,
             FrameMargins->{{9, 0}, {0, 0}},
             ImageMargins->0,
             ImageSize->Full,
             Method->"Preemptive"],
            
            EventHandlerTag[{
             "MouseEntered" :> 
              FEPrivate`Set[System`InformationDump`mouseOver$$, True], 
              "MouseExited" :> 
              FEPrivate`Set[System`InformationDump`mouseOver$$, False], 
              Method -> "Preemptive", PassEventsDown -> Automatic, 
              PassEventsUp -> True}]],
           BaseStyle->"InformationTitleBackground",
           StripOnInput->False], "\[SpanFromLeft]"}
        },
        AutoDelete->False,
        FrameStyle->Directive[
          GrayLevel[0.8], 
          Thickness[Tiny]],
        GridBoxAlignment->{"Columns" -> {Left, Right}, "Rows" -> {{Center}}},
        GridBoxDividers->{
         "Columns" -> {{None}}, "Rows" -> {False, {True}, False}},
        GridBoxItemSize->{
         "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
       "Grid"], False->
      TagBox[GridBox[{
         {
          ItemBox[
           PaneBox[
            StyleBox["\<\" Symbol\"\>", "InformationTitleText",
             StripOnInput->False],
            FrameMargins->{{4, 0}, {-1, 1}}],
           BaseStyle->"InformationTitleBackground",
           StripOnInput->False], 
          ItemBox["\<\"\"\>",
           BaseStyle->"InformationTitleBackground",
           StripOnInput->False]},
         {
          ItemBox[
           PaneBox[
            
            StyleBox["\<\"fromKetBra[\\!\\(\\*FormBox[StyleBox[\\\"expr\\\", \
Italic, Rule[StripOnInput, False]], TraditionalForm]\\)_, \
\\!\\(\\*FormBox[StyleBox[\\\"outbasis\\\", Italic, Rule[StripOnInput, \
False]], TraditionalForm]\\)_, \\!\\(\\*FormBox[StyleBox[\\\"inbasis\\\", \
Italic, Rule[StripOnInput, False]], TraditionalForm]\\)_]: From operator \
expressed as \\!\\(\\*FormBox[StyleBox[\\\"expr\\\", Italic, \
Rule[StripOnInput, False]], TraditionalForm]\\) in terms of ketbras returns \
its matrix representation. Only operators acting on unipartite systems are \
allowed. The second and third arguments specify output and input bases in \
which the operator is expressed. If the third argument is omitted, it is \
taken to be identical to the second argument. If both, second and third, \
arguments are omitted, the input and output bases are inferred from \
\\!\\(\\*FormBox[StyleBox[\\\"expr\\\", Italic, Rule[StripOnInput, False]], \
TraditionalForm]\\). In such a case the minimum necessary number of basis \
vectors is chosen leading to a rectangular matrix, in general.\"\>", 
             "InformationUsageText",
             StripOnInput->False,
             LineSpacing->{1.5, 1.5, 3.}],
            FrameMargins->{{10, 10}, {8, 10}}],
           BaseStyle->"InformationUsageSubtitleBackground",
           StripOnInput->False], 
          ItemBox["\<\"\"\>",
           BaseStyle->"InformationUsageSubtitleBackground",
           StripOnInput->False]},
         {
          ItemBox[
           TagBox[
            ButtonBox[
             PaneSelectorBox[{False->
              
              DynamicBox[FEPrivate`FrontEndResource[
               "FEBitmaps", "DownPointerOpener"],
               ImageSizeCache->{10., {3., 7.}}], True->
              
              DynamicBox[FEPrivate`FrontEndResource[
               "FEBitmaps", "DownPointerOpenerHot"],
               ImageSizeCache->{10., {3., 7.}}]}, Dynamic[
              System`InformationDump`mouseOver$$]],
             Alignment->Left,
             Appearance->{"Default" -> None},
             
             ButtonFunction:>FEPrivate`Set[
              System`InformationDump`open$$, True],
             Evaluator->Automatic,
             FrameMargins->{{9, 0}, {0, 0}},
             ImageMargins->0,
             ImageSize->Full,
             Method->"Preemptive"],
            
            EventHandlerTag[{
             "MouseEntered" :> 
              FEPrivate`Set[System`InformationDump`mouseOver$$, True], 
              "MouseExited" :> 
              FEPrivate`Set[System`InformationDump`mouseOver$$, False], 
              Method -> "Preemptive", PassEventsDown -> Automatic, 
              PassEventsUp -> True}]],
           BaseStyle->"InformationTitleBackground",
           StripOnInput->False], "\[SpanFromLeft]"}
        },
        AutoDelete->False,
        FrameStyle->Directive[
          GrayLevel[0.8], 
          Thickness[Tiny]],
        GridBoxAlignment->{"Columns" -> {Left, Right}, "Rows" -> {{Center}}},
        GridBoxDividers->{
         "Columns" -> {{None}}, "Rows" -> {False, {True}, False}},
        GridBoxItemSize->{
         "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
       "Grid"]}, Dynamic[System`InformationDump`open$$],
      BaselinePosition->Baseline,
      FrameMargins->0,
      ImageSize->Automatic],
     DynamicModuleValues:>{}],
    BaseStyle->"InformationGridFrame",
    StripOnInput->False], "InformationGridPlain",
   StripOnInput->False],
  InformationData[<|
   "ObjectType" -> "Symbol", "Usage" -> 
    "fromKetBra[\!\(\*FormBox[StyleBox[\"expr\", Italic, Rule[StripOnInput, \
False]], TraditionalForm]\)_, \!\(\*FormBox[StyleBox[\"outbasis\", Italic, \
Rule[StripOnInput, False]], TraditionalForm]\)_, \
\!\(\*FormBox[StyleBox[\"inbasis\", Italic, Rule[StripOnInput, False]], \
TraditionalForm]\)_]: From operator expressed as \
\!\(\*FormBox[StyleBox[\"expr\", Italic, Rule[StripOnInput, False]], \
TraditionalForm]\) in terms of ketbras returns its matrix representation. \
Only operators acting on unipartite systems are allowed. The second and third \
arguments specify output and input bases in which the operator is expressed. \
If the third argument is omitted, it is taken to be identical to the second \
argument. If both, second and third, arguments are omitted, the input and \
output bases are inferred from \!\(\*FormBox[StyleBox[\"expr\", Italic, \
Rule[StripOnInput, False]], TraditionalForm]\). In such a case the minimum \
necessary number of basis vectors is chosen leading to a rectangular matrix, \
in general.", "Documentation" -> None, "OwnValues" -> None, "UpValues" -> 
    None, "DownValues" -> 
    Information`InformationValueForm[
     DownValues, KetsBras`fromKetBra, {KetsBras`fromKetBra[
         Pattern[KetsBras`Private`expr, 
          Blank[]], 
         Pattern[KetsBras`Private`basis, 
          Blank[]]] :> 
       KetsBras`fromKetBra[
        KetsBras`Private`expr, KetsBras`Private`basis, 
         KetsBras`Private`basis], KetsBras`fromKetBra[
         Pattern[KetsBras`Private`expr, 
          Blank[]], 
         Optional[
          Pattern[KetsBras`Private`outbasis, 
           Alternatives["Identify", {
             BlankSequence[Ket]}]], "Identify"], 
         Optional[
          Pattern[KetsBras`Private`inbasis, 
           Alternatives["Identify", {
             BlankSequence[Ket]}]], "Identify"]] :> 
       Module[{KetsBras`Private`raw, KetsBras`Private`outspace, 
          KetsBras`Private`inspace, KetsBras`Private`specs, 
          KetsBras`Private`coefs, KetsBras`Private`locinbas, 
          KetsBras`Private`locoutbas, KetsBras`Private`pos, 
          KetsBras`Private`outer, KetsBras`Private`absent, 
          KetsBras`Private`mat, KetsBras`Private`locexpr}, 
         KetsBras`Private`locexpr = 
          KetsBras`Private`parseKetBraSpecs[
           KetsBras`Private`expr, KetsBras`fromKet]; 
         If[KetsBras`Private`locexpr === $Failed, 
           
           Return[], {
            KetsBras`Private`locexpr, KetsBras`Private`coefs, 
             KetsBras`Private`specs} = KetsBras`Private`locexpr]; If[
           Not[
            DuplicateFreeQ[KetsBras`Private`specs]], Message[
             MessageName[KetsBras`fromKet, "multterm"]]; Return[]]; 
         If[Length[
             Union[
              Map[Length, KetsBras`Private`specs]]] > 1, Message[
             MessageName[KetsBras`fromKet, "diffsub"]]; Return[]]; {
           KetsBras`Private`outspace, KetsBras`Private`inspace} = 
          Transpose[KetsBras`Private`specs]; 
         KetsBras`Private`locinbas = 
          KetsBras`Private`createIdentifiedBasis[
           KetsBras`Private`inbasis, KetsBras`Private`inspace, False, 
            KetsBras`fromKetBra]; If[KetsBras`Private`locinbas === Null, 
           Return[]]; 
         KetsBras`Private`locoutbas = 
          KetsBras`Private`createIdentifiedBasis[
           KetsBras`Private`outbasis, KetsBras`Private`outspace, False, 
            KetsBras`fromKetBra]; If[KetsBras`Private`locoutbas === Null, 
           Return[]]; 
         KetsBras`Private`outer = 
          Outer[List, KetsBras`Private`locoutbas, KetsBras`Private`locinbas]; 
         KetsBras`Private`pos = 
          Map[FirstPosition[KetsBras`Private`outer, #]& , 
            KetsBras`Private`specs]; KetsBras`Private`absent = Flatten[
            Position[KetsBras`Private`pos, 
             Blank[Missing]]]; 
         If[KetsBras`Private`absent != {}, 
           KetsBras`Private`absent = 
            Part[KetsBras`Private`specs, KetsBras`Private`absent]; Message[
             MessageName[KetsBras`fromKetBra, "absent"], 
             Apply[NonCommutativeMultiply[#, 
               ConjugateTranspose[#2]]& , KetsBras`Private`absent, {1}], 
             Short[KetsBras`Private`locoutbas], 
             Short[KetsBras`Private`locinbas]]; Return[]]; 
         KetsBras`Private`mat = SparseArray[{}, {
             Length[KetsBras`Private`locoutbas], 
             Length[KetsBras`Private`locinbas]}]; 
         Apply[(Part[KetsBras`Private`mat, 
             Apply[Sequence, #]] = #2)& , 
           Transpose[{KetsBras`Private`pos, KetsBras`Private`coefs}], {1}]; {
          KetsBras`Private`mat, KetsBras`Private`locoutbas, 
           KetsBras`Private`locinbas}]}], "SubValues" -> None, 
    "DefaultValues" -> 
    Information`InformationValueForm[
     DefaultValues, KetsBras`fromKetBra, {
      SyntaxInformation[KetsBras`fromKetBra] -> {"ArgumentsPattern" -> {
           BlankSequence[]}}}], "NValues" -> None, "FormatValues" -> None, 
    "Options" -> None, "Attributes" -> {}, "FullName" -> 
    "KetsBras`fromKetBra"|>, False]]], "Output",
 CellChangeTimes->{3.869225289053308*^9},
 CellLabel->"Out[17]=",ExpressionUUID->"b0072373-45b5-4a16-88ea-0338095e0f5f"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"fromKet", "[", 
  RowBox[{
   RowBox[{"Ket", "[", 
    RowBox[{"1", ",", "2"}], "]"}], "+", 
   RowBox[{"3", " ", 
    RowBox[{"Ket", "[", 
     RowBox[{"3", ",", "2"}], "]"}]}]}], "]"}]], "Input",
 CellChangeTimes->{{3.7590438992963552`*^9, 3.75904390734869*^9}},
 CellLabel->"In[54]:=",ExpressionUUID->"2ac60cb2-f977-4f06-bed1-57f6373b15cb"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"1", ",", "0", ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     TemplateBox[{
       RowBox[{"1", ",", "2"}]},
      "Ket"], ",", 
     TemplateBox[{
       RowBox[{"2", ",", "2"}]},
      "Ket"], ",", 
     TemplateBox[{
       RowBox[{"3", ",", "2"}]},
      "Ket"]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.759043907791201*^9},
 CellLabel->"Out[54]=",ExpressionUUID->"ed948eea-09eb-4367-9ab2-2c2ae8dd4827"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"fromKetBra", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Ket", "[", 
      RowBox[{"1", ",", "2"}], "]"}], "**", 
     RowBox[{"Bra", "[", 
      RowBox[{"2", ",", "2"}], "]"}]}], "+", 
    RowBox[{"3", " ", 
     RowBox[{
      RowBox[{"Ket", "[", 
       RowBox[{"3", ",", "2"}], "]"}], "**", 
      RowBox[{"Bra", "[", 
       RowBox[{"3", ",", "2"}], "]"}]}]}]}], "]"}], "//", "Normal"}]], "Input",\

 CellChangeTimes->{{3.7590438992963552`*^9, 3.759043947912069*^9}, {
  3.759044024786749*^9, 3.759044035003563*^9}},
 CellLabel->"In[58]:=",ExpressionUUID->"c3cebedd-91bf-4b9d-ba93-af850b35bda1"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "3"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     TemplateBox[{
       RowBox[{"1", ",", "2"}]},
      "Ket"], ",", 
     TemplateBox[{
       RowBox[{"3", ",", "2"}]},
      "Ket"]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     TemplateBox[{
       RowBox[{"2", ",", "2"}]},
      "Ket"], ",", 
     TemplateBox[{
       RowBox[{"3", ",", "2"}]},
      "Ket"]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.7590440255979414`*^9, 3.7590440353525853`*^9}},
 CellLabel->"Out[58]=",ExpressionUUID->"af707b08-a06e-4366-8a75-fa5c5449e193"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"fromKetBra", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Ket", "[", 
      RowBox[{"1", ",", "\"\<V\>\""}], "]"}], "**", 
     RowBox[{"Bra", "[", 
      RowBox[{"2", ",", "\"\<H\>\""}], "]"}]}], "+", 
    RowBox[{"3", " ", 
     RowBox[{
      RowBox[{"Ket", "[", 
       RowBox[{"3", ",", "\"\<V\>\""}], "]"}], "**", 
      RowBox[{"Bra", "[", 
       RowBox[{"3", ",", "\"\<H\>\""}], "]"}]}]}]}], "]"}], "//", 
  "Normal"}]], "Input",
 CellChangeTimes->{{3.7590438992963552`*^9, 3.759043947912069*^9}, {
  3.759044024786749*^9, 3.7590440683117886`*^9}},
 CellLabel->"In[59]:=",ExpressionUUID->"60206da7-c882-41ac-a9c8-3144774e612f"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "3", ",", "0"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     TemplateBox[{
       RowBox[{"1", ",", "\"H\""}]},
      "Ket"], ",", 
     TemplateBox[{
       RowBox[{"1", ",", "\"V\""}]},
      "Ket"], ",", 
     TemplateBox[{
       RowBox[{"3", ",", "\"H\""}]},
      "Ket"], ",", 
     TemplateBox[{
       RowBox[{"3", ",", "\"V\""}]},
      "Ket"]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     TemplateBox[{
       RowBox[{"2", ",", "\"H\""}]},
      "Ket"], ",", 
     TemplateBox[{
       RowBox[{"2", ",", "\"V\""}]},
      "Ket"], ",", 
     TemplateBox[{
       RowBox[{"3", ",", "\"H\""}]},
      "Ket"], ",", 
     TemplateBox[{
       RowBox[{"3", ",", "\"V\""}]},
      "Ket"]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.759044069870216*^9},
 CellLabel->"Out[59]=",ExpressionUUID->"3ccfcb73-ed7a-4583-8d78-b2964514c42f"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"fromKet", "[", 
  RowBox[{
   RowBox[{"Ket", "[", 
    RowBox[{"1", ",", "\"\<V\>\""}], "]"}], "+", 
   RowBox[{"3", " ", 
    RowBox[{"Ket", "[", 
     RowBox[{"3", ",", "\"\<V\>\""}], "]"}]}]}], "]"}]], "Input",
 CellChangeTimes->{{3.7590438992963552`*^9, 3.7590439278050795`*^9}},
 CellLabel->"In[55]:=",ExpressionUUID->"ebd11e3e-8f1a-4d40-9156-3fc29d313f66"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"0", ",", "1", ",", "0", ",", "0", ",", "0", ",", "3"}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{
     TemplateBox[{
       RowBox[{"1", ",", "\"H\""}]},
      "Ket"], ",", 
     TemplateBox[{
       RowBox[{"1", ",", "\"V\""}]},
      "Ket"], ",", 
     TemplateBox[{
       RowBox[{"2", ",", "\"H\""}]},
      "Ket"], ",", 
     TemplateBox[{
       RowBox[{"2", ",", "\"V\""}]},
      "Ket"], ",", 
     TemplateBox[{
       RowBox[{"3", ",", "\"H\""}]},
      "Ket"], ",", 
     TemplateBox[{
       RowBox[{"3", ",", "\"V\""}]},
      "Ket"]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.7590439282857943`*^9},
 CellLabel->"Out[55]=",ExpressionUUID->"72d2f727-0db1-4dae-b0fd-59c11bf601bd"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"state", "=", 
  RowBox[{
   RowBox[{"\[Alpha]", " ", "\[Beta]", " ", 
    RowBox[{"Ket", "[", 
     RowBox[{"a", ",", "b", ",", "v"}], "]"}]}], "+", " ", 
   RowBox[{"\[Gamma]", " ", 
    RowBox[{"Ket", "[", 
     RowBox[{"a", ",", "b", ",", "f"}], "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.757330192920431*^9, 3.757330229743927*^9}, {
  3.7576942639210634`*^9, 3.7576943046241884`*^9}, {3.7580236488517203`*^9, 
  3.758023653014554*^9}, {3.7580292225619497`*^9, 3.7580292255864553`*^9}, {
  3.758034797194248*^9, 3.7580348090786743`*^9}, {3.7580350451399207`*^9, 
  3.7580350817572174`*^9}, {3.758957613325924*^9, 3.75895761413976*^9}},
 CellLabel->"In[22]:=",ExpressionUUID->"5dd00cb0-afd0-4974-a6bb-7daff12536f1"],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[Gamma]", " ", 
   TemplateBox[{
     RowBox[{"a", ",", "b", ",", "f"}]},
    "Ket"]}], "+", 
  RowBox[{"\[Alpha]", " ", "\[Beta]", " ", 
   TemplateBox[{
     RowBox[{"a", ",", "b", ",", "v"}]},
    "Ket"]}]}]], "Output",
 CellChangeTimes->{
  3.757330230660483*^9, 3.757694136641506*^9, 3.757694267048667*^9, 
   3.757694305328264*^9, 3.75802190459748*^9, {3.7580236274509363`*^9, 
   3.7580236538573*^9}, 3.7580238193379173`*^9, 3.7580281625251875`*^9, 
   3.758028469004219*^9, 3.758029225946492*^9, 3.758030464154036*^9, 
   3.7580336943547935`*^9, 3.7580338100134664`*^9, {3.758034781021222*^9, 
   3.75803480986602*^9}, {3.7580350461298523`*^9, 3.7580350820943103`*^9}, 
   3.7589576168395033`*^9, 3.7589608177836185`*^9, 3.7590411687940674`*^9, 
   3.759043481833354*^9, 3.7590435480786266`*^9},
 CellLabel->"Out[22]=",ExpressionUUID->"aaf4c34f-8aa0-46b5-b6d8-1bda020bce51"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"state", "=", 
  RowBox[{
   RowBox[{
    SuperscriptBox["\[Alpha]", "2"], "\[Beta]", " ", 
    RowBox[{"Ket", "[", 
     RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}]}], "+", 
   RowBox[{
    SuperscriptBox["\[Alpha]", "2"], " ", "\[Beta]", " ", 
    RowBox[{"Ket", "[", 
     RowBox[{"a", ",", "e", ",", "g", ",", "d"}], "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.757330192920431*^9, 3.757330229743927*^9}, {
  3.7573306177630033`*^9, 3.7573306213424263`*^9}, {3.757658737282015*^9, 
  3.7576587496349435`*^9}},
 CellLabel->"In[23]:=",ExpressionUUID->"dd8aac6f-1ab4-491f-8100-0d2eece12a6b"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   SuperscriptBox["\[Alpha]", "2"], " ", "\[Beta]", " ", 
   TemplateBox[{
     RowBox[{"a", ",", "b", ",", "c", ",", "d"}]},
    "Ket"]}], "+", 
  RowBox[{
   SuperscriptBox["\[Alpha]", "2"], " ", "\[Beta]", " ", 
   TemplateBox[{
     RowBox[{"a", ",", "e", ",", "g", ",", "d"}]},
    "Ket"]}]}]], "Output",
 CellChangeTimes->{3.757330621941786*^9, 3.757330817042883*^9, 
  3.757332192900422*^9, 3.75765779750877*^9, 3.7576587505724287`*^9, 
  3.7580219055050535`*^9, 3.758873517797869*^9, 3.7588800078726406`*^9, 
  3.7589104223485813`*^9, 3.7589108887968197`*^9, 3.7589110197834263`*^9, 
  3.7589576280924015`*^9, 3.758960906188137*^9, 3.759041169834321*^9, 
  3.759043497138691*^9, 3.759043549449202*^9},
 CellLabel->"Out[23]=",ExpressionUUID->"336cfde8-673c-4b39-83fb-0975895f1e7b"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"factorKetsList", "[", "state", "]"}]], "Input",
 CellChangeTimes->{{3.7573301896262803`*^9, 3.757330190842988*^9}},
 CellLabel->"In[24]:=",ExpressionUUID->"49b48c0c-8138-418d-89e8-e30de87060e9"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", "0", "}"}], ",", 
     RowBox[{
      SuperscriptBox["\[Alpha]", "2"], " ", "\[Beta]"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", "1", "}"}], ",", 
     TemplateBox[{"a"},
      "Ket"]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"2", ",", "3"}], "}"}], ",", 
     RowBox[{
      TemplateBox[{
        RowBox[{"b", ",", "c"}]},
       "Ket"], "+", 
      TemplateBox[{
        RowBox[{"e", ",", "g"}]},
       "Ket"]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", "4", "}"}], ",", 
     TemplateBox[{"d"},
      "Ket"]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.758035049076215*^9, 3.7580350847821894`*^9}, 
   3.7588735202253757`*^9, 3.7588901314024954`*^9, 3.7589104325742273`*^9, 
   3.758910550921647*^9, 3.7589106894131775`*^9, 3.7589108904783216`*^9, 
   3.7589110211527634`*^9, 3.7589576294118905`*^9, 3.7589577329608755`*^9, {
   3.7589588487731733`*^9, 3.7589588610234036`*^9}, 3.7589600142371674`*^9, 
   3.7589601340885153`*^9, 3.758960737961147*^9, {3.7589609071226263`*^9, 
   3.7589609304133234`*^9}, 3.7589613600151253`*^9, 3.75896161931948*^9, 
   3.759041170740118*^9, 3.759042418713356*^9, 3.7590434979829454`*^9, 
   3.759043550552006*^9},
 CellLabel->"Out[24]=",ExpressionUUID->"7c4466c8-cbe3-4096-8838-1a3a7dfe5923"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"unfactorKetsList", "[", 
  RowBox[{"factorKetsList", "[", 
   RowBox[{"Ket", "[", "2", "]"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.7590412506902328`*^9, 3.759041256738534*^9}, {
   3.759042441296276*^9, 3.7590424441477647`*^9}, {3.7590425638275123`*^9, 
   3.759042566032523*^9}, 3.7590427511042013`*^9, {3.759042895237717*^9, 
   3.7590429429556017`*^9}},
 CellLabel->"In[25]:=",ExpressionUUID->"2b0d2cc7-ec06-4d2d-908e-6d89af35d2ba"],

Cell[BoxData[
 TemplateBox[{"2"},
  "Ket"]], "Output",
 CellChangeTimes->{{3.759042903215624*^9, 3.7590429436498013`*^9}, {
   3.759042975185255*^9, 3.7590429775363755`*^9}, {3.7590431342272463`*^9, 
   3.759043143842786*^9}, 3.7590434990356417`*^9, 3.7590435515801163`*^9},
 CellLabel->"Out[25]=",ExpressionUUID->"a6cc7b5e-4f30-4a3d-8dad-61d136a80a21"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"unfactorKetsList", "[", 
  RowBox[{"{", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", "0", "}"}], ",", "2"}], "}"}], "}"}], "]"}]], "Input",
 CellChangeTimes->{{3.759041265272842*^9, 3.7590412973975315`*^9}, {
  3.759043148857428*^9, 3.7590431490947905`*^9}},
 CellLabel->"In[26]:=",ExpressionUUID->"57e3123a-4217-4ab8-a53f-07061b409115"],

Cell[BoxData[
 RowBox[{"2", " ", 
  RowBox[{"CircleTimes", "[", "]"}]}]], "Output",
 CellChangeTimes->{3.759043149584978*^9, 3.759043500272686*^9, 
  3.759043552822648*^9},
 CellLabel->"Out[26]=",ExpressionUUID->"ea85a96b-b364-482b-a7e0-3cccb141f226"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"factorKetsList", "[", 
  RowBox[{
   RowBox[{"98790", "\[Alpha]", " ", 
    RowBox[{"Ket", "[", 
     RowBox[{"4", ",", "h", ",", "a", ",", "h"}], "]"}]}], "+", 
   RowBox[{"\[Alpha]", "   ", 
    RowBox[{"Ket", "[", 
     RowBox[{"4", ",", "h", ",", "b", ",", "h"}], "]"}]}]}], "]"}]], "Input",
 CellChangeTimes->{{3.7573301896262803`*^9, 3.757330190842988*^9}, {
   3.7580309857296314`*^9, 3.7580309991375017`*^9}, {3.758033900809799*^9, 
   3.758033907062939*^9}, {3.758033939204441*^9, 3.7580339596502924`*^9}, {
   3.7588800301829586`*^9, 3.7588800462018175`*^9}, 3.7588801378825645`*^9, {
   3.758880424334346*^9, 3.7588804594224844`*^9}, {3.7588804920751734`*^9, 
   3.7588804953005447`*^9}, {3.7588902632774396`*^9, 3.758890263885849*^9}, 
   3.758891801250206*^9, {3.7588918857691174`*^9, 3.7588919026967998`*^9}, {
   3.7590435862576575`*^9, 3.759043587536917*^9}},
 CellLabel->"In[30]:=",ExpressionUUID->"be41ef45-1113-41ad-84e0-ef67dbc59c8c"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", "0", "}"}], ",", "\[Alpha]"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", "1", "}"}], ",", 
     TemplateBox[{"4"},
      "Ket"]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", "2", "}"}], ",", 
     TemplateBox[{"h"},
      "Ket"]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", "3", "}"}], ",", 
     RowBox[{
      RowBox[{"98790", " ", 
       TemplateBox[{"a"},
        "Ket"]}], "+", 
      TemplateBox[{"b"},
       "Ket"]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", "4", "}"}], ",", 
     TemplateBox[{"h"},
      "Ket"]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.7588918017757673`*^9, {3.7588918868302827`*^9, 3.7588919326207514`*^9}, 
   3.7588922368469405`*^9, {3.758892396827982*^9, 3.758892413483428*^9}, 
   3.7588926190455437`*^9, 3.7589104395894623`*^9, {3.7589105679560776`*^9, 
   3.7589105851770124`*^9}, 3.7589106260736127`*^9, 3.7589106829684176`*^9, 
   3.758911025200936*^9, 3.7589576309427767`*^9, 3.7589577341307454`*^9, 
   3.7589596090466566`*^9, 3.758960015906659*^9, 3.758960135088874*^9, 
   3.75896051916343*^9, 3.7589607355735245`*^9, {3.758960908334385*^9, 
   3.7589609313787413`*^9}, 3.7589613609955025`*^9, 3.7589616202589645`*^9, 
   3.7590435539884615`*^9, 3.759043588123348*^9},
 CellLabel->"Out[30]=",ExpressionUUID->"4c233e15-7dea-4b54-9ef8-bace2ef6cf4c"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"unfactorKetsList", "[", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", "0", "}"}], ",", "\[Alpha]"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", "1", "}"}], ",", 
      TemplateBox[{"4"},
       "Ket"]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", "2", "}"}], ",", 
      TemplateBox[{"h"},
       "Ket"]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", "3", "}"}], ",", 
      RowBox[{
       RowBox[{"98790", " ", 
        TemplateBox[{"a"},
         "Ket"]}], "+", 
       TemplateBox[{"b"},
        "Ket"]}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", "4", "}"}], ",", 
      TemplateBox[{"h"},
       "Ket"]}], "}"}]}], "}"}], "]"}]], "Input",
 CellChangeTimes->{{3.7590435651691313`*^9, 3.7590435918209257`*^9}},
 CellLabel->"In[31]:=",ExpressionUUID->"40ddf86b-1f91-4e53-9b5f-c857a5c46046"],

Cell[BoxData[
 RowBox[{"\[Alpha]", " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"98790", " ", 
     TemplateBox[{
       RowBox[{"4", ",", "h", ",", "a", ",", "h"}]},
      "Ket"]}], "+", 
    TemplateBox[{
      RowBox[{"4", ",", "h", ",", "b", ",", "h"}]},
     "Ket"]}], ")"}]}]], "Output",
 CellChangeTimes->{{3.7590435699746737`*^9, 3.7590435925766687`*^9}},
 CellLabel->"Out[31]=",ExpressionUUID->"6ae42f8d-d608-44aa-812c-8352f4e939c7"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"factorKetsList", "[", 
  RowBox[{
   RowBox[{"98790", "\[Alpha]", " ", 
    RowBox[{
     RowBox[{"Ket", "[", 
      RowBox[{"4", ",", "h", ",", "h"}], "]"}], "**", 
     RowBox[{"Bra", "[", 
      RowBox[{"a", ",", "h", ",", "g"}], "]"}]}]}], "+", 
   RowBox[{"\[Alpha]", "  ", "3", " ", 
    RowBox[{
     RowBox[{"Ket", "[", 
      RowBox[{"4", ",", "h", ",", "5"}], "]"}], "**", 
     RowBox[{"Bra", "[", 
      RowBox[{"a", ",", "h", ",", "5"}], "]"}]}]}]}], "]"}]], "Input",
 CellLabel->"In[32]:=",ExpressionUUID->"46a11ce5-8184-461d-b515-65455f8918b5"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", "0", "}"}], ",", 
     RowBox[{"3", " ", "\[Alpha]"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", "1", "}"}], ",", 
     RowBox[{
      TemplateBox[{"4"},
       "Ket"], "**", 
      TemplateBox[{"a"},
       "Bra"]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", "2", "}"}], ",", 
     RowBox[{
      TemplateBox[{"h"},
       "Ket"], "**", 
      TemplateBox[{"h"},
       "Bra"]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", "3", "}"}], ",", 
     RowBox[{
      RowBox[{
       TemplateBox[{"5"},
        "Ket"], "**", 
       TemplateBox[{"5"},
        "Bra"]}], "+", 
      RowBox[{"32930", " ", 
       RowBox[{
        TemplateBox[{"h"},
         "Ket"], "**", 
        TemplateBox[{"g"},
         "Bra"]}]}]}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.7590436092125983`*^9},
 CellLabel->"Out[32]=",ExpressionUUID->"d7a4351d-3d1e-4bd3-aa47-8619dec98532"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"unfactorKetsList", "[", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", "0", "}"}], ",", 
      RowBox[{"3", " ", "\[Alpha]"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", "1", "}"}], ",", 
      RowBox[{
       TemplateBox[{"4"},
        "Ket"], "**", 
       TemplateBox[{"a"},
        "Bra"]}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", "2", "}"}], ",", 
      RowBox[{
       TemplateBox[{"h"},
        "Ket"], "**", 
       TemplateBox[{"h"},
        "Bra"]}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", "3", "}"}], ",", 
      RowBox[{
       RowBox[{
        TemplateBox[{"5"},
         "Ket"], "**", 
        TemplateBox[{"5"},
         "Bra"]}], "+", 
       RowBox[{"32930", " ", 
        RowBox[{
         TemplateBox[{"h"},
          "Ket"], "**", 
         TemplateBox[{"g"},
          "Bra"]}]}]}]}], "}"}]}], "}"}], "]"}]], "Input",
 CellChangeTimes->{{3.759043610068313*^9, 3.759043613951034*^9}},
 CellLabel->"In[33]:=",ExpressionUUID->"5181bab5-0050-48d3-925b-1ee464edb121"],

Cell[BoxData[
 RowBox[{"3", " ", "\[Alpha]", " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     TemplateBox[{
       RowBox[{"4", ",", "h", ",", "5"}]},
      "Ket"], "**", 
     TemplateBox[{
       RowBox[{"a", ",", "h", ",", "5"}]},
      "Bra"]}], "+", 
    RowBox[{"32930", " ", 
     RowBox[{
      TemplateBox[{
        RowBox[{"4", ",", "h", ",", "h"}]},
       "Ket"], "**", 
      TemplateBox[{
        RowBox[{"a", ",", "h", ",", "g"}]},
       "Bra"]}]}]}], ")"}]}]], "Output",
 CellChangeTimes->{3.759043614806883*^9},
 CellLabel->"Out[33]=",ExpressionUUID->"d9de62d3-df9e-40ef-90c0-139b49cf32ee"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"factorKetsList", "[", 
  RowBox[{
   RowBox[{"98790", "\[Alpha]", " ", 
    RowBox[{"Ket", "[", 
     RowBox[{"4", ",", "h", ",", "a", ",", "h"}], "]"}]}], "+", 
   RowBox[{"\[Alpha]", "   ", 
    RowBox[{"Ket", "[", 
     RowBox[{"4", ",", "j", ",", "a", ",", "h", ",", "t"}], "]"}]}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.7573301896262803`*^9, 3.757330190842988*^9}, {
   3.7580309857296314`*^9, 3.7580309991375017`*^9}, {3.758033900809799*^9, 
   3.758033907062939*^9}, {3.758033939204441*^9, 3.7580339596502924`*^9}, {
   3.7588800301829586`*^9, 3.7588800462018175`*^9}, 3.7588801378825645`*^9, {
   3.758880424334346*^9, 3.7588804594224844`*^9}, {3.7588804920751734`*^9, 
   3.7588804953005447`*^9}, {3.7588902632774396`*^9, 3.758890263885849*^9}, 
   3.758891801250206*^9, {3.7588918857691174`*^9, 3.7588919026967998`*^9}, {
   3.758960138667271*^9, 3.758960140661934*^9}, {3.7589605914610314`*^9, 
   3.7589605956927147`*^9}},
 CellLabel->"In[28]:=",ExpressionUUID->"0d97859f-eee6-4626-8fd1-d414d1402a4e"],

Cell[BoxData[
 TemplateBox[{
  "factorKetsList", "diffdim", 
   "\"Input expression is a linear combinations of terms with different \
number of subsystems. Such input expressions are not supported.\"", 2, 28, 1, 
   26191496410366677217, "Local", "KetsBras`factorKetsList"},
  "MessageTemplate2"]], "Message", "MSG",
 CellChangeTimes->{
  3.7589605965474296`*^9, {3.7589609094185*^9, 3.7589609323262067`*^9}, 
   3.7589613619360123`*^9, 3.7589616212263775`*^9, 3.759043555249106*^9},
 CellLabel->
  "During evaluation of \
In[28]:=",ExpressionUUID->"ca4f0485-477f-4c93-9302-8b58032d3b08"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"factorKetsList", "[", 
  RowBox[{"Ket", "[", 
   RowBox[{"4", ",", "j", ",", "a", ",", "h"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.7573301896262803`*^9, 3.757330190842988*^9}, {
   3.7580309857296314`*^9, 3.7580309991375017`*^9}, {3.758033900809799*^9, 
   3.758033907062939*^9}, {3.758033939204441*^9, 3.7580339596502924`*^9}, {
   3.7588800301829586`*^9, 3.7588800462018175`*^9}, 3.7588801378825645`*^9, {
   3.758880424334346*^9, 3.7588804594224844`*^9}, {3.7588804920751734`*^9, 
   3.7588804953005447`*^9}, {3.7588902632774396`*^9, 3.758890263885849*^9}, 
   3.758891801250206*^9, {3.7588918857691174`*^9, 3.7588919026967998`*^9}, {
   3.7589576889556274`*^9, 3.7589576956796045`*^9}},
 CellLabel->"In[70]:=",ExpressionUUID->"43074308-4085-4833-9161-d5423dcc1e09"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", "0", "}"}], ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", "1", "}"}], ",", 
     TemplateBox[{"4"},
      "Ket"]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", "2", "}"}], ",", 
     TemplateBox[{"j"},
      "Ket"]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", "3", "}"}], ",", 
     TemplateBox[{"a"},
      "Ket"]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", "4", "}"}], ",", 
     TemplateBox[{"h"},
      "Ket"]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.758957696386712*^9, 3.758959611523037*^9, {3.7589600174694753`*^9, 
   3.7589600423998227`*^9}, 3.758960136327527*^9, {3.7589602254950047`*^9, 
   3.758960228218904*^9}, 3.7589605040727963`*^9, 3.758960741042138*^9, {
   3.7589609105454717`*^9, 3.758960933392376*^9}, 3.758961362714946*^9, 
   3.7589616221900015`*^9},
 CellLabel->"Out[70]=",ExpressionUUID->"af47dd7a-5357-4708-a8ee-9979314cd5d4"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"FactorList", "[", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"Hold", "[", "a", "]"}], 
    RowBox[{"Hold", "[", "b", "]"}], 
    RowBox[{"Hold", "[", "c", "]"}]}], "}"}], "]"}]], "Input",
 CellChangeTimes->{{3.758960768945256*^9, 3.7589607855398636`*^9}},
 CellLabel->"In[71]:=",ExpressionUUID->"62aed573-7381-4d07-9c38-97d3f33b6c91"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"1", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Hold", "[", "a", "]"}], " ", 
       RowBox[{"Hold", "[", "b", "]"}], " ", 
       RowBox[{"Hold", "[", "c", "]"}]}], "}"}], ",", "1"}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.758960776369396*^9, 3.7589607873719673`*^9}, 
   3.758960911616606*^9, 3.7589613635937815`*^9, 3.7589616232409887`*^9},
 CellLabel->"Out[71]=",ExpressionUUID->"4500d38c-42b8-4830-938b-dc4ca6ad1b2b"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"factorKetsList", "[", 
  RowBox[{
   RowBox[{"98790", "\[Alpha]", " ", 
    RowBox[{
     RowBox[{"Ket", "[", 
      RowBox[{"4", ",", "h", ",", "h"}], "]"}], "**", 
     RowBox[{"Bra", "[", 
      RowBox[{"a", ",", "h", ",", "g"}], "]"}]}]}], "+", 
   RowBox[{"\[Alpha]", "  ", "3", " ", 
    RowBox[{
     RowBox[{"Ket", "[", 
      RowBox[{"4", ",", "h", ",", "5"}], "]"}], "**", 
     RowBox[{"Bra", "[", 
      RowBox[{"a", ",", "h", ",", "5"}], "]"}]}]}]}], "]"}]], "Input",
 CellChangeTimes->{{3.7573301896262803`*^9, 3.757330190842988*^9}, {
   3.7580309857296314`*^9, 3.7580309991375017`*^9}, {3.758033900809799*^9, 
   3.758033907062939*^9}, {3.758033939204441*^9, 3.7580339596502924`*^9}, {
   3.7588800301829586`*^9, 3.7588800462018175`*^9}, 3.7588801378825645`*^9, {
   3.758880424334346*^9, 3.7588804594224844`*^9}, {3.7588804920751734`*^9, 
   3.7588804953005447`*^9}, {3.7588899273270507`*^9, 
   3.7588899398246355`*^9}, {3.7588900029381337`*^9, 3.758890004060134*^9}, {
   3.7588903959824495`*^9, 3.758890396093154*^9}, {3.7588904827623105`*^9, 
   3.758890483422544*^9}, {3.758890711706911*^9, 3.758890720039603*^9}, {
   3.7588911851588793`*^9, 3.758891188545821*^9}, {3.7588922935821686`*^9, 
   3.758892296316886*^9}, {3.758961379594775*^9, 3.7589613940680676`*^9}},
 CellLabel->"In[50]:=",ExpressionUUID->"47a89d92-c240-4fca-b20e-dcb92bd45f6a"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", "0", "}"}], ",", 
     RowBox[{"3", " ", "\[Alpha]"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", "1", "}"}], ",", 
     RowBox[{
      TemplateBox[{"4"},
       "Ket"], "**", 
      TemplateBox[{"a"},
       "Bra"]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", "2", "}"}], ",", 
     RowBox[{
      TemplateBox[{"h"},
       "Ket"], "**", 
      TemplateBox[{"h"},
       "Bra"]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", "3", "}"}], ",", 
     RowBox[{
      RowBox[{
       TemplateBox[{"5"},
        "Ket"], "**", 
       TemplateBox[{"5"},
        "Bra"]}], "+", 
      RowBox[{"32930", " ", 
       RowBox[{
        TemplateBox[{"h"},
         "Ket"], "**", 
        TemplateBox[{"g"},
         "Bra"]}]}]}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.7589613950394335`*^9, 3.758961630696046*^9, 
  3.75904173413939*^9, 3.7590426641559134`*^9},
 CellLabel->"Out[50]=",ExpressionUUID->"62edda65-ae97-46c1-a885-c716f0c7f0eb"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", "0", "}"}], ",", 
     RowBox[{"3", " ", "\[Alpha]"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", "1", "}"}], ",", 
     RowBox[{
      TemplateBox[{"4"},
       "Ket"], "**", 
      TemplateBox[{"a"},
       "Bra"]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", "2", "}"}], ",", 
     RowBox[{
      TemplateBox[{"h"},
       "Ket"], "**", 
      TemplateBox[{"h"},
       "Bra"]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", "3", "}"}], ",", 
     RowBox[{
      RowBox[{
       TemplateBox[{"5"},
        "Ket"], "**", 
       TemplateBox[{"5"},
        "Bra"]}], "+", 
      RowBox[{"32930", " ", 
       RowBox[{
        TemplateBox[{"h"},
         "Ket"], "**", 
        TemplateBox[{"g"},
         "Bra"]}]}]}]}], "}"}]}], "}"}]], "Input",
 CellChangeTimes->{3.758910449625614*^9},
 CellLabel->"In[17]:=",ExpressionUUID->"3ba51152-6fbb-46fc-83ea-6d9c10b2b2a0"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", "0", "}"}], ",", 
     RowBox[{"3", " ", "\[Alpha]"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", "1", "}"}], ",", 
     RowBox[{
      TemplateBox[{"4"},
       "Ket"], "**", 
      TemplateBox[{"a"},
       "Bra"]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", "2", "}"}], ",", 
     RowBox[{
      TemplateBox[{"h"},
       "Ket"], "**", 
      TemplateBox[{"h"},
       "Bra"]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", "3", "}"}], ",", 
     RowBox[{
      RowBox[{
       TemplateBox[{"5"},
        "Ket"], "**", 
       TemplateBox[{"5"},
        "Bra"]}], "+", 
      RowBox[{"32930", " ", 
       RowBox[{
        TemplateBox[{"h"},
         "Ket"], "**", 
        TemplateBox[{"g"},
         "Bra"]}]}]}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.7589104498061337`*^9},
 CellLabel->"Out[17]=",ExpressionUUID->"6f4fa58b-5117-4754-8c61-c2eac18fe62c"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Replace", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"a", ",", 
     RowBox[{"{", 
      RowBox[{"3", ",", "4", ",", "a"}], "}"}]}], "}"}], ",", 
   RowBox[{"a", "->", "21"}], ",", 
   RowBox[{"{", "1", "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.7588802814525595`*^9, 3.7588803130011673`*^9}, {
  3.7588803540982633`*^9, 3.75888035826608*^9}},
 CellLabel->"In[4]:=",ExpressionUUID->"8ff5dbe2-03c5-499b-a75c-72bd59b22164"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"21", ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "4", ",", "a"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.7588803050713778`*^9, 3.758880317951922*^9}, {
  3.758880355144431*^9, 3.7588803586151476`*^9}},
 CellLabel->"Out[4]=",ExpressionUUID->"7728741d-5370-4cd3-8a69-49699d084233"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Ket", "[", "]"}], "/.", 
  RowBox[{
   RowBox[{"Ket", "[", "x__", "]"}], "\[RuleDelayed]", "x"}]}]], "Input",
 CellChangeTimes->{{3.758034035778343*^9, 3.7580340444163127`*^9}},
 CellLabel->"In[14]:=",ExpressionUUID->"75b2a879-b196-402c-8b2a-d9dda77c65ae"],

Cell[BoxData[
 RowBox[{"Ket", "[", "]"}]], "Output",
 CellChangeTimes->{3.758034067169468*^9},
 CellLabel->"Out[14]=",ExpressionUUID->"1d5db951-42f0-41c8-8e11-811ef5039b25"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"factorKetsList", "[", 
  RowBox[{"adsf", " ", "\[Beta]", " ", 
   RowBox[{
    RowBox[{"Ket", "[", "f", "]"}], "**", 
    RowBox[{"Bra", "[", "g", "]"}]}]}], "]"}]], "Input",
 CellChangeTimes->{{3.7580337308637424`*^9, 3.758033743348179*^9}, {
  3.758033822011028*^9, 3.7580338303077393`*^9}},
 CellLabel->"In[19]:=",ExpressionUUID->"160e1e90-de66-4033-8611-1243f2b088d9"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", "0", "}"}], ",", 
     RowBox[{"adsf", " ", "\[Beta]"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", "1", "}"}], ",", 
     RowBox[{
      TemplateBox[{"f"},
       "Ket"], "**", 
      TemplateBox[{"g"},
       "Bra"]}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.758033735079768*^9, 3.7580337441869326`*^9}, {
  3.7580338191649604`*^9, 3.758033830930219*^9}},
 CellLabel->"Out[19]=",ExpressionUUID->"a4d37279-6d7a-40a3-b804-87e07c568311"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"factorKetsList", "[", 
  RowBox[{
   RowBox[{"\[Alpha]", " ", 
    RowBox[{
     RowBox[{"Ket", "[", 
      RowBox[{"f", ",", "j"}], "]"}], "**", 
     RowBox[{"Bra", "[", 
      RowBox[{"g", ",", "k"}], "]"}]}]}], "+", 
   RowBox[{"\[Alpha]", " ", 
    RowBox[{
     RowBox[{"Ket", "[", 
      RowBox[{"f", ",", "j"}], "]"}], "**", 
     RowBox[{"Bra", "[", 
      RowBox[{"g", ",", "n"}], "]"}]}]}]}], "]"}]], "Input",
 CellChangeTimes->{{3.7580337308637424`*^9, 3.758033743348179*^9}, {
  3.758033822011028*^9, 3.758033866249522*^9}},
 CellLabel->"In[61]:=",ExpressionUUID->"41bb3c6d-da70-4faf-8c0c-181194d6a567"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", "0", "}"}], ",", "\[Alpha]"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", "1", "}"}], ",", 
     RowBox[{
      TemplateBox[{"f"},
       "Ket"], "**", 
      TemplateBox[{"g"},
       "Bra"]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", "2", "}"}], ",", 
     RowBox[{
      RowBox[{
       TemplateBox[{"j"},
        "Ket"], "**", 
       TemplateBox[{"k"},
        "Bra"]}], "+", 
      RowBox[{
       TemplateBox[{"j"},
        "Ket"], "**", 
       TemplateBox[{"n"},
        "Bra"]}]}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.7589596304673553`*^9},
 CellLabel->"Out[61]=",ExpressionUUID->"39ec0bad-cb12-441d-a218-654469d0c279"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"factorKetsList", "[", 
  RowBox[{"Ket", "[", 
   RowBox[{"0", ",", "2", ",", "1"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.7580288926027856`*^9, 3.758028898768241*^9}},
 CellLabel->"In[62]:=",ExpressionUUID->"1e10e4f0-73b4-42cf-bbc4-e53e2df55e60"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", "0", "}"}], ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", "1", "}"}], ",", 
     TemplateBox[{"0"},
      "Ket"]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", "2", "}"}], ",", 
     TemplateBox[{"2"},
      "Ket"]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", "3", "}"}], ",", 
     TemplateBox[{"1"},
      "Ket"]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.758028899355843*^9, 3.758028974112475*^9, 
  3.758029398594305*^9, 3.75802944302164*^9, 3.7580304798963366`*^9, 
  3.7589596560559044`*^9},
 CellLabel->"Out[62]=",ExpressionUUID->"a76fc3d0-04a9-471c-a73d-f5b4e0297dd4"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"factorKetsList", "[", 
  RowBox[{"Ket", "[", "0", "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.7580288926027856`*^9, 3.7580289094057083`*^9}},
 CellLabel->"In[64]:=",ExpressionUUID->"3317e9c6-4887-459a-8cc3-81b89abb2c2b"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", "0", "}"}], ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", "1", "}"}], ",", 
     TemplateBox[{"0"},
      "Ket"]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.75802890994227*^9, 3.7589596715295353`*^9},
 CellLabel->"Out[64]=",ExpressionUUID->"2407746e-9620-41fb-9db7-7d121f655d5e"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"replaceKet", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"\[Alpha]", " ", 
     RowBox[{"Ket", "[", 
      RowBox[{"1", ",", "A"}], "]"}]}], "+", 
    RowBox[{"\[Beta]", " ", 
     RowBox[{"Ket", "[", 
      RowBox[{"g", ",", "2", ",", "B"}], "]"}]}]}], ",", 
   RowBox[{
    RowBox[{"Ket", "[", "1", "]"}], "\[Rule]", 
    RowBox[{"Ket", "[", "jedna", "]"}]}]}], "]"}]], "Input",
 CellChangeTimes->{{3.7590375747935686`*^9, 3.7590376331035805`*^9}, {
  3.759037893914903*^9, 3.759037894105426*^9}},
 CellLabel->"In[38]:=",ExpressionUUID->"f18b38fd-c235-4743-9690-fd1af22fe92f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[Alpha]", " ", 
   TemplateBox[{
     RowBox[{"jedna", ",", "A"}]},
    "Ket"]}], "+", 
  RowBox[{"\[Beta]", " ", 
   TemplateBox[{
     RowBox[{"g", ",", "2", ",", "B"}]},
    "Ket"]}]}]], "Output",
 CellChangeTimes->{3.7590402679888697`*^9},
 CellLabel->"Out[38]=",ExpressionUUID->"4a445c1f-4aeb-4192-84e0-6e8cf23726cc"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"jedna", "=", "345"}]], "Input",
 CellChangeTimes->{{3.7590376402913933`*^9, 3.7590376412308407`*^9}},
 CellLabel->"In[14]:=",ExpressionUUID->"f2f463f0-66f2-4183-9cda-9cf5d42e960d"],

Cell[BoxData["345"], "Output",
 CellChangeTimes->{3.7590376414881525`*^9, 3.759037882805852*^9, 
  3.7590383007236757`*^9, 3.759039874440249*^9, 3.7590410684762993`*^9},
 CellLabel->"Out[14]=",ExpressionUUID->"0bc9b584-96ec-45f5-a85b-178c1dcc461a"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"g", "=", "4"}]], "Input",
 CellChangeTimes->{{3.759037890655629*^9, 3.7590378915193553`*^9}},
 CellLabel->"In[15]:=",ExpressionUUID->"2a0ab946-698e-4698-b93b-85344b3c8d76"],

Cell[BoxData["4"], "Output",
 CellChangeTimes->{3.759037891872367*^9, 3.7590383322962184`*^9},
 CellLabel->"Out[15]=",ExpressionUUID->"a6926065-a75c-4fce-8f8a-5455a52125e3"],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[Alpha]", " ", 
   TemplateBox[{
     RowBox[{"jedna", ",", "A"}]},
    "Ket"]}], "+", 
  RowBox[{"\[Beta]", " ", 
   TemplateBox[{
     RowBox[{"g", ",", "2", ",", "B"}]},
    "Ket"]}]}]], "Output",
 CellChangeTimes->{{3.7590378837271547`*^9, 3.7590378945252695`*^9}, 
   3.7590383333065176`*^9, 3.759039917265769*^9, 3.7590399775729833`*^9},
 CellLabel->"Out[24]=",ExpressionUUID->"e069aee4-3543-460b-b234-422ec16df820"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"replaceKet", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"\[Alpha]", " ", 
     RowBox[{
      RowBox[{"Ket", "[", 
       RowBox[{"1", ",", "A"}], "]"}], "**", 
      RowBox[{"Bra", "[", "4", "]"}]}]}], "+", 
    RowBox[{"\[Beta]", " ", 
     RowBox[{
      RowBox[{"Ket", "[", 
       RowBox[{"g", ",", "2", ",", "B"}], "]"}], "**", 
      RowBox[{"Bra", "[", 
       RowBox[{"6", ",", "1"}], "]"}]}]}]}], ",", 
   RowBox[{
    RowBox[{"Ket", "[", "1", "]"}], "\[Rule]", 
    RowBox[{"Ket", "[", "jedna", "]"}]}]}], "]"}]], "Input",
 CellChangeTimes->{
  3.7590376440672526`*^9, {3.759038616095048*^9, 3.7590386311029024`*^9}, 
   3.7590387263032384`*^9, 3.759040278673874*^9, 3.7590404001836643`*^9},
 CellLabel->"In[14]:=",ExpressionUUID->"25f0ae73-ca45-4d54-9211-ec021aed1dad"],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[Alpha]", " ", 
   RowBox[{
    TemplateBox[{
      RowBox[{"jedna", ",", "A"}]},
     "Ket"], "**", 
    TemplateBox[{"4"},
     "Bra"]}]}], "+", 
  RowBox[{"\[Beta]", " ", 
   RowBox[{
    TemplateBox[{
      RowBox[{"g", ",", "2", ",", "B"}]},
     "Ket"], "**", 
    TemplateBox[{
      RowBox[{"6", ",", "jedna"}]},
     "Bra"]}]}]}]], "Output",
 CellChangeTimes->{
  3.7590376441629972`*^9, 3.7590378848671055`*^9, 3.7590383348156457`*^9, 
   3.7590386316145377`*^9, {3.7590386944364853`*^9, 3.759038726862742*^9}, {
   3.759040270871769*^9, 3.7590402797430115`*^9}, {3.7590403398186455`*^9, 
   3.7590403552942553`*^9}, {3.759040391270053*^9, 3.7590404006530547`*^9}, 
   3.759040960769575*^9, 3.7590410826625323`*^9, 3.7953272806836424`*^9},
 CellLabel->"Out[14]=",ExpressionUUID->"7e5645c5-2e6a-4c91-b1fa-32915ac2bda4"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"replaceKet", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"\[Alpha]", " ", 
     RowBox[{
      RowBox[{"Ket", "[", 
       RowBox[{"1", ",", "A"}], "]"}], "**", 
      RowBox[{"Bra", "[", "4", "]"}]}]}], "+", 
    RowBox[{"\[Beta]", " ", 
     RowBox[{
      RowBox[{"Ket", "[", 
       RowBox[{"g", ",", "2", ",", "B"}], "]"}], "**", 
      RowBox[{"Bra", "[", 
       RowBox[{"6", ",", "1"}], "]"}]}]}]}], ",", 
   RowBox[{
    RowBox[{"Ket", "[", "A", "]"}], "\[Rule]", 
    RowBox[{"Ket", "[", "jedna", "]"}]}], ",", "2"}], "]"}]], "Input",
 CellChangeTimes->{
  3.7590376440672526`*^9, {3.759038616095048*^9, 3.7590386311029024`*^9}, 
   3.7590387263032384`*^9, 3.759040278673874*^9, 3.7590404001836643`*^9, {
   3.7953272838688526`*^9, 3.795327291779731*^9}},
 CellLabel->"In[16]:=",ExpressionUUID->"7493466b-5115-4f8a-8adb-87a401aeaf28"],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[Alpha]", " ", 
   RowBox[{
    TemplateBox[{
      RowBox[{"1", ",", "jedna"}]},
     "Ket"], "**", 
    TemplateBox[{"4"},
     "Bra"]}]}], "+", 
  RowBox[{"\[Beta]", " ", 
   RowBox[{
    TemplateBox[{
      RowBox[{"g", ",", "2", ",", "B"}]},
     "Ket"], "**", 
    TemplateBox[{
      RowBox[{"6", ",", "1"}]},
     "Bra"]}]}]}]], "Output",
 CellChangeTimes->{{3.7953272859389477`*^9, 3.7953272921914897`*^9}},
 CellLabel->"Out[16]=",ExpressionUUID->"32bffc2e-80a8-435e-af3c-235758006196"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"?", "replaceKet"}]], "Input",
 CellChangeTimes->{{3.7953273197677035`*^9, 3.7953273201095104`*^9}},
 CellLabel->"In[17]:=",ExpressionUUID->"76c63be2-d523-474d-8baf-2b9b53726114"],

Cell[BoxData[
 InterpretationBox[
  StyleBox[
   FrameBox[
    DynamicModuleBox[{System`InformationDump`open$$ = False, 
     System`InformationDump`mouseOver$$ = False}, 
     PaneSelectorBox[{True->
      TagBox[GridBox[{
         {
          ItemBox[
           PaneBox[
            StyleBox["\<\" Symbol\"\>", "InformationTitleText",
             StripOnInput->False,
             BaseStyle -> None],
            FrameMargins->{{4, 0}, {-1, 1}}],
           BaseStyle->"InformationTitleBackground",
           StripOnInput->False], 
          ItemBox["\<\"\"\>",
           BaseStyle->"InformationTitleBackground",
           StripOnInput->False]},
         {
          ItemBox[
           PaneBox[
            
            StyleBox["\<\"replaceKet[\\!\\(\\*FormBox[StyleBox[\\\"expr\\\", \
Italic, Rule[StripOnInput, False]], \
TraditionalForm]\\)_,\\!\\(\\*FormBox[StyleBox[\\\"patt\\\", Italic, \
Rule[StripOnInput, False]], TraditionalForm]\\)_,\\!\\(\\*FormBox[StyleBox[\\\
\"sub\\\", Italic, Rule[StripOnInput, False]], TraditionalForm]\\)_]: In a \
linear combination \\!\\(\\*FormBox[StyleBox[\\\"expr\\\", Italic, \
Rule[StripOnInput, False]], TraditionalForm]\\) of Kets of the form \
\\!\\(\\*FormBox[StyleBox[TemplateBox[List[RowBox[List[\\\"a1\\\", \\\",\\\", \
\\\"a2\\\", \\\",\\\", \\\"a3\\\", \\\",\\\", \\\"etc\\\"]]], \\\"Ket\\\"], \
Italic, Rule[StripOnInput, False]], TraditionalForm]\\) replaces expressions \
\\!\\(\\*FormBox[StyleBox[TemplateBox[List[\\\"ai\\\"], \\\"Ket\\\"], Italic, \
Rule[StripOnInput, False]], TraditionalForm]\\) according to pattern \
\\!\\(\\*FormBox[StyleBox[\\\"patt\\\", Italic, Rule[StripOnInput, False]], \
TraditionalForm]\\). The third, optional, argument specifies in which \
subsystem the replacement should be performed. For instance, \
replaceKet[\\!\\(\\*FormBox[StyleBox[TemplateBox[List[RowBox[List[\\\"1\\\", \
\\\",\\\", \\\"b\\\"]]], \\\"Ket\\\"], Italic, Rule[StripOnInput, False]], \
TraditionalForm]\\)+2.3 \
\\!\\(\\*FormBox[StyleBox[TemplateBox[List[RowBox[List[\\\"0\\\", \\\",\\\", \
\\\"2\\\", \\\",\\\", \\\"8\\\"]]], \\\"Ket\\\"], Italic, Rule[StripOnInput, \
False]], TraditionalForm]\\)+\\!\\(\\*FormBox[StyleBox[TemplateBox[List[\\\"b\
\\\"], \\\"Ket\\\"], Italic, Rule[StripOnInput, False]], \
TraditionalForm]\\),{\\!\\(\\*FormBox[StyleBox[TemplateBox[List[\\\"b\\\"], \
\\\"Ket\\\"], Italic, Rule[StripOnInput, False]], TraditionalForm]\\)->\\!\\(\
\\*FormBox[StyleBox[TemplateBox[List[RowBox[List[\\\"-\\\", \\\"5\\\"]]], \
\\\"Ket\\\"], Italic, Rule[StripOnInput, False]], \
TraditionalForm]\\),\\!\\(\\*FormBox[StyleBox[TemplateBox[List[\\\"8\\\"], \\\
\"Ket\\\"], Italic, Rule[StripOnInput, False]], \
TraditionalForm]\\)->\\!\\(\\*FormBox[StyleBox[TemplateBox[List[\\\"c\\\"], \
\\\"Ket\\\"], Italic, Rule[StripOnInput, False]], TraditionalForm]\\)},{1,3}] \
returns \\!\\(\\*FormBox[StyleBox[TemplateBox[List[RowBox[List[\\\"-\\\", \
\\\"5\\\"]]], \\\"Ket\\\"], Italic, Rule[StripOnInput, False]], \
TraditionalForm]\\)+\\!\\(\\*FormBox[StyleBox[TemplateBox[List[RowBox[List[\\\
\"1\\\", \\\",\\\", \\\"b\\\"]]], \\\"Ket\\\"], Italic, Rule[StripOnInput, \
False]], TraditionalForm]\\)+2.3 \
\\!\\(\\*FormBox[StyleBox[TemplateBox[List[RowBox[List[\\\"0\\\", \\\",\\\", \
\\\"2\\\", \\\",\\\", \\\"c\\\"]]], \\\"Ket\\\"], Italic, Rule[StripOnInput, \
False]], TraditionalForm]\\), since substitution is not done in the second \
subsystem. In \\!\\(\\*FormBox[StyleBox[\\\"patt\\\", Italic, \
Rule[StripOnInput, False]], TraditionalForm]\\) only unipartite replacement \
rules are allowed. If there is only one subsystem one wants to perform \
substitution in, one can omit braces and as \\!\\(\\*FormBox[StyleBox[\\\"sub\
\\\", Italic, Rule[StripOnInput, False]], TraditionalForm]\\) specify just \
the integral index. If the third argument is omitted, the substitutions are \
done in all subsystems.\"\>", "InformationUsageText",
             StripOnInput->False,
             LineSpacing->{1.5, 1.5, 3.}],
            FrameMargins->{{10, 10}, {8, 10}}],
           BaseStyle->"InformationUsageSubtitleBackground",
           StripOnInput->False], 
          ItemBox["\<\"\"\>",
           BaseStyle->"InformationUsageSubtitleBackground",
           StripOnInput->False]},
         {
          PaneBox[GridBox[{
             {
              
              DynamicModuleBox[{System`InformationDump`open$$ = {
               False, False, False, False, False, False, False, False, False, 
                False, False, False}}, 
               StyleBox[GridBox[{
                  {
                   TagBox[
                    TooltipBox[
                    StyleBox["\<\" Definitions\"\>", "InformationRowLabel",
                    StripOnInput->False],
                    "\"Definitions\"",
                    TooltipStyle->"TextStyling"],
                    Annotation[#, "Definitions", "Tooltip"]& ], GridBox[{
                    {
                    RowBox[{
                    RowBox[{"replaceKet", "[", 
                    RowBox[{
                    "KetsBras`Private`expr_", ",", "KetsBras`Private`patt_", 
                    ",", 
                    RowBox[{
                    "KetsBras`Private`sub_Integer", "?", "Positive"}]}], 
                    "]"}], ":=", 
                    RowBox[{"replaceKet", "[", 
                    RowBox[{
                    "KetsBras`Private`expr", ",", "KetsBras`Private`patt", 
                    ",", 
                    RowBox[{"{", "KetsBras`Private`sub", "}"}]}], "]"}]}]},
                    {
                    RowBox[{
                    RowBox[{"replaceKet", "[", 
                    RowBox[{
                    RowBox[{"KetsBras`Private`expr_", "?", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"linearCombinationQ", "[", 
                    RowBox[{"#1", ",", "_Ket"}], "]"}], "&"}], ")"}]}], ",", 
                    "KetsBras`Private`patt_", ",", 
                    RowBox[{"KetsBras`Private`sub_", ":", "All"}]}], "]"}], ":=", 
                    RowBox[{"Module", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    "KetsBras`Private`locexpr", ",", "KetsBras`Private`raw", 
                    ",", "KetsBras`Private`coefs", ",", 
                    "KetsBras`Private`specs", ",", 
                    RowBox[{
                    "KetsBras`Private`locpatt", "=", 
                    "KetsBras`Private`patt"}], ",", 
                    "KetsBras`Private`locsub"}], "}"}], ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    "KetsBras`Private`locexpr", ",", "KetsBras`Private`coefs",
                     ",", "KetsBras`Private`specs"}], "}"}], "=", 
                    RowBox[{"KetsBras`Private`parseKetSpecs", "[", 
                    RowBox[{"KetsBras`Private`expr", ",", "replaceKet"}], 
                    "]"}]}], ";", 
                    RowBox[{"KetsBras`Private`raw", "=", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"#1", ",", 
                    RowBox[{"List", "@@", 
                    RowBox[{"Ket", "/@", "#1"}]}]}], "}"}], "&"}], ")"}], "/@",
                     "KetsBras`Private`specs"}]}], ";", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"KetsBras`Private`raw", "\[Equal]", 
                    RowBox[{"{", "}"}]}], ",", 
                    RowBox[{"Return", "[", "KetsBras`Private`expr", "]"}]}], 
                    "]"}], ";", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Head", "[", "KetsBras`Private`locpatt", "]"}], "=!=",
                     "List"}], ",", 
                    RowBox[{"KetsBras`Private`locpatt", "=", 
                    RowBox[{"{", "KetsBras`Private`locpatt", "}"}]}]}], "]"}],
                     ";", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"!", 
                    RowBox[{"AllTrue", "[", 
                    RowBox[{"KetsBras`Private`locpatt", ",", 
                    RowBox[{"MatchQ", "[", 
                    RowBox[{"_Ket", "\[Rule]", 
                    RowBox[{"_", "?", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"linearCombinationQ", "[", 
                    RowBox[{"#1", ",", "_Ket"}], "]"}], "&"}], ")"}]}]}], 
                    "]"}]}], "]"}]}], ",", 
                    RowBox[{"Message", "[", 
                    StyleBox[
                    RowBox[{"replaceKet", "::", "invpatt"}], "MessageName"], 
                    "]"}]}], "]"}], ";", 
                    RowBox[{"KetsBras`Private`replaceKetInternal", "[", 
                    RowBox[{
                    "KetsBras`Private`expr", ",", "KetsBras`Private`raw", ",",
                     "KetsBras`Private`sub", ",", 
                    "KetsBras`Private`locpatt"}], "]"}]}]}], "]"}]}]},
                    {
                    RowBox[{
                    RowBox[{"replaceKet", "[", 
                    RowBox[{
                    RowBox[{"KetsBras`Private`expr_", "?", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"linearCombinationQ", "[", 
                    RowBox[{"#1", ",", 
                    RowBox[{
                    TemplateBox[{"__"},
                    "Ket"], "**", 
                    TemplateBox[{"__"},
                    "Bra"]}]}], "]"}], "&"}], ")"}]}], ",", 
                    "KetsBras`Private`patt_", ",", 
                    RowBox[{"KetsBras`Private`sub_", ":", "All"}]}], "]"}], ":=", 
                    RowBox[{"Module", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    "KetsBras`Private`locexpr", ",", 
                    "KetsBras`Private`ketraw", ",", "KetsBras`Private`braraw",
                     ",", "KetsBras`Private`coefs", ",", 
                    "KetsBras`Private`specs", ",", 
                    RowBox[{
                    "KetsBras`Private`ketpatt", "=", 
                    "KetsBras`Private`patt"}], ",", 
                    "KetsBras`Private`brapatt", ",", 
                    "KetsBras`Private`ketlist", ",", 
                    "KetsBras`Private`bralist"}], "}"}], ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    "KetsBras`Private`locexpr", ",", "KetsBras`Private`coefs",
                     ",", "KetsBras`Private`specs"}], "}"}], "=", 
                    RowBox[{"KetsBras`Private`parseKetBraSpecs", "[", 
                    RowBox[{"KetsBras`Private`expr", ",", "replaceKet"}], 
                    "]"}]}], ";", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    "KetsBras`Private`ketlist", ",", 
                    "KetsBras`Private`bralist"}], "}"}], "=", 
                    RowBox[{
                    "Transpose", "[", "KetsBras`Private`specs", "]"}]}], ";", 
                    
                    RowBox[{"KetsBras`Private`ketraw", "=", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"#1", ",", 
                    RowBox[{"List", "@@", 
                    RowBox[{"Ket", "/@", "#1"}]}]}], "}"}], "&"}], ")"}], "/@",
                     "KetsBras`Private`ketlist"}]}], ";", 
                    RowBox[{"KetsBras`Private`braraw", "=", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"#1", ",", 
                    RowBox[{"List", "@@", 
                    RowBox[{"Ket", "/@", "#1"}]}]}], "}"}], "&"}], ")"}], "/@",
                     "KetsBras`Private`bralist"}]}], ";", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"KetsBras`Private`ketraw", "\[Equal]", 
                    RowBox[{"{", "}"}]}], "&&", 
                    RowBox[{"KetsBras`Private`braraw", "\[Equal]", 
                    RowBox[{"{", "}"}]}]}], ",", 
                    RowBox[{"Return", "[", "KetsBras`Private`expr", "]"}]}], 
                    "]"}], ";", 
                    RowBox[{"KetsBras`Private`braraw", "=", 
                    RowBox[{
                    "KetsBras`Private`braraw", "/.", "\[VeryThinSpace]", 
                    RowBox[{"Ket", "\[Rule]", "Bra"}]}]}], ";", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Head", "[", "KetsBras`Private`ketpatt", "]"}], "=!=",
                     "List"}], ",", 
                    RowBox[{"KetsBras`Private`ketpatt", "=", 
                    RowBox[{"{", "KetsBras`Private`ketpatt", "}"}]}]}], "]"}],
                     ";", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"!", 
                    RowBox[{"AllTrue", "[", 
                    RowBox[{"KetsBras`Private`ketpatt", ",", 
                    RowBox[{"MatchQ", "[", 
                    RowBox[{"_Ket", "\[Rule]", 
                    RowBox[{"_", "?", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"linearCombinationQ", "[", 
                    RowBox[{"#1", ",", "_Ket"}], "]"}], "&"}], ")"}]}]}], 
                    "]"}]}], "]"}]}], ",", 
                    RowBox[{"Message", "[", 
                    StyleBox[
                    RowBox[{"replaceKet", "::", "invpatt"}], "MessageName"], 
                    "]"}]}], "]"}], ";", 
                    RowBox[{"KetsBras`Private`brapatt", "=", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    "ConjugateTranspose", ",", "KetsBras`Private`ketpatt", 
                    ",", 
                    RowBox[{"{", "2", "}"}]}], "]"}]}], ";", 
                    RowBox[{"KetsBras`Private`locexpr", "=", 
                    RowBox[{"KetsBras`Private`replaceKetInternal", "[", 
                    RowBox[{
                    "KetsBras`Private`expr", ",", "KetsBras`Private`ketraw", 
                    ",", "KetsBras`Private`sub", ",", 
                    "KetsBras`Private`ketpatt"}], "]"}]}], ";", 
                    RowBox[{"KetsBras`Private`locexpr", "=", 
                    RowBox[{"KetsBras`Private`replaceKetInternal", "[", 
                    RowBox[{
                    "KetsBras`Private`locexpr", ",", 
                    "KetsBras`Private`braraw", ",", "KetsBras`Private`sub", 
                    ",", "KetsBras`Private`brapatt"}], "]"}]}], ";", 
                    "KetsBras`Private`locexpr"}]}], "]"}]}]}
                    },
                    DefaultBaseStyle->"Column",
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}]},
                  {
                   TagBox[
                    TooltipBox[
                    
                    StyleBox["\<\" Default Definitions\"\>", 
                    "InformationRowLabel",
                    StripOnInput->False],
                    "\"DefaultValues\"",
                    TooltipStyle->"TextStyling"],
                    Annotation[#, "DefaultValues", "Tooltip"]& ], 
                   InterpretationBox[GridBox[{
                    {
                    RowBox[{
                    RowBox[{"SyntaxInformation", "[", "replaceKet", "]"}], 
                    "=", 
                    RowBox[{"{", 
                    RowBox[{"\<\"ArgumentsPattern\"\>", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"_", ",", "_", ",", "___"}], "}"}]}], "}"}]}]}
                    },
                    BaselinePosition->{Baseline, {1, 1}},
                    
                    GridBoxAlignment->{
                    "Columns" -> {{Left}}, "Rows" -> {{Baseline}}}],
                    
                    ColumnForm[{
                    SyntaxInformation[KetsBras`replaceKet] = {
                    "ArgumentsPattern" -> {
                    Blank[], 
                    Blank[], 
                    BlankNullSequence[]}}}],
                    Editable->False]},
                  {
                   TagBox[
                    TooltipBox[
                    StyleBox["\<\" Full Name\"\>", "InformationRowLabel",
                    StripOnInput->False],
                    "\"FullName\"",
                    TooltipStyle->"TextStyling"],
                    
                    Annotation[#, "FullName", 
                    "Tooltip"]& ], "\<\"KetsBras`replaceKet\"\>"}
                 },
                 AutoDelete->False,
                 GridBoxAlignment->{"Columns" -> {Right, Left}},
                 GridBoxDividers->None,
                 GridBoxItemSize->{"Columns" -> {Automatic, Automatic}},
                 GridBoxSpacings->{"Columns" -> {
                    Offset[0.27999999999999997`], {
                    Offset[0.5599999999999999]}, 
                    Offset[0.27999999999999997`]}, "Rows" -> {
                    Offset[0.2], {
                    Offset[0.8]}, 
                    Offset[0.2]}}], "DialogStyle",
                StripOnInput->False],
               DynamicModuleValues:>{}]}
            },
            DefaultBaseStyle->"Column",
            GridBoxAlignment->{"Columns" -> {{Left}}},
            GridBoxDividers->{"Columns" -> {{False}}, "Rows" -> {{False}}},
            
            GridBoxItemSize->{
             "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}},
            GridBoxSpacings->{"Columns" -> {
                Offset[0.27999999999999997`], {
                 Offset[0.5599999999999999]}, 
                Offset[0.27999999999999997`]}, "Rows" -> {
                Offset[0.2], {
                 Offset[3.6]}, 
                Offset[0.2]}}],
           FrameMargins->6], ""},
         {
          ItemBox[
           TagBox[
            ButtonBox[
             PaneSelectorBox[{False->
              
              DynamicBox[FEPrivate`FrontEndResource[
               "FEBitmaps", "UpPointerOpener"]], True->
              
              DynamicBox[FEPrivate`FrontEndResource[
               "FEBitmaps", "UpPointerOpenerHot"]]}, Dynamic[
              System`InformationDump`mouseOver$$]],
             Alignment->Left,
             Appearance->{"Default" -> None},
             
             ButtonFunction:>FEPrivate`Set[
              System`InformationDump`open$$, False],
             Evaluator->Automatic,
             FrameMargins->{{9, 0}, {0, 0}},
             ImageMargins->0,
             ImageSize->Full,
             Method->"Preemptive"],
            
            EventHandlerTag[{
             "MouseEntered" :> 
              FEPrivate`Set[System`InformationDump`mouseOver$$, True], 
              "MouseExited" :> 
              FEPrivate`Set[System`InformationDump`mouseOver$$, False], 
              Method -> "Preemptive", PassEventsDown -> Automatic, 
              PassEventsUp -> True}]],
           BaseStyle->"InformationTitleBackground",
           StripOnInput->False], "\[SpanFromLeft]"}
        },
        AutoDelete->False,
        FrameStyle->Directive[
          GrayLevel[0.8], 
          Thickness[Tiny]],
        GridBoxAlignment->{"Columns" -> {Left, Right}, "Rows" -> {{Center}}},
        GridBoxDividers->{
         "Columns" -> {{None}}, "Rows" -> {False, {True}, False}},
        GridBoxItemSize->{
         "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
       "Grid"], False->
      TagBox[GridBox[{
         {
          ItemBox[
           PaneBox[
            StyleBox["\<\" Symbol\"\>", "InformationTitleText",
             StripOnInput->False],
            FrameMargins->{{4, 0}, {-1, 1}}],
           BaseStyle->"InformationTitleBackground",
           StripOnInput->False], 
          ItemBox["\<\"\"\>",
           BaseStyle->"InformationTitleBackground",
           StripOnInput->False]},
         {
          ItemBox[
           PaneBox[
            
            StyleBox["\<\"replaceKet[\\!\\(\\*FormBox[StyleBox[\\\"expr\\\", \
Italic, Rule[StripOnInput, False]], \
TraditionalForm]\\)_,\\!\\(\\*FormBox[StyleBox[\\\"patt\\\", Italic, \
Rule[StripOnInput, False]], TraditionalForm]\\)_,\\!\\(\\*FormBox[StyleBox[\\\
\"sub\\\", Italic, Rule[StripOnInput, False]], TraditionalForm]\\)_]: In a \
linear combination \\!\\(\\*FormBox[StyleBox[\\\"expr\\\", Italic, \
Rule[StripOnInput, False]], TraditionalForm]\\) of Kets of the form \
\\!\\(\\*FormBox[StyleBox[TemplateBox[List[RowBox[List[\\\"a1\\\", \\\",\\\", \
\\\"a2\\\", \\\",\\\", \\\"a3\\\", \\\",\\\", \\\"etc\\\"]]], \\\"Ket\\\"], \
Italic, Rule[StripOnInput, False]], TraditionalForm]\\) replaces expressions \
\\!\\(\\*FormBox[StyleBox[TemplateBox[List[\\\"ai\\\"], \\\"Ket\\\"], Italic, \
Rule[StripOnInput, False]], TraditionalForm]\\) according to pattern \
\\!\\(\\*FormBox[StyleBox[\\\"patt\\\", Italic, Rule[StripOnInput, False]], \
TraditionalForm]\\). The third, optional, argument specifies in which \
subsystem the replacement should be performed. For instance, \
replaceKet[\\!\\(\\*FormBox[StyleBox[TemplateBox[List[RowBox[List[\\\"1\\\", \
\\\",\\\", \\\"b\\\"]]], \\\"Ket\\\"], Italic, Rule[StripOnInput, False]], \
TraditionalForm]\\)+2.3 \
\\!\\(\\*FormBox[StyleBox[TemplateBox[List[RowBox[List[\\\"0\\\", \\\",\\\", \
\\\"2\\\", \\\",\\\", \\\"8\\\"]]], \\\"Ket\\\"], Italic, Rule[StripOnInput, \
False]], TraditionalForm]\\)+\\!\\(\\*FormBox[StyleBox[TemplateBox[List[\\\"b\
\\\"], \\\"Ket\\\"], Italic, Rule[StripOnInput, False]], \
TraditionalForm]\\),{\\!\\(\\*FormBox[StyleBox[TemplateBox[List[\\\"b\\\"], \
\\\"Ket\\\"], Italic, Rule[StripOnInput, False]], TraditionalForm]\\)->\\!\\(\
\\*FormBox[StyleBox[TemplateBox[List[RowBox[List[\\\"-\\\", \\\"5\\\"]]], \
\\\"Ket\\\"], Italic, Rule[StripOnInput, False]], \
TraditionalForm]\\),\\!\\(\\*FormBox[StyleBox[TemplateBox[List[\\\"8\\\"], \\\
\"Ket\\\"], Italic, Rule[StripOnInput, False]], \
TraditionalForm]\\)->\\!\\(\\*FormBox[StyleBox[TemplateBox[List[\\\"c\\\"], \
\\\"Ket\\\"], Italic, Rule[StripOnInput, False]], TraditionalForm]\\)},{1,3}] \
returns \\!\\(\\*FormBox[StyleBox[TemplateBox[List[RowBox[List[\\\"-\\\", \
\\\"5\\\"]]], \\\"Ket\\\"], Italic, Rule[StripOnInput, False]], \
TraditionalForm]\\)+\\!\\(\\*FormBox[StyleBox[TemplateBox[List[RowBox[List[\\\
\"1\\\", \\\",\\\", \\\"b\\\"]]], \\\"Ket\\\"], Italic, Rule[StripOnInput, \
False]], TraditionalForm]\\)+2.3 \
\\!\\(\\*FormBox[StyleBox[TemplateBox[List[RowBox[List[\\\"0\\\", \\\",\\\", \
\\\"2\\\", \\\",\\\", \\\"c\\\"]]], \\\"Ket\\\"], Italic, Rule[StripOnInput, \
False]], TraditionalForm]\\), since substitution is not done in the second \
subsystem. In \\!\\(\\*FormBox[StyleBox[\\\"patt\\\", Italic, \
Rule[StripOnInput, False]], TraditionalForm]\\) only unipartite replacement \
rules are allowed. If there is only one subsystem one wants to perform \
substitution in, one can omit braces and as \\!\\(\\*FormBox[StyleBox[\\\"sub\
\\\", Italic, Rule[StripOnInput, False]], TraditionalForm]\\) specify just \
the integral index. If the third argument is omitted, the substitutions are \
done in all subsystems.\"\>", "InformationUsageText",
             StripOnInput->False,
             LineSpacing->{1.5, 1.5, 3.}],
            FrameMargins->{{10, 10}, {8, 10}}],
           BaseStyle->"InformationUsageSubtitleBackground",
           StripOnInput->False], 
          ItemBox["\<\"\"\>",
           BaseStyle->"InformationUsageSubtitleBackground",
           StripOnInput->False]},
         {
          ItemBox[
           TagBox[
            ButtonBox[
             PaneSelectorBox[{False->
              
              DynamicBox[FEPrivate`FrontEndResource[
               "FEBitmaps", "DownPointerOpener"],
               ImageSizeCache->{10., {3., 7.}}], True->
              
              DynamicBox[FEPrivate`FrontEndResource[
               "FEBitmaps", "DownPointerOpenerHot"],
               ImageSizeCache->{10., {3., 7.}}]}, Dynamic[
              System`InformationDump`mouseOver$$]],
             Alignment->Left,
             Appearance->{"Default" -> None},
             
             ButtonFunction:>FEPrivate`Set[
              System`InformationDump`open$$, True],
             Evaluator->Automatic,
             FrameMargins->{{9, 0}, {0, 0}},
             ImageMargins->0,
             ImageSize->Full,
             Method->"Preemptive"],
            
            EventHandlerTag[{
             "MouseEntered" :> 
              FEPrivate`Set[System`InformationDump`mouseOver$$, True], 
              "MouseExited" :> 
              FEPrivate`Set[System`InformationDump`mouseOver$$, False], 
              Method -> "Preemptive", PassEventsDown -> Automatic, 
              PassEventsUp -> True}]],
           BaseStyle->"InformationTitleBackground",
           StripOnInput->False], "\[SpanFromLeft]"}
        },
        AutoDelete->False,
        FrameStyle->Directive[
          GrayLevel[0.8], 
          Thickness[Tiny]],
        GridBoxAlignment->{"Columns" -> {Left, Right}, "Rows" -> {{Center}}},
        GridBoxDividers->{
         "Columns" -> {{None}}, "Rows" -> {False, {True}, False}},
        GridBoxItemSize->{
         "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
       "Grid"]}, Dynamic[System`InformationDump`open$$],
      BaselinePosition->Baseline,
      FrameMargins->0,
      ImageSize->Automatic],
     DynamicModuleValues:>{}],
    BaseStyle->"InformationGridFrame",
    StripOnInput->False], "InformationGridPlain",
   StripOnInput->False],
  InformationData[<|
   "ObjectType" -> "Symbol", "Usage" -> 
    "replaceKet[\!\(\*FormBox[StyleBox[\"expr\", Italic, Rule[StripOnInput, \
False]], TraditionalForm]\)_,\!\(\*FormBox[StyleBox[\"patt\", Italic, \
Rule[StripOnInput, False]], \
TraditionalForm]\)_,\!\(\*FormBox[StyleBox[\"sub\", Italic, \
Rule[StripOnInput, False]], TraditionalForm]\)_]: In a linear combination \
\!\(\*FormBox[StyleBox[\"expr\", Italic, Rule[StripOnInput, False]], \
TraditionalForm]\) of Kets of the form \
\!\(\*FormBox[StyleBox[TemplateBox[List[RowBox[List[\"a1\", \",\", \"a2\", \
\",\", \"a3\", \",\", \"etc\"]]], \"Ket\"], Italic, Rule[StripOnInput, \
False]], TraditionalForm]\) replaces expressions \
\!\(\*FormBox[StyleBox[TemplateBox[List[\"ai\"], \"Ket\"], Italic, \
Rule[StripOnInput, False]], TraditionalForm]\) according to pattern \
\!\(\*FormBox[StyleBox[\"patt\", Italic, Rule[StripOnInput, False]], \
TraditionalForm]\). The third, optional, argument specifies in which \
subsystem the replacement should be performed. For instance, \
replaceKet[\!\(\*FormBox[StyleBox[TemplateBox[List[RowBox[List[\"1\", \",\", \
\"b\"]]], \"Ket\"], Italic, Rule[StripOnInput, False]], \
TraditionalForm]\)+2.3 \
\!\(\*FormBox[StyleBox[TemplateBox[List[RowBox[List[\"0\", \",\", \"2\", \
\",\", \"8\"]]], \"Ket\"], Italic, Rule[StripOnInput, False]], \
TraditionalForm]\)+\!\(\*FormBox[StyleBox[TemplateBox[List[\"b\"], \"Ket\"], \
Italic, Rule[StripOnInput, False]], \
TraditionalForm]\),{\!\(\*FormBox[StyleBox[TemplateBox[List[\"b\"], \"Ket\"], \
Italic, Rule[StripOnInput, False]], \
TraditionalForm]\)->\!\(\*FormBox[StyleBox[TemplateBox[List[RowBox[List[\"-\",\
 \"5\"]]], \"Ket\"], Italic, Rule[StripOnInput, False]], \
TraditionalForm]\),\!\(\*FormBox[StyleBox[TemplateBox[List[\"8\"], \"Ket\"], \
Italic, Rule[StripOnInput, False]], \
TraditionalForm]\)->\!\(\*FormBox[StyleBox[TemplateBox[List[\"c\"], \"Ket\"], \
Italic, Rule[StripOnInput, False]], TraditionalForm]\)},{1,3}] returns \
\!\(\*FormBox[StyleBox[TemplateBox[List[RowBox[List[\"-\", \"5\"]]], \
\"Ket\"], Italic, Rule[StripOnInput, False]], \
TraditionalForm]\)+\!\(\*FormBox[StyleBox[TemplateBox[List[RowBox[List[\"1\", \
\",\", \"b\"]]], \"Ket\"], Italic, Rule[StripOnInput, False]], \
TraditionalForm]\)+2.3 \
\!\(\*FormBox[StyleBox[TemplateBox[List[RowBox[List[\"0\", \",\", \"2\", \
\",\", \"c\"]]], \"Ket\"], Italic, Rule[StripOnInput, False]], \
TraditionalForm]\), since substitution is not done in the second subsystem. \
In \!\(\*FormBox[StyleBox[\"patt\", Italic, Rule[StripOnInput, False]], \
TraditionalForm]\) only unipartite replacement rules are allowed. If there is \
only one subsystem one wants to perform substitution in, one can omit braces \
and as \!\(\*FormBox[StyleBox[\"sub\", Italic, Rule[StripOnInput, False]], \
TraditionalForm]\) specify just the integral index. If the third argument is \
omitted, the substitutions are done in all subsystems.", "Documentation" -> 
    None, "OwnValues" -> None, "UpValues" -> None, "DownValues" -> 
    Information`InformationValueForm[
     DownValues, KetsBras`replaceKet, {KetsBras`replaceKet[
         Pattern[KetsBras`Private`expr, 
          Blank[]], 
         Pattern[KetsBras`Private`patt, 
          Blank[]], 
         PatternTest[
          Pattern[KetsBras`Private`sub, 
           Blank[Integer]], Positive]] :> 
       KetsBras`replaceKet[
        KetsBras`Private`expr, KetsBras`Private`patt, {KetsBras`Private`sub}],
        KetsBras`replaceKet[
         PatternTest[
          Pattern[KetsBras`Private`expr, 
           Blank[]], KetsBras`linearCombinationQ[#, 
           Blank[Ket]]& ], 
         Pattern[KetsBras`Private`patt, 
          Blank[]], 
         Optional[
          Pattern[KetsBras`Private`sub, 
           Blank[]], All]] :> 
       Module[{KetsBras`Private`locexpr, KetsBras`Private`raw, 
          KetsBras`Private`coefs, KetsBras`Private`specs, 
          KetsBras`Private`locpatt = KetsBras`Private`patt, 
          KetsBras`Private`locsub}, {
           KetsBras`Private`locexpr, KetsBras`Private`coefs, 
            KetsBras`Private`specs} = 
          KetsBras`Private`parseKetSpecs[
           KetsBras`Private`expr, KetsBras`replaceKet]; 
         KetsBras`Private`raw = Map[{#, 
             Apply[List, 
              Map[Ket, #]]}& , KetsBras`Private`specs]; 
         If[KetsBras`Private`raw == {}, 
           Return[KetsBras`Private`expr]]; 
         If[Head[KetsBras`Private`locpatt] =!= List, 
           KetsBras`Private`locpatt = {KetsBras`Private`locpatt}]; If[
           Not[
            AllTrue[KetsBras`Private`locpatt, 
             MatchQ[Blank[Ket] -> PatternTest[
                Blank[], KetsBras`linearCombinationQ[#, 
                 Blank[Ket]]& ]]]], 
           Message[
            MessageName[KetsBras`replaceKet, "invpatt"]]]; 
         KetsBras`Private`replaceKetInternal[
          KetsBras`Private`expr, KetsBras`Private`raw, KetsBras`Private`sub, 
           KetsBras`Private`locpatt]], KetsBras`replaceKet[
         PatternTest[
          Pattern[KetsBras`Private`expr, 
           Blank[]], KetsBras`linearCombinationQ[#, 
           NonCommutativeMultiply[
            Ket[
             BlankSequence[]], 
            Bra[
             BlankSequence[]]]]& ], 
         Pattern[KetsBras`Private`patt, 
          Blank[]], 
         Optional[
          Pattern[KetsBras`Private`sub, 
           Blank[]], All]] :> 
       Module[{KetsBras`Private`locexpr, KetsBras`Private`ketraw, 
          KetsBras`Private`braraw, KetsBras`Private`coefs, 
          KetsBras`Private`specs, KetsBras`Private`ketpatt = 
          KetsBras`Private`patt, KetsBras`Private`brapatt, 
          KetsBras`Private`ketlist, 
          KetsBras`Private`bralist}, {
           KetsBras`Private`locexpr, KetsBras`Private`coefs, 
            KetsBras`Private`specs} = 
          KetsBras`Private`parseKetBraSpecs[
           KetsBras`Private`expr, KetsBras`replaceKet]; {
           KetsBras`Private`ketlist, KetsBras`Private`bralist} = 
          Transpose[KetsBras`Private`specs]; KetsBras`Private`ketraw = Map[{#, 
             Apply[List, 
              Map[Ket, #]]}& , KetsBras`Private`ketlist]; 
         KetsBras`Private`braraw = Map[{#, 
             Apply[List, 
              Map[Ket, #]]}& , KetsBras`Private`bralist]; If[
           And[KetsBras`Private`ketraw == {}, KetsBras`Private`braraw == {}], 
           
           Return[KetsBras`Private`expr]]; 
         KetsBras`Private`braraw = 
          ReplaceAll[KetsBras`Private`braraw, Ket -> Bra]; 
         If[
          Head[KetsBras`Private`ketpatt] =!= List, 
           KetsBras`Private`ketpatt = {KetsBras`Private`ketpatt}]; If[
           Not[
            AllTrue[KetsBras`Private`ketpatt, 
             MatchQ[Blank[Ket] -> PatternTest[
                Blank[], KetsBras`linearCombinationQ[#, 
                 Blank[Ket]]& ]]]], 
           Message[
            MessageName[KetsBras`replaceKet, "invpatt"]]]; 
         KetsBras`Private`brapatt = 
          Map[ConjugateTranspose, KetsBras`Private`ketpatt, {2}]; 
         KetsBras`Private`locexpr = 
          KetsBras`Private`replaceKetInternal[
           KetsBras`Private`expr, KetsBras`Private`ketraw, 
            KetsBras`Private`sub, KetsBras`Private`ketpatt]; 
         KetsBras`Private`locexpr = 
          KetsBras`Private`replaceKetInternal[
           KetsBras`Private`locexpr, KetsBras`Private`braraw, 
            KetsBras`Private`sub, KetsBras`Private`brapatt]; 
         KetsBras`Private`locexpr]}], "SubValues" -> None, "DefaultValues" -> 
    Information`InformationValueForm[
     DefaultValues, KetsBras`replaceKet, {
      SyntaxInformation[KetsBras`replaceKet] -> {"ArgumentsPattern" -> {
           Blank[], 
           Blank[], 
           BlankNullSequence[]}}}], "NValues" -> None, "FormatValues" -> None,
     "Options" -> None, "Attributes" -> {}, "FullName" -> 
    "KetsBras`replaceKet"|>, False]]], "Output",
 CellChangeTimes->{3.7953273206976795`*^9},
 CellLabel->"Out[17]=",ExpressionUUID->"80477fb9-32fc-4297-9f04-f657e5384850"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"changeBasis", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Ket", "[", "\"\<H\>\"", "]"}], "**", 
     RowBox[{"Bra", "[", "\"\<V\>\"", "]"}]}], ",", "\"\<comp\>\"", ",", 
    "\"\<diag\>\""}], "]"}], "//", "Simplify"}]], "Input",
 CellChangeTimes->{{3.759040733832063*^9, 3.7590407642416983`*^9}, {
  3.7590408979096985`*^9, 3.759040914141921*^9}},
 CellLabel->"In[16]:=",ExpressionUUID->"09a9261e-834e-4c0a-a092-c5d38c5c3c54"],

Cell[BoxData[
 RowBox[{
  FractionBox["1", "2"], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"-", 
     RowBox[{
      TemplateBox[{"\"A\""},
       "Ket"], "**", 
      TemplateBox[{"\"A\""},
       "Bra"]}]}], "+", 
    RowBox[{
     TemplateBox[{"\"A\""},
      "Ket"], "**", 
     TemplateBox[{"\"D\""},
      "Bra"]}], "-", 
    RowBox[{
     TemplateBox[{"\"D\""},
      "Ket"], "**", 
     TemplateBox[{"\"A\""},
      "Bra"]}], "+", 
    RowBox[{
     TemplateBox[{"\"D\""},
      "Ket"], "**", 
     TemplateBox[{"\"D\""},
      "Bra"]}]}], ")"}]}]], "Output",
 CellChangeTimes->{{3.7590407581029096`*^9, 3.7590407653465567`*^9}, 
   3.759040850225341*^9, {3.7590408947978*^9, 3.7590409147174015`*^9}, 
   3.7590409623425927`*^9, 3.759041034438038*^9, 3.759041083896081*^9},
 CellLabel->"Out[16]=",ExpressionUUID->"573679eb-4b8a-4d61-a9f6-4bf2d8506cf9"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"changeBasis", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Ket", "[", "\"\<H\>\"", "]"}], "**", 
     RowBox[{"Bra", "[", "\"\<V\>\"", "]"}]}], ",", 
    RowBox[{"\"\<comp\>\"", "\[Rule]", "\"\<diag\>\""}]}], "]"}], "//", 
  "Simplify"}]], "Input",
 CellChangeTimes->{{3.759040733832063*^9, 3.7590407642416983`*^9}, {
  3.7590408979096985`*^9, 3.759040914141921*^9}, {3.7590410351769495`*^9, 
  3.759041038462263*^9}},
 CellLabel->"In[17]:=",ExpressionUUID->"05712651-4094-4d2d-9100-06c532f91aeb"],

Cell[BoxData[
 RowBox[{
  FractionBox["1", "2"], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"-", 
     RowBox[{
      TemplateBox[{"\"A\""},
       "Ket"], "**", 
      TemplateBox[{"\"A\""},
       "Bra"]}]}], "+", 
    RowBox[{
     TemplateBox[{"\"A\""},
      "Ket"], "**", 
     TemplateBox[{"\"D\""},
      "Bra"]}], "-", 
    RowBox[{
     TemplateBox[{"\"D\""},
      "Ket"], "**", 
     TemplateBox[{"\"A\""},
      "Bra"]}], "+", 
    RowBox[{
     TemplateBox[{"\"D\""},
      "Ket"], "**", 
     TemplateBox[{"\"D\""},
      "Bra"]}]}], ")"}]}]], "Output",
 CellChangeTimes->{3.759041039413166*^9, 3.7590410849947977`*^9},
 CellLabel->"Out[17]=",ExpressionUUID->"297a0e76-3af3-47b7-9189-abeb9a00a13b"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"changeBasis", "[", 
   RowBox[{
    RowBox[{
     FractionBox["1", "2"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", 
        RowBox[{
         TemplateBox[{"\"A\""},
          "Ket"], "**", 
         TemplateBox[{"\"A\""},
          "Bra"]}]}], "+", 
       RowBox[{
        TemplateBox[{"\"A\""},
         "Ket"], "**", 
        TemplateBox[{"\"D\""},
         "Bra"]}], "-", 
       RowBox[{
        TemplateBox[{"\"D\""},
         "Ket"], "**", 
        TemplateBox[{"\"A\""},
         "Bra"]}], "+", 
       RowBox[{
        TemplateBox[{"\"D\""},
         "Ket"], "**", 
        TemplateBox[{"\"D\""},
         "Bra"]}]}], ")"}]}], ",", "\"\<diag\>\"", ",", "\"\<comp\>\""}], 
   "]"}], "//", "Simplify"}]], "Input",
 CellChangeTimes->{{3.7590409312367005`*^9, 3.7590409487121525`*^9}},
 CellLabel->"In[96]:=",ExpressionUUID->"54346fae-ebf3-4043-96af-63d5a925dcca"],

Cell[BoxData[
 RowBox[{
  TemplateBox[{"\"H\""},
   "Ket"], "**", 
  TemplateBox[{"\"V\""},
   "Bra"]}]], "Output",
 CellChangeTimes->{{3.759040945483734*^9, 3.759040963490346*^9}},
 CellLabel->"Out[96]=",ExpressionUUID->"a29c3a62-b7c8-44ac-9ed0-aa0e04356f6f"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"changeBasis", "[", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"Ket", "[", 
       RowBox[{"1", ",", "\"\<H\>\""}], "]"}], "**", 
      RowBox[{"Bra", "[", 
       RowBox[{"3", ",", "\"\<V\>\""}], "]"}]}], "+", 
     RowBox[{
      RowBox[{"Ket", "[", 
       RowBox[{"1", ",", "\"\<H\>\""}], "]"}], "**", 
      RowBox[{"Bra", "[", 
       RowBox[{"6", ",", "\"\<V\>\""}], "]"}]}]}], ",", "\"\<comp\>\"", ",", 
    "\"\<diag\>\"", ",", 
    RowBox[{"{", "2", "}"}]}], "]"}], "//", "Simplify"}]], "Input",
 CellChangeTimes->{{3.759040733832063*^9, 3.759040788700595*^9}, {
  3.7590408589962835`*^9, 3.759040865299543*^9}},
 CellLabel->"In[97]:=",ExpressionUUID->"3e3175fe-10b0-44e2-b61e-162f318c8dd2"],

Cell[BoxData[
 RowBox[{
  FractionBox["1", "2"], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"-", 
     RowBox[{
      TemplateBox[{
        RowBox[{"1", ",", "\"A\""}]},
       "Ket"], "**", 
      TemplateBox[{
        RowBox[{"3", ",", "\"A\""}]},
       "Bra"]}]}], "+", 
    RowBox[{
     TemplateBox[{
       RowBox[{"1", ",", "\"A\""}]},
      "Ket"], "**", 
     TemplateBox[{
       RowBox[{"3", ",", "\"D\""}]},
      "Bra"]}], "-", 
    RowBox[{
     TemplateBox[{
       RowBox[{"1", ",", "\"A\""}]},
      "Ket"], "**", 
     TemplateBox[{
       RowBox[{"6", ",", "\"A\""}]},
      "Bra"]}], "+", 
    RowBox[{
     TemplateBox[{
       RowBox[{"1", ",", "\"A\""}]},
      "Ket"], "**", 
     TemplateBox[{
       RowBox[{"6", ",", "\"D\""}]},
      "Bra"]}], "-", 
    RowBox[{
     TemplateBox[{
       RowBox[{"1", ",", "\"D\""}]},
      "Ket"], "**", 
     TemplateBox[{
       RowBox[{"3", ",", "\"A\""}]},
      "Bra"]}], "+", 
    RowBox[{
     TemplateBox[{
       RowBox[{"1", ",", "\"D\""}]},
      "Ket"], "**", 
     TemplateBox[{
       RowBox[{"3", ",", "\"D\""}]},
      "Bra"]}], "-", 
    RowBox[{
     TemplateBox[{
       RowBox[{"1", ",", "\"D\""}]},
      "Ket"], "**", 
     TemplateBox[{
       RowBox[{"6", ",", "\"A\""}]},
      "Bra"]}], "+", 
    RowBox[{
     TemplateBox[{
       RowBox[{"1", ",", "\"D\""}]},
      "Ket"], "**", 
     TemplateBox[{
       RowBox[{"6", ",", "\"D\""}]},
      "Bra"]}]}], ")"}]}]], "Output",
 CellChangeTimes->{{3.759040782299222*^9, 3.75904078912845*^9}, {
   3.7590408437221756`*^9, 3.7590408657902336`*^9}, 3.759040967875613*^9},
 CellLabel->"Out[97]=",ExpressionUUID->"0a5bedce-5554-4151-b8eb-25df62350b1f"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"changeBasis", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"Ket", "[", 
     RowBox[{"1", ",", "\"\<H\>\""}], "]"}], "+", 
    RowBox[{"Ket", "[", 
     RowBox[{"3", ",", "\"\<H\>\""}], "]"}]}], ",", "\"\<diag\>\"", ",", 
   "\"\<comp\>\"", ",", 
   RowBox[{"{", "2", "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.759040733832063*^9, 3.759040818718201*^9}},
 CellLabel->"In[98]:=",ExpressionUUID->"5c24f63e-65fd-4575-af98-f30ed6ea2779"],

Cell[BoxData[
 RowBox[{
  TemplateBox[{
    RowBox[{"1", ",", "\"H\""}]},
   "Ket"], "+", 
  TemplateBox[{
    RowBox[{"3", ",", "\"H\""}]},
   "Ket"]}]], "Output",
 CellChangeTimes->{{3.7590408158050165`*^9, 3.7590408190240355`*^9}, 
   3.7590409730006027`*^9},
 CellLabel->"Out[98]=",ExpressionUUID->"93642daa-ed99-49d1-a530-98a37ecc40f0"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Map", "[", 
  RowBox[{"ConjugateTranspose", ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Ket", "[", "1", "]"}], "\[Rule]", 
     RowBox[{"I", " ", 
      RowBox[{"Ket", "[", "2", "]"}]}]}], "}"}], ",", 
   RowBox[{"{", "2", "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.759040072418586*^9, 3.7590401273698635`*^9}},
 CellLabel->"In[29]:=",ExpressionUUID->"8a4f14a5-6c50-4ba4-b0c9-67086029919d"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   TemplateBox[{"1"},
    "Bra"], "\[Rule]", 
   RowBox[{
    RowBox[{"-", "\[ImaginaryI]"}], " ", 
    TemplateBox[{"2"},
     "Bra"]}]}], "}"}]], "Output",
 CellChangeTimes->{{3.759040082296468*^9, 3.7590401281279583`*^9}},
 CellLabel->"Out[29]=",ExpressionUUID->"87aca8d3-9d04-459a-b863-cab4b973bb2d"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"?", "replaceKet"}]], "Input",
 CellChangeTimes->{{3.759037383168165*^9, 3.759037383311781*^9}},
 CellLabel->"In[18]:=",ExpressionUUID->"228eefac-db1d-4bc0-bec4-49892555b787"],

Cell[BoxData["\<\"replaceKet[\\!\\(\\*FormBox[StyleBox[\\\"expr\\\", Italic, \
Rule[StripOnInput, False]], TraditionalForm]\\)_,\\!\\(\\*FormBox[StyleBox[\\\
\"patt\\\", Italic, Rule[StripOnInput, False]], \
TraditionalForm]\\)_,\\!\\(\\*FormBox[StyleBox[\\\"sub\\\", Italic, \
Rule[StripOnInput, False]], TraditionalForm]\\)_]: In a linear combination \
\\!\\(\\*FormBox[StyleBox[\\\"expr\\\", Italic, Rule[StripOnInput, False]], \
TraditionalForm]\\) of Kets of the form \
\\!\\(\\*FormBox[StyleBox[TemplateBox[List[RowBox[List[\\\"a1\\\", \\\",\\\", \
\\\"a2\\\", \\\",\\\", \\\"a3\\\", \\\",\\\", \\\"etc\\\"]]], \\\"Ket\\\"], \
Italic, Rule[StripOnInput, False]], TraditionalForm]\\) replaces expressions \
\\!\\(\\*FormBox[StyleBox[TemplateBox[List[\\\"ai\\\"], \\\"Ket\\\"], Italic, \
Rule[StripOnInput, False]], TraditionalForm]\\) according to pattern \
\\!\\(\\*FormBox[StyleBox[\\\"patt\\\", Italic, Rule[StripOnInput, False]], \
TraditionalForm]\\). The third, optional, argument specifies in which \
subsystem the replacement should be performed. For instance, \
replaceKet[\\!\\(\\*FormBox[StyleBox[TemplateBox[List[RowBox[List[\\\"1\\\", \
\\\",\\\", \\\"b\\\"]]], \\\"Ket\\\"], Italic, Rule[StripOnInput, False]], \
TraditionalForm]\\)+2.3 \
\\!\\(\\*FormBox[StyleBox[TemplateBox[List[RowBox[List[\\\"0\\\", \\\",\\\", \
\\\"2\\\", \\\",\\\", \\\"8\\\"]]], \\\"Ket\\\"], Italic, Rule[StripOnInput, \
False]], TraditionalForm]\\)+\\!\\(\\*FormBox[StyleBox[TemplateBox[List[\\\"b\
\\\"], \\\"Ket\\\"], Italic, Rule[StripOnInput, False]], \
TraditionalForm]\\),{\\!\\(\\*FormBox[StyleBox[TemplateBox[List[\\\"b\\\"], \
\\\"Ket\\\"], Italic, Rule[StripOnInput, False]], TraditionalForm]\\)->\\!\\(\
\\*FormBox[StyleBox[TemplateBox[List[RowBox[List[\\\"-\\\", \\\"5\\\"]]], \
\\\"Ket\\\"], Italic, Rule[StripOnInput, False]], \
TraditionalForm]\\),\\!\\(\\*FormBox[StyleBox[TemplateBox[List[\\\"8\\\"], \\\
\"Ket\\\"], Italic, Rule[StripOnInput, False]], \
TraditionalForm]\\)->\\!\\(\\*FormBox[StyleBox[TemplateBox[List[\\\"c\\\"], \
\\\"Ket\\\"], Italic, Rule[StripOnInput, False]], TraditionalForm]\\)},{1,3}] \
returns \\!\\(\\*FormBox[StyleBox[TemplateBox[List[RowBox[List[\\\"-\\\", \
\\\"5\\\"]]], \\\"Ket\\\"], Italic, Rule[StripOnInput, False]], \
TraditionalForm]\\)+\\!\\(\\*FormBox[StyleBox[TemplateBox[List[RowBox[List[\\\
\"1\\\", \\\",\\\", \\\"b\\\"]]], \\\"Ket\\\"], Italic, Rule[StripOnInput, \
False]], TraditionalForm]\\)+2.3 \
\\!\\(\\*FormBox[StyleBox[TemplateBox[List[RowBox[List[\\\"0\\\", \\\",\\\", \
\\\"2\\\", \\\",\\\", \\\"c\\\"]]], \\\"Ket\\\"], Italic, Rule[StripOnInput, \
False]], TraditionalForm]\\), since substitution is not done in the second \
subsystem. In \\!\\(\\*FormBox[StyleBox[\\\"patt\\\", Italic, \
Rule[StripOnInput, False]], TraditionalForm]\\) only unipartite replacement \
rules are allowed. If there is only one subsystem one wants to perform \
substitution in, one can omit braces and as \\!\\(\\*FormBox[StyleBox[\\\"sub\
\\\", Italic, Rule[StripOnInput, False]], TraditionalForm]\\) specify just \
the integral index. If the third argument is omitted, the substitutions are \
done in all subsystems.\"\>"], "Print", "PrintUsage",
 CellChangeTimes->{3.759038336066135*^9},
 CellTags->
  "Info183759041935-1734034",ExpressionUUID->"f1982d7e-6c52-472f-86b8-\
c37b56826b46"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"partTr", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"\[Alpha]", " ", 
      RowBox[{"Ket", "[", 
       RowBox[{"0", ",", "1", ",", "g2"}], "]"}]}], "+", 
     RowBox[{"\[Beta]", " ", 
      RowBox[{"Ket", "[", 
       RowBox[{"4", ",", "1", ",", "g1"}], "]"}]}]}], ",", 
    RowBox[{"{", 
     RowBox[{"1", ",", "3"}], "}"}]}], "]"}], 
  RowBox[{"(*", 
   RowBox[{"//", 
    RowBox[{
     RowBox[{"FullSimplify", "[", 
      RowBox[{"#", ",", 
       RowBox[{
        RowBox[{
         SuperscriptBox[
          RowBox[{"Abs", "[", "\[Alpha]", "]"}], "2"], "+", 
         SuperscriptBox[
          RowBox[{"Abs", "[", "\[Beta]", "]"}], "2"]}], "\[Equal]", "1"}]}], 
      "]"}], "&"}]}], "*)"}]}]], "Input",
 CellChangeTimes->{{3.7589664867498865`*^9, 3.7589665224636774`*^9}, {
   3.758966557529599*^9, 3.758966560708237*^9}, {3.7589666844877243`*^9, 
   3.7589666847689714`*^9}, {3.758966994443718*^9, 3.7589670164987087`*^9}, 
   3.7589671653084345`*^9, {3.7589676964596405`*^9, 3.758967696760868*^9}, {
   3.758967744954148*^9, 3.7589677487544317`*^9}, {3.7589678391783857`*^9, 
   3.758967865423463*^9}, 3.758974264810385*^9},
 CellLabel->"In[38]:=",ExpressionUUID->"c9961fda-15cd-4eeb-8d25-2c2f4a061173"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{
    RowBox[{"\[Alpha]", " ", 
     RowBox[{"Conjugate", "[", "\[Alpha]", "]"}]}], "+", 
    RowBox[{"\[Beta]", " ", 
     RowBox[{"Conjugate", "[", "\[Beta]", "]"}]}]}], ")"}], " ", 
  RowBox[{
   TemplateBox[{"1"},
    "Ket"], "**", 
   TemplateBox[{"1"},
    "Bra"]}]}]], "Output",
 CellChangeTimes->{
  3.7589742731029015`*^9, {3.758979364057021*^9, 3.7589793808620663`*^9}, 
   3.7589794688666544`*^9, 3.7589795189087887`*^9, 3.7589797172829485`*^9, 
   3.7589816176260853`*^9, 3.758982641688687*^9, 3.758982746949112*^9, 
   3.7589828320195436`*^9, 3.758984996608203*^9, 3.7589850737877445`*^9},
 CellLabel->"Out[38]=",ExpressionUUID->"61975075-fcc7-4e6b-a3af-ee7570128ddc"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"partTr", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"\[Alpha]", " ", 
      RowBox[{"Ket", "[", 
       RowBox[{"3", ",", "1", ",", "g2"}], "]"}]}], "+", 
     RowBox[{"\[Beta]", " ", 
      RowBox[{"Ket", "[", 
       RowBox[{"4", ",", "1", ",", "g1"}], "]"}]}]}], ",", 
    RowBox[{"{", "3", "}"}]}], "]"}], 
  RowBox[{"(*", 
   RowBox[{"//", 
    RowBox[{
     RowBox[{"FullSimplify", "[", 
      RowBox[{"#", ",", 
       RowBox[{
        RowBox[{
         SuperscriptBox[
          RowBox[{"Abs", "[", "\[Alpha]", "]"}], "2"], "+", 
         SuperscriptBox[
          RowBox[{"Abs", "[", "\[Beta]", "]"}], "2"]}], "\[Equal]", "1"}]}], 
      "]"}], "&"}]}], "*)"}]}]], "Input",
 CellChangeTimes->{{3.7589664867498865`*^9, 3.7589665224636774`*^9}, {
   3.758966557529599*^9, 3.758966560708237*^9}, {3.7589666844877243`*^9, 
   3.7589666847689714`*^9}, {3.758966994443718*^9, 3.7589670164987087`*^9}, 
   3.7589671653084345`*^9, {3.7589676964596405`*^9, 3.758967696760868*^9}, {
   3.758967744954148*^9, 3.7589677487544317`*^9}, {3.7589678391783857`*^9, 
   3.758967865423463*^9}, {3.7589685985333395`*^9, 3.758968610474963*^9}, 
   3.758974267755074*^9, {3.758981665804206*^9, 3.7589816717911916`*^9}},
 CellLabel->"In[39]:=",ExpressionUUID->"be7c7510-c1e9-4ff3-8abc-63a1567b3dbc"],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[Alpha]", " ", 
   RowBox[{"Conjugate", "[", "\[Alpha]", "]"}], " ", 
   RowBox[{
    TemplateBox[{
      RowBox[{"3", ",", "1"}]},
     "Ket"], "**", 
    TemplateBox[{
      RowBox[{"3", ",", "1"}]},
     "Bra"]}]}], "+", 
  RowBox[{"\[Beta]", " ", 
   RowBox[{"Conjugate", "[", "\[Beta]", "]"}], " ", 
   RowBox[{
    TemplateBox[{
      RowBox[{"4", ",", "1"}]},
     "Ket"], "**", 
    TemplateBox[{
      RowBox[{"4", ",", "1"}]},
     "Bra"]}]}]}]], "Output",
 CellChangeTimes->{{3.758981666938173*^9, 3.7589816729122057`*^9}, 
   3.758982833568402*^9, 3.758985000681308*^9, 3.758985074927695*^9},
 CellLabel->"Out[39]=",ExpressionUUID->"e50e2f56-df98-4cf0-82b8-e973821017fb"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"partTr", "[", 
  RowBox[{
   RowBox[{
    RowBox[{
     TemplateBox[{
       RowBox[{"a", ",", "1"}]},
      "Ket"], "**", 
     TemplateBox[{
       RowBox[{"a", ",", "1"}]},
      "Bra"]}], "+", 
    RowBox[{
     TemplateBox[{
       RowBox[{"a", ",", "2"}]},
      "Ket"], "**", 
     TemplateBox[{
       RowBox[{"a", ",", "2"}]},
      "Bra"]}], "+", 
    RowBox[{"3", " ", 
     RowBox[{
      TemplateBox[{
        RowBox[{"a", ",", "2"}]},
       "Ket"], "**", 
      TemplateBox[{
        RowBox[{"b", ",", "1"}]},
       "Bra"]}]}], "+", 
    RowBox[{"3", " ", 
     RowBox[{
      TemplateBox[{
        RowBox[{"b", ",", "1"}]},
       "Ket"], "**", 
      TemplateBox[{
        RowBox[{"a", ",", "2"}]},
       "Bra"]}]}], "+", 
    RowBox[{
     TemplateBox[{
       RowBox[{"b", ",", "1"}]},
      "Ket"], "**", 
     TemplateBox[{
       RowBox[{"b", ",", "1"}]},
      "Bra"]}], "+", 
    RowBox[{
     TemplateBox[{
       RowBox[{"b", ",", "2"}]},
      "Ket"], "**", 
     TemplateBox[{
       RowBox[{"b", ",", "2"}]},
      "Bra"]}]}], ",", 
   RowBox[{"{", "1", "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.7589686267591677`*^9, 3.7589686323720922`*^9}, {
   3.758968894528491*^9, 3.758968927980399*^9}, 3.7589690730136576`*^9, 
   3.7589695486791677`*^9, {3.7589702684050922`*^9, 3.758970296704906*^9}, {
   3.7589705800875416`*^9, 3.7589705803169265`*^9}},
 CellLabel->"In[40]:=",ExpressionUUID->"2978ccb9-bd83-46d4-93a3-6c47f39742d2"],

Cell[BoxData[
 RowBox[{
  RowBox[{"2", " ", 
   RowBox[{
    TemplateBox[{"1"},
     "Ket"], "**", 
    TemplateBox[{"1"},
     "Bra"]}]}], "+", 
  RowBox[{"2", " ", 
   RowBox[{
    TemplateBox[{"2"},
     "Ket"], "**", 
    TemplateBox[{"2"},
     "Bra"]}]}]}]], "Output",
 CellChangeTimes->{
  3.7589701388830433`*^9, {3.7589702153786416`*^9, 3.75897023651867*^9}, {
   3.7589702693162317`*^9, 3.7589702974500523`*^9}, {3.758970391981679*^9, 
   3.7589704137744637`*^9}, 3.7589704444243755`*^9, 3.7589704770799074`*^9, {
   3.758970566929626*^9, 3.7589705809987288`*^9}, 3.7589720936439724`*^9, 
   3.7589738689714794`*^9, 3.7589827993160276`*^9, 3.758982835001567*^9, 
   3.758985003681281*^9, 3.758985076069641*^9},
 CellLabel->"Out[40]=",ExpressionUUID->"8b60abe9-a569-4b75-8f65-85e93b95f612"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"partTr", "[", 
  RowBox[{
   RowBox[{
    RowBox[{
     TemplateBox[{
       RowBox[{"a", ",", "1"}]},
      "Ket"], "**", 
     TemplateBox[{
       RowBox[{"a", ",", "1", ",", "m"}]},
      "Bra"]}], "+", 
    RowBox[{"3", " ", 
     RowBox[{
      TemplateBox[{
        RowBox[{"a", ",", "2"}]},
       "Ket"], "**", 
      TemplateBox[{
        RowBox[{"a", ",", "2", ",", "v"}]},
       "Bra"]}]}], "+", 
    RowBox[{"3", " ", 
     RowBox[{
      TemplateBox[{
        RowBox[{"a", ",", "2"}]},
       "Ket"], "**", 
      TemplateBox[{
        RowBox[{"b", ",", "1", ",", "r"}]},
       "Bra"]}]}]}], ",", 
   RowBox[{"{", "1", "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.7589686267591677`*^9, 3.7589686323720922`*^9}, {
   3.758968894528491*^9, 3.758968927980399*^9}, 3.7589690730136576`*^9, 
   3.7589695486791677`*^9, {3.7589702684050922`*^9, 3.758970296704906*^9}, {
   3.7589705800875416`*^9, 3.7589705803169265`*^9}, {3.758970625823654*^9, 
   3.7589706484366584`*^9}, {3.7589707395939426`*^9, 3.758970744104529*^9}, {
   3.7589850133314686`*^9, 3.7589850303559284`*^9}},
 CellLabel->"In[41]:=",ExpressionUUID->"45836032-c159-4a83-8daf-2942c3a8a0ca"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   TemplateBox[{"1"},
    "Ket"], "**", 
   TemplateBox[{
     RowBox[{"1", ",", "m"}]},
    "Bra"]}], "+", 
  RowBox[{"3", " ", 
   RowBox[{
    TemplateBox[{"2"},
     "Ket"], "**", 
    TemplateBox[{
      RowBox[{"2", ",", "v"}]},
     "Bra"]}]}]}]], "Output",
 CellChangeTimes->{
  3.7589706491278086`*^9, 3.7589707452285185`*^9, 3.7589718443362513`*^9, 
   3.758982839257184*^9, {3.758985007654652*^9, 3.7589850319057827`*^9}, 
   3.758985077110855*^9},
 CellLabel->"Out[41]=",ExpressionUUID->"b0092fd5-4951-4525-be5f-0f7d60174d90"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"partTr", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       TemplateBox[{
         RowBox[{"a", ",", "1"}]},
        "Ket"], "**", 
       TemplateBox[{
         RowBox[{"a", ",", "1", ",", "m"}]},
        "Bra"]}], "+", 
      RowBox[{
       TemplateBox[{
         RowBox[{"a", ",", "2"}]},
        "Ket"], "**", 
       TemplateBox[{
         RowBox[{"a", ",", "2", ",", "v"}]},
        "Bra"]}], "+", 
      RowBox[{"3", " ", 
       RowBox[{
        TemplateBox[{
          RowBox[{"a", ",", "2"}]},
         "Ket"], "**", 
        TemplateBox[{
          RowBox[{"b", ",", "1", ",", "r"}]},
         "Bra"]}]}]}], ")"}], "\[ConjugateTranspose]"}], ",", 
   RowBox[{"{", "1", "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.7589686267591677`*^9, 3.7589686323720922`*^9}, {
   3.758968894528491*^9, 3.758968927980399*^9}, 3.7589690730136576`*^9, 
   3.7589695486791677`*^9, {3.7589702684050922`*^9, 3.758970296704906*^9}, {
   3.7589705800875416`*^9, 3.7589705803169265`*^9}, {3.758970625823654*^9, 
   3.7589706484366584`*^9}, {3.7589707395939426`*^9, 3.758970744104529*^9}, 
   3.758971849662502*^9, {3.7589721432431135`*^9, 3.758972148717533*^9}},
 CellLabel->"In[42]:=",ExpressionUUID->"56c32b78-6b2e-4ce6-a263-f1d7e3f51a47"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   TemplateBox[{
     RowBox[{"1", ",", "m"}]},
    "Ket"], "**", 
   TemplateBox[{"1"},
    "Bra"]}], "+", 
  RowBox[{
   TemplateBox[{
     RowBox[{"2", ",", "v"}]},
    "Ket"], "**", 
   TemplateBox[{"2"},
    "Bra"]}]}]], "Output",
 CellChangeTimes->{
  3.758972150022607*^9, {3.758985053262652*^9, 3.7589850781022034`*^9}},
 CellLabel->"Out[42]=",ExpressionUUID->"acb7a341-2509-47fd-87b5-41f3cded4bb5"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"partTr", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"\[Alpha]", " ", 
     RowBox[{"Ket", "[", 
      RowBox[{"0", ",", "1", ",", "g2"}], "]"}]}], "+", 
    RowBox[{"\[Beta]", " ", 
     RowBox[{"Ket", "[", 
      RowBox[{"4", ",", "1", ",", "g1"}], "]"}]}]}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "2"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.7589664867498865`*^9, 3.7589665224636774`*^9}, {
   3.758966557529599*^9, 3.758966560708237*^9}, {3.7589666844877243`*^9, 
   3.7589666847689714`*^9}, {3.758966994443718*^9, 3.7589670164987087`*^9}, 
   3.7589671653084345`*^9, {3.7589676964596405`*^9, 3.758967696760868*^9}, {
   3.758967744954148*^9, 3.7589677487544317`*^9}, 3.758968115986924*^9},
 CellLabel->"In[44]:=",ExpressionUUID->"b4695894-8182-426c-9420-cfff45c8b926"],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[Beta]", " ", 
   RowBox[{"Conjugate", "[", "\[Beta]", "]"}], " ", 
   RowBox[{
    TemplateBox[{"g1"},
     "Ket"], "**", 
    TemplateBox[{"g1"},
     "Bra"]}]}], "+", 
  RowBox[{"\[Alpha]", " ", 
   RowBox[{"Conjugate", "[", "\[Alpha]", "]"}], " ", 
   RowBox[{
    TemplateBox[{"g2"},
     "Ket"], "**", 
    TemplateBox[{"g2"},
     "Bra"]}]}]}]], "Output",
 CellChangeTimes->{
  3.7589676973539343`*^9, {3.7589677295486355`*^9, 3.7589677569324646`*^9}, 
   3.7589679494534655`*^9, {3.7589680947311296`*^9, 3.7589681163050747`*^9}, 
   3.758971302027201*^9, 3.7589850869864397`*^9},
 CellLabel->"Out[44]=",ExpressionUUID->"f818c36b-a354-47bd-8d35-7b7af3d899d0"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"partTr", "[", 
  RowBox[{
   RowBox[{"\[Alpha]", " ", 
    RowBox[{"Ket", "[", 
     RowBox[{"0", ",", "1", ",", "g2"}], "]"}]}], ",", 
   RowBox[{"{", "1", "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.7589664867498865`*^9, 3.7589665224636774`*^9}, {
   3.758966557529599*^9, 3.758966560708237*^9}, {3.7589666844877243`*^9, 
   3.7589666847689714`*^9}, {3.758966994443718*^9, 3.7589670164987087`*^9}, 
   3.7589671653084345`*^9, {3.7589676964596405`*^9, 3.758967696760868*^9}, {
   3.758967744954148*^9, 3.7589677487544317`*^9}, 3.758968115986924*^9, {
   3.758968197083128*^9, 3.7589682258002925`*^9}},
 CellLabel->"In[45]:=",ExpressionUUID->"8345484b-a082-4901-a1b5-82b34b8029eb"],

Cell[BoxData[
 RowBox[{"\[Alpha]", " ", 
  RowBox[{"Conjugate", "[", "\[Alpha]", "]"}], " ", 
  RowBox[{
   TemplateBox[{
     RowBox[{"1", ",", "g2"}]},
    "Ket"], "**", 
   TemplateBox[{
     RowBox[{"1", ",", "g2"}]},
    "Bra"]}]}]], "Output",
 CellChangeTimes->{{3.7589682225826054`*^9, 3.7589682261049786`*^9}, 
   3.758985096889948*^9},
 CellLabel->"Out[45]=",ExpressionUUID->"eb933660-ff4c-4f34-9eba-d25719cfff87"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"partTr", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"\[Alpha]", " ", 
      RowBox[{"Ket", "[", 
       RowBox[{"0", ",", "1", ",", "g2"}], "]"}]}], "+", 
     RowBox[{"\[Beta]", " ", 
      RowBox[{"Ket", "[", 
       RowBox[{"4", ",", "1", ",", "g1"}], "]"}]}]}], ",", 
    RowBox[{"{", 
     RowBox[{"1", ",", "3"}], "}"}]}], "]"}], "//", 
  RowBox[{
   RowBox[{"FullSimplify", "[", 
    RowBox[{"#", ",", 
     RowBox[{
      RowBox[{
       SuperscriptBox[
        RowBox[{"Abs", "[", "\[Alpha]", "]"}], "2"], "+", 
       SuperscriptBox[
        RowBox[{"Abs", "[", "\[Beta]", "]"}], "2"]}], "\[Equal]", "1"}]}], 
    "]"}], "&"}]}]], "Input",
 CellChangeTimes->{{3.7589664867498865`*^9, 3.7589665224636774`*^9}, {
   3.758966557529599*^9, 3.758966560708237*^9}, {3.7589666844877243`*^9, 
   3.7589666847689714`*^9}, {3.758966994443718*^9, 3.7589670164987087`*^9}, 
   3.7589671653084345`*^9, {3.7589676964596405`*^9, 3.758967696760868*^9}, {
   3.758967744954148*^9, 3.7589677487544317`*^9}, {3.7589678391783857`*^9, 
   3.758967865423463*^9}},
 CellLabel->"In[46]:=",ExpressionUUID->"94cb8bdc-6658-4087-869b-b50ec857bb6a"],

Cell[BoxData[
 RowBox[{
  TemplateBox[{"1"},
   "Ket"], "**", 
  TemplateBox[{"1"},
   "Bra"]}]], "Output",
 CellChangeTimes->{3.7589738821181397`*^9, 3.758974173674912*^9, 
  3.75898509895542*^9},
 CellLabel->"Out[46]=",ExpressionUUID->"a4a6fc5e-8e8e-4e81-8bbb-3b92d776be75"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"partTr", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"\[Alpha]", " ", 
      RowBox[{"Ket", "[", 
       RowBox[{"\"\<nula\>\"", ",", "1", ",", "g2"}], "]"}]}], "+", 
     RowBox[{"\[Beta]", " ", 
      RowBox[{"Ket", "[", 
       RowBox[{"4", ",", "1", ",", "g1"}], "]"}]}]}], ",", 
    RowBox[{"{", 
     RowBox[{"1", ",", "3"}], "}"}]}], "]"}], "//", 
  RowBox[{
   RowBox[{"FullSimplify", "[", 
    RowBox[{"#", ",", 
     RowBox[{
      RowBox[{
       SuperscriptBox[
        RowBox[{"Abs", "[", "\[Alpha]", "]"}], "2"], "+", 
       SuperscriptBox[
        RowBox[{"Abs", "[", "\[Beta]", "]"}], "2"]}], "\[Equal]", "1"}]}], 
    "]"}], "&"}]}]], "Input",
 CellChangeTimes->{{3.7589664867498865`*^9, 3.7589665224636774`*^9}, {
   3.758966557529599*^9, 3.758966560708237*^9}, {3.7589666844877243`*^9, 
   3.7589666847689714`*^9}, {3.758966994443718*^9, 3.7589670164987087`*^9}, 
   3.7589671653084345`*^9, {3.7589676964596405`*^9, 3.758967696760868*^9}, {
   3.758967744954148*^9, 3.7589677487544317`*^9}, {3.7589678391783857`*^9, 
   3.758967865423463*^9}, {3.7589685985333395`*^9, 3.758968610474963*^9}},
 CellLabel->"In[47]:=",ExpressionUUID->"afc102ba-db28-414d-9722-50f897cf59bb"],

Cell[BoxData[
 TemplateBox[{
  "partTr", "invbases", 
   "\"Some of the vectors in the input are not valid basis vectors.\"", 2, 47,
    1, 26191112683862255905, "Local", "KetsBras`partTr"},
  "MessageTemplate2"]], "Message", "MSG",
 CellChangeTimes->{3.7589851086175756`*^9},
 CellLabel->
  "During evaluation of \
In[47]:=",ExpressionUUID->"e4af1c90-00f3-4ace-9f5e-8df060a17431"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"mat", "=", 
  RowBox[{"toKetBra", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"1", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "1", ",", "3", ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "3", ",", "1", ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0", ",", "1"}], "}"}]}], "}"}], ",", 
    "\"\<Integral\>\"", ",", "2"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.758968899635926*^9, 3.7589689159464273`*^9}, {
  3.7589689541073103`*^9, 3.758969055020305*^9}, {3.758969090168265*^9, 
  3.7589690904185452`*^9}, {3.7589694821217904`*^9, 3.7589694829014516`*^9}},
 CellLabel->
  "In[191]:=",ExpressionUUID->"216dcfd8-3324-464b-947b-2b08ee3e147c"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   TemplateBox[{
     RowBox[{"1", ",", "1"}]},
    "Ket"], "**", 
   TemplateBox[{
     RowBox[{"1", ",", "1"}]},
    "Bra"]}], "+", 
  RowBox[{
   TemplateBox[{
     RowBox[{"1", ",", "2"}]},
    "Ket"], "**", 
   TemplateBox[{
     RowBox[{"1", ",", "2"}]},
    "Bra"]}], "+", 
  RowBox[{"3", " ", 
   RowBox[{
    TemplateBox[{
      RowBox[{"1", ",", "2"}]},
     "Ket"], "**", 
    TemplateBox[{
      RowBox[{"2", ",", "1"}]},
     "Bra"]}]}], "+", 
  RowBox[{"3", " ", 
   RowBox[{
    TemplateBox[{
      RowBox[{"2", ",", "1"}]},
     "Ket"], "**", 
    TemplateBox[{
      RowBox[{"1", ",", "2"}]},
     "Bra"]}]}], "+", 
  RowBox[{
   TemplateBox[{
     RowBox[{"2", ",", "1"}]},
    "Ket"], "**", 
   TemplateBox[{
     RowBox[{"2", ",", "1"}]},
    "Bra"]}], "+", 
  RowBox[{
   TemplateBox[{
     RowBox[{"2", ",", "2"}]},
    "Ket"], "**", 
   TemplateBox[{
     RowBox[{"2", ",", "2"}]},
    "Bra"]}]}]], "Output",
 CellChangeTimes->{
  3.758968916874944*^9, {3.7589689543960495`*^9, 3.7589690567699413`*^9}, 
   3.7589690909648633`*^9, 3.7589691657323413`*^9, 3.7589692574411297`*^9, {
   3.7589694837071*^9, 3.758969495573805*^9}},
 CellLabel->
  "Out[191]=",ExpressionUUID->"b8862061-1fc5-4dfd-b715-a90eddaf9269"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData["mat"], "Input",
 CellChangeTimes->{{3.758969166766816*^9, 3.7589691669598126`*^9}},
 CellLabel->
  "In[192]:=",ExpressionUUID->"1452597b-b404-42dd-b604-1763800bb2a8"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   TemplateBox[{
     RowBox[{"1", ",", "1"}]},
    "Ket"], "**", 
   TemplateBox[{
     RowBox[{"1", ",", "1"}]},
    "Bra"]}], "+", 
  RowBox[{
   TemplateBox[{
     RowBox[{"1", ",", "2"}]},
    "Ket"], "**", 
   TemplateBox[{
     RowBox[{"1", ",", "2"}]},
    "Bra"]}], "+", 
  RowBox[{"3", " ", 
   RowBox[{
    TemplateBox[{
      RowBox[{"1", ",", "2"}]},
     "Ket"], "**", 
    TemplateBox[{
      RowBox[{"2", ",", "1"}]},
     "Bra"]}]}], "+", 
  RowBox[{"3", " ", 
   RowBox[{
    TemplateBox[{
      RowBox[{"2", ",", "1"}]},
     "Ket"], "**", 
    TemplateBox[{
      RowBox[{"1", ",", "2"}]},
     "Bra"]}]}], "+", 
  RowBox[{
   TemplateBox[{
     RowBox[{"2", ",", "1"}]},
    "Ket"], "**", 
   TemplateBox[{
     RowBox[{"2", ",", "1"}]},
    "Bra"]}], "+", 
  RowBox[{
   TemplateBox[{
     RowBox[{"2", ",", "2"}]},
    "Ket"], "**", 
   TemplateBox[{
     RowBox[{"2", ",", "2"}]},
    "Bra"]}]}]], "Output",
 CellChangeTimes->{3.7589691674360867`*^9, 3.758969258514258*^9, 
  3.7589694965547237`*^9},
 CellLabel->
  "Out[192]=",ExpressionUUID->"ba22069e-ffe7-4752-9f33-522efaef8537"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"changeBasis", "[", 
   RowBox[{"mat", ",", "\"\<diag\>\"", ",", "\"\<comp\>\"", ",", 
    RowBox[{"{", "1", "}"}]}], "]"}], "*)"}]], "Input",
 CellChangeTimes->{{3.7589691028096476`*^9, 3.758969132739107*^9}, {
  3.7589691777667265`*^9, 3.7589691813805876`*^9}, {3.7589692216967225`*^9, 
  3.758969221902173*^9}},
 CellLabel->
  "In[193]:=",ExpressionUUID->"ada8f0ac-2f33-49e7-aee9-13789e1a81e1"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"partTr", "[", 
  RowBox[{
   RowBox[{
    RowBox[{
     TemplateBox[{
       RowBox[{"1", ",", "1"}]},
      "Ket"], "**", 
     TemplateBox[{
       RowBox[{"1", ",", "1"}]},
      "Bra"]}], "+", 
    RowBox[{
     TemplateBox[{
       RowBox[{"1", ",", "2"}]},
      "Ket"], "**", 
     TemplateBox[{
       RowBox[{"1", ",", "2"}]},
      "Bra"]}], "+", 
    RowBox[{"3", " ", 
     RowBox[{
      TemplateBox[{
        RowBox[{"1", ",", "2"}]},
       "Ket"], "**", 
      TemplateBox[{
        RowBox[{"2", ",", "1"}]},
       "Bra"]}]}], "+", 
    RowBox[{"3", " ", 
     RowBox[{
      TemplateBox[{
        RowBox[{"2", ",", "1"}]},
       "Ket"], "**", 
      TemplateBox[{
        RowBox[{"1", ",", "2"}]},
       "Bra"]}]}], "+", 
    RowBox[{
     TemplateBox[{
       RowBox[{"2", ",", "1"}]},
      "Ket"], "**", 
     TemplateBox[{
       RowBox[{"2", ",", "1"}]},
      "Bra"]}], "+", 
    RowBox[{
     TemplateBox[{
       RowBox[{"2", ",", "2"}]},
      "Ket"], "**", 
     TemplateBox[{
       RowBox[{"2", ",", "2"}]},
      "Bra"]}]}], ",", 
   RowBox[{"{", "2", "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.7589686267591677`*^9, 3.7589686323720922`*^9}, {
   3.758968894528491*^9, 3.758968927980399*^9}, 3.7589690730136576`*^9, 
   3.7589695486791677`*^9},
 CellLabel->"In[15]:=",ExpressionUUID->"cd71a3ab-8c33-4683-9096-2d525c1c973c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"2", " ", 
   RowBox[{
    TemplateBox[{"1"},
     "Ket"], "**", 
    TemplateBox[{"1"},
     "Bra"]}]}], "+", 
  RowBox[{"2", " ", 
   RowBox[{
    TemplateBox[{"2"},
     "Ket"], "**", 
    TemplateBox[{"2"},
     "Bra"]}]}]}]], "Output",
 CellChangeTimes->{
  3.7589686328363624`*^9, {3.758968920537121*^9, 3.7589689287081156`*^9}, {
   3.7589690359519267`*^9, 3.758969092716164*^9}, {3.758969489427429*^9, 
   3.7589695072838984`*^9}, 3.7589695502683773`*^9, 3.7590437765646005`*^9, 
   3.7607006820621567`*^9},
 CellLabel->"Out[15]=",ExpressionUUID->"d9cb328a-1c3d-402b-880d-31ca1168d022"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"partTr", "[", 
  RowBox[{
   RowBox[{
    RowBox[{
     TemplateBox[{
       RowBox[{"1", ",", "1"}]},
      "Ket"], "**", 
     TemplateBox[{
       RowBox[{"1", ",", "1"}]},
      "Bra"]}], "+", 
    RowBox[{
     TemplateBox[{
       RowBox[{"1", ",", "2"}]},
      "Ket"], "**", 
     TemplateBox[{
       RowBox[{"1", ",", "2"}]},
      "Bra"]}], "+", 
    RowBox[{"3", " ", 
     RowBox[{
      TemplateBox[{
        RowBox[{"1", ",", "2"}]},
       "Ket"], "**", 
      TemplateBox[{
        RowBox[{"2", ",", "1"}]},
       "Bra"]}]}], "+", 
    RowBox[{"3", " ", 
     RowBox[{
      TemplateBox[{
        RowBox[{"2", ",", "1", ",", "asfd"}]},
       "Ket"], "**", 
      TemplateBox[{
        RowBox[{"1", ",", "2"}]},
       "Bra"]}]}], "+", 
    RowBox[{
     TemplateBox[{
       RowBox[{"2", ",", "1"}]},
      "Ket"], "**", 
     TemplateBox[{
       RowBox[{"2", ",", "1"}]},
      "Bra"]}], "+", 
    RowBox[{
     TemplateBox[{
       RowBox[{"2", ",", "2"}]},
      "Ket"], "**", 
     TemplateBox[{
       RowBox[{"2", ",", "2"}]},
      "Bra"]}]}], ",", 
   RowBox[{"{", "2", "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.7589686267591677`*^9, 3.7589686323720922`*^9}, {
   3.758968894528491*^9, 3.758968927980399*^9}, 3.7589690730136576`*^9, {
   3.7589695486791677`*^9, 3.7589695552534823`*^9}},
 CellLabel->"In[16]:=",ExpressionUUID->"0eba5460-d5da-41ab-803b-ef037d9efcfb"],

Cell[BoxData[
 TemplateBox[{
  "partTr", "diffdimket", 
   "\"Input expression is a linear combination of vectors with different \
number of dimensions in ket specifications.\"", 2, 16, 1, 
   26202241212332214966, "Local", "KetsBras`partTr"},
  "MessageTemplate2"]], "Message", "MSG",
 CellChangeTimes->{3.758969555903837*^9, 3.7590437787700567`*^9, 
  3.7607006832938614`*^9},
 CellLabel->
  "During evaluation of \
In[16]:=",ExpressionUUID->"65c994da-5f15-4446-b612-0b68c426db64"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"fromKet", "[", 
  RowBox[{
   RowBox[{"\[Alpha]", " ", 
    RowBox[{"Ket", "[", 
     RowBox[{"0", ",", "1"}], "]"}]}], "+", 
   RowBox[{"\[Beta]", " ", 
    RowBox[{"Ket", "[", 
     RowBox[{"6", ",", "1"}], "]"}]}]}], "]"}]], "Input",
 CellChangeTimes->{{3.7580281721605787`*^9, 3.7580282205038548`*^9}, {
   3.758028490342411*^9, 3.7580284994404335`*^9}, 3.7590437293399215`*^9},
 CellLabel->"In[36]:=",ExpressionUUID->"7f809984-789c-4a78-9aaf-c4c159f0e7de"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
    "\[Alpha]", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
     "\[Beta]"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     TemplateBox[{
       RowBox[{"0", ",", "1"}]},
      "Ket"], ",", 
     TemplateBox[{
       RowBox[{"1", ",", "1"}]},
      "Ket"], ",", 
     TemplateBox[{
       RowBox[{"2", ",", "1"}]},
      "Ket"], ",", 
     TemplateBox[{
       RowBox[{"3", ",", "1"}]},
      "Ket"], ",", 
     TemplateBox[{
       RowBox[{"4", ",", "1"}]},
      "Ket"], ",", 
     TemplateBox[{
       RowBox[{"5", ",", "1"}]},
      "Ket"], ",", 
     TemplateBox[{
       RowBox[{"6", ",", "1"}]},
      "Ket"]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.7590437296822615`*^9},
 CellLabel->"Out[36]=",ExpressionUUID->"ed6520ba-9e0f-4466-9ff9-dbeb606049b7"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"fromKet", "[", 
  RowBox[{
   RowBox[{"Ket", "[", 
    RowBox[{"0", ",", "1"}], "]"}], "+", "34"}], "]"}]], "Input",
 CellChangeTimes->{{3.7580281721605787`*^9, 3.7580282205038548`*^9}, {
  3.758028490342411*^9, 3.7580285276486897`*^9}},
 CellLabel->"In[35]:=",ExpressionUUID->"10cd26b5-188d-481c-8d94-d3e622271481"],

Cell[BoxData[
 TemplateBox[{
  "fromKet", "invalket", 
   "\"Input expression is not a linear combination of terms Ket[x].\"", 2, 35,
    3, 26191496410366677217, "Local", "KetsBras`fromKet"},
  "MessageTemplate2"]], "Message", "MSG",
 CellChangeTimes->{3.7580285281382236`*^9, 3.7589596780441003`*^9, 
  3.7590437253095303`*^9},
 CellLabel->
  "During evaluation of \
In[35]:=",ExpressionUUID->"db1f31c3-4e80-41af-9e77-0cb55097dc31"]
}, Open  ]],

Cell[BoxData["fromKet"], "Input",ExpressionUUID->"1382b710-19f8-472f-abfe-38934103eb47"],

Cell[BoxData[{
 RowBox[{"expr", "=", 
  RowBox[{
   RowBox[{"\[Alpha]", " ", 
    RowBox[{
     RowBox[{"Ket", "[", "a", "]"}], "**", 
     RowBox[{"Bra", "[", "b", "]"}]}]}], "+", 
   RowBox[{"3", "\[Beta]", " ", 
    RowBox[{
     RowBox[{"Ket", "[", "c", "]"}], "**", 
     RowBox[{"Bra", "[", "b", "]"}]}]}], "+", 
   RowBox[{"\[Gamma]", " ", 
    RowBox[{
     RowBox[{"Ket", "[", "a", "]"}], "**", 
     RowBox[{"Bra", "[", "b", "]"}]}]}]}]}], "\[IndentingNewLine]", 
 RowBox[{"Collect", "[", 
  RowBox[{"expr", ",", 
   RowBox[{
    RowBox[{"Ket", "[", "__", "]"}], "**", 
    RowBox[{"Bra", "[", "__", "]"}]}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.7580243599811354`*^9, 3.7580244005296345`*^9}},
 CellLabel->"In[68]:=",ExpressionUUID->"15c976e3-fa7b-4574-b273-2067baded4bf"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"fromKet", "[", 
  RowBox[{
   RowBox[{"Ket", "[", 
    RowBox[{"0", ",", "\"\<A\>\""}], "]"}], "+", 
   RowBox[{"Ket", "[", 
    RowBox[{"1", ",", "\"\<A\>\""}], "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.7589597860401945`*^9, 3.758959826306482*^9}},
 CellLabel->"In[72]:=",ExpressionUUID->"21ce367e-084e-4c0a-b950-01e6a1c175fa"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"0", ",", "1", ",", "0", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     TemplateBox[{
       RowBox[{"0", ",", "\"D\""}]},
      "Ket"], ",", 
     TemplateBox[{
       RowBox[{"0", ",", "\"A\""}]},
      "Ket"], ",", 
     TemplateBox[{
       RowBox[{"1", ",", "\"D\""}]},
      "Ket"], ",", 
     TemplateBox[{
       RowBox[{"1", ",", "\"A\""}]},
      "Ket"]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.758959826644574*^9},
 CellLabel->"Out[72]=",ExpressionUUID->"6574b507-16ca-4997-8236-7b485ae877b9"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"permuteKets", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"I", " ", 
     RowBox[{"Ket", "[", 
      RowBox[{"a", ",", "6"}], "]"}]}], "+", 
    RowBox[{"5", "  ", 
     RowBox[{"Ket", "[", 
      RowBox[{"3", ",", "6"}], "]"}]}]}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "3"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.757324335504698*^9, 3.7573243581829977`*^9}, {
  3.757324389608932*^9, 3.7573244806723676`*^9}},
 CellLabel->"In[56]:=",ExpressionUUID->"4ad8ab4c-5e7a-4056-969c-67c702c60b28"],

Cell[BoxData[
 TemplateBox[{
  "permuteKets", "invperm", 
   "\"Invalid permutation \\!\\(\\*RowBox[{\\\"{\\\", RowBox[{\\\"2\\\", \
\\\",\\\", \\\"3\\\"}], \\\"}\\\"}]\\) for number \
\\!\\(\\*RowBox[{\\\"2\\\"}]\\) of unipartite subspaces.\"", 2, 56, 6, 
   26180224420750667274, "Local", "KetsBras`permuteKets"},
  "MessageTemplate2"]], "Message", "MSG",
 CellChangeTimes->{3.7573244810243955`*^9},
 CellLabel->
  "During evaluation of \
In[56]:=",ExpressionUUID->"8404039d-9edb-4818-9e75-45d34d4911da"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"mat", "=", 
   RowBox[{
    FractionBox["1", "2"], 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"1", ",", "0", ",", "0", ",", "0", ",", "0", ",", "1"}], "}"}],
       ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}],
       ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}],
       ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}],
       ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}],
       ",", 
      RowBox[{"{", 
       RowBox[{"1", ",", "0", ",", "0", ",", "0", ",", "0", ",", "1"}], 
       "}"}]}], "}"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"MatrixForm", "[", "mat", "]"}]}], "Input",
 CellChangeTimes->{{3.757249992925129*^9, 3.7572499987471175`*^9}},
 CellLabel->"In[17]:=",ExpressionUUID->"e3282641-83be-48ad-923f-98710b907439"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      FractionBox["1", "2"], "0", "0", "0", "0", 
      FractionBox["1", "2"]},
     {"0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0"},
     {
      FractionBox["1", "2"], "0", "0", "0", "0", 
      FractionBox["1", "2"]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.7572499991450634`*^9, 3.7572529667171497`*^9, 
  3.760700702959272*^9},
 CellLabel->
  "Out[18]//MatrixForm=",ExpressionUUID->"2bd31b07-d982-4f53-bf9b-\
c4f097505c7e"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"toKetBra", "[", 
  RowBox[{
   RowBox[{"PauliMatrix", "[", "1", "]"}], ",", "\"\<comp\>\""}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.7573173430279837`*^9, 3.7573173603885098`*^9}},
 CellLabel->"In[19]:=",ExpressionUUID->"62014f1c-9b9e-4835-9e53-e2ff07861d69"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   TemplateBox[{"\"H\""},
    "Ket"], "**", 
   TemplateBox[{"\"V\""},
    "Bra"]}], "+", 
  RowBox[{
   TemplateBox[{"\"V\""},
    "Ket"], "**", 
   TemplateBox[{"\"H\""},
    "Bra"]}]}]], "Output",
 CellChangeTimes->{3.7607007041680403`*^9},
 CellLabel->"Out[19]=",ExpressionUUID->"9f808654-6703-40e6-a779-03ff5144d15f"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"partTr", "[", 
   RowBox[{"mat", ",", 
    RowBox[{"{", "1", "}"}], ",", "3"}], "]"}], "//", "MatrixForm"}]], "Input",\

 CellChangeTimes->{{3.757249068009469*^9, 3.7572490984655848`*^9}, {
   3.7572491431352386`*^9, 3.75724914435114*^9}, {3.757249475375085*^9, 
   3.757249485902234*^9}, {3.7572497551371236`*^9, 3.7572497736843243`*^9}, {
   3.757249808828673*^9, 3.7572498360653734`*^9}, {3.7572499905386972`*^9, 
   3.757249991375407*^9}, {3.7572507188474646`*^9, 3.757250723331642*^9}, 
   3.7572529961753516`*^9},
 CellLabel->"In[20]:=",ExpressionUUID->"5ba9f2cf-95ce-4c90-80e7-a4a8327a548e"],

Cell[BoxData[
 TemplateBox[{
  "partTr", "invdimsdiff", 
   "\"Dimensions \\!\\(\\*RowBox[{\\\"{\\\", RowBox[{\\\"6\\\", \\\",\\\", \\\
\"6\\\"}], \\\"}\\\"}]\\) of input matrix do not correspond to density matrix \
of \\!\\(\\*RowBox[{\\\"1\\\"}]\\) systems with respective dimensions \
\\!\\(\\*RowBox[{\\\"{\\\", \\\"3\\\", \\\"}\\\"}]\\) \
(Times@@\\!\\(\\*RowBox[{\\\"{\\\", \\\"3\\\", \\\"}\\\"}]\\) = \
\\!\\(\\*RowBox[{\\\"3\\\"}]\\) != First@\\!\\(\\*RowBox[{\\\"{\\\", RowBox[{\
\\\"6\\\", \\\",\\\", \\\"6\\\"}], \\\"}\\\"}]\\)).\"", 2, 20, 2, 
   26202241212332214966, "Local", "KetsBras`partTr"},
  "MessageTemplate2"]], "Message", "MSG",
 CellChangeTimes->{3.760700714515374*^9},
 CellLabel->
  "During evaluation of \
In[20]:=",ExpressionUUID->"cca128ea-4191-4ba9-ac6a-501415508484"],

Cell[BoxData[
 TagBox["Null",
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.757249486774313*^9, 3.7572496611897955`*^9, 3.7572496915981903`*^9, {
   3.7572497368702493`*^9, 3.757249755574953*^9}, {3.757249809599162*^9, 
   3.7572498367741766`*^9}, {3.757250713644993*^9, 3.7572507237684875`*^9}, {
   3.7572529577012663`*^9, 3.757252996505465*^9}, 3.7607007145223513`*^9},
 CellLabel->
  "Out[20]//MatrixForm=",ExpressionUUID->"9ffc4c06-4d75-4e1c-bf05-\
eccd0b6cd335"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"partTr", "[", 
   RowBox[{"mat", ",", 
    RowBox[{"{", "2", "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"2", ",", "3"}], "}"}]}], "]"}], "//", "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.757249068009469*^9, 3.7572490984655848`*^9}, {
  3.7572491431352386`*^9, 3.75724914435114*^9}, {3.757249475375085*^9, 
  3.757249485902234*^9}, {3.7572497551371236`*^9, 3.7572497736843243`*^9}, {
  3.757249808828673*^9, 3.7572498360653734`*^9}, {3.7572499905386972`*^9, 
  3.757249991375407*^9}, {3.7572507188474646`*^9, 3.7572507274699235`*^9}},
 CellLabel->"In[21]:=",ExpressionUUID->"17314ed2-a6fe-4e22-b1b0-f52f27ec98a9"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     FractionBox["1", "2"], ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", 
     FractionBox["1", "2"]}], "}"}]}], "}"}]], "Echo",
 CellChangeTimes->{
  3.7607007407232847`*^9},ExpressionUUID->"b39c13a5-0684-4060-877e-\
81f02d983b01"],

Cell[BoxData["True"], "Echo",
 CellChangeTimes->{
  3.7607007407442317`*^9},ExpressionUUID->"78ce58f8-e500-489f-b0a4-\
05dcfb03cde6"]
}, Open  ]],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      FractionBox["1", "2"], "0"},
     {"0", 
      FractionBox["1", "2"]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.757250727748173*^9, 3.7607007407990804`*^9},
 CellLabel->
  "Out[21]//MatrixForm=",ExpressionUUID->"2a8f601e-5ae2-4758-afe6-\
2d6c48649296"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"partTr", "[", 
   RowBox[{
    RowBox[{"Array", "[", 
     RowBox[{
      RowBox[{
       SubscriptBox["a", "##"], "&"}], ",", 
      RowBox[{"{", 
       RowBox[{"6", ",", "6"}], "}"}]}], "]"}], ",", 
    RowBox[{"{", "2", "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"2", ",", "3"}], "}"}]}], "]"}], "//", "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.757249068009469*^9, 3.7572490984655848`*^9}, {
  3.7572491431352386`*^9, 3.75724914435114*^9}, {3.757249475375085*^9, 
  3.757249485902234*^9}, {3.7572497551371236`*^9, 3.7572497736843243`*^9}, {
  3.757249808828673*^9, 3.7572498360653734`*^9}, {3.7572499905386972`*^9, 
  3.757249991375407*^9}, {3.7572507188474646`*^9, 3.757250770268737*^9}},
 CellLabel->"In[22]:=",ExpressionUUID->"193a0f46-dd1e-4ead-80ca-32afff1f7bcb"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      SubscriptBox["a", 
       RowBox[{"1", ",", "1"}]], "+", 
      SubscriptBox["a", 
       RowBox[{"2", ",", "2"}]], "+", 
      SubscriptBox["a", 
       RowBox[{"3", ",", "3"}]]}], ",", 
     RowBox[{
      SubscriptBox["a", 
       RowBox[{"1", ",", "4"}]], "+", 
      SubscriptBox["a", 
       RowBox[{"2", ",", "5"}]], "+", 
      SubscriptBox["a", 
       RowBox[{"3", ",", "6"}]]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      SubscriptBox["a", 
       RowBox[{"4", ",", "1"}]], "+", 
      SubscriptBox["a", 
       RowBox[{"5", ",", "2"}]], "+", 
      SubscriptBox["a", 
       RowBox[{"6", ",", "3"}]]}], ",", 
     RowBox[{
      SubscriptBox["a", 
       RowBox[{"4", ",", "4"}]], "+", 
      SubscriptBox["a", 
       RowBox[{"5", ",", "5"}]], "+", 
      SubscriptBox["a", 
       RowBox[{"6", ",", "6"}]]}]}], "}"}]}], "}"}]], "Echo",
 CellChangeTimes->{
  3.76070074274089*^9},ExpressionUUID->"1c7a8530-1990-4041-89ff-f644bcaf308c"],

Cell[BoxData["True"], "Echo",
 CellChangeTimes->{
  3.7607007427698135`*^9},ExpressionUUID->"0e0816fb-4c4a-4066-9059-\
fc6335b01634"]
}, Open  ]],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{
       SubscriptBox["a", 
        RowBox[{"1", ",", "1"}]], "+", 
       SubscriptBox["a", 
        RowBox[{"2", ",", "2"}]], "+", 
       SubscriptBox["a", 
        RowBox[{"3", ",", "3"}]]}], 
      RowBox[{
       SubscriptBox["a", 
        RowBox[{"1", ",", "4"}]], "+", 
       SubscriptBox["a", 
        RowBox[{"2", ",", "5"}]], "+", 
       SubscriptBox["a", 
        RowBox[{"3", ",", "6"}]]}]},
     {
      RowBox[{
       SubscriptBox["a", 
        RowBox[{"4", ",", "1"}]], "+", 
       SubscriptBox["a", 
        RowBox[{"5", ",", "2"}]], "+", 
       SubscriptBox["a", 
        RowBox[{"6", ",", "3"}]]}], 
      RowBox[{
       SubscriptBox["a", 
        RowBox[{"4", ",", "4"}]], "+", 
       SubscriptBox["a", 
        RowBox[{"5", ",", "5"}]], "+", 
       SubscriptBox["a", 
        RowBox[{"6", ",", "6"}]]}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.757250756565715*^9, 3.7572507706755943`*^9}, 
   3.7607007428276567`*^9},
 CellLabel->
  "Out[22]//MatrixForm=",ExpressionUUID->"005a2c07-c445-43a3-a235-\
722951ad9f7b"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"partTr", "[", 
   RowBox[{
    RowBox[{"Array", "[", 
     RowBox[{
      RowBox[{
       SubscriptBox["a", "##"], "&"}], ",", 
      RowBox[{"{", 
       RowBox[{"6", ",", "6"}], "}"}]}], "]"}], ",", 
    RowBox[{"{", "2", "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"3", ",", "2"}], "}"}]}], "]"}], "//", "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.757249068009469*^9, 3.7572490984655848`*^9}, {
  3.7572491431352386`*^9, 3.75724914435114*^9}, {3.757249475375085*^9, 
  3.757249485902234*^9}, {3.7572497551371236`*^9, 3.7572497736843243`*^9}, {
  3.757249808828673*^9, 3.7572498360653734`*^9}, {3.7572499905386972`*^9, 
  3.757249991375407*^9}, {3.7572507188474646`*^9, 3.757250770268737*^9}, {
  3.7572512713403983`*^9, 3.7572512745062304`*^9}},
 CellLabel->"In[23]:=",ExpressionUUID->"41cf12d3-fdf4-4974-a56c-2e632f966a66"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      SubscriptBox["a", 
       RowBox[{"1", ",", "1"}]], "+", 
      SubscriptBox["a", 
       RowBox[{"2", ",", "2"}]]}], ",", 
     RowBox[{
      SubscriptBox["a", 
       RowBox[{"1", ",", "3"}]], "+", 
      SubscriptBox["a", 
       RowBox[{"2", ",", "4"}]]}], ",", 
     RowBox[{
      SubscriptBox["a", 
       RowBox[{"1", ",", "5"}]], "+", 
      SubscriptBox["a", 
       RowBox[{"2", ",", "6"}]]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      SubscriptBox["a", 
       RowBox[{"3", ",", "1"}]], "+", 
      SubscriptBox["a", 
       RowBox[{"4", ",", "2"}]]}], ",", 
     RowBox[{
      SubscriptBox["a", 
       RowBox[{"3", ",", "3"}]], "+", 
      SubscriptBox["a", 
       RowBox[{"4", ",", "4"}]]}], ",", 
     RowBox[{
      SubscriptBox["a", 
       RowBox[{"3", ",", "5"}]], "+", 
      SubscriptBox["a", 
       RowBox[{"4", ",", "6"}]]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      SubscriptBox["a", 
       RowBox[{"5", ",", "1"}]], "+", 
      SubscriptBox["a", 
       RowBox[{"6", ",", "2"}]]}], ",", 
     RowBox[{
      SubscriptBox["a", 
       RowBox[{"5", ",", "3"}]], "+", 
      SubscriptBox["a", 
       RowBox[{"6", ",", "4"}]]}], ",", 
     RowBox[{
      SubscriptBox["a", 
       RowBox[{"5", ",", "5"}]], "+", 
      SubscriptBox["a", 
       RowBox[{"6", ",", "6"}]]}]}], "}"}]}], "}"}]], "Echo",
 CellChangeTimes->{
  3.760700746422044*^9},ExpressionUUID->"34afb43e-251d-4091-8e68-\
69ec55756b5a"],

Cell[BoxData["True"], "Echo",
 CellChangeTimes->{
  3.760700746450966*^9},ExpressionUUID->"4d6c3883-772b-4ee5-a377-\
85bae75dcf47"]
}, Open  ]],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{
       SubscriptBox["a", 
        RowBox[{"1", ",", "1"}]], "+", 
       SubscriptBox["a", 
        RowBox[{"2", ",", "2"}]]}], 
      RowBox[{
       SubscriptBox["a", 
        RowBox[{"1", ",", "3"}]], "+", 
       SubscriptBox["a", 
        RowBox[{"2", ",", "4"}]]}], 
      RowBox[{
       SubscriptBox["a", 
        RowBox[{"1", ",", "5"}]], "+", 
       SubscriptBox["a", 
        RowBox[{"2", ",", "6"}]]}]},
     {
      RowBox[{
       SubscriptBox["a", 
        RowBox[{"3", ",", "1"}]], "+", 
       SubscriptBox["a", 
        RowBox[{"4", ",", "2"}]]}], 
      RowBox[{
       SubscriptBox["a", 
        RowBox[{"3", ",", "3"}]], "+", 
       SubscriptBox["a", 
        RowBox[{"4", ",", "4"}]]}], 
      RowBox[{
       SubscriptBox["a", 
        RowBox[{"3", ",", "5"}]], "+", 
       SubscriptBox["a", 
        RowBox[{"4", ",", "6"}]]}]},
     {
      RowBox[{
       SubscriptBox["a", 
        RowBox[{"5", ",", "1"}]], "+", 
       SubscriptBox["a", 
        RowBox[{"6", ",", "2"}]]}], 
      RowBox[{
       SubscriptBox["a", 
        RowBox[{"5", ",", "3"}]], "+", 
       SubscriptBox["a", 
        RowBox[{"6", ",", "4"}]]}], 
      RowBox[{
       SubscriptBox["a", 
        RowBox[{"5", ",", "5"}]], "+", 
       SubscriptBox["a", 
        RowBox[{"6", ",", "6"}]]}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.757251274866266*^9, 3.76070074651779*^9},
 CellLabel->
  "Out[23]//MatrixForm=",ExpressionUUID->"50da54e5-3d38-48ed-9a4f-\
4d6906cebd06"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"partTr", "[", 
   RowBox[{
    RowBox[{"Array", "[", 
     RowBox[{
      RowBox[{
       SubscriptBox["a", "##"], "&"}], ",", 
      RowBox[{"{", 
       RowBox[{"6", ",", "6"}], "}"}]}], "]"}], ",", 
    RowBox[{"{", "1", "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"2", ",", "3"}], "}"}]}], "]"}], "//", "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.757249068009469*^9, 3.7572490984655848`*^9}, {
  3.7572491431352386`*^9, 3.75724914435114*^9}, {3.757249475375085*^9, 
  3.757249485902234*^9}, {3.7572497551371236`*^9, 3.7572497736843243`*^9}, {
  3.757249808828673*^9, 3.7572498360653734`*^9}, {3.7572499905386972`*^9, 
  3.757249991375407*^9}, {3.7572507188474646`*^9, 3.757250776195255*^9}},
 CellLabel->"In[82]:=",ExpressionUUID->"e369bad2-cf61-408e-801a-215ffd3b0fe3"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{
       SubscriptBox["a", 
        RowBox[{"1", ",", "1"}]], "+", 
       SubscriptBox["a", 
        RowBox[{"4", ",", "4"}]]}], 
      RowBox[{
       SubscriptBox["a", 
        RowBox[{"1", ",", "2"}]], "+", 
       SubscriptBox["a", 
        RowBox[{"4", ",", "5"}]]}], 
      RowBox[{
       SubscriptBox["a", 
        RowBox[{"1", ",", "3"}]], "+", 
       SubscriptBox["a", 
        RowBox[{"4", ",", "6"}]]}]},
     {
      RowBox[{
       SubscriptBox["a", 
        RowBox[{"2", ",", "1"}]], "+", 
       SubscriptBox["a", 
        RowBox[{"5", ",", "4"}]]}], 
      RowBox[{
       SubscriptBox["a", 
        RowBox[{"2", ",", "2"}]], "+", 
       SubscriptBox["a", 
        RowBox[{"5", ",", "5"}]]}], 
      RowBox[{
       SubscriptBox["a", 
        RowBox[{"2", ",", "3"}]], "+", 
       SubscriptBox["a", 
        RowBox[{"5", ",", "6"}]]}]},
     {
      RowBox[{
       SubscriptBox["a", 
        RowBox[{"3", ",", "1"}]], "+", 
       SubscriptBox["a", 
        RowBox[{"6", ",", "4"}]]}], 
      RowBox[{
       SubscriptBox["a", 
        RowBox[{"3", ",", "2"}]], "+", 
       SubscriptBox["a", 
        RowBox[{"6", ",", "5"}]]}], 
      RowBox[{
       SubscriptBox["a", 
        RowBox[{"3", ",", "3"}]], "+", 
       SubscriptBox["a", 
        RowBox[{"6", ",", "6"}]]}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.7572507765223384`*^9, 3.758962027904842*^9},
 CellLabel->
  "Out[82]//MatrixForm=",ExpressionUUID->"af27de84-e4f2-49c2-93e5-\
42a8c3d17e21"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"partTr", "[", 
   RowBox[{
    RowBox[{"Array", "[", 
     RowBox[{
      RowBox[{
       SubscriptBox["a", "##"], "&"}], ",", 
      RowBox[{"{", 
       RowBox[{"6", ",", "6"}], "}"}]}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"1", ",", "2"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"2", ",", "3"}], "}"}]}], "]"}], "//", "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.757249068009469*^9, 3.7572490984655848`*^9}, {
  3.7572491431352386`*^9, 3.75724914435114*^9}, {3.757249475375085*^9, 
  3.757249485902234*^9}, {3.7572497551371236`*^9, 3.7572497736843243`*^9}, {
  3.757249808828673*^9, 3.7572498360653734`*^9}, {3.7572499905386972`*^9, 
  3.757249991375407*^9}, {3.7572507188474646`*^9, 3.757250779553093*^9}},
 CellLabel->"In[71]:=",ExpressionUUID->"49ca1517-76c7-4e59-a81f-ff1c42015d94"],

Cell[BoxData[
 TagBox[
  RowBox[{
   SubscriptBox["a", 
    RowBox[{"1", ",", "1"}]], "+", 
   SubscriptBox["a", 
    RowBox[{"2", ",", "2"}]], "+", 
   SubscriptBox["a", 
    RowBox[{"3", ",", "3"}]], "+", 
   SubscriptBox["a", 
    RowBox[{"4", ",", "4"}]], "+", 
   SubscriptBox["a", 
    RowBox[{"5", ",", "5"}]], "+", 
   SubscriptBox["a", 
    RowBox[{"6", ",", "6"}]]}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.7572507799071603`*^9},
 CellLabel->
  "Out[71]//MatrixForm=",ExpressionUUID->"9a2d93ce-df12-419d-bd89-\
240b56fee826"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"IdentityMatrix", "[", "6", "]"}]], "Input",
 CellChangeTimes->{{3.757249777078005*^9, 3.7572497792521243`*^9}},
 CellLabel->"In[46]:=",ExpressionUUID->"097476fd-26d8-4ca2-94f9-1913987e52d1"],

Cell[BoxData[
 RowBox[{"trmat", "=", 
  RowBox[{"Nest", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Partition", "[", 
      RowBox[{"#", ",", 
       RowBox[{"{", 
        RowBox[{"dim", ",", "dim"}], "}"}]}], "]"}], "&"}], ",", "mat", ",", 
    RowBox[{"num", "-", "1"}]}], "]"}]}]], "Input",ExpressionUUID->"44b9986d-\
3181-4f1e-862e-2d6021e376ba"],

Cell[BoxData[
 RowBox[{"Nest", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"Partition", "[", 
     RowBox[{"#1", ",", 
      RowBox[{"{", 
       RowBox[{"#2", ",", "#2"}], "}"}]}], "]"}], "&"}], ",", "mat", ",", 
   "dims"}], "]"}]], "Input",
 CellChangeTimes->{{3.757249200129423*^9, 
  3.7572492246672764`*^9}},ExpressionUUID->"ef089c63-8652-460a-aff2-\
0349ede50e9b"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"partTr", "::", "invdims"}]], "Input",
 CellLabel->
  "In[114]:=",ExpressionUUID->"7dd1f803-4e5b-475c-a1a0-63fcb2ce6793"],

Cell[BoxData["\<\"Dimensions `1` of input matrix do not correspond to density \
matrix of `2`-partite state of `3`-dimensional systems.\"\>"], "Output",
 CellChangeTimes->{3.7572465229705877`*^9},
 CellLabel->
  "Out[114]=",ExpressionUUID->"6e31c476-8b24-48ab-932d-75223d098a63"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"toKetBra", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "2", ",", "3", ",", "8"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"4", ",", "5", ",", "6", ",", "7"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", "\"\<nono\>\"", "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"{", 
     RowBox[{
      TemplateBox[{"\"H\""},
       "Ket"], ",", 
      TemplateBox[{"\[Wolf]"},
       "Ket"], ",", 
      RowBox[{"Ket", "[", "2", "]"}], ",", 
      RowBox[{"Ket", "[", "jk", "]"}]}], "}"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.757239231383898*^9, 3.7572393097183495`*^9}, {
  3.757239788803195*^9, 3.7572398042039967`*^9}, {3.757239885641019*^9, 
  3.757239886656337*^9}, {3.7572399599103727`*^9, 3.7572400179647417`*^9}, {
  3.7572404397267895`*^9, 3.757240440387545*^9}, {3.757240497211933*^9, 
  3.757240577957648*^9}},
 CellLabel->"In[14]:=",ExpressionUUID->"4cc2668d-564f-4ce7-b9b2-2688a9fc77c3"],

Cell[BoxData[
 RowBox[{
  RowBox[{"3", " ", 
   RowBox[{
    TemplateBox[{"\"no1\""},
     "Ket"], "**", 
    TemplateBox[{"2"},
     "Bra"]}]}], "+", 
  RowBox[{
   TemplateBox[{"\"no1\""},
    "Ket"], "**", 
   TemplateBox[{"\"H\""},
    "Bra"]}], "+", 
  RowBox[{"8", " ", 
   RowBox[{
    TemplateBox[{"\"no1\""},
     "Ket"], "**", 
    TemplateBox[{"jk"},
     "Bra"]}]}], "+", 
  RowBox[{"2", " ", 
   RowBox[{
    TemplateBox[{"\"no1\""},
     "Ket"], "**", 
    TemplateBox[{"\[Wolf]"},
     "Bra"]}]}], "+", 
  RowBox[{"6", " ", 
   RowBox[{
    TemplateBox[{"\"no2\""},
     "Ket"], "**", 
    TemplateBox[{"2"},
     "Bra"]}]}], "+", 
  RowBox[{"4", " ", 
   RowBox[{
    TemplateBox[{"\"no2\""},
     "Ket"], "**", 
    TemplateBox[{"\"H\""},
     "Bra"]}]}], "+", 
  RowBox[{"7", " ", 
   RowBox[{
    TemplateBox[{"\"no2\""},
     "Ket"], "**", 
    TemplateBox[{"jk"},
     "Bra"]}]}], "+", 
  RowBox[{"5", " ", 
   RowBox[{
    TemplateBox[{"\"no2\""},
     "Ket"], "**", 
    TemplateBox[{"\[Wolf]"},
     "Bra"]}]}]}]], "Output",
 CellChangeTimes->{
  3.757240578618886*^9, 3.7572408927949476`*^9, {3.7572409333164473`*^9, 
   3.7572409681269245`*^9}, 3.757243149634206*^9, 3.7572439214168324`*^9, 
   3.7590437412992573`*^9, 3.760683139672325*^9},
 CellLabel->"Out[14]=",ExpressionUUID->"7de7852f-42b6-4f7a-8db9-da014e66f2fe"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"fromKetBra", "[", "]"}]], "Input",
 CellChangeTimes->{{3.759043742834695*^9, 
  3.759043745579031*^9}},ExpressionUUID->"dc2ef9e8-be3a-4d60-adc9-\
40674e27a7a4"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"?", "fromKetBra"}]], "Input",
 CellChangeTimes->{{3.759043748193735*^9, 3.759043748494891*^9}},
 CellLabel->"In[38]:=",ExpressionUUID->"71ccc1a5-effe-4bf0-8479-98e13ac214d9"],

Cell[BoxData["\<\"fromKetBra[\\!\\(\\*FormBox[StyleBox[\\\"expr\\\", Italic, \
Rule[StripOnInput, False]], TraditionalForm]\\)_, \
\\!\\(\\*FormBox[StyleBox[\\\"outbasis\\\", Italic, Rule[StripOnInput, \
False]], TraditionalForm]\\)_, \\!\\(\\*FormBox[StyleBox[\\\"inbasis\\\", \
Italic, Rule[StripOnInput, False]], TraditionalForm]\\)_]: From operator \
expressed as \\!\\(\\*FormBox[StyleBox[\\\"expr\\\", Italic, \
Rule[StripOnInput, False]], TraditionalForm]\\) in terms of ketbras returns \
its matrix representation. Only operators acting on unipartite systems are \
allowed. The second and third arguments specify output and input bases in \
which the operator is expressed. If the third argument is omitted, it is \
taken to be identical to the second argument. If both, second and third, \
arguments are omitted, the input and output bases are inferred from \
\\!\\(\\*FormBox[StyleBox[\\\"expr\\\", Italic, Rule[StripOnInput, False]], \
TraditionalForm]\\). In such a case the minimum necessary number of basis \
vectors is chosen leading to a rectangular matrix, in general.\"\>"], "Print",\
 "PrintUsage",
 CellChangeTimes->{3.759043748895052*^9},
 CellTags->
  "Info383759047348-6451956",ExpressionUUID->"48a4e35b-06d9-415f-9e65-\
aa5f184161b2"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"?", "unfactorKetsList"}]], "Input",
 CellChangeTimes->{{3.759043753980076*^9, 3.75904375842245*^9}},
 CellLabel->"In[39]:=",ExpressionUUID->"f86c22e8-85ee-4b16-be8b-06eaa97c221d"],

Cell[BoxData["\<\"unfactorKetsList[emph[expr]_:{{{__},__}..}]: Takes output \
of factorKetsList and reconstructs the original expression. Argument \
emph[expr] should be a list of doubles, where the first element of each \
douple is a list of integers representing the order of subspaces present in \
the second element and the second element is either a Ket (Ket**Bra) or a \
lin. comb. of Kets (Ket**Bras) corresponding to that subspace.\"\>"], "Print",\
 "PrintUsage",
 CellChangeTimes->{3.7590437589893417`*^9},
 CellTags->
  "Info393759047358-6451956",ExpressionUUID->"f5c11f5b-d8f2-4bad-bfc2-\
b1412e5f770a"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"toKetBra", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "2", ",", "3", ",", "8"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"4", ",", "5", ",", "6", ",", "7"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "2", ",", "3", ",", "8"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"4", ",", "5", ",", "6", ",", "7"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", "\"\<Integral\>\"", "}"}], ",", 
   RowBox[{"{", "\"\<nono\>\"", "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.757239231383898*^9, 3.7572393097183495`*^9}, {
  3.757239788803195*^9, 3.7572398042039967`*^9}, {3.757239885641019*^9, 
  3.757239886656337*^9}, {3.7572399599103727`*^9, 3.7572400179647417`*^9}, {
  3.7572404397267895`*^9, 3.757240440387545*^9}, {3.757240497211933*^9, 
  3.757240577957648*^9}, {3.7572439280992436`*^9, 3.7572439309368815`*^9}, {
  3.757243995100747*^9, 3.757244015856355*^9}, {3.757244615249402*^9, 
  3.7572446224154563`*^9}, {3.7572446557156925`*^9, 3.757244656560855*^9}},
 CellLabel->"In[31]:=",ExpressionUUID->"d2a8b549-5664-4aab-a0fc-63f0445cd06f"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   TemplateBox[{"1"},
    "Ket"], "**", 
   TemplateBox[{"\"no1\""},
    "Bra"]}], "+", 
  RowBox[{"2", " ", 
   RowBox[{
    TemplateBox[{"1"},
     "Ket"], "**", 
    TemplateBox[{"\"no2\""},
     "Bra"]}]}], "+", 
  RowBox[{"3", " ", 
   RowBox[{
    TemplateBox[{"1"},
     "Ket"], "**", 
    TemplateBox[{"\"no3\""},
     "Bra"]}]}], "+", 
  RowBox[{"8", " ", 
   RowBox[{
    TemplateBox[{"1"},
     "Ket"], "**", 
    TemplateBox[{"\"no4\""},
     "Bra"]}]}], "+", 
  RowBox[{"4", " ", 
   RowBox[{
    TemplateBox[{"2"},
     "Ket"], "**", 
    TemplateBox[{"\"no1\""},
     "Bra"]}]}], "+", 
  RowBox[{"5", " ", 
   RowBox[{
    TemplateBox[{"2"},
     "Ket"], "**", 
    TemplateBox[{"\"no2\""},
     "Bra"]}]}], "+", 
  RowBox[{"6", " ", 
   RowBox[{
    TemplateBox[{"2"},
     "Ket"], "**", 
    TemplateBox[{"\"no3\""},
     "Bra"]}]}], "+", 
  RowBox[{"7", " ", 
   RowBox[{
    TemplateBox[{"2"},
     "Ket"], "**", 
    TemplateBox[{"\"no4\""},
     "Bra"]}]}], "+", 
  RowBox[{
   TemplateBox[{"3"},
    "Ket"], "**", 
   TemplateBox[{"\"no1\""},
    "Bra"]}], "+", 
  RowBox[{"2", " ", 
   RowBox[{
    TemplateBox[{"3"},
     "Ket"], "**", 
    TemplateBox[{"\"no2\""},
     "Bra"]}]}], "+", 
  RowBox[{"3", " ", 
   RowBox[{
    TemplateBox[{"3"},
     "Ket"], "**", 
    TemplateBox[{"\"no3\""},
     "Bra"]}]}], "+", 
  RowBox[{"8", " ", 
   RowBox[{
    TemplateBox[{"3"},
     "Ket"], "**", 
    TemplateBox[{"\"no4\""},
     "Bra"]}]}], "+", 
  RowBox[{"4", " ", 
   RowBox[{
    TemplateBox[{"4"},
     "Ket"], "**", 
    TemplateBox[{"\"no1\""},
     "Bra"]}]}], "+", 
  RowBox[{"5", " ", 
   RowBox[{
    TemplateBox[{"4"},
     "Ket"], "**", 
    TemplateBox[{"\"no2\""},
     "Bra"]}]}], "+", 
  RowBox[{"6", " ", 
   RowBox[{
    TemplateBox[{"4"},
     "Ket"], "**", 
    TemplateBox[{"\"no3\""},
     "Bra"]}]}], "+", 
  RowBox[{"7", " ", 
   RowBox[{
    TemplateBox[{"4"},
     "Ket"], "**", 
    TemplateBox[{"\"no4\""},
     "Bra"]}]}]}]], "Output",
 CellChangeTimes->{3.757244016415821*^9, 3.7572445047443485`*^9, 
  3.757244623150505*^9, 3.7572446572734723`*^9},
 CellLabel->"Out[31]=",ExpressionUUID->"b019f7ba-0923-472e-96e7-b1f564ed1438"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"MatchQ", "[", 
  RowBox[{
   RowBox[{"f", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"1", ",", "2", ",", "3"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"4", ",", "5", ",", "6"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"\"\<comp\>\"", ",", "\"\<nono\>\"", ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Ket", "[", "\"\<a\>\"", "]"}], ",", 
         RowBox[{"Ket", "[", "\"\<b\>\"", "]"}]}], "}"}]}], "}"}]}], "]"}], 
   ",", 
   RowBox[{"f", "[", 
    RowBox[{"mat_", ",", 
     RowBox[{"inbases", ":", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"(", ")"}], ".."}], "}"}]}]}], "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.757239517897462*^9, 
  3.757239596051071*^9}},ExpressionUUID->"e906b869-a184-486c-b86a-\
5df62e5b9496"],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{{3.7572395336663637`*^9, 3.75723955837029*^9}, 
   3.7572395895664177`*^9},
 CellLabel->"Out[18]=",ExpressionUUID->"2f4a416c-37a5-4f33-8b56-487d260efa99"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"MatchQ", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"\"\<a\>\"", ",", "\"\<b\>\"", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Ket", "@", "3"}], ",", 
       RowBox[{"Ket", "@", "4"}]}], "}"}], ",", "\"\<c\>\""}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"_String", "|", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Ket", "[", "_", "]"}], ".."}], "}"}]}], ")"}], ".."}], 
    "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.7572396066537447`*^9, 3.7572396869855614`*^9}},
 CellLabel->"In[30]:=",ExpressionUUID->"a5a7e5a8-16e9-4a6b-932b-5552eb001a44"],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{{3.757239630664706*^9, 3.757239687413456*^9}},
 CellLabel->"Out[30]=",ExpressionUUID->"728f7014-19c4-416e-82c7-27f4adb61c85"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"inbases", ":", 
  RowBox[{"{", 
   RowBox[{"(", 
    RowBox[{"_String", "|", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Ket", "[", "_", "]"}], ".."}], "}"}], ".."}]}], ")"}], 
   "}"}]}]], "Input",ExpressionUUID->"f5a8f286-b118-48c9-a2fc-674512878344"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"toKet", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"1", ",", "2", ",", "4", ",", "5"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"\"\<comp\>\"", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Ket", "[", "2", "]"}], ",", 
       RowBox[{"Ket", "[", "5", "]"}]}], "}"}]}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.7571536916170354`*^9, 3.7571537108486147`*^9}, {
  3.7571563156758995`*^9, 3.7571564046761045`*^9}, {3.757160961697935*^9, 
  3.7571609996594877`*^9}, {3.7571610677020893`*^9, 3.757161088644637*^9}},
 CellLabel->"In[16]:=",ExpressionUUID->"03141970-fd2f-4694-88d2-d86d9250d2b2"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     TemplateBox[{"\"H\""},
      "Ket"], ",", 
     TemplateBox[{"\"V\""},
      "Ket"]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     TemplateBox[{"2"},
      "Ket"], ",", 
     TemplateBox[{"5"},
      "Ket"]}], "}"}]}], "}"}]], "Echo",
 CellChangeTimes->{
  3.757239181529258*^9},ExpressionUUID->"e6d9a0aa-9405-4092-ab1c-\
6d8d5caa1ae5"],

Cell[BoxData[
 RowBox[{
  TemplateBox[{
    RowBox[{"\"H\"", ",", "2"}]},
   "Ket"], "+", 
  RowBox[{"2", " ", 
   TemplateBox[{
     RowBox[{"\"H\"", ",", "5"}]},
    "Ket"]}], "+", 
  RowBox[{"4", " ", 
   TemplateBox[{
     RowBox[{"\"V\"", ",", "2"}]},
    "Ket"]}], "+", 
  RowBox[{"5", " ", 
   TemplateBox[{
     RowBox[{"\"V\"", ",", "5"}]},
    "Ket"]}]}]], "Output",
 CellChangeTimes->{{3.75716106947604*^9, 3.757161089582668*^9}, 
   3.757161852624959*^9, 3.7571619198682556`*^9, 3.7571627467056866`*^9, 
   3.757162917353862*^9, 3.757163138816353*^9, 3.7572252282858973`*^9, 
   3.757238212061056*^9, 3.7572390180916505`*^9, {3.7572391587910833`*^9, 
   3.7572391815741353`*^9}},
 CellLabel->"Out[16]=",ExpressionUUID->"aa26a1af-21cd-4aa5-a76c-a842187078b7"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"toKet", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
    "1", ",", "2", ",", "4", ",", "5", ",", "6", ",", "8", ",", "9", ",", 
     "3"}], "}"}], ",", "\"\<nono\>\"", ",", "3"}], "]"}]], "Input",
 CellChangeTimes->{{3.7571536916170354`*^9, 3.7571537108486147`*^9}, {
  3.7571563156758995`*^9, 3.7571564046761045`*^9}, {3.757160961697935*^9, 
  3.7571609996594877`*^9}, {3.7571610677020893`*^9, 3.757161250236911*^9}, {
  3.7571615167767277`*^9, 3.7571615394296303`*^9}, {3.757162317086811*^9, 
  3.75716231892169*^9}},
 CellLabel->"In[17]:=",ExpressionUUID->"0a5f1952-19de-4c8a-b8cf-1d9ecb2273d9"],

Cell[BoxData[
 RowBox[{
  TemplateBox[{
    RowBox[{"\"no1\"", ",", "\"no1\"", ",", "\"no1\""}]},
   "Ket"], "+", 
  RowBox[{"2", " ", 
   TemplateBox[{
     RowBox[{"\"no1\"", ",", "\"no1\"", ",", "\"no2\""}]},
    "Ket"]}], "+", 
  RowBox[{"4", " ", 
   TemplateBox[{
     RowBox[{"\"no1\"", ",", "\"no2\"", ",", "\"no1\""}]},
    "Ket"]}], "+", 
  RowBox[{"5", " ", 
   TemplateBox[{
     RowBox[{"\"no1\"", ",", "\"no2\"", ",", "\"no2\""}]},
    "Ket"]}], "+", 
  RowBox[{"6", " ", 
   TemplateBox[{
     RowBox[{"\"no2\"", ",", "\"no1\"", ",", "\"no1\""}]},
    "Ket"]}], "+", 
  RowBox[{"8", " ", 
   TemplateBox[{
     RowBox[{"\"no2\"", ",", "\"no1\"", ",", "\"no2\""}]},
    "Ket"]}], "+", 
  RowBox[{"9", " ", 
   TemplateBox[{
     RowBox[{"\"no2\"", ",", "\"no2\"", ",", "\"no1\""}]},
    "Ket"]}], "+", 
  RowBox[{"3", " ", 
   TemplateBox[{
     RowBox[{"\"no2\"", ",", "\"no2\"", ",", "\"no2\""}]},
    "Ket"]}]}]], "Output",
 CellChangeTimes->{{3.757161529605567*^9, 3.7571615405014544`*^9}, 
   3.7571618570531197`*^9, 3.7571619235265684`*^9, 3.757162320323327*^9, 
   3.7571627509567633`*^9, 3.7571629199008694`*^9, 3.7571631432617483`*^9, 
   3.7572382121568007`*^9},
 CellLabel->"Out[17]=",ExpressionUUID->"e91f50be-0e56-4785-80f0-1e3a7125b1d5"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"toKet", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"1", ",", "2", ",", "4", ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"\"\<Integral\>\"", ",", "\"\<IdentityKet\>\""}], "}"}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.7571536916170354`*^9, 3.7571537108486147`*^9}, {
  3.7571563156758995`*^9, 3.7571564046761045`*^9}, {3.757160961697935*^9, 
  3.7571609996594877`*^9}, {3.7571610677020893`*^9, 3.757161250236911*^9}, {
  3.7571615167767277`*^9, 3.7571615394296303`*^9}, {3.757162317086811*^9, 
  3.75716231892169*^9}, {3.7572252409141984`*^9, 3.7572252700072193`*^9}, {
  3.7572254359441476`*^9, 3.757225458876649*^9}},
 CellLabel->"In[18]:=",ExpressionUUID->"1ce2a835-7576-4e19-8db2-eaced6055100"],

Cell[BoxData[
 RowBox[{
  TemplateBox[{
    RowBox[{"1", ",", "idket"}]},
   "Ket"], "+", 
  RowBox[{"2", " ", 
   TemplateBox[{
     RowBox[{"2", ",", "idket"}]},
    "Ket"]}], "+", 
  RowBox[{"4", " ", 
   TemplateBox[{
     RowBox[{"3", ",", "idket"}]},
    "Ket"]}], "+", 
  RowBox[{"3", " ", 
   TemplateBox[{
     RowBox[{"4", ",", "idket"}]},
    "Ket"]}]}]], "Output",
 CellChangeTimes->{3.757225459580579*^9, 3.757238215129847*^9},
 CellLabel->"Out[18]=",ExpressionUUID->"1dc4d3a1-53c2-4f54-9b3b-5886639aedc2"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   InterpretationBox[
    RowBox[{
     TagBox["SparseArray",
      "SummaryHead"], "[", 
     DynamicModuleBox[{Typeset`open$$ = False, Typeset`embedState$$ = 
      "Ready"}, 
      TemplateBox[{
        PaneSelectorBox[{False -> GridBox[{{
              PaneBox[
               ButtonBox[
                DynamicBox[
                 FEPrivate`FrontEndResource[
                 "FEBitmaps", "SquarePlusIconMedium"]], 
                ButtonFunction :> (Typeset`open$$ = True), Appearance -> None,
                 Evaluator -> Automatic, Method -> "Preemptive"], 
               Alignment -> {Center, Center}, ImageSize -> 
               Dynamic[{
                 Automatic, 
                  3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                   Magnification])}]], 
              GraphicsBox[
               
               RasterBox[{{{0.772061, 0.92462, 0.998703}, {0.5, 0., 0.}}, {{
                0.235431, 0.32765, 0.833291}, {0.235431, 0.32765, 
                0.833291}}}, {{0, 0}, {2, 2}}, {0, 1}], AspectRatio -> 1, 
               Axes -> False, Frame -> False, FrameLabel -> {None, None}, 
               FrameStyle -> Directive[
                 Opacity[0.5], 
                 Thickness[Tiny], 
                 RGBColor[0.368417, 0.506779, 0.709798]], 
               FrameTicks -> {{None, None}, {None, None}}, GridLinesStyle -> 
               Directive[
                 GrayLevel[0.5, 0.4]], ImageSize -> 
               Dynamic[{
                 Automatic, 
                  3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                   Magnification])}], 
               Method -> {
                "AxisPadding" -> Scaled[0.02], "DefaultBoundaryStyle" -> 
                 Automatic, "DefaultPlotStyle" -> Automatic, "DomainPadding" -> 
                 Scaled[0.02], "RangePadding" -> Scaled[0.05]}], 
              GridBox[{{
                 RowBox[{
                   TagBox[
                   "\"Specified elements: \"", "SummaryItemAnnotation"], 
                   "\[InvisibleSpace]", 
                   TagBox["2", "SummaryItem"]}]}, {
                 RowBox[{
                   TagBox["\"Dimensions: \"", "SummaryItemAnnotation"], 
                   "\[InvisibleSpace]", 
                   TagBox[
                    RowBox[{"{", 
                    RowBox[{"2", ",", "2"}], "}"}], "SummaryItem"]}]}}, 
               GridBoxAlignment -> {
                "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
               False, GridBoxItemSize -> {
                "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
               GridBoxSpacings -> {
                "Columns" -> {{2}}, "Rows" -> {{Automatic}}}, 
               BaseStyle -> {
                ShowStringCharacters -> False, NumberMarks -> False, 
                 PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
            GridBoxAlignment -> {"Rows" -> {{Top}}}, AutoDelete -> False, 
            GridBoxItemSize -> {
             "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
            BaselinePosition -> {1, 1}], True -> GridBox[{{
              PaneBox[
               ButtonBox[
                DynamicBox[
                 FEPrivate`FrontEndResource[
                 "FEBitmaps", "SquareMinusIconMedium"]], 
                ButtonFunction :> (Typeset`open$$ = False), Appearance -> 
                None, Evaluator -> Automatic, Method -> "Preemptive"], 
               Alignment -> {Center, Center}, ImageSize -> 
               Dynamic[{
                 Automatic, 
                  3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                   Magnification])}]], 
              GraphicsBox[
               
               RasterBox[{{{0.772061, 0.92462, 0.998703}, {0.5, 0., 0.}}, {{
                0.235431, 0.32765, 0.833291}, {0.235431, 0.32765, 
                0.833291}}}, {{0, 0}, {2, 2}}, {0, 1}], AspectRatio -> 1, 
               Axes -> False, Frame -> False, FrameLabel -> {None, None}, 
               FrameStyle -> Directive[
                 Opacity[0.5], 
                 Thickness[Tiny], 
                 RGBColor[0.368417, 0.506779, 0.709798]], 
               FrameTicks -> {{None, None}, {None, None}}, GridLinesStyle -> 
               Directive[
                 GrayLevel[0.5, 0.4]], ImageSize -> 
               Dynamic[{
                 Automatic, 
                  3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                   Magnification])}], 
               Method -> {
                "AxisPadding" -> Scaled[0.02], "DefaultBoundaryStyle" -> 
                 Automatic, "DefaultPlotStyle" -> Automatic, "DomainPadding" -> 
                 Scaled[0.02], "RangePadding" -> Scaled[0.05]}], 
              GridBox[{{
                 RowBox[{
                   TagBox[
                   "\"Specified elements: \"", "SummaryItemAnnotation"], 
                   "\[InvisibleSpace]", 
                   TagBox["2", "SummaryItem"]}]}, {
                 RowBox[{
                   TagBox["\"Dimensions: \"", "SummaryItemAnnotation"], 
                   "\[InvisibleSpace]", 
                   TagBox[
                    RowBox[{"{", 
                    RowBox[{"2", ",", "2"}], "}"}], "SummaryItem"]}]}, {
                 RowBox[{
                   TagBox["\"Default: \"", "SummaryItemAnnotation"], 
                   "\[InvisibleSpace]", 
                   TagBox["0", "SummaryItem"]}]}, {
                 RowBox[{
                   TagBox["\"Density: \"", "SummaryItemAnnotation"], 
                   "\[InvisibleSpace]", 
                   TagBox["0.5`", "SummaryItem"]}]}, {
                 RowBox[{
                   TagBox["\"Elements:\"", "SummaryItemAnnotation"], 
                   "\[InvisibleSpace]", 
                   TagBox["\"\"", "SummaryItem"]}]}, {
                 TagBox[
                  TagBox[
                   GridBox[{{
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"2", ",", "1"}], "}"}], "\[Rule]", 
                    StyleBox[
                    PaneBox[
                    "3", ContentPadding -> False, FrameMargins -> 0, 
                    StripOnInput -> True, BaselinePosition -> Baseline, 
                    ImageSize -> {{1, 300}, Automatic}], LineBreakWithin -> 
                    False]}]}, {
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"2", ",", "2"}], "}"}], "\[Rule]", 
                    StyleBox[
                    PaneBox[
                    RowBox[{"2", "+", "\[Alpha]", "+", 
                    RowBox[{"4", " ", "\[Beta]"}]}], ContentPadding -> False, 
                    FrameMargins -> 0, StripOnInput -> True, BaselinePosition -> 
                    Baseline, ImageSize -> {{1, 300}, Automatic}], 
                    LineBreakWithin -> False]}]}}, 
                    GridBoxAlignment -> {"Columns" -> {{Left}}}, 
                    DefaultBaseStyle -> "Column", 
                    GridBoxItemSize -> {
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}], 
                   "Column"], "SummaryItem"]}}, 
               GridBoxAlignment -> {
                "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
               False, GridBoxItemSize -> {
                "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
               GridBoxSpacings -> {
                "Columns" -> {{2}}, "Rows" -> {{Automatic}}}, 
               BaseStyle -> {
                ShowStringCharacters -> False, NumberMarks -> False, 
                 PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
            GridBoxAlignment -> {"Rows" -> {{Top}}}, AutoDelete -> False, 
            GridBoxItemSize -> {
             "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
            BaselinePosition -> {1, 1}]}, 
         Dynamic[Typeset`open$$], ImageSize -> Automatic]},
       "SummaryPanel"],
      DynamicModuleValues:>{}], "]"}],
    SparseArray[
    Automatic, {2, 2}, 0, {
     1, {{0, 0, 2}, {{1}, {2}}}, {
      3, 2 + $CellContext`\[Alpha] + 4 $CellContext`\[Beta]}}],
    Editable->False,
    SelectWithContents->True,
    Selectable->False], ",", 
   RowBox[{"{", 
    RowBox[{
     TemplateBox[{"\"H\""},
      "Ket"], ",", 
     TemplateBox[{"\"V\""},
      "Ket"]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     TemplateBox[{"\"H\""},
      "Ket"], ",", 
     TemplateBox[{"\"V\""},
      "Ket"]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.7572302067388515`*^9, 3.757230259673512*^9}, 
   3.7572304431503677`*^9, 3.757230509036853*^9, {3.757230564600211*^9, 
   3.7572305702064295`*^9}, 3.7572306470363765`*^9, 3.757231092072693*^9, {
   3.7572311652257924`*^9, 3.7572311732415404`*^9}, 3.757231210631818*^9, 
   3.7572382118147144`*^9},
 CellLabel->"Out[14]=",ExpressionUUID->"fc376c7e-7052-4720-b003-ed11d6357a6f"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "0"},
     {"3", 
      RowBox[{"2", "+", "\[Alpha]", "+", 
       RowBox[{"4", " ", "\[Beta]"}]}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.7572302067388515`*^9, 3.757230259673512*^9}, 
   3.7572304431503677`*^9, 3.757230509036853*^9, {3.757230564600211*^9, 
   3.7572305702064295`*^9}, 3.7572306470363765`*^9, 3.757231092072693*^9, {
   3.7572311652257924`*^9, 3.7572311732415404`*^9}, 3.757231210631818*^9, 
   3.7572382118406487`*^9},
 CellLabel->
  "Out[15]//MatrixForm=",ExpressionUUID->"8035d1f9-9381-41cc-9de9-\
6f333352f5b0"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"{", 
   RowBox[{"mat", ",", "bas1", ",", "bas2"}], "}"}], "=", 
  RowBox[{"fromKetBra", "[", 
   RowBox[{
    RowBox[{"\[Alpha]", 
     RowBox[{
      TemplateBox[{
        RowBox[{"\"V\"", ",", "\"J\""}]},
       "Ket"], "**", 
      TemplateBox[{
        RowBox[{"\"V\"", ",", "\"V\""}]},
       "Bra"]}]}], "+", 
    RowBox[{"2", " ", 
     RowBox[{
      TemplateBox[{
        RowBox[{"\"V\"", ",", "\"H\""}]},
       "Ket"], "**", 
      TemplateBox[{
        RowBox[{"\"V\"", ",", "\"H\""}]},
       "Bra"]}]}]}], 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      RowBox[{"+", "3"}], " ", 
      RowBox[{
       TemplateBox[{"\"V\""},
        "Ket"], "**", 
       TemplateBox[{"\"H\""},
        "Bra"]}]}], "+", 
     RowBox[{"4", " ", "\[Beta]", " ", 
      RowBox[{
       TemplateBox[{"\"V\""},
        "Ket"], "**", 
       TemplateBox[{"\"V\""},
        "Bra"]}]}]}], "*)"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Normal", "[", "mat", "]"}], "//", "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.7572301773029313`*^9, 3.7572302590421467`*^9}, 
   3.757230442685651*^9, {3.7572305638457212`*^9, 3.7572305697277513`*^9}, {
   3.7572306441795588`*^9, 3.757230645965394*^9}, {3.757231171329432*^9, 
   3.7572311728198366`*^9}, {3.7572312100254*^9, 3.757231237699825*^9}, 
   3.7572313087502985`*^9},
 CellLabel->"In[28]:=",ExpressionUUID->"bcbf18bb-60f7-445c-b316-ef4184ecd7b0"],

Cell[BoxData[
 TemplateBox[{
  "fromKetBra", "morebas", 
   "\"More bases found in the input expression for given subspace(s).\"", 2, 
   28, 6, 26179618311211884463, "Local", "KetsBras`fromKetBra"},
  "MessageTemplate2"]], "Message", "MSG",
 CellChangeTimes->{3.7572313095107007`*^9},
 CellLabel->
  "During evaluation of \
In[28]:=",ExpressionUUID->"478d16d5-b65f-4279-8327-eea7ee590e0e"],

Cell[BoxData[
 TemplateBox[{
  "Set", "shape", 
   "\"Lists \\!\\(\\*RowBox[{\\\"{\\\", RowBox[{\\\"mat\\\", \\\",\\\", \
\\\"bas1\\\", \\\",\\\", \\\"bas2\\\"}], \\\"}\\\"}]\\) and \\!\\(\\*RowBox[{\
\\\"Null\\\"}]\\) are not the same shape.\"", 2, 28, 7, 26179618311211884463, 
   "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.7572313095795155`*^9},
 CellLabel->
  "During evaluation of \
In[28]:=",ExpressionUUID->"efdf3c0d-4249-48a9-88b8-870668d84ab4"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "0", "0", "0"},
     {"0", "0", "0", "0"},
     {"0", "0", "2", "\[Alpha]"},
     {"0", "0", "0", "0"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.7572312280770216`*^9, 3.757231238323945*^9}, 
   3.7572313095845013`*^9},
 CellLabel->
  "Out[29]//MatrixForm=",ExpressionUUID->"70007a01-69af-4a93-be4c-\
0331b46e3942"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"{", 
   RowBox[{"mat", ",", "bas1", ",", "bas2"}], "}"}], "=", 
  RowBox[{"fromKetBra", "[", 
   RowBox[{
    RowBox[{"\[Alpha]", 
     RowBox[{
      TemplateBox[{
        RowBox[{"\"V\"", ",", "1"}]},
       "Ket"], "**", 
      TemplateBox[{
        RowBox[{"\"H\"", ",", "1"}]},
       "Bra"]}]}], "+", 
    RowBox[{"2", " ", 
     RowBox[{
      TemplateBox[{
        RowBox[{"\"V\"", ",", "3"}]},
       "Ket"], "**", 
      TemplateBox[{
        RowBox[{"\"V\"", ",", "1"}]},
       "Bra"]}]}]}], 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      RowBox[{"+", "3"}], " ", 
      RowBox[{
       TemplateBox[{"\"V\""},
        "Ket"], "**", 
       TemplateBox[{"\"H\""},
        "Bra"]}]}], "+", 
     RowBox[{"4", " ", "\[Beta]", " ", 
      RowBox[{
       TemplateBox[{"\"V\""},
        "Ket"], "**", 
       TemplateBox[{"\"V\""},
        "Bra"]}]}]}], "*)"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Normal", "[", "mat", "]"}], "//", "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.7572301773029313`*^9, 3.7572302590421467`*^9}, 
   3.757230442685651*^9, {3.7572305638457212`*^9, 3.7572305697277513`*^9}, {
   3.7572306441795588`*^9, 3.757230645965394*^9}, {3.757231171329432*^9, 
   3.7572311728198366`*^9}, {3.7572312100254*^9, 3.757231237699825*^9}, 
   3.7572313087502985`*^9, {3.7572317274563494`*^9, 3.7572317674712715`*^9}, 
   3.75723181275238*^9},
 CellLabel->"In[42]:=",ExpressionUUID->"b9401360-23a3-489a-b3e2-d7885e7f147c"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"fromKet", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"\[Alpha]", " ", 
      RowBox[{"Ket", "[", 
       RowBox[{"\"\<H\>\"", ",", "2"}], "]"}]}], "+", 
     RowBox[{"\[Beta]", " ", 
      RowBox[{"Ket", "[", 
       RowBox[{"\"\<H\>\"", ",", "5", ",", "6"}], "]"}]}]}], ",", 
    "\"\<Identify\>\"", ",", "True"}], 
   RowBox[{"(*", 
    RowBox[{",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Ket", "[", "\"\<H\>\"", "]"}], ",", 
       RowBox[{"Ket", "[", "\"\<V\>\"", "]"}], ",", 
       RowBox[{"Ket", "[", "\"\<S\>\"", "]"}]}], "}"}]}], "*)"}], "]"}], "//",
   "InputForm"}]], "Input",
 CellChangeTimes->{{3.757088650140026*^9, 3.757088705107627*^9}, {
   3.7570896672484856`*^9, 3.757089667676309*^9}, {3.757089727201725*^9, 
   3.757089767559185*^9}, {3.7570898067679043`*^9, 3.7570898774737763`*^9}, 
   3.7570901650129476`*^9, {3.757090950340893*^9, 3.757090955154542*^9}, {
   3.7570910075595083`*^9, 3.7570910108704767`*^9}, {3.757091125022831*^9, 
   3.7570911359718623`*^9}, {3.7570916334369683`*^9, 
   3.7570916377087765`*^9}, {3.757093986352166*^9, 3.7570939879784174`*^9}, {
   3.757231103469717*^9, 3.7572311040841103`*^9}},
 CellLabel->"In[17]:=",ExpressionUUID->"17fded39-4ce2-46c2-a661-168d6103a41a"],

Cell[BoxData[
 TemplateBox[{
  "fromKet", "diffsub", 
   "\"Specifications do not correspond to the same number of subspaces.\"", 2,
    17, 1, 26179618311211884463, "Local", "KetsBras`fromKet"},
  "MessageTemplate2"]], "Message", "MSG",
 CellChangeTimes->{3.7572311046266203`*^9},
 CellLabel->
  "During evaluation of \
In[17]:=",ExpressionUUID->"e4adc815-ccbd-436b-9a73-5e4442e8bace"],

Cell["Null", "Output",
 CellChangeTimes->{
  3.7570939892600775`*^9, 3.7571526060786896`*^9, 3.757153005317063*^9, 
   3.7572281192077007`*^9, 3.7572281707718315`*^9, 3.7572294951677923`*^9, {
   3.7572311004640694`*^9, 3.7572311046336036`*^9}},
 CellLabel->
  "Out[17]//InputForm=",ExpressionUUID->"503ffb36-b7f6-4d11-8548-\
9b58c470eb82"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"fromKet", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"\[Alpha]", " ", 
      RowBox[{"Ket", "[", 
       RowBox[{"\"\<H\>\"", ",", "\"\<no2\>\""}], "]"}]}], "+", 
     RowBox[{"\[Beta]", " ", 
      RowBox[{"Ket", "[", 
       RowBox[{"\"\<H\>\"", ",", "\"\<no5\>\""}], "]"}]}]}], ",", 
    "\"\<Identify\>\"", ",", "True"}], 
   RowBox[{"(*", 
    RowBox[{",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Ket", "[", "\"\<H\>\"", "]"}], ",", 
       RowBox[{"Ket", "[", "\"\<V\>\"", "]"}], ",", 
       RowBox[{"Ket", "[", "\"\<S\>\"", "]"}]}], "}"}]}], "*)"}], "]"}], "//",
   "InputForm"}]], "Input",
 CellChangeTimes->{{3.757088650140026*^9, 3.757088705107627*^9}, {
   3.7570896672484856`*^9, 3.757089667676309*^9}, {3.757089727201725*^9, 
   3.757089767559185*^9}, {3.7570898067679043`*^9, 3.7570898774737763`*^9}, 
   3.7570901650129476`*^9, {3.757090950340893*^9, 3.757090955154542*^9}, {
   3.7570910075595083`*^9, 3.7570910108704767`*^9}, {3.757091125022831*^9, 
   3.7570911359718623`*^9}, {3.7570916334369683`*^9, 
   3.7570916377087765`*^9}, {3.7570938534679494`*^9, 3.757093868445063*^9}, {
   3.757093997711714*^9, 3.7570940085200405`*^9}},
 CellLabel->"In[15]:=",ExpressionUUID->"74549ebc-6cfb-42f6-be28-6d92db384fd5"],

Cell["\<\
{{\[Alpha], 0, 0, \[Beta], 0, 0, 0, 0}, {Ket[\"H\", \"no2\"], Ket[\"H\", \
\"no3\"], Ket[\"H\", \"no4\"], Ket[\"H\", \"no5\"], 
  Ket[\"V\", \"no2\"], Ket[\"V\", \"no3\"], Ket[\"V\", \"no4\"], Ket[\"V\", \
\"no5\"]}}\
\>", "Output",
 CellChangeTimes->{{3.757094004890046*^9, 3.7570940098101397`*^9}, 
   3.7571521220813365`*^9, {3.757152589295565*^9, 3.757152593606041*^9}, 
   3.7571526318712125`*^9, 3.757153007816379*^9, 3.7571631575456023`*^9, 
   3.7572267078455496`*^9, 3.757228116144085*^9, 3.7572281708511324`*^9, 
   3.7572294963520164`*^9},
 CellLabel->
  "Out[15]//InputForm=",ExpressionUUID->"9f4bc4bd-289f-48b2-8f59-\
91b4c4f53426"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"fromKet", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"\[Alpha]", " ", 
      RowBox[{"Ket", "[", 
       RowBox[{"\"\<H\>\"", ",", "\"\<no2\>\""}], "]"}]}], "+", 
     RowBox[{"\[Beta]", " ", 
      RowBox[{"Ket", "[", 
       RowBox[{"\"\<H\>\"", ",", "\"\<no5\>\""}], "]"}]}]}], ",", 
    "\"\<Identify\>\"", ",", "False"}], 
   RowBox[{"(*", 
    RowBox[{",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Ket", "[", "\"\<H\>\"", "]"}], ",", 
       RowBox[{"Ket", "[", "\"\<V\>\"", "]"}], ",", 
       RowBox[{"Ket", "[", "\"\<S\>\"", "]"}]}], "}"}]}], "*)"}], "]"}], "//",
   "InputForm"}]], "Input",
 CellChangeTimes->{{3.757088650140026*^9, 3.757088705107627*^9}, {
   3.7570896672484856`*^9, 3.757089667676309*^9}, {3.757089727201725*^9, 
   3.757089767559185*^9}, {3.7570898067679043`*^9, 3.7570898774737763`*^9}, 
   3.7570901650129476`*^9, {3.757090950340893*^9, 3.757090955154542*^9}, {
   3.7570910075595083`*^9, 3.7570910108704767`*^9}, {3.757091125022831*^9, 
   3.7570911359718623`*^9}, {3.7570916334369683`*^9, 
   3.7570916377087765`*^9}, {3.7570938534679494`*^9, 3.757093868445063*^9}, {
   3.757093997711714*^9, 3.7570940085200405`*^9}, {3.75715303095053*^9, 
   3.757153034775298*^9}},
 CellLabel->"In[16]:=",ExpressionUUID->"a010abd8-e0c5-4e2c-9a02-6fd7d58ad91d"],

Cell["\<\
{{\[Alpha], \[Beta], 0, 0}, {Ket[\"H\", \"no2\"], Ket[\"H\", \"no5\"], \
Ket[\"V\", \"no2\"], Ket[\"V\", \"no5\"]}}\
\>", "Output",
 CellChangeTimes->{3.757153035731738*^9, 3.7572280039708996`*^9, 
  3.757228077935111*^9, 3.7572281128824654`*^9, 3.757228170907982*^9, 
  3.757229497315343*^9},
 CellLabel->
  "Out[16]//InputForm=",ExpressionUUID->"eeb60c6f-929b-456b-af5e-\
4baf9fba6c03"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"fromKet", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"\[Alpha]", " ", 
      RowBox[{"Ket", "[", 
       RowBox[{"\"\<H\>\"", ",", "g1"}], "]"}]}], "+", 
     RowBox[{"\[Beta]", " ", 
      RowBox[{"Ket", "[", 
       RowBox[{"\"\<H\>\"", ",", "g4"}], "]"}]}]}], ",", "\"\<Identify\>\"", 
    ",", "True"}], 
   RowBox[{"(*", 
    RowBox[{",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Ket", "[", "\"\<H\>\"", "]"}], ",", 
       RowBox[{"Ket", "[", "\"\<V\>\"", "]"}], ",", 
       RowBox[{"Ket", "[", "\"\<S\>\"", "]"}]}], "}"}]}], "*)"}], "]"}], "//",
   "InputForm"}]], "Input",
 CellChangeTimes->{{3.757088650140026*^9, 3.757088705107627*^9}, {
   3.7570896672484856`*^9, 3.757089667676309*^9}, {3.757089727201725*^9, 
   3.757089767559185*^9}, {3.7570898067679043`*^9, 3.7570898774737763`*^9}, 
   3.7570901650129476`*^9, {3.757090950340893*^9, 3.757090955154542*^9}, {
   3.7570910075595083`*^9, 3.7570910108704767`*^9}, {3.757091125022831*^9, 
   3.7570911359718623`*^9}, {3.7570916334369683`*^9, 
   3.7570916377087765`*^9}, {3.7570938534679494`*^9, 3.757093892155034*^9}, {
   3.7570940163048663`*^9, 3.757094018002838*^9}},
 CellLabel->"In[17]:=",ExpressionUUID->"5d916a63-b3d6-45c0-9c25-cbeebd6f9541"],

Cell["\<\
{{\[Alpha], 0, 0, \[Beta], 0, 0, 0, 0}, {Ket[\"H\", g1], Ket[\"H\", g2], Ket[\
\"H\", g3], Ket[\"H\", g4], Ket[\"V\", g1], 
  Ket[\"V\", g2], Ket[\"V\", g3], Ket[\"V\", g4]}}\
\>", "Output",
 CellChangeTimes->{3.757094019395438*^9, 3.7571526487793713`*^9, 
  3.75715300993272*^9, 3.7572281234638977`*^9, 3.7572294988012657`*^9},
 CellLabel->
  "Out[17]//InputForm=",ExpressionUUID->"60f434ff-3c21-4f45-bda5-\
ea3a46dc4b94"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"fromKet", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"\[Alpha]", " ", 
      RowBox[{"Ket", "[", 
       RowBox[{"\"\<H\>\"", ",", "g1"}], "]"}]}], "+", 
     RowBox[{"\[Beta]", " ", 
      RowBox[{"Ket", "[", 
       RowBox[{"\"\<H\>\"", ",", "g4"}], "]"}]}]}], ",", "\"\<Identify\>\"", 
    ",", "False"}], 
   RowBox[{"(*", 
    RowBox[{",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Ket", "[", "\"\<H\>\"", "]"}], ",", 
       RowBox[{"Ket", "[", "\"\<V\>\"", "]"}], ",", 
       RowBox[{"Ket", "[", "\"\<S\>\"", "]"}]}], "}"}]}], "*)"}], "]"}], "//",
   "InputForm"}]], "Input",
 CellChangeTimes->{{3.757088650140026*^9, 3.757088705107627*^9}, {
   3.7570896672484856`*^9, 3.757089667676309*^9}, {3.757089727201725*^9, 
   3.757089767559185*^9}, {3.7570898067679043`*^9, 3.7570898774737763`*^9}, 
   3.7570901650129476`*^9, {3.757090950340893*^9, 3.757090955154542*^9}, {
   3.7570910075595083`*^9, 3.7570910108704767`*^9}, {3.757091125022831*^9, 
   3.7570911359718623`*^9}, {3.7570916334369683`*^9, 
   3.7570916377087765`*^9}, {3.7570938534679494`*^9, 3.757093892155034*^9}, {
   3.7570940163048663`*^9, 3.757094018002838*^9}, {3.757152897487376*^9, 
   3.7571529003078356`*^9}},
 CellLabel->"In[18]:=",ExpressionUUID->"3546ad54-3f06-4972-bcfd-7e232d7ad38f"],

Cell["\<\
{{\[Alpha], \[Beta], 0, 0}, {Ket[\"H\", g1], Ket[\"H\", g4], Ket[\"V\", g1], \
Ket[\"V\", g4]}}\
\>", "Output",
 CellChangeTimes->{3.7571529016861515`*^9, 3.757153012074992*^9, 
  3.7572295019178953`*^9},
 CellLabel->
  "Out[18]//InputForm=",ExpressionUUID->"491a64f9-0385-41a7-b615-\
27275cd0c3df"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"fromKet", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"\[Alpha]", " ", 
      RowBox[{"Ket", "[", 
       RowBox[{"\"\<H\>\"", ",", "\"\<\>\""}], "]"}]}], "+", 
     RowBox[{"\[Beta]", " ", 
      RowBox[{"Ket", "[", 
       RowBox[{"\"\<H\>\"", ",", "g4"}], "]"}]}]}], ",", "\"\<Identify\>\"", 
    ",", "False"}], 
   RowBox[{"(*", 
    RowBox[{",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Ket", "[", "\"\<H\>\"", "]"}], ",", 
       RowBox[{"Ket", "[", "\"\<V\>\"", "]"}], ",", 
       RowBox[{"Ket", "[", "\"\<S\>\"", "]"}]}], "}"}]}], "*)"}], "]"}], 
  RowBox[{"(*", 
   RowBox[{"//", "InputForm"}], "*)"}]}]], "Input",
 CellChangeTimes->{{3.757088650140026*^9, 3.757088705107627*^9}, {
   3.7570896672484856`*^9, 3.757089667676309*^9}, {3.757089727201725*^9, 
   3.757089767559185*^9}, {3.7570898067679043`*^9, 3.7570898774737763`*^9}, 
   3.7570901650129476`*^9, {3.757090950340893*^9, 3.757090955154542*^9}, {
   3.7570910075595083`*^9, 3.7570910108704767`*^9}, {3.757091125022831*^9, 
   3.7570911359718623`*^9}, {3.7570916334369683`*^9, 
   3.7570916377087765`*^9}, {3.7570938534679494`*^9, 3.757093892155034*^9}, {
   3.7570940163048663`*^9, 3.757094018002838*^9}, {3.757152897487376*^9, 
   3.7571529003078356`*^9}, {3.757153019674673*^9, 3.7571530258421803`*^9}, {
   3.757229691141472*^9, 3.757229693893225*^9}},
 CellLabel->"In[15]:=",ExpressionUUID->"20caee17-872c-4fa6-83a1-231fe8e8fd2f"],

Cell[BoxData[
 TemplateBox[{
  "fromKet", "morebas", 
   "\"More bases found in the input expression for given subspace(s).\"", 2, 
   15, 2, 26179609136581818503, "Local", "KetsBras`fromKet"},
  "MessageTemplate2"]], "Message", "MSG",
 CellChangeTimes->{
  3.757229502895278*^9, {3.7572296781805286`*^9, 3.7572296944373894`*^9}},
 CellLabel->
  "During evaluation of \
In[15]:=",ExpressionUUID->"30159ed6-3e26-4e75-acc5-98a3cfa77a73"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"fromKet", "[", 
  RowBox[{
   RowBox[{"\[Alpha]", " ", 
    RowBox[{"Ket", "[", "\"\<H\>\"", "]"}]}], "+", 
   RowBox[{"\[Beta]", " ", 
    RowBox[{"Ket", "[", "\"\<V\>\"", "]"}]}]}], 
  RowBox[{"(*", 
   RowBox[{",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Ket", "[", "\"\<H\>\"", "]"}], ",", 
      RowBox[{"Ket", "[", "\"\<V\>\"", "]"}], ",", 
      RowBox[{"Ket", "[", "\"\<S\>\"", "]"}]}], "}"}]}], "*)"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.757088650140026*^9, 3.757088705107627*^9}, {
   3.7570896672484856`*^9, 3.757089667676309*^9}, {3.757089727201725*^9, 
   3.757089767559185*^9}, {3.7570898067679043`*^9, 3.7570898774737763`*^9}, 
   3.7570901650129476`*^9, {3.757090282765998*^9, 3.7570902893569174`*^9}},
 CellLabel->"In[55]:=",ExpressionUUID->"32b9b413-8aa2-49ed-af5d-a44342c9dd41"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"\[Alpha]", ",", "\[Beta]"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     TemplateBox[{"\"H\""},
      "Ket"], ",", 
     TemplateBox[{"\"V\""},
      "Ket"]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.757090290683375*^9, 3.7570904755929804`*^9, 
  3.7570909337535267`*^9, 3.757152658903301*^9},
 CellLabel->"Out[55]=",ExpressionUUID->"66cf6fed-7b4d-4021-8900-74e427bf5e26"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"fromKet", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"\[Alpha]", " ", 
     RowBox[{"Ket", "[", 
      RowBox[{"0", ",", "2"}], "]"}]}], "+", 
    RowBox[{"\[Beta]", " ", 
     RowBox[{"Ket", "[", 
      RowBox[{"1", ",", "4"}], "]"}]}]}], ",", "\"\<Identify\>\"", ",", 
   "False"}], "]"}]], "Input",
 CellChangeTimes->{{3.757088650140026*^9, 3.757088672968972*^9}, {
  3.757152703607773*^9, 3.7571527251342144`*^9}},
 CellLabel->"In[71]:=",ExpressionUUID->"177d4685-f100-4b17-9aa1-8bb510713189"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"\[Alpha]", ",", "0", ",", "0", ",", "\[Beta]"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     TemplateBox[{
       RowBox[{"0", ",", "2"}]},
      "Ket"], ",", 
     TemplateBox[{
       RowBox[{"0", ",", "4"}]},
      "Ket"], ",", 
     TemplateBox[{
       RowBox[{"1", ",", "2"}]},
      "Ket"], ",", 
     TemplateBox[{
       RowBox[{"1", ",", "4"}]},
      "Ket"]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.7571528471539574`*^9},
 CellLabel->"Out[71]=",ExpressionUUID->"b3619135-bd3c-43ab-a0f2-8db5453402ce"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"spc", "=", 
   RowBox[{"{", 
    RowBox[{"\"\<nono\>\"", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Ket", "[", "2", "]"}], ",", 
       RowBox[{"Ket", "[", "3", "]"}]}], "}"}], ",", "adfa", ",", 
     "\"\<comp\>\"", ",", "\"\<coco\>\"", ",", 
     RowBox[{"{", 
      RowBox[{"4", ",", "45"}], "}"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"spc", "=", 
   RowBox[{"{", 
    RowBox[{"\"\<nono\>\"", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Ket", "[", "2", "]"}], ",", 
       RowBox[{"Ket", "[", "3", "]"}]}], "}"}], ",", "\"\<comp\>\"", ",", 
     "\"\<coco\>\""}], "}"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.7571563841544313`*^9, 3.757156392533595*^9}, {
  3.757156522835725*^9, 3.757156528867572*^9}},
 CellLabel->"In[14]:=",ExpressionUUID->"c693902c-8c2a-4e4b-966f-19d585a9a134"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"identifyBases", "[", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"Ket", "[", 
     RowBox[{"\"\<aH\>\"", ",", "\"\<H\>\""}], "]"}], ",", 
    RowBox[{"Ket", "[", 
     RowBox[{"\"\<Vg\>\"", ",", "\"\<H\>\""}], "]"}]}], "}"}], "]"}]], "Input",\

 CellChangeTimes->{{3.7570870685769367`*^9, 3.7570871661589656`*^9}},
 CellLabel->
  "In[156]:=",ExpressionUUID->"4012ccb8-409c-445b-a7ec-c06d4c43bdc3"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"None", ",", "\<\"comp\"\>"}], "}"}]], "Output",
 CellChangeTimes->{3.7570871669726696`*^9},
 CellLabel->
  "Out[156]=",ExpressionUUID->"2d2c76d7-ca66-4234-b246-4c4c93ddc2a8"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"replaceKet", "[", 
  RowBox[{
   RowBox[{"Ket", "[", 
    RowBox[{"\"\<H\>\"", ",", "\"\<H\>\""}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Ket", "[", "\"\<H\>\"", "]"}], "\[Rule]", 
     RowBox[{"Ket", "[", "\"\<A\>\"", "]"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "2"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.757070608917776*^9, 3.7570706528103776`*^9}, {
  3.7570716158753405`*^9, 3.7570716426567316`*^9}, {3.7570720857769165`*^9, 
  3.7570720891100044`*^9}},
 CellLabel->"In[67]:=",ExpressionUUID->"b517f842-2be7-4cad-a908-fb1351bc6db9"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"{", "1", "}"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", "1", "}"}], ",", 
     RowBox[{"{", "2", "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", "1", "}"}], ",", 
     RowBox[{"{", "2", "}"}]}], "}"}]}], "}"}]], "Echo",
 CellChangeTimes->{
  3.7570720899477663`*^9},ExpressionUUID->"ad13792a-4155-4949-a21b-\
e3390aa320ee"],

Cell[BoxData[
 TemplateBox[{
   RowBox[{"\"A\"", ",", "\"A\""}]},
  "Ket"]], "Output",
 CellChangeTimes->{
  3.7570706553854923`*^9, {3.757070866393301*^9, 3.7570708708414097`*^9}, {
   3.7570716104588223`*^9, 3.7570716432102523`*^9}, {3.7570720831659*^9, 
   3.757072089971702*^9}},
 CellLabel->"Out[67]=",ExpressionUUID->"1918f627-b70e-49a6-b30f-f885b562da2f"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"changeBasis", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"\[Alpha]", " ", 
      RowBox[{"Ket", "[", "\"\<H\>\"", "]"}]}], "+", 
     RowBox[{"\[Beta]", " ", 
      RowBox[{"Ket", "[", "\"\<V\>\"", "]"}]}]}], ",", "\"\<comp\>\"", ",", 
    "\"\<diag\>\""}], "]"}], "//", "Simplify"}]], "Input",
 CellChangeTimes->{{3.7570682630261774`*^9, 3.757068265201359*^9}, {
  3.7570693164864364`*^9, 3.7570693455896206`*^9}, {3.757072215564892*^9, 
  3.757072216468484*^9}},
 CellLabel->"In[69]:=",ExpressionUUID->"e0484c8b-c308-4e7a-b332-8b4215e95ff3"],

Cell[BoxData[
 FractionBox[
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{"\[Alpha]", "-", "\[Beta]"}], ")"}], " ", 
    TemplateBox[{"\"A\""},
     "Ket"]}], "+", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"\[Alpha]", "+", "\[Beta]"}], ")"}], " ", 
    TemplateBox[{"\"D\""},
     "Ket"]}]}], 
  SqrtBox["2"]]], "Output",
 CellChangeTimes->{
  3.7570682662176423`*^9, 3.7570693463944683`*^9, 3.7570694026729918`*^9, 
   3.757069448680975*^9, 3.75707088143209*^9, {3.757072212415312*^9, 
   3.757072217111754*^9}},
 CellLabel->"Out[69]=",ExpressionUUID->"3c7d66b7-2821-45fa-8c73-8e09c0e1e1a8"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Ket", "[", "\"\<0\>\"", "]"}], "=", 
  RowBox[{"Ket", "[", "5", "]"}]}]], "Input",
 CellChangeTimes->{{3.7351262694929523`*^9, 3.7351263049047956`*^9}},
 CellLabel->"In[73]:=",ExpressionUUID->"cb93139f-5f7a-483a-ae72-0958b01e2f72"],

Cell[BoxData[
 TemplateBox[{"5"},
  "Ket"]], "Output",
 CellChangeTimes->{3.7589618427162275`*^9},
 CellLabel->"Out[73]=",ExpressionUUID->"bcfd0b9e-26df-4fe2-a86a-bfe92efd40c4"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"basisVectorQ", "[", "\"\<Integral\>\"", "]"}], "@", 
  RowBox[{"Ket", "[", "0", "]"}]}]], "Input",
 CellChangeTimes->{{3.7589618504196224`*^9, 3.7589618894472575`*^9}},
 CellLabel->"In[78]:=",ExpressionUUID->"102a1f7a-029a-4439-b7d2-51cdd83d84aa"],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{{3.758961854002038*^9, 3.7589618900954866`*^9}},
 CellLabel->"Out[78]=",ExpressionUUID->"9d433d86-6b1a-434f-b9e8-4e9f90484d5c"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"basisVectorQ", "[", "\"\<Integral\>\"", "]"}], "@", 
  RowBox[{"Ket", "[", "\"\<0\>\"", "]"}]}]], "Input",
 CellChangeTimes->{{3.7589618504196224`*^9, 3.758961894609413*^9}},
 CellLabel->"In[79]:=",ExpressionUUID->"a0804f32-25a6-43ca-85e6-43260e2b0c75"],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{3.7589618950931177`*^9},
 CellLabel->"Out[79]=",ExpressionUUID->"ff3256b0-7e4a-4521-9c56-b16ddd53da60"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"basisVectorQ", "[", "\"\<Integral\>\"", "]"}], "@", 
  RowBox[{"Ket", "[", "\"\<1\>\"", "]"}]}]], "Input",
 CellChangeTimes->{{3.7589618504196224`*^9, 3.758961894609413*^9}, {
  3.7589619580975847`*^9, 3.7589619594529896`*^9}},
 CellLabel->"In[80]:=",ExpressionUUID->"6b2bac45-17bb-4a6e-89a3-39363c09d88e"],

Cell[BoxData["False"], "Output",
 CellChangeTimes->{3.7589619597501593`*^9},
 CellLabel->"Out[80]=",ExpressionUUID->"3e1873b0-670f-4707-87f8-a6716ace0e1a"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"kroneckerKetProducts", "[", 
  RowBox[{
   RowBox[{"onBases", "[", "\"\<nono\>\"", "]"}], ",", "3"}], "]"}]], "Input",\

 CellChangeTimes->{{3.735128166979184*^9, 3.7351281963354473`*^9}, {
  3.7351295941631107`*^9, 
  3.735129607966936*^9}},ExpressionUUID->"4985cf28-a8e0-489c-9ea9-\
59a8db8adb1d"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    TemplateBox[{"aa"},
     "Ket"], "**", 
    TemplateBox[{"aa"},
     "Ket"], "**", 
    TemplateBox[{"aa"},
     "Ket"]}], ",", 
   RowBox[{
    TemplateBox[{"aa"},
     "Ket"], "**", 
    TemplateBox[{"aa"},
     "Ket"], "**", 
    TemplateBox[{"jj"},
     "Ket"]}], ",", 
   RowBox[{
    TemplateBox[{"aa"},
     "Ket"], "**", 
    TemplateBox[{"aa"},
     "Ket"], "**", 
    TemplateBox[{"uu"},
     "Ket"]}], ",", 
   RowBox[{
    TemplateBox[{"aa"},
     "Ket"], "**", 
    TemplateBox[{"jj"},
     "Ket"], "**", 
    TemplateBox[{"aa"},
     "Ket"]}], ",", 
   RowBox[{
    TemplateBox[{"aa"},
     "Ket"], "**", 
    TemplateBox[{"jj"},
     "Ket"], "**", 
    TemplateBox[{"jj"},
     "Ket"]}], ",", 
   RowBox[{
    TemplateBox[{"aa"},
     "Ket"], "**", 
    TemplateBox[{"jj"},
     "Ket"], "**", 
    TemplateBox[{"uu"},
     "Ket"]}], ",", 
   RowBox[{
    TemplateBox[{"aa"},
     "Ket"], "**", 
    TemplateBox[{"uu"},
     "Ket"], "**", 
    TemplateBox[{"aa"},
     "Ket"]}], ",", 
   RowBox[{
    TemplateBox[{"aa"},
     "Ket"], "**", 
    TemplateBox[{"uu"},
     "Ket"], "**", 
    TemplateBox[{"jj"},
     "Ket"]}], ",", 
   RowBox[{
    TemplateBox[{"aa"},
     "Ket"], "**", 
    TemplateBox[{"uu"},
     "Ket"], "**", 
    TemplateBox[{"uu"},
     "Ket"]}], ",", 
   RowBox[{
    TemplateBox[{"jj"},
     "Ket"], "**", 
    TemplateBox[{"aa"},
     "Ket"], "**", 
    TemplateBox[{"aa"},
     "Ket"]}], ",", 
   RowBox[{
    TemplateBox[{"jj"},
     "Ket"], "**", 
    TemplateBox[{"aa"},
     "Ket"], "**", 
    TemplateBox[{"jj"},
     "Ket"]}], ",", 
   RowBox[{
    TemplateBox[{"jj"},
     "Ket"], "**", 
    TemplateBox[{"aa"},
     "Ket"], "**", 
    TemplateBox[{"uu"},
     "Ket"]}], ",", 
   RowBox[{
    TemplateBox[{"jj"},
     "Ket"], "**", 
    TemplateBox[{"jj"},
     "Ket"], "**", 
    TemplateBox[{"aa"},
     "Ket"]}], ",", 
   RowBox[{
    TemplateBox[{"jj"},
     "Ket"], "**", 
    TemplateBox[{"jj"},
     "Ket"], "**", 
    TemplateBox[{"jj"},
     "Ket"]}], ",", 
   RowBox[{
    TemplateBox[{"jj"},
     "Ket"], "**", 
    TemplateBox[{"jj"},
     "Ket"], "**", 
    TemplateBox[{"uu"},
     "Ket"]}], ",", 
   RowBox[{
    TemplateBox[{"jj"},
     "Ket"], "**", 
    TemplateBox[{"uu"},
     "Ket"], "**", 
    TemplateBox[{"aa"},
     "Ket"]}], ",", 
   RowBox[{
    TemplateBox[{"jj"},
     "Ket"], "**", 
    TemplateBox[{"uu"},
     "Ket"], "**", 
    TemplateBox[{"jj"},
     "Ket"]}], ",", 
   RowBox[{
    TemplateBox[{"jj"},
     "Ket"], "**", 
    TemplateBox[{"uu"},
     "Ket"], "**", 
    TemplateBox[{"uu"},
     "Ket"]}], ",", 
   RowBox[{
    TemplateBox[{"uu"},
     "Ket"], "**", 
    TemplateBox[{"aa"},
     "Ket"], "**", 
    TemplateBox[{"aa"},
     "Ket"]}], ",", 
   RowBox[{
    TemplateBox[{"uu"},
     "Ket"], "**", 
    TemplateBox[{"aa"},
     "Ket"], "**", 
    TemplateBox[{"jj"},
     "Ket"]}], ",", 
   RowBox[{
    TemplateBox[{"uu"},
     "Ket"], "**", 
    TemplateBox[{"aa"},
     "Ket"], "**", 
    TemplateBox[{"uu"},
     "Ket"]}], ",", 
   RowBox[{
    TemplateBox[{"uu"},
     "Ket"], "**", 
    TemplateBox[{"jj"},
     "Ket"], "**", 
    TemplateBox[{"aa"},
     "Ket"]}], ",", 
   RowBox[{
    TemplateBox[{"uu"},
     "Ket"], "**", 
    TemplateBox[{"jj"},
     "Ket"], "**", 
    TemplateBox[{"jj"},
     "Ket"]}], ",", 
   RowBox[{
    TemplateBox[{"uu"},
     "Ket"], "**", 
    TemplateBox[{"jj"},
     "Ket"], "**", 
    TemplateBox[{"uu"},
     "Ket"]}], ",", 
   RowBox[{
    TemplateBox[{"uu"},
     "Ket"], "**", 
    TemplateBox[{"uu"},
     "Ket"], "**", 
    TemplateBox[{"aa"},
     "Ket"]}], ",", 
   RowBox[{
    TemplateBox[{"uu"},
     "Ket"], "**", 
    TemplateBox[{"uu"},
     "Ket"], "**", 
    TemplateBox[{"jj"},
     "Ket"]}], ",", 
   RowBox[{
    TemplateBox[{"uu"},
     "Ket"], "**", 
    TemplateBox[{"uu"},
     "Ket"], "**", 
    TemplateBox[{"uu"},
     "Ket"]}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.7351281965193033`*^9, {3.735129589442383*^9, 
   3.735129608391534*^9}},ExpressionUUID->"693c56d4-4889-4e02-9b70-\
e8e1c88830b0"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"kroneckerProductKet", "[", 
  RowBox[{
   RowBox[{"onBases", "[", "\"\<nono\>\"", "]"}], ",", 
   RowBox[{"onBases", "[", "\"\<nono\>\"", "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.735128166979184*^9, 
  3.7351282140265923`*^9}},ExpressionUUID->"a7b0e3a5-0465-433c-8173-\
f3a0c34479bc"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   TemplateBox[{
     RowBox[{"aa", ",", "aa"}]},
    "Ket"], ",", 
   TemplateBox[{
     RowBox[{"aa", ",", "jj"}]},
    "Ket"], ",", 
   TemplateBox[{
     RowBox[{"aa", ",", "uu"}]},
    "Ket"], ",", 
   TemplateBox[{
     RowBox[{"jj", ",", "aa"}]},
    "Ket"], ",", 
   TemplateBox[{
     RowBox[{"jj", ",", "jj"}]},
    "Ket"], ",", 
   TemplateBox[{
     RowBox[{"jj", ",", "uu"}]},
    "Ket"], ",", 
   TemplateBox[{
     RowBox[{"uu", ",", "aa"}]},
    "Ket"], ",", 
   TemplateBox[{
     RowBox[{"uu", ",", "jj"}]},
    "Ket"], ",", 
   TemplateBox[{
     RowBox[{"uu", ",", "uu"}]},
    "Ket"]}], "}"}]], "Output",
 CellChangeTimes->{{3.735128205110256*^9, 
  3.735128214331933*^9}},ExpressionUUID->"31e0a6ea-e493-4619-8608-\
d268039730b3"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"onBases", "[", "]"}]], "Input",
 CellChangeTimes->{{3.734882482076055*^9, 3.734882503290577*^9}, {
  3.734882567903084*^9, 3.734882573090047*^9}, {3.734882626083108*^9, 
  3.734882626383491*^9}, {3.734885263037759*^9, 3.734885264948267*^9}},
 CellLabel->"In[81]:=",ExpressionUUID->"709f13c2-1634-495d-9432-94ff75e2d141"],

Cell[BoxData[
 RowBox[{"\[LeftAssociation]", 
  RowBox[{
   RowBox[{"\<\"Integral\"\>", "\[Rule]", 
    RowBox[{"infiniteBasis", "[", "None", "]"}]}], ",", 
   RowBox[{"\<\"IdentityKet\"\>", "\[Rule]", 
    RowBox[{"{", 
     TemplateBox[{"idket"},
      "Ket"], "}"}]}], ",", 
   RowBox[{"\<\"comp\"\>", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      TemplateBox[{"\"H\""},
       "Ket"], ",", 
      TemplateBox[{"\"V\""},
       "Ket"]}], "}"}]}], ",", 
   RowBox[{"\<\"diag\"\>", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      TemplateBox[{"\"D\""},
       "Ket"], ",", 
      TemplateBox[{"\"A\""},
       "Ket"]}], "}"}]}], ",", 
   RowBox[{"\<\"circ\"\>", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      TemplateBox[{"\"R\""},
       "Ket"], ",", 
      TemplateBox[{"\"L\""},
       "Ket"]}], "}"}]}], ",", 
   RowBox[{"\<\"coco\"\>", "\[Rule]", 
    RowBox[{"infiniteBasis", "[", "g", "]"}]}], ",", 
   RowBox[{"\<\"nono\"\>", "\[Rule]", 
    RowBox[{"infiniteBasis", "[", "\<\"no\"\>", "]"}]}]}], 
  "\[RightAssociation]"}]], "Output",
 CellChangeTimes->{3.7348824935410967`*^9, 3.7348825737168922`*^9, 
  3.734882626803155*^9, 3.7348852652686243`*^9, 3.734885307227797*^9, 
  3.734885492507745*^9, 3.7589619794285493`*^9},
 CellLabel->"Out[81]=",ExpressionUUID->"e19e9a4f-e321-419a-a2c8-81bba41f4ab0"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"basisVectorQ", "[", "\"\<bi\>\"", "]"}], "/@", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"Ket", "[", "0", "]"}], ",", 
    RowBox[{"Ket", "[", "10", "]"}], ",", 
    RowBox[{"Ket", "[", "\"\<0\>\"", "]"}], ",", 
    RowBox[{"Ket", "[", "a", "]"}]}], "}"}]}]], "Input",
 CellChangeTimes->{{3.7348853125081167`*^9, 
  3.734885391590983*^9}},ExpressionUUID->"b5d4a550-91dd-460c-8cd8-\
bc34ed5ae7e0"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"False", ",", "False", ",", "True", ",", "False"}], "}"}]], "Output",\

 CellChangeTimes->{{3.7348853236590643`*^9, 3.734885391974144*^9}, 
   3.734885493491291*^9},ExpressionUUID->"0a87c4c2-5005-4b82-900c-\
2c2f760c33fd"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"basisVectorQ", "[", "\"\<nono\>\"", "]"}], "/@", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"Ket", "[", "0", "]"}], ",", 
    RowBox[{"Ket", "[", "10", "]"}], ",", 
    RowBox[{"Ket", "[", "\"\<0\>\"", "]"}], ",", 
    RowBox[{"Ket", "[", "a", "]"}]}], "}"}]}]], "Input",
 CellChangeTimes->{{3.7348853125081167`*^9, 
  3.734885432295185*^9}},ExpressionUUID->"ace6c0f3-af80-40f3-977b-\
a71a534fe106"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"False", ",", "False", ",", "False", ",", "False"}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.734885399283243*^9, 3.7348854334879923`*^9}, 
   3.734885494555434*^9},ExpressionUUID->"d8c4811a-18ff-4dd8-a80b-\
efef27b51e8f"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"basisVectorQ", "[", "\"\<abc\>\"", "]"}], "/@", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"Ket", "[", "0", "]"}], ",", 
    RowBox[{"Ket", "[", "10", "]"}], ",", 
    RowBox[{"Ket", "[", "\"\<0\>\"", "]"}], ",", 
    RowBox[{"Ket", "[", "\"\<a\>\"", "]"}]}], "}"}]}]], "Input",
 CellChangeTimes->{{3.7348853125081167`*^9, 
  3.734885439111019*^9}},ExpressionUUID->"45b7a5f9-0bad-4a5a-8e05-\
b8d9e83e9ba0"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"False", ",", "False", ",", "False", ",", "True"}], "}"}]], "Output",\

 CellChangeTimes->{{3.734885404117176*^9, 3.7348854092520733`*^9}, 
   3.7348854394389277`*^9, 
   3.7348854954026413`*^9},ExpressionUUID->"e5a8aed1-f3ed-46b1-bc21-\
7cf1a18a330d"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"basisVectorQ", "[", "\"\<Integral\>\"", "]"}], "/@", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"Ket", "[", "0", "]"}], ",", 
    RowBox[{"Ket", "[", "10", "]"}], ",", 
    RowBox[{"Ket", "[", "\"\<0\>\"", "]"}], ",", 
    RowBox[{"Ket", "[", "a", "]"}]}], "}"}]}]], "Input",
 CellChangeTimes->{{3.7348853125081167`*^9, 3.734885410806656*^9}, {
  3.734885443051399*^9, 
  3.734885445531878*^9}},ExpressionUUID->"0671bc70-ac36-4881-bb73-\
27c39669469f"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"True", ",", "True", ",", "False", ",", "False"}], "}"}]], "Output",\

 CellChangeTimes->{3.734885446416751*^9, 3.7348854963137712`*^9, 
  3.734885530012432*^9},ExpressionUUID->"ee3cf10a-32f9-47ad-9643-\
70ab92460de5"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"MatchQ", "[", 
  RowBox[{
   RowBox[{"Ket", "[", "\"\<n0\>\"", "]"}], ",", 
   RowBox[{"Ket", "[", 
    RowBox[{"\"\<n\>\"", "~~", "\"\<0\>\""}], "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.734883019545947*^9, 
  3.734883046675942*^9}},ExpressionUUID->"775fea38-3f19-4af6-8cc5-\
94595a9f6bf7"],

Cell[BoxData["False"], "Output",
 CellChangeTimes->{{3.734883032059969*^9, 
  3.734883038998283*^9}},ExpressionUUID->"80dcd4fa-2abb-4cd0-8621-\
b2f8b1a893ef"]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.757762357793208*^9, 
  3.757762363747283*^9}},ExpressionUUID->"d64abccf-5274-4f15-9772-\
443251144b0f"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"bsh", "=", 
  RowBox[{
   RowBox[{
    FractionBox["1", 
     SqrtBox["2"]], 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Ket", "[", 
        RowBox[{"\"\<H\>\"", ",", "\"\<p1\>\""}], "]"}], "+", 
       RowBox[{"I", " ", 
        RowBox[{"Ket", "[", 
         RowBox[{"\"\<H\>\"", ",", "\"\<p2\>\""}], "]"}]}]}], ")"}], "**", 
     RowBox[{"Bra", "[", 
      RowBox[{"\"\<H\>\"", ",", "\"\<p1\>\""}], "]"}]}]}], "+", 
   RowBox[{
    FractionBox["1", 
     SqrtBox["2"]], 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Ket", "[", 
        RowBox[{"\"\<H\>\"", ",", "\"\<p2\>\""}], "]"}], "+", 
       RowBox[{"I", " ", 
        RowBox[{"Ket", "[", 
         RowBox[{"\"\<H\>\"", ",", "\"\<p1\>\""}], "]"}]}]}], ")"}], "**", 
     RowBox[{"Bra", "[", 
      RowBox[{"\"\<H\>\"", ",", "\"\<p2\>\""}], "]"}]}]}]}]}]], "Input",
 CellChangeTimes->{{3.7577623899511957`*^9, 3.7577624659140205`*^9}},
 CellLabel->"In[61]:=",ExpressionUUID->"90352c27-b98b-4abc-88a8-56582657066e"],

Cell[BoxData[
 RowBox[{
  FractionBox[
   RowBox[{
    RowBox[{
     TemplateBox[{
       RowBox[{"\"H\"", ",", "\"p1\""}]},
      "Ket"], "**", 
     TemplateBox[{
       RowBox[{"\"H\"", ",", "\"p1\""}]},
      "Bra"]}], "+", 
    RowBox[{"\[ImaginaryI]", " ", 
     RowBox[{
      TemplateBox[{
        RowBox[{"\"H\"", ",", "\"p2\""}]},
       "Ket"], "**", 
      TemplateBox[{
        RowBox[{"\"H\"", ",", "\"p1\""}]},
       "Bra"]}]}]}], 
   SqrtBox["2"]], "+", 
  FractionBox[
   RowBox[{
    RowBox[{"\[ImaginaryI]", " ", 
     RowBox[{
      TemplateBox[{
        RowBox[{"\"H\"", ",", "\"p1\""}]},
       "Ket"], "**", 
      TemplateBox[{
        RowBox[{"\"H\"", ",", "\"p2\""}]},
       "Bra"]}]}], "+", 
    RowBox[{
     TemplateBox[{
       RowBox[{"\"H\"", ",", "\"p2\""}]},
      "Ket"], "**", 
     TemplateBox[{
       RowBox[{"\"H\"", ",", "\"p2\""}]},
      "Bra"]}]}], 
   SqrtBox["2"]]}]], "Output",
 CellChangeTimes->{3.757762466402689*^9, 3.759044124313097*^9},
 CellLabel->"Out[61]=",ExpressionUUID->"4714d860-c2aa-41f3-86c6-c9ec61bb7150"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"addBasis", "[", 
  RowBox[{"\"\<path\>\"", ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Ket", "[", "\"\<p1\>\"", "]"}], ",", 
     RowBox[{"Ket", "[", "\"\<p2\>\"", "]"}]}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.757762485852646*^9, 3.7577625055858583`*^9}},
 CellLabel->"In[62]:=",ExpressionUUID->"4ca84c90-1d38-49c3-ad9b-eaddbbb3f27b"],

Cell[BoxData[
 TemplateBox[{
  "addBasis", "invname", 
   "\"Name '\\!\\(\\*RowBox[{\\\"\\\\\\\"path\\\\\\\"\\\"}]\\)' already used.\
\"", 2, 62, 6, 26191496410366677217, "Local", "KetsBras`addBasis"},
  "MessageTemplate2"]], "Message", "MSG",
 CellChangeTimes->{3.7590441252535963`*^9},
 CellLabel->
  "During evaluation of \
In[62]:=",ExpressionUUID->"5fb177b7-df57-4df2-8d24-67b59add5438"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"fromKetBra", "[", "bsh", "]"}], "//", "Normal"}]], "Input",
 CellChangeTimes->{{3.757762468244748*^9, 3.7577624843526583`*^9}, {
  3.7577625147712975`*^9, 3.7577625189481125`*^9}, {3.75904412896889*^9, 
  3.7590441317249374`*^9}, {3.7590441647259264`*^9, 3.7590441671337843`*^9}},
 CellLabel->"In[64]:=",ExpressionUUID->"5d6b39d9-0ccc-4350-b1da-35f9cd8be9e7"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       FractionBox["1", 
        SqrtBox["2"]], ",", 
       FractionBox["\[ImaginaryI]", 
        SqrtBox["2"]], ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       FractionBox["\[ImaginaryI]", 
        SqrtBox["2"]], ",", 
       FractionBox["1", 
        SqrtBox["2"]], ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     TemplateBox[{
       RowBox[{"\"H\"", ",", "\"p1\""}]},
      "Ket"], ",", 
     TemplateBox[{
       RowBox[{"\"H\"", ",", "\"p2\""}]},
      "Ket"], ",", 
     TemplateBox[{
       RowBox[{"\"V\"", ",", "\"p1\""}]},
      "Ket"], ",", 
     TemplateBox[{
       RowBox[{"\"V\"", ",", "\"p2\""}]},
      "Ket"]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     TemplateBox[{
       RowBox[{"\"H\"", ",", "\"p1\""}]},
      "Ket"], ",", 
     TemplateBox[{
       RowBox[{"\"H\"", ",", "\"p2\""}]},
      "Ket"], ",", 
     TemplateBox[{
       RowBox[{"\"V\"", ",", "\"p1\""}]},
      "Ket"], ",", 
     TemplateBox[{
       RowBox[{"\"V\"", ",", "\"p2\""}]},
      "Ket"]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.7590441323477235`*^9, 3.7590441674589653`*^9},
 CellLabel->"Out[64]=",ExpressionUUID->"8398f61a-35ff-43db-810f-f0fbd91b22e7"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"changeBasis", "[", 
   RowBox[{"bsh", ",", 
    RowBox[{"\"\<comp\>\"", "\[Rule]", "\"\<diag\>\""}]}], "]"}], "//", 
  "Simplify"}]], "Input",
 CellChangeTimes->{{3.759044538627616*^9, 3.759044558986699*^9}},
 CellLabel->"In[66]:=",ExpressionUUID->"45813395-fa76-4bc8-b4ba-a3a3f1f57fcd"],

Cell[BoxData[
 RowBox[{
  FractionBox["1", 
   RowBox[{"2", " ", 
    SqrtBox["2"]}]], 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     TemplateBox[{
       RowBox[{"\"A\"", ",", "\"p1\""}]},
      "Ket"], "**", 
     TemplateBox[{
       RowBox[{"\"A\"", ",", "\"p1\""}]},
      "Bra"]}], "+", 
    RowBox[{"\[ImaginaryI]", " ", 
     RowBox[{
      TemplateBox[{
        RowBox[{"\"A\"", ",", "\"p1\""}]},
       "Ket"], "**", 
      TemplateBox[{
        RowBox[{"\"A\"", ",", "\"p2\""}]},
       "Bra"]}]}], "+", 
    RowBox[{
     TemplateBox[{
       RowBox[{"\"A\"", ",", "\"p1\""}]},
      "Ket"], "**", 
     TemplateBox[{
       RowBox[{"\"D\"", ",", "\"p1\""}]},
      "Bra"]}], "+", 
    RowBox[{"\[ImaginaryI]", " ", 
     RowBox[{
      TemplateBox[{
        RowBox[{"\"A\"", ",", "\"p1\""}]},
       "Ket"], "**", 
      TemplateBox[{
        RowBox[{"\"D\"", ",", "\"p2\""}]},
       "Bra"]}]}], "+", 
    RowBox[{"\[ImaginaryI]", " ", 
     RowBox[{
      TemplateBox[{
        RowBox[{"\"A\"", ",", "\"p2\""}]},
       "Ket"], "**", 
      TemplateBox[{
        RowBox[{"\"A\"", ",", "\"p1\""}]},
       "Bra"]}]}], "+", 
    RowBox[{
     TemplateBox[{
       RowBox[{"\"A\"", ",", "\"p2\""}]},
      "Ket"], "**", 
     TemplateBox[{
       RowBox[{"\"A\"", ",", "\"p2\""}]},
      "Bra"]}], "+", 
    RowBox[{"\[ImaginaryI]", " ", 
     RowBox[{
      TemplateBox[{
        RowBox[{"\"A\"", ",", "\"p2\""}]},
       "Ket"], "**", 
      TemplateBox[{
        RowBox[{"\"D\"", ",", "\"p1\""}]},
       "Bra"]}]}], "+", 
    RowBox[{
     TemplateBox[{
       RowBox[{"\"A\"", ",", "\"p2\""}]},
      "Ket"], "**", 
     TemplateBox[{
       RowBox[{"\"D\"", ",", "\"p2\""}]},
      "Bra"]}], "+", 
    RowBox[{
     TemplateBox[{
       RowBox[{"\"D\"", ",", "\"p1\""}]},
      "Ket"], "**", 
     TemplateBox[{
       RowBox[{"\"A\"", ",", "\"p1\""}]},
      "Bra"]}], "+", 
    RowBox[{"\[ImaginaryI]", " ", 
     RowBox[{
      TemplateBox[{
        RowBox[{"\"D\"", ",", "\"p1\""}]},
       "Ket"], "**", 
      TemplateBox[{
        RowBox[{"\"A\"", ",", "\"p2\""}]},
       "Bra"]}]}], "+", 
    RowBox[{
     TemplateBox[{
       RowBox[{"\"D\"", ",", "\"p1\""}]},
      "Ket"], "**", 
     TemplateBox[{
       RowBox[{"\"D\"", ",", "\"p1\""}]},
      "Bra"]}], "+", 
    RowBox[{"\[ImaginaryI]", " ", 
     RowBox[{
      TemplateBox[{
        RowBox[{"\"D\"", ",", "\"p1\""}]},
       "Ket"], "**", 
      TemplateBox[{
        RowBox[{"\"D\"", ",", "\"p2\""}]},
       "Bra"]}]}], "+", 
    RowBox[{"\[ImaginaryI]", " ", 
     RowBox[{
      TemplateBox[{
        RowBox[{"\"D\"", ",", "\"p2\""}]},
       "Ket"], "**", 
      TemplateBox[{
        RowBox[{"\"A\"", ",", "\"p1\""}]},
       "Bra"]}]}], "+", 
    RowBox[{
     TemplateBox[{
       RowBox[{"\"D\"", ",", "\"p2\""}]},
      "Ket"], "**", 
     TemplateBox[{
       RowBox[{"\"A\"", ",", "\"p2\""}]},
      "Bra"]}], "+", 
    RowBox[{"\[ImaginaryI]", " ", 
     RowBox[{
      TemplateBox[{
        RowBox[{"\"D\"", ",", "\"p2\""}]},
       "Ket"], "**", 
      TemplateBox[{
        RowBox[{"\"D\"", ",", "\"p1\""}]},
       "Bra"]}]}], "+", 
    RowBox[{
     TemplateBox[{
       RowBox[{"\"D\"", ",", "\"p2\""}]},
      "Ket"], "**", 
     TemplateBox[{
       RowBox[{"\"D\"", ",", "\"p2\""}]},
      "Bra"]}]}], ")"}]}]], "Output",
 CellChangeTimes->{{3.7590445553500743`*^9, 3.759044559515744*^9}},
 CellLabel->"Out[66]=",ExpressionUUID->"84050c30-4f3d-4406-9924-944f7f04a7c0"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"cnotmat", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "1", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "1", ",", "0"}], "}"}]}], "}"}]}], ";", 
  RowBox[{"MatrixForm", "[", "cnotmat", "]"}]}]], "Input",
 CellChangeTimes->{{3.7590446563641615`*^9, 3.7590446835150023`*^9}},
 CellLabel->"In[69]:=",ExpressionUUID->"c520313e-dd19-4d03-9fb0-2cf4f866e22b"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"1", "0", "0", "0"},
     {"0", "1", "0", "0"},
     {"0", "0", "0", "1"},
     {"0", "0", "1", "0"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.7590446769266033`*^9, 3.7590446839498763`*^9}},
 CellLabel->
  "Out[69]//MatrixForm=",ExpressionUUID->"ace3ccda-54a2-444a-8068-\
46668c03980b"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"?", "toKetBra"}]], "Input",
 CellChangeTimes->{{3.759044711809641*^9, 3.7590447121243668`*^9}},
 CellLabel->"In[71]:=",ExpressionUUID->"25b808d7-da9d-478c-a1e5-1f29678d4590"],

Cell[BoxData["\<\"toKetBra[\\!\\(\\*FormBox[StyleBox[\\\"mat\\\", Italic, \
Rule[StripOnInput, False]], TraditionalForm]\\)_, \
\\!\\(\\*FormBox[StyleBox[\\\"outbasis\\\", Italic, Rule[StripOnInput, \
False]], TraditionalForm]\\)_, \\!\\(\\*FormBox[StyleBox[\\\"inbasis\\\", \
Italic, Rule[StripOnInput, False]], TraditionalForm]\\)_, \
\\!\\(\\*FormBox[StyleBox[\\\"num\\\", Italic, Rule[StripOnInput, False]], \
TraditionalForm]\\)_]: From matrix \\!\\(\\*FormBox[StyleBox[\\\"mat\\\", \
Italic, Rule[StripOnInput, False]], TraditionalForm]\\) creates corresponding \
operator expressed by ketbras. The second and third arguments, \
\\!\\(\\*FormBox[StyleBox[\\\"outbasis\\\", Italic, Rule[StripOnInput, \
False]], TraditionalForm]\\) and \\!\\(\\*FormBox[StyleBox[\\\"inbasis\\\", \
Italic, Rule[StripOnInput, False]], TraditionalForm]\\), specify bases (in \
the form of names of bases or lists of Kets) in which the operator is to be \
expressed. Argument \\!\\(\\*FormBox[StyleBox[\\\"inbasis\\\", Italic, \
Rule[StripOnInput, False]], TraditionalForm]\\) may be omitted in which case \
it is taken to be identical to \\!\\(\\*FormBox[StyleBox[\\\"outbasis\\\", \
Italic, Rule[StripOnInput, False]], TraditionalForm]\\). Also the second \
argument may be omitted in which case both, the input and output bases are by \
default chosen to be integer bases with appropriate number of elements. \
Argument \\!\\(\\*FormBox[StyleBox[\\\"num\\\", Italic, Rule[StripOnInput, \
False]], TraditionalForm]\\) specifies number of subspaces and by default it \
equals 1. For \\!\\(\\*FormBox[StyleBox[\\\"num\\\", Italic, \
Rule[StripOnInput, False]], TraditionalForm]\\)==1 the number of basis \
vectors may exceed dimension of \\!\\(\\*FormBox[StyleBox[\\\"mat\\\", \
Italic, Rule[StripOnInput, False]], TraditionalForm]\\); for \
\\!\\(\\*FormBox[StyleBox[\\\"num\\\", Italic, Rule[StripOnInput, False]], \
TraditionalForm]\\)>1, equalities \\!\\(\\*FormBox[StyleBox[\\\"num\\\", \
Italic, Rule[StripOnInput, False]], \
TraditionalForm]\\)*Length/@{\\!\\(\\*FormBox[StyleBox[\\\"outbasis\\\", \
Italic, Rule[StripOnInput, False]], \
TraditionalForm]\\),\\!\\(\\*FormBox[StyleBox[\\\"inbasis\\\", Italic, \
Rule[StripOnInput, False]], \
TraditionalForm]\\)}==Dimensions[\\!\\(\\*FormBox[StyleBox[\\\"mat\\\", \
Italic, Rule[StripOnInput, False]], TraditionalForm]\\)] have to be \
satisfied.\"\>"], "Print", "PrintUsage",
 CellChangeTimes->{3.759044712530048*^9},
 CellTags->
  "Info713759048312-6451956",ExpressionUUID->"30090bf1-f4f6-479a-bebd-\
758b18d2c4d9"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"toKetBra", "[", 
  RowBox[{"cnotmat", ",", "\"\<2Dint\>\"", ",", "2"}], "]"}]], "Input",
 CellChangeTimes->{{3.759044686636753*^9, 3.7590447087799845`*^9}, {
  3.7590447558674984`*^9, 3.7590448022913446`*^9}, {3.7590448594328613`*^9, 
  3.759044860573947*^9}},
 CellLabel->"In[84]:=",ExpressionUUID->"86edc627-5cac-4186-982f-7d4fd71668cc"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   TemplateBox[{
     RowBox[{"\"0\"", ",", "\"0\""}]},
    "Ket"], "**", 
   TemplateBox[{
     RowBox[{"\"0\"", ",", "\"0\""}]},
    "Bra"]}], "+", 
  RowBox[{
   TemplateBox[{
     RowBox[{"\"0\"", ",", "\"1\""}]},
    "Ket"], "**", 
   TemplateBox[{
     RowBox[{"\"0\"", ",", "\"1\""}]},
    "Bra"]}], "+", 
  RowBox[{
   TemplateBox[{
     RowBox[{"\"1\"", ",", "\"0\""}]},
    "Ket"], "**", 
   TemplateBox[{
     RowBox[{"\"1\"", ",", "\"1\""}]},
    "Bra"]}], "+", 
  RowBox[{
   TemplateBox[{
     RowBox[{"\"1\"", ",", "\"1\""}]},
    "Ket"], "**", 
   TemplateBox[{
     RowBox[{"\"1\"", ",", "\"0\""}]},
    "Bra"]}]}]], "Output",
 CellChangeTimes->{3.759044704395978*^9, 3.7590447609389467`*^9, 
  3.7590448029803143`*^9, 3.7590448610352736`*^9, 3.7590449556559315`*^9},
 CellLabel->"Out[84]=",ExpressionUUID->"1a6ac40a-1124-4e6d-b71a-cced8c27dc8c"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"changeBasis", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       TemplateBox[{
         RowBox[{"\"0\"", ",", "\"0\""}]},
        "Ket"], "**", 
       TemplateBox[{
         RowBox[{"\"0\"", ",", "\"0\""}]},
        "Bra"]}], "+", 
      RowBox[{
       TemplateBox[{
         RowBox[{"\"0\"", ",", "\"1\""}]},
        "Ket"], "**", 
       TemplateBox[{
         RowBox[{"\"0\"", ",", "\"1\""}]},
        "Bra"]}], "+", 
      RowBox[{
       TemplateBox[{
         RowBox[{"\"1\"", ",", "\"0\""}]},
        "Ket"], "**", 
       TemplateBox[{
         RowBox[{"\"1\"", ",", "\"1\""}]},
        "Bra"]}], "+", 
      RowBox[{
       TemplateBox[{
         RowBox[{"\"1\"", ",", "\"1\""}]},
        "Ket"], "**", 
       TemplateBox[{
         RowBox[{"\"1\"", ",", "\"0\""}]},
        "Bra"]}]}], ",", 
     RowBox[{"\"\<2Dint\>\"", "\[Rule]", "\"\<diag\>\""}]}], "]"}], "//", 
   "Simplify"}], "//", "fromKetBra"}]], "Input",
 CellChangeTimes->{{3.759044959800919*^9, 3.759044982370066*^9}},
 CellLabel->"In[87]:=",ExpressionUUID->"ec98a8cd-eccb-4cf3-a313-253c19ff1a3a"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{",", 
   RowBox[{"{", 
    RowBox[{
     TemplateBox[{
       RowBox[{"\"D\"", ",", "\"D\""}]},
      "Ket"], ",", 
     TemplateBox[{
       RowBox[{"\"D\"", ",", "\"A\""}]},
      "Ket"], ",", 
     TemplateBox[{
       RowBox[{"\"A\"", ",", "\"D\""}]},
      "Ket"], ",", 
     TemplateBox[{
       RowBox[{"\"A\"", ",", "\"A\""}]},
      "Ket"]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     TemplateBox[{
       RowBox[{"\"D\"", ",", "\"D\""}]},
      "Ket"], ",", 
     TemplateBox[{
       RowBox[{"\"D\"", ",", "\"A\""}]},
      "Ket"], ",", 
     TemplateBox[{
       RowBox[{"\"A\"", ",", "\"D\""}]},
      "Ket"], ",", 
     TemplateBox[{
       RowBox[{"\"A\"", ",", "\"A\""}]},
      "Ket"]}], "}"}]}], "}"}]], "Input",
 CellChangeTimes->{{3.759044986166901*^9, 
  3.7590449862097864`*^9}},ExpressionUUID->"a26bfecd-100c-4eec-9bc3-\
dbbefc4798f6"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   InterpretationBox[
    RowBox[{
     TagBox["SparseArray",
      "SummaryHead"], "[", 
     DynamicModuleBox[{Typeset`open$$ = False, Typeset`embedState$$ = 
      "Ready"}, 
      TemplateBox[{
        PaneSelectorBox[{False -> GridBox[{{
              PaneBox[
               ButtonBox[
                DynamicBox[
                 FEPrivate`FrontEndResource[
                 "FEBitmaps", "SquarePlusIconMedium"]], 
                ButtonFunction :> (Typeset`open$$ = True), Appearance -> None,
                 Evaluator -> Automatic, Method -> "Preemptive"], 
               Alignment -> {Center, Center}, ImageSize -> 
               Dynamic[{
                 Automatic, 
                  3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                   Magnification])}]], 
              GraphicsBox[
               RasterBox[CompressedData["
1:eJxTTMoPSmVmYGBggWIQ26p8d9wspXP2c4wXbTH/ccX+xSLFx4GrXtnv7DZw
3bnlhf0N9+Xraqa9tT8Zkfsv/ut7e1zqqSU+2OyltXsA2nLR/A==
                "], {{0, 
                0}, {4, 4}}, {0, 1}], AspectRatio -> 1, Axes -> False, Frame -> 
               False, FrameLabel -> {None, None}, FrameStyle -> Directive[
                 Opacity[0.5], 
                 Thickness[Tiny], 
                 RGBColor[0.368417, 0.506779, 0.709798]], 
               FrameTicks -> {{None, None}, {None, None}}, GridLinesStyle -> 
               Directive[
                 GrayLevel[0.5, 0.4]], ImageSize -> 
               Dynamic[{
                 Automatic, 
                  3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                   Magnification])}], 
               Method -> {
                "AxisPadding" -> Scaled[0.02], "DefaultBoundaryStyle" -> 
                 Automatic, "DefaultPlotStyle" -> Automatic, "DomainPadding" -> 
                 Scaled[0.02], "RangePadding" -> Scaled[0.05]}], 
              GridBox[{{
                 RowBox[{
                   TagBox[
                   "\"Specified elements: \"", "SummaryItemAnnotation"], 
                   "\[InvisibleSpace]", 
                   TagBox["4", "SummaryItem"]}]}, {
                 RowBox[{
                   TagBox["\"Dimensions: \"", "SummaryItemAnnotation"], 
                   "\[InvisibleSpace]", 
                   TagBox[
                    RowBox[{"{", 
                    RowBox[{"4", ",", "4"}], "}"}], "SummaryItem"]}]}}, 
               GridBoxAlignment -> {
                "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
               False, GridBoxItemSize -> {
                "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
               GridBoxSpacings -> {
                "Columns" -> {{2}}, "Rows" -> {{Automatic}}}, 
               BaseStyle -> {
                ShowStringCharacters -> False, NumberMarks -> False, 
                 PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
            GridBoxAlignment -> {"Rows" -> {{Top}}}, AutoDelete -> False, 
            GridBoxItemSize -> {
             "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
            BaselinePosition -> {1, 1}], True -> GridBox[{{
              PaneBox[
               ButtonBox[
                DynamicBox[
                 FEPrivate`FrontEndResource[
                 "FEBitmaps", "SquareMinusIconMedium"]], 
                ButtonFunction :> (Typeset`open$$ = False), Appearance -> 
                None, Evaluator -> Automatic, Method -> "Preemptive"], 
               Alignment -> {Center, Center}, ImageSize -> 
               Dynamic[{
                 Automatic, 
                  3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                   Magnification])}]], 
              GraphicsBox[
               RasterBox[CompressedData["
1:eJxTTMoPSmVmYGBggWIQ26p8d9wspXP2c4wXbTH/ccX+xSLFx4GrXtnv7DZw
3bnlhf0N9+Xraqa9tT8Zkfsv/ut7e1zqqSU+2OyltXsA2nLR/A==
                "], {{0, 
                0}, {4, 4}}, {0, 1}], AspectRatio -> 1, Axes -> False, Frame -> 
               False, FrameLabel -> {None, None}, FrameStyle -> Directive[
                 Opacity[0.5], 
                 Thickness[Tiny], 
                 RGBColor[0.368417, 0.506779, 0.709798]], 
               FrameTicks -> {{None, None}, {None, None}}, GridLinesStyle -> 
               Directive[
                 GrayLevel[0.5, 0.4]], ImageSize -> 
               Dynamic[{
                 Automatic, 
                  3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                   Magnification])}], 
               Method -> {
                "AxisPadding" -> Scaled[0.02], "DefaultBoundaryStyle" -> 
                 Automatic, "DefaultPlotStyle" -> Automatic, "DomainPadding" -> 
                 Scaled[0.02], "RangePadding" -> Scaled[0.05]}], 
              GridBox[{{
                 RowBox[{
                   TagBox[
                   "\"Specified elements: \"", "SummaryItemAnnotation"], 
                   "\[InvisibleSpace]", 
                   TagBox["4", "SummaryItem"]}]}, {
                 RowBox[{
                   TagBox["\"Dimensions: \"", "SummaryItemAnnotation"], 
                   "\[InvisibleSpace]", 
                   TagBox[
                    RowBox[{"{", 
                    RowBox[{"4", ",", "4"}], "}"}], "SummaryItem"]}]}, {
                 RowBox[{
                   TagBox["\"Default: \"", "SummaryItemAnnotation"], 
                   "\[InvisibleSpace]", 
                   TagBox["0", "SummaryItem"]}]}, {
                 RowBox[{
                   TagBox["\"Density: \"", "SummaryItemAnnotation"], 
                   "\[InvisibleSpace]", 
                   TagBox["0.25`", "SummaryItem"]}]}, {
                 RowBox[{
                   TagBox["\"Elements:\"", "SummaryItemAnnotation"], 
                   "\[InvisibleSpace]", 
                   TagBox["\"\"", "SummaryItem"]}]}, {
                 TagBox[
                  TagBox[
                   GridBox[{{
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"1", ",", "1"}], "}"}], "\[Rule]", 
                    StyleBox[
                    PaneBox[
                    "1", ContentPadding -> False, FrameMargins -> 0, 
                    StripOnInput -> True, BaselinePosition -> Baseline, 
                    ImageSize -> {{1, 300}, Automatic}], LineBreakWithin -> 
                    False]}]}, {
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"2", ",", "4"}], "}"}], "\[Rule]", 
                    StyleBox[
                    PaneBox[
                    "1", ContentPadding -> False, FrameMargins -> 0, 
                    StripOnInput -> True, BaselinePosition -> Baseline, 
                    ImageSize -> {{1, 300}, Automatic}], LineBreakWithin -> 
                    False]}]}, {
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"3", ",", "3"}], "}"}], "\[Rule]", 
                    StyleBox[
                    PaneBox[
                    "1", ContentPadding -> False, FrameMargins -> 0, 
                    StripOnInput -> True, BaselinePosition -> Baseline, 
                    ImageSize -> {{1, 300}, Automatic}], LineBreakWithin -> 
                    False]}]}, {
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"4", ",", "2"}], "}"}], "\[Rule]", 
                    StyleBox[
                    PaneBox[
                    "1", ContentPadding -> False, FrameMargins -> 0, 
                    StripOnInput -> True, BaselinePosition -> Baseline, 
                    ImageSize -> {{1, 300}, Automatic}], LineBreakWithin -> 
                    False]}]}}, GridBoxAlignment -> {"Columns" -> {{Left}}}, 
                    DefaultBaseStyle -> "Column", 
                    GridBoxItemSize -> {
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}], 
                   "Column"], "SummaryItem"]}}, 
               GridBoxAlignment -> {
                "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
               False, GridBoxItemSize -> {
                "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
               GridBoxSpacings -> {
                "Columns" -> {{2}}, "Rows" -> {{Automatic}}}, 
               BaseStyle -> {
                ShowStringCharacters -> False, NumberMarks -> False, 
                 PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
            GridBoxAlignment -> {"Rows" -> {{Top}}}, AutoDelete -> False, 
            GridBoxItemSize -> {
             "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
            BaselinePosition -> {1, 1}]}, 
         Dynamic[Typeset`open$$], ImageSize -> Automatic]},
       "SummaryPanel"],
      DynamicModuleValues:>{}], "]"}],
    SparseArray[
    Automatic, {4, 4}, 0, {
     1, {{0, 1, 2, 3, 4}, {{1}, {4}, {3}, {2}}}, {1, 1, 1, 1}}],
    Editable->False,
    SelectWithContents->True,
    Selectable->False], "//", "Normal"}], "//", "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.759044988196953*^9, 3.7590449937923355`*^9}},
 CellLabel->"In[89]:=",ExpressionUUID->"51c71c4c-60d8-4b15-b8ae-3a0643bb13ea"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"1", "0", "0", "0"},
     {"0", "0", "0", "1"},
     {"0", "0", "1", "0"},
     {"0", "1", "0", "0"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.759044989547618*^9, 3.7590449941583567`*^9}},
 CellLabel->
  "Out[89]//MatrixForm=",ExpressionUUID->"798a73b8-b0cc-4e24-861b-\
2b7a3cd7a245"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"?", "addBasisTransformation"}]], "Input",
 CellChangeTimes->{{3.759044897723592*^9, 3.7590449157425385`*^9}},
 CellLabel->"In[82]:=",ExpressionUUID->"a8e4e8e0-575b-4c63-8531-909a3cca0bfc"],

Cell[BoxData["\<\"addBasisTransformation[\\!\\(\\*FormBox[StyleBox[\\\"\
frombasis\\\", Italic, Rule[StripOnInput, False]], \
TraditionalForm]\\)_String,\\!\\(\\*FormBox[StyleBox[\\\"tobasis\\\", Italic, \
Rule[StripOnInput, False]], TraditionalForm]\\)_String,mat]: Add a matrix \\!\
\\(\\*FormBox[StyleBox[\\\"mat\\\", Italic, Rule[StripOnInput, False]], \
TraditionalForm]\\) specifying how basis vectors from basis \
\\!\\(\\*FormBox[StyleBox[\\\"frombasis\\\", Italic, Rule[StripOnInput, \
False]], TraditionalForm]\\) relate to vectors in \
\\!\\(\\*FormBox[StyleBox[\\\"tobasis\\\", Italic, Rule[StripOnInput, \
False]], TraditionalForm]\\). Infinite bases are not supported.\"\>"], "Print",\
 "PrintUsage",
 CellChangeTimes->{3.7590449177902784`*^9},
 CellTags->
  "Info823759048517-6451956",ExpressionUUID->"8fec7a12-6c58-4480-8207-\
8b32611b37df"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"addBasisTransformation", "[", 
  RowBox[{"\"\<2Dint\>\"", ",", "\"\<comp\>\"", ",", 
   RowBox[{"IdentityMatrix", "[", "2", "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.7590449192770834`*^9, 3.7590449522879105`*^9}},
 CellLabel->"In[83]:=",ExpressionUUID->"f4029a97-5cd2-46b7-ba00-e7c8972c3e18"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"onBases", "[", "]"}]], "Input",
 CellChangeTimes->{{3.7590448104872217`*^9, 3.759044812852623*^9}},
 CellLabel->"In[78]:=",ExpressionUUID->"9b034ad0-9955-47a4-91f2-66e61a69cea9"],

Cell[BoxData[
 RowBox[{"\[LeftAssociation]", 
  RowBox[{
   RowBox[{"\<\"Integral\"\>", "\[Rule]", 
    RowBox[{"infiniteBasis", "[", "None", "]"}]}], ",", 
   RowBox[{"\<\"IdentityKet\"\>", "\[Rule]", 
    RowBox[{"{", 
     TemplateBox[{"idket"},
      "Ket"], "}"}]}], ",", 
   RowBox[{"\<\"comp\"\>", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      TemplateBox[{"\"H\""},
       "Ket"], ",", 
      TemplateBox[{"\"V\""},
       "Ket"]}], "}"}]}], ",", 
   RowBox[{"\<\"diag\"\>", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      TemplateBox[{"\"D\""},
       "Ket"], ",", 
      TemplateBox[{"\"A\""},
       "Ket"]}], "}"}]}], ",", 
   RowBox[{"\<\"circ\"\>", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      TemplateBox[{"\"R\""},
       "Ket"], ",", 
      TemplateBox[{"\"L\""},
       "Ket"]}], "}"}]}], ",", 
   RowBox[{"\<\"coco\"\>", "\[Rule]", 
    RowBox[{"infiniteBasis", "[", "g", "]"}]}], ",", 
   RowBox[{"\<\"nono\"\>", "\[Rule]", 
    RowBox[{"infiniteBasis", "[", "\<\"no\"\>", "]"}]}], ",", 
   RowBox[{"\<\"path\"\>", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      TemplateBox[{"\"p1\""},
       "Ket"], ",", 
      TemplateBox[{"\"p2\""},
       "Ket"]}], "}"}]}], ",", 
   RowBox[{"\<\"2Dint\"\>", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      TemplateBox[{"\"0\""},
       "Ket"], ",", 
      TemplateBox[{"\"1\""},
       "Ket"]}], "}"}]}]}], "\[RightAssociation]"}]], "Output",
 CellChangeTimes->{3.7590448132690487`*^9, 3.7590448539217525`*^9},
 CellLabel->"Out[78]=",ExpressionUUID->"cc17ae34-8689-4f00-9351-b638bea1679d"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"addBasis", "[", 
  RowBox[{"\"\<2Dint\>\"", ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Ket", "@", "\"\<0\>\""}], ",", 
     RowBox[{"Ket", "@", "\"\<1\>\""}]}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.7590448256368093`*^9, 3.7590448481665134`*^9}},
 CellLabel->"In[77]:=",ExpressionUUID->"c085795d-a030-47f7-9810-11dc0ea9b43f"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"partTr", "[", 
   RowBox[{
    RowBox[{
     RowBox[{
      FractionBox["I", "2"], 
      RowBox[{"(", 
       RowBox[{"1", "+", 
        RowBox[{"Exp", "[", 
         RowBox[{"I", " ", "\[CurlyPhi]"}], "]"}]}], ")"}], 
      RowBox[{"Ket", "[", 
       RowBox[{"A", ",", 
        RowBox[{"B", "'"}]}], "]"}]}], "-", 
     RowBox[{
      FractionBox["1", "2"], 
      RowBox[{"(", 
       RowBox[{"1", "-", 
        RowBox[{"Exp", "[", 
         RowBox[{"I", " ", "\[CurlyPhi]"}], "]"}]}], ")"}], 
      RowBox[{"Ket", "[", 
       RowBox[{"A", ",", "B"}], "]"}]}]}], ",", 
    RowBox[{"{", "2", "}"}]}], "]"}], "//", "Simplify", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"//", 
     RowBox[{
      RowBox[{"Simplify", "[", 
       RowBox[{"#", ",", 
        RowBox[{"\[CurlyPhi]", "\[Element]", "Reals"}]}], "]"}], "&"}]}], "//",
     "ExpToTrig"}], "*)"}]}]], "Input",
 CellChangeTimes->{{3.759057739128352*^9, 3.7590578346149826`*^9}},
 CellLabel->"In[19]:=",ExpressionUUID->"8c0e41fb-a98c-400b-b618-49624b3d3d80"],

Cell[BoxData[
 RowBox[{
  FractionBox["1", "2"], " ", 
  SuperscriptBox["\[ExponentialE]", 
   RowBox[{
    RowBox[{"-", "\[ImaginaryI]"}], " ", 
    RowBox[{"Conjugate", "[", "\[CurlyPhi]", "]"}]}]], " ", 
  RowBox[{"(", 
   RowBox[{
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{"\[ImaginaryI]", " ", "\[CurlyPhi]"}]], "+", 
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{"\[ImaginaryI]", " ", 
      RowBox[{"Conjugate", "[", "\[CurlyPhi]", "]"}]}]]}], ")"}], " ", 
  RowBox[{
   TemplateBox[{"A"},
    "Ket"], "**", 
   TemplateBox[{"A"},
    "Bra"]}]}]], "Output",
 CellChangeTimes->{{3.7590577921232867`*^9, 3.759057834962138*^9}},
 CellLabel->"Out[19]=",ExpressionUUID->"5280bf79-3eff-450e-b8b4-9a7a23a3a6ae"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   FractionBox["1", "2"], " ", 
   SuperscriptBox["\[ExponentialE]", 
    RowBox[{
     RowBox[{"-", "\[ImaginaryI]"}], " ", 
     RowBox[{"Conjugate", "[", "\[CurlyPhi]", "]"}]}]], " ", 
   RowBox[{"(", 
    RowBox[{
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{"\[ImaginaryI]", " ", "\[CurlyPhi]"}]], "+", 
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{"\[ImaginaryI]", " ", 
       RowBox[{"Conjugate", "[", "\[CurlyPhi]", "]"}]}]]}], ")"}]}], "//", 
  RowBox[{
   RowBox[{"Simplify", "[", 
    RowBox[{"#", ",", 
     RowBox[{"\[CurlyPhi]", "\[Element]", "Reals"}]}], "]"}], 
   "&"}]}]], "Input",
 CellChangeTimes->{{3.7590578571677113`*^9, 3.7590578617084465`*^9}},
 CellLabel->"In[20]:=",ExpressionUUID->"f9df6cb1-1464-4cae-bfa4-c193ea560db6"],

Cell[BoxData["1"], "Output",
 CellChangeTimes->{3.7590578625856133`*^9},
 CellLabel->"Out[20]=",ExpressionUUID->"8322166b-9108-4aea-b956-337c5196d41c"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Tests", "Section",
 CellChangeTimes->{{3.7602511620676794`*^9, 
  3.760251163249519*^9}},ExpressionUUID->"520d94ba-8d13-4855-b55b-\
c859dc84d32e"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"num", "=", "4"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"wstate", "=", 
  RowBox[{
   FractionBox["1", 
    SqrtBox["num"]], 
   RowBox[{"Total", "[", 
    RowBox[{"Ket", "@@@", 
     RowBox[{"IdentityMatrix", "[", "num", "]"}]}], 
    "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{"ghzstate", "=", 
  RowBox[{
   FractionBox["1", 
    SqrtBox["2"]], 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Ket", "@@", 
      RowBox[{"ConstantArray", "[", 
       RowBox[{"0", ",", "num"}], "]"}]}], "+", 
     RowBox[{"Ket", "@@", 
      RowBox[{"ConstantArray", "[", 
       RowBox[{"1", ",", "num"}], "]"}]}]}], ")"}]}]}]}], "Input",
 CellChangeTimes->{{3.760172516091669*^9, 3.760172573711583*^9}, {
  3.760172713681274*^9, 3.7601727663987684`*^9}},
 CellLabel->"In[14]:=",ExpressionUUID->"6d26bfbd-a111-482e-8536-e4fee0875125"],

Cell[BoxData[
 RowBox[{
  FractionBox["1", "2"], " ", 
  RowBox[{"(", 
   RowBox[{
    TemplateBox[{
      RowBox[{"0", ",", "0", ",", "0", ",", "1"}]},
     "Ket"], "+", 
    TemplateBox[{
      RowBox[{"0", ",", "0", ",", "1", ",", "0"}]},
     "Ket"], "+", 
    TemplateBox[{
      RowBox[{"0", ",", "1", ",", "0", ",", "0"}]},
     "Ket"], "+", 
    TemplateBox[{
      RowBox[{"1", ",", "0", ",", "0", ",", "0"}]},
     "Ket"]}], ")"}]}]], "Output",
 CellChangeTimes->{{3.7601725454082737`*^9, 3.760172574455593*^9}, {
   3.7601727452229385`*^9, 3.760172771836228*^9}, 3.760251170342551*^9},
 CellLabel->"Out[15]=",ExpressionUUID->"af2eddac-ebcb-462c-9df7-8533434b3040"],

Cell[BoxData[
 FractionBox[
  RowBox[{
   TemplateBox[{
     RowBox[{"0", ",", "0", ",", "0", ",", "0"}]},
    "Ket"], "+", 
   TemplateBox[{
     RowBox[{"1", ",", "1", ",", "1", ",", "1"}]},
    "Ket"]}], 
  SqrtBox["2"]]], "Output",
 CellChangeTimes->{{3.7601725454082737`*^9, 3.760172574455593*^9}, {
   3.7601727452229385`*^9, 3.760172771836228*^9}, 3.760251170363495*^9},
 CellLabel->"Out[16]=",ExpressionUUID->"4bc53bc3-daae-40da-8962-657a163badc4"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"wpt4", "=", 
  RowBox[{
   RowBox[{"partTr", "[", 
    RowBox[{"wstate", ",", 
     RowBox[{"{", "4", "}"}]}], "]"}], "//", 
   "Simplify"}]}], "\[IndentingNewLine]", 
 RowBox[{"ghzpt4", "=", 
  RowBox[{
   RowBox[{"partTr", "[", 
    RowBox[{"ghzstate", ",", 
     RowBox[{"{", "4", "}"}]}], "]"}], "//", "Simplify"}]}]}], "Input",
 CellChangeTimes->{{3.7601725767484975`*^9, 3.7601726090740156`*^9}, {
  3.760172789048201*^9, 3.760172795379269*^9}},
 CellLabel->"In[17]:=",ExpressionUUID->"5a44efd1-4dcd-42a2-a300-847704663503"],

Cell[BoxData[
 RowBox[{
  FractionBox["1", "4"], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     TemplateBox[{
       RowBox[{"0", ",", "0", ",", "0"}]},
      "Ket"], "**", 
     TemplateBox[{
       RowBox[{"0", ",", "0", ",", "0"}]},
      "Bra"]}], "+", 
    RowBox[{
     TemplateBox[{
       RowBox[{"0", ",", "0", ",", "1"}]},
      "Ket"], "**", 
     TemplateBox[{
       RowBox[{"0", ",", "0", ",", "1"}]},
      "Bra"]}], "+", 
    RowBox[{
     TemplateBox[{
       RowBox[{"0", ",", "0", ",", "1"}]},
      "Ket"], "**", 
     TemplateBox[{
       RowBox[{"0", ",", "1", ",", "0"}]},
      "Bra"]}], "+", 
    RowBox[{
     TemplateBox[{
       RowBox[{"0", ",", "0", ",", "1"}]},
      "Ket"], "**", 
     TemplateBox[{
       RowBox[{"1", ",", "0", ",", "0"}]},
      "Bra"]}], "+", 
    RowBox[{
     TemplateBox[{
       RowBox[{"0", ",", "1", ",", "0"}]},
      "Ket"], "**", 
     TemplateBox[{
       RowBox[{"0", ",", "0", ",", "1"}]},
      "Bra"]}], "+", 
    RowBox[{
     TemplateBox[{
       RowBox[{"0", ",", "1", ",", "0"}]},
      "Ket"], "**", 
     TemplateBox[{
       RowBox[{"0", ",", "1", ",", "0"}]},
      "Bra"]}], "+", 
    RowBox[{
     TemplateBox[{
       RowBox[{"0", ",", "1", ",", "0"}]},
      "Ket"], "**", 
     TemplateBox[{
       RowBox[{"1", ",", "0", ",", "0"}]},
      "Bra"]}], "+", 
    RowBox[{
     TemplateBox[{
       RowBox[{"1", ",", "0", ",", "0"}]},
      "Ket"], "**", 
     TemplateBox[{
       RowBox[{"0", ",", "0", ",", "1"}]},
      "Bra"]}], "+", 
    RowBox[{
     TemplateBox[{
       RowBox[{"1", ",", "0", ",", "0"}]},
      "Ket"], "**", 
     TemplateBox[{
       RowBox[{"0", ",", "1", ",", "0"}]},
      "Bra"]}], "+", 
    RowBox[{
     TemplateBox[{
       RowBox[{"1", ",", "0", ",", "0"}]},
      "Ket"], "**", 
     TemplateBox[{
       RowBox[{"1", ",", "0", ",", "0"}]},
      "Bra"]}]}], ")"}]}]], "Output",
 CellChangeTimes->{{3.7601725839711466`*^9, 3.760172609517828*^9}, 
   3.7601727962289953`*^9, 3.760251170423335*^9},
 CellLabel->"Out[17]=",ExpressionUUID->"b11bff57-774c-4517-8079-1a923c3b35bb"],

Cell[BoxData[
 RowBox[{
  FractionBox["1", "2"], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     TemplateBox[{
       RowBox[{"0", ",", "0", ",", "0"}]},
      "Ket"], "**", 
     TemplateBox[{
       RowBox[{"0", ",", "0", ",", "0"}]},
      "Bra"]}], "+", 
    RowBox[{
     TemplateBox[{
       RowBox[{"1", ",", "1", ",", "1"}]},
      "Ket"], "**", 
     TemplateBox[{
       RowBox[{"1", ",", "1", ",", "1"}]},
      "Bra"]}]}], ")"}]}]], "Output",
 CellChangeTimes->{{3.7601725839711466`*^9, 3.760172609517828*^9}, 
   3.7601727962289953`*^9, 3.7602511704692116`*^9},
 CellLabel->"Out[18]=",ExpressionUUID->"e5fa728c-0edf-4aa6-8a6f-4191ef7cbe01"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Tr", "[", 
  RowBox[{"wpt4", "**", "wpt4"}], "]"}]], "Input",
 CellChangeTimes->{{3.7601726108053875`*^9, 3.760172627823875*^9}},
 CellLabel->"In[19]:=",ExpressionUUID->"c7a9254d-68ff-4f2a-aafa-5adf567f2180"],

Cell[BoxData[
 RowBox[{"Tr", "[", 
  RowBox[{
   FractionBox["1", "16"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      TemplateBox[{
        RowBox[{"0", ",", "0", ",", "0"}]},
       "Ket"], "**", 
      TemplateBox[{
        RowBox[{"0", ",", "0", ",", "0"}]},
       "Bra"]}], "+", 
     RowBox[{"3", " ", 
      RowBox[{
       TemplateBox[{
         RowBox[{"0", ",", "0", ",", "1"}]},
        "Ket"], "**", 
       TemplateBox[{
         RowBox[{"0", ",", "0", ",", "1"}]},
        "Bra"]}]}], "+", 
     RowBox[{"3", " ", 
      RowBox[{
       TemplateBox[{
         RowBox[{"0", ",", "0", ",", "1"}]},
        "Ket"], "**", 
       TemplateBox[{
         RowBox[{"0", ",", "1", ",", "0"}]},
        "Bra"]}]}], "+", 
     RowBox[{"3", " ", 
      RowBox[{
       TemplateBox[{
         RowBox[{"0", ",", "0", ",", "1"}]},
        "Ket"], "**", 
       TemplateBox[{
         RowBox[{"1", ",", "0", ",", "0"}]},
        "Bra"]}]}], "+", 
     RowBox[{"3", " ", 
      RowBox[{
       TemplateBox[{
         RowBox[{"0", ",", "1", ",", "0"}]},
        "Ket"], "**", 
       TemplateBox[{
         RowBox[{"0", ",", "0", ",", "1"}]},
        "Bra"]}]}], "+", 
     RowBox[{"3", " ", 
      RowBox[{
       TemplateBox[{
         RowBox[{"0", ",", "1", ",", "0"}]},
        "Ket"], "**", 
       TemplateBox[{
         RowBox[{"0", ",", "1", ",", "0"}]},
        "Bra"]}]}], "+", 
     RowBox[{"3", " ", 
      RowBox[{
       TemplateBox[{
         RowBox[{"0", ",", "1", ",", "0"}]},
        "Ket"], "**", 
       TemplateBox[{
         RowBox[{"1", ",", "0", ",", "0"}]},
        "Bra"]}]}], "+", 
     RowBox[{"3", " ", 
      RowBox[{
       TemplateBox[{
         RowBox[{"1", ",", "0", ",", "0"}]},
        "Ket"], "**", 
       TemplateBox[{
         RowBox[{"0", ",", "0", ",", "1"}]},
        "Bra"]}]}], "+", 
     RowBox[{"3", " ", 
      RowBox[{
       TemplateBox[{
         RowBox[{"1", ",", "0", ",", "0"}]},
        "Ket"], "**", 
       TemplateBox[{
         RowBox[{"0", ",", "1", ",", "0"}]},
        "Bra"]}]}], "+", 
     RowBox[{"3", " ", 
      RowBox[{
       TemplateBox[{
         RowBox[{"1", ",", "0", ",", "0"}]},
        "Ket"], "**", 
       TemplateBox[{
         RowBox[{"1", ",", "0", ",", "0"}]},
        "Bra"]}]}]}], ")"}]}], "]"}]], "Output",
 CellChangeTimes->{{3.760172616869169*^9, 3.7601726291593027`*^9}, 
   3.7602511706527214`*^9},
 CellLabel->"Out[19]=",ExpressionUUID->"2dfa2a25-744b-4a60-8715-8834ef624668"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"{", 
   RowBox[{"mat", ",", "bas", ",", "bas2"}], "}"}], "=", 
  RowBox[{"fromKetBra", "[", 
   RowBox[{"wpt4", "**", "wpt4"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.7601726108053875`*^9, 3.7601726842888765`*^9}},
 CellLabel->"In[20]:=",ExpressionUUID->"3a3decbf-6df8-432c-a550-611294734737"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   InterpretationBox[
    RowBox[{
     TagBox["SparseArray",
      "SummaryHead"], "[", 
     DynamicModuleBox[{Typeset`open$$ = False, Typeset`embedState$$ = 
      "Ready"}, 
      TemplateBox[{
        PaneSelectorBox[{False -> GridBox[{{
              PaneBox[
               ButtonBox[
                DynamicBox[
                 FEPrivate`FrontEndResource[
                 "FEBitmaps", "SquarePlusIconMedium"]], 
                ButtonFunction :> (Typeset`open$$ = True), Appearance -> None,
                 Evaluator -> Automatic, Method -> "Preemptive"], 
               Alignment -> {Center, Center}, ImageSize -> 
               Dynamic[{
                 Automatic, 
                  3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                   Magnification])}]], 
              GraphicsBox[
               RasterBox[CompressedData["
1:eJxTTMoPSmVmYGDggGIQ26p8d9wspXP2c4wXbTH/ccX+xSLFx4GrXtmPio+K
UyK+s9vAdeeWF/Y33Jevq5n21v5kRO6/+K/vcYqTas5g8+9gEx/q4T9U3J/r
5D6jf+JF+xtR8SpbUh/ba/+8Ebsg5d2gSw+4xAEsRTji
                "], {{0, 0}, {8, 
                8}}, {0, 1}], AspectRatio -> 1, Axes -> False, Frame -> False,
                FrameLabel -> {None, None}, FrameStyle -> Directive[
                 Opacity[0.5], 
                 Thickness[Tiny], 
                 RGBColor[0.368417, 0.506779, 0.709798]], 
               FrameTicks -> {{None, None}, {None, None}}, GridLinesStyle -> 
               Directive[
                 GrayLevel[0.5, 0.4]], ImageSize -> 
               Dynamic[{
                 Automatic, 
                  3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                   Magnification])}], 
               Method -> {
                "AxisPadding" -> Scaled[0.02], "DefaultBoundaryStyle" -> 
                 Automatic, "DefaultPlotStyle" -> Automatic, "DomainPadding" -> 
                 Scaled[0.02], "RangePadding" -> Scaled[0.05]}], 
              GridBox[{{
                 RowBox[{
                   TagBox[
                   "\"Specified elements: \"", "SummaryItemAnnotation"], 
                   "\[InvisibleSpace]", 
                   TagBox["10", "SummaryItem"]}]}, {
                 RowBox[{
                   TagBox["\"Dimensions: \"", "SummaryItemAnnotation"], 
                   "\[InvisibleSpace]", 
                   TagBox[
                    RowBox[{"{", 
                    RowBox[{"8", ",", "8"}], "}"}], "SummaryItem"]}]}}, 
               GridBoxAlignment -> {
                "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
               False, GridBoxItemSize -> {
                "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
               GridBoxSpacings -> {
                "Columns" -> {{2}}, "Rows" -> {{Automatic}}}, 
               BaseStyle -> {
                ShowStringCharacters -> False, NumberMarks -> False, 
                 PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
            GridBoxAlignment -> {"Rows" -> {{Top}}}, AutoDelete -> False, 
            GridBoxItemSize -> {
             "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
            BaselinePosition -> {1, 1}], True -> GridBox[{{
              PaneBox[
               ButtonBox[
                DynamicBox[
                 FEPrivate`FrontEndResource[
                 "FEBitmaps", "SquareMinusIconMedium"]], 
                ButtonFunction :> (Typeset`open$$ = False), Appearance -> 
                None, Evaluator -> Automatic, Method -> "Preemptive"], 
               Alignment -> {Center, Center}, ImageSize -> 
               Dynamic[{
                 Automatic, 
                  3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                   Magnification])}]], 
              GraphicsBox[
               RasterBox[CompressedData["
1:eJxTTMoPSmVmYGDggGIQ26p8d9wspXP2c4wXbTH/ccX+xSLFx4GrXtmPio+K
UyK+s9vAdeeWF/Y33Jevq5n21v5kRO6/+K/vcYqTas5g8+9gEx/q4T9U3J/r
5D6jf+JF+xtR8SpbUh/ba/+8Ebsg5d2gSw+4xAEsRTji
                "], {{0, 0}, {8, 
                8}}, {0, 1}], AspectRatio -> 1, Axes -> False, Frame -> False,
                FrameLabel -> {None, None}, FrameStyle -> Directive[
                 Opacity[0.5], 
                 Thickness[Tiny], 
                 RGBColor[0.368417, 0.506779, 0.709798]], 
               FrameTicks -> {{None, None}, {None, None}}, GridLinesStyle -> 
               Directive[
                 GrayLevel[0.5, 0.4]], ImageSize -> 
               Dynamic[{
                 Automatic, 
                  3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                   Magnification])}], 
               Method -> {
                "AxisPadding" -> Scaled[0.02], "DefaultBoundaryStyle" -> 
                 Automatic, "DefaultPlotStyle" -> Automatic, "DomainPadding" -> 
                 Scaled[0.02], "RangePadding" -> Scaled[0.05]}], 
              GridBox[{{
                 RowBox[{
                   TagBox[
                   "\"Specified elements: \"", "SummaryItemAnnotation"], 
                   "\[InvisibleSpace]", 
                   TagBox["10", "SummaryItem"]}]}, {
                 RowBox[{
                   TagBox["\"Dimensions: \"", "SummaryItemAnnotation"], 
                   "\[InvisibleSpace]", 
                   TagBox[
                    RowBox[{"{", 
                    RowBox[{"8", ",", "8"}], "}"}], "SummaryItem"]}]}, {
                 RowBox[{
                   TagBox["\"Default: \"", "SummaryItemAnnotation"], 
                   "\[InvisibleSpace]", 
                   TagBox["0", "SummaryItem"]}]}, {
                 RowBox[{
                   TagBox["\"Density: \"", "SummaryItemAnnotation"], 
                   "\[InvisibleSpace]", 
                   TagBox["0.15625`", "SummaryItem"]}]}, {
                 RowBox[{
                   TagBox["\"Elements:\"", "SummaryItemAnnotation"], 
                   "\[InvisibleSpace]", 
                   TagBox["\"\"", "SummaryItem"]}]}, {
                 TagBox[
                  TagBox[
                   GridBox[{{
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"1", ",", "1"}], "}"}], "\[Rule]", 
                    StyleBox[
                    PaneBox[
                    FractionBox["1", "16"], ContentPadding -> False, 
                    FrameMargins -> 0, StripOnInput -> True, BaselinePosition -> 
                    Baseline, ImageSize -> {{1, 300}, Automatic}], 
                    LineBreakWithin -> False]}]}, {
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"2", ",", "2"}], "}"}], "\[Rule]", 
                    StyleBox[
                    PaneBox[
                    FractionBox["3", "16"], ContentPadding -> False, 
                    FrameMargins -> 0, StripOnInput -> True, BaselinePosition -> 
                    Baseline, ImageSize -> {{1, 300}, Automatic}], 
                    LineBreakWithin -> False]}]}, {
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"2", ",", "3"}], "}"}], "\[Rule]", 
                    StyleBox[
                    PaneBox[
                    FractionBox["3", "16"], ContentPadding -> False, 
                    FrameMargins -> 0, StripOnInput -> True, BaselinePosition -> 
                    Baseline, ImageSize -> {{1, 300}, Automatic}], 
                    LineBreakWithin -> False]}]}, {
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"2", ",", "5"}], "}"}], "\[Rule]", 
                    StyleBox[
                    PaneBox[
                    FractionBox["3", "16"], ContentPadding -> False, 
                    FrameMargins -> 0, StripOnInput -> True, BaselinePosition -> 
                    Baseline, ImageSize -> {{1, 300}, Automatic}], 
                    LineBreakWithin -> False]}]}, {
                    ItemBox[
                    "\"\[VerticalEllipsis]\"", Alignment -> Center, 
                    StripOnInput -> False]}}, 
                    GridBoxAlignment -> {"Columns" -> {{Left}}}, 
                    DefaultBaseStyle -> "Column", 
                    GridBoxItemSize -> {
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}], 
                   "Column"], "SummaryItem"]}}, 
               GridBoxAlignment -> {
                "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
               False, GridBoxItemSize -> {
                "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
               GridBoxSpacings -> {
                "Columns" -> {{2}}, "Rows" -> {{Automatic}}}, 
               BaseStyle -> {
                ShowStringCharacters -> False, NumberMarks -> False, 
                 PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
            GridBoxAlignment -> {"Rows" -> {{Top}}}, AutoDelete -> False, 
            GridBoxItemSize -> {
             "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
            BaselinePosition -> {1, 1}]}, 
         Dynamic[Typeset`open$$], ImageSize -> Automatic]},
       "SummaryPanel"],
      DynamicModuleValues:>{}], "]"}],
    SparseArray[
    Automatic, {8, 8}, 0, {
     1, {{0, 1, 4, 7, 7, 10, 10, 10, 10}, {{1}, {2}, {3}, {5}, {2}, {3}, {
       5}, {2}, {3}, {5}}}, {
      Rational[1, 16], Rational[3, 16], Rational[3, 16], Rational[3, 16], 
       Rational[3, 16], Rational[3, 16], Rational[3, 16], Rational[3, 16], 
       Rational[3, 16], Rational[3, 16]}}],
    Editable->False,
    SelectWithContents->True,
    Selectable->False], ",", 
   RowBox[{"{", 
    RowBox[{
     TemplateBox[{
       RowBox[{"0", ",", "0", ",", "0"}]},
      "Ket"], ",", 
     TemplateBox[{
       RowBox[{"0", ",", "0", ",", "1"}]},
      "Ket"], ",", 
     TemplateBox[{
       RowBox[{"0", ",", "1", ",", "0"}]},
      "Ket"], ",", 
     TemplateBox[{
       RowBox[{"0", ",", "1", ",", "1"}]},
      "Ket"], ",", 
     TemplateBox[{
       RowBox[{"1", ",", "0", ",", "0"}]},
      "Ket"], ",", 
     TemplateBox[{
       RowBox[{"1", ",", "0", ",", "1"}]},
      "Ket"], ",", 
     TemplateBox[{
       RowBox[{"1", ",", "1", ",", "0"}]},
      "Ket"], ",", 
     TemplateBox[{
       RowBox[{"1", ",", "1", ",", "1"}]},
      "Ket"]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     TemplateBox[{
       RowBox[{"0", ",", "0", ",", "0"}]},
      "Ket"], ",", 
     TemplateBox[{
       RowBox[{"0", ",", "0", ",", "1"}]},
      "Ket"], ",", 
     TemplateBox[{
       RowBox[{"0", ",", "1", ",", "0"}]},
      "Ket"], ",", 
     TemplateBox[{
       RowBox[{"0", ",", "1", ",", "1"}]},
      "Ket"], ",", 
     TemplateBox[{
       RowBox[{"1", ",", "0", ",", "0"}]},
      "Ket"], ",", 
     TemplateBox[{
       RowBox[{"1", ",", "0", ",", "1"}]},
      "Ket"], ",", 
     TemplateBox[{
       RowBox[{"1", ",", "1", ",", "0"}]},
      "Ket"], ",", 
     TemplateBox[{
       RowBox[{"1", ",", "1", ",", "1"}]},
      "Ket"]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.760172664885763*^9, 3.760172685062807*^9}, 
   3.7602511710237293`*^9},
 CellLabel->"Out[20]=",ExpressionUUID->"18ae1de0-812a-4f2e-8d7f-db5e09995fbb"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"{", 
   RowBox[{"matghz", ",", "bas", ",", "bas2"}], "}"}], "=", 
  RowBox[{"fromKetBra", "[", 
   RowBox[{"ghzpt4", "**", "ghzpt4"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.7601726108053875`*^9, 3.7601726842888765`*^9}, {
  3.7601727790718775`*^9, 3.760172811920035*^9}},
 CellLabel->"In[21]:=",ExpressionUUID->"1e309074-3976-4c27-b712-23974f818b69"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   InterpretationBox[
    RowBox[{
     TagBox["SparseArray",
      "SummaryHead"], "[", 
     DynamicModuleBox[{Typeset`open$$ = False, Typeset`embedState$$ = 
      "Ready"}, 
      TemplateBox[{
        PaneSelectorBox[{False -> GridBox[{{
              PaneBox[
               ButtonBox[
                DynamicBox[
                 FEPrivate`FrontEndResource[
                 "FEBitmaps", "SquarePlusIconMedium"]], 
                ButtonFunction :> (Typeset`open$$ = True), Appearance -> None,
                 Evaluator -> Automatic, Method -> "Preemptive"], 
               Alignment -> {Center, Center}, ImageSize -> 
               Dynamic[{
                 Automatic, 
                  3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                   Magnification])}]], 
              GraphicsBox[
               RasterBox[CompressedData["
1:eJxTTMoPSmVmYGDggGIQ26p8d9wspXP2c4wXbTH/ccX+xSLFx4GrXtkPNvGd
3QauO7e8sL/hvnxdzbS39icjcv/Ff30/6Nw5Kj4qPio+csSHerkEAO1PL68=

                "], {{0, 0}, {8, 8}}, {0, 1}], AspectRatio -> 1, Axes -> 
               False, Frame -> False, FrameLabel -> {None, None}, FrameStyle -> 
               Directive[
                 Opacity[0.5], 
                 Thickness[Tiny], 
                 RGBColor[0.368417, 0.506779, 0.709798]], 
               FrameTicks -> {{None, None}, {None, None}}, GridLinesStyle -> 
               Directive[
                 GrayLevel[0.5, 0.4]], ImageSize -> 
               Dynamic[{
                 Automatic, 
                  3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                   Magnification])}], 
               Method -> {
                "AxisPadding" -> Scaled[0.02], "DefaultBoundaryStyle" -> 
                 Automatic, "DefaultPlotStyle" -> Automatic, "DomainPadding" -> 
                 Scaled[0.02], "RangePadding" -> Scaled[0.05]}], 
              GridBox[{{
                 RowBox[{
                   TagBox[
                   "\"Specified elements: \"", "SummaryItemAnnotation"], 
                   "\[InvisibleSpace]", 
                   TagBox["2", "SummaryItem"]}]}, {
                 RowBox[{
                   TagBox["\"Dimensions: \"", "SummaryItemAnnotation"], 
                   "\[InvisibleSpace]", 
                   TagBox[
                    RowBox[{"{", 
                    RowBox[{"8", ",", "8"}], "}"}], "SummaryItem"]}]}}, 
               GridBoxAlignment -> {
                "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
               False, GridBoxItemSize -> {
                "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
               GridBoxSpacings -> {
                "Columns" -> {{2}}, "Rows" -> {{Automatic}}}, 
               BaseStyle -> {
                ShowStringCharacters -> False, NumberMarks -> False, 
                 PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
            GridBoxAlignment -> {"Rows" -> {{Top}}}, AutoDelete -> False, 
            GridBoxItemSize -> {
             "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
            BaselinePosition -> {1, 1}], True -> GridBox[{{
              PaneBox[
               ButtonBox[
                DynamicBox[
                 FEPrivate`FrontEndResource[
                 "FEBitmaps", "SquareMinusIconMedium"]], 
                ButtonFunction :> (Typeset`open$$ = False), Appearance -> 
                None, Evaluator -> Automatic, Method -> "Preemptive"], 
               Alignment -> {Center, Center}, ImageSize -> 
               Dynamic[{
                 Automatic, 
                  3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                   Magnification])}]], 
              GraphicsBox[
               RasterBox[CompressedData["
1:eJxTTMoPSmVmYGDggGIQ26p8d9wspXP2c4wXbTH/ccX+xSLFx4GrXtkPNvGd
3QauO7e8sL/hvnxdzbS39icjcv/Ff30/6Nw5Kj4qPio+csSHerkEAO1PL68=

                "], {{0, 0}, {8, 8}}, {0, 1}], AspectRatio -> 1, Axes -> 
               False, Frame -> False, FrameLabel -> {None, None}, FrameStyle -> 
               Directive[
                 Opacity[0.5], 
                 Thickness[Tiny], 
                 RGBColor[0.368417, 0.506779, 0.709798]], 
               FrameTicks -> {{None, None}, {None, None}}, GridLinesStyle -> 
               Directive[
                 GrayLevel[0.5, 0.4]], ImageSize -> 
               Dynamic[{
                 Automatic, 
                  3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                   Magnification])}], 
               Method -> {
                "AxisPadding" -> Scaled[0.02], "DefaultBoundaryStyle" -> 
                 Automatic, "DefaultPlotStyle" -> Automatic, "DomainPadding" -> 
                 Scaled[0.02], "RangePadding" -> Scaled[0.05]}], 
              GridBox[{{
                 RowBox[{
                   TagBox[
                   "\"Specified elements: \"", "SummaryItemAnnotation"], 
                   "\[InvisibleSpace]", 
                   TagBox["2", "SummaryItem"]}]}, {
                 RowBox[{
                   TagBox["\"Dimensions: \"", "SummaryItemAnnotation"], 
                   "\[InvisibleSpace]", 
                   TagBox[
                    RowBox[{"{", 
                    RowBox[{"8", ",", "8"}], "}"}], "SummaryItem"]}]}, {
                 RowBox[{
                   TagBox["\"Default: \"", "SummaryItemAnnotation"], 
                   "\[InvisibleSpace]", 
                   TagBox["0", "SummaryItem"]}]}, {
                 RowBox[{
                   TagBox["\"Density: \"", "SummaryItemAnnotation"], 
                   "\[InvisibleSpace]", 
                   TagBox["0.03125`", "SummaryItem"]}]}, {
                 RowBox[{
                   TagBox["\"Elements:\"", "SummaryItemAnnotation"], 
                   "\[InvisibleSpace]", 
                   TagBox["\"\"", "SummaryItem"]}]}, {
                 TagBox[
                  TagBox[
                   GridBox[{{
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"1", ",", "1"}], "}"}], "\[Rule]", 
                    StyleBox[
                    PaneBox[
                    FractionBox["1", "4"], ContentPadding -> False, 
                    FrameMargins -> 0, StripOnInput -> True, BaselinePosition -> 
                    Baseline, ImageSize -> {{1, 300}, Automatic}], 
                    LineBreakWithin -> False]}]}, {
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"8", ",", "8"}], "}"}], "\[Rule]", 
                    StyleBox[
                    PaneBox[
                    FractionBox["1", "4"], ContentPadding -> False, 
                    FrameMargins -> 0, StripOnInput -> True, BaselinePosition -> 
                    Baseline, ImageSize -> {{1, 300}, Automatic}], 
                    LineBreakWithin -> False]}]}}, 
                    GridBoxAlignment -> {"Columns" -> {{Left}}}, 
                    DefaultBaseStyle -> "Column", 
                    GridBoxItemSize -> {
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}], 
                   "Column"], "SummaryItem"]}}, 
               GridBoxAlignment -> {
                "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
               False, GridBoxItemSize -> {
                "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
               GridBoxSpacings -> {
                "Columns" -> {{2}}, "Rows" -> {{Automatic}}}, 
               BaseStyle -> {
                ShowStringCharacters -> False, NumberMarks -> False, 
                 PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
            GridBoxAlignment -> {"Rows" -> {{Top}}}, AutoDelete -> False, 
            GridBoxItemSize -> {
             "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
            BaselinePosition -> {1, 1}]}, 
         Dynamic[Typeset`open$$], ImageSize -> Automatic]},
       "SummaryPanel"],
      DynamicModuleValues:>{}], "]"}],
    SparseArray[
    Automatic, {8, 8}, 0, {
     1, {{0, 1, 1, 1, 1, 1, 1, 1, 2}, {{1}, {8}}}, {
      Rational[1, 4], Rational[1, 4]}}],
    Editable->False,
    SelectWithContents->True,
    Selectable->False], ",", 
   RowBox[{"{", 
    RowBox[{
     TemplateBox[{
       RowBox[{"0", ",", "0", ",", "0"}]},
      "Ket"], ",", 
     TemplateBox[{
       RowBox[{"0", ",", "0", ",", "1"}]},
      "Ket"], ",", 
     TemplateBox[{
       RowBox[{"0", ",", "1", ",", "0"}]},
      "Ket"], ",", 
     TemplateBox[{
       RowBox[{"0", ",", "1", ",", "1"}]},
      "Ket"], ",", 
     TemplateBox[{
       RowBox[{"1", ",", "0", ",", "0"}]},
      "Ket"], ",", 
     TemplateBox[{
       RowBox[{"1", ",", "0", ",", "1"}]},
      "Ket"], ",", 
     TemplateBox[{
       RowBox[{"1", ",", "1", ",", "0"}]},
      "Ket"], ",", 
     TemplateBox[{
       RowBox[{"1", ",", "1", ",", "1"}]},
      "Ket"]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     TemplateBox[{
       RowBox[{"0", ",", "0", ",", "0"}]},
      "Ket"], ",", 
     TemplateBox[{
       RowBox[{"0", ",", "0", ",", "1"}]},
      "Ket"], ",", 
     TemplateBox[{
       RowBox[{"0", ",", "1", ",", "0"}]},
      "Ket"], ",", 
     TemplateBox[{
       RowBox[{"0", ",", "1", ",", "1"}]},
      "Ket"], ",", 
     TemplateBox[{
       RowBox[{"1", ",", "0", ",", "0"}]},
      "Ket"], ",", 
     TemplateBox[{
       RowBox[{"1", ",", "0", ",", "1"}]},
      "Ket"], ",", 
     TemplateBox[{
       RowBox[{"1", ",", "1", ",", "0"}]},
      "Ket"], ",", 
     TemplateBox[{
       RowBox[{"1", ",", "1", ",", "1"}]},
      "Ket"]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.760172812776742*^9, 3.76025117112047*^9},
 CellLabel->"Out[21]=",ExpressionUUID->"cdf7f39a-6c54-45dd-9b0f-d157669384e4"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"mat", "//", "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.760172686959738*^9, 3.760172689046154*^9}},
 CellLabel->"In[22]:=",ExpressionUUID->"a3135a81-0dba-4172-814e-6381150ccff3"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      FractionBox["1", "16"], "0", "0", "0", "0", "0", "0", "0"},
     {"0", 
      FractionBox["3", "16"], 
      FractionBox["3", "16"], "0", 
      FractionBox["3", "16"], "0", "0", "0"},
     {"0", 
      FractionBox["3", "16"], 
      FractionBox["3", "16"], "0", 
      FractionBox["3", "16"], "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", 
      FractionBox["3", "16"], 
      FractionBox["3", "16"], "0", 
      FractionBox["3", "16"], "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[
   SparseArray[
    Automatic, {8, 8}, 0, {
     1, {{0, 1, 4, 7, 7, 10, 10, 10, 10}, {{1}, {2}, {3}, {5}, {2}, {3}, {
       5}, {2}, {3}, {5}}}, {
      Rational[1, 16], Rational[3, 16], Rational[3, 16], Rational[3, 16], 
       Rational[3, 16], Rational[3, 16], Rational[3, 16], Rational[3, 16], 
       Rational[3, 16], Rational[3, 16]}}]]]]], "Output",
 CellChangeTimes->{3.7601726894869757`*^9, 3.7602511712052536`*^9},
 CellLabel->
  "Out[22]//MatrixForm=",ExpressionUUID->"5cc3d608-e906-44dc-bce5-\
9f74c16e4cb7"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"?", "partTr"}]], "Input",
 CellChangeTimes->{{3.760172946343589*^9, 3.760172946687639*^9}},
 CellLabel->"In[23]:=",ExpressionUUID->"a04beb75-c782-471a-b6bf-ae7644516b61"],

Cell[BoxData["\<\"partTr[\\!\\(\\*FormBox[StyleBox[\\\"vec\\\", Italic, \
Rule[StripOnInput, False]], TraditionalForm]\\)_, \
\\!\\(\\*FormBox[StyleBox[\\\"subsp\\\", Italic, Rule[StripOnInput, False]], \
TraditionalForm]\\)_]: Partial trace of expression \\!\\(\\*FormBox[StyleBox[\
\\\"vec\\\", Italic, Rule[StripOnInput, False]], TraditionalForm]\\) \
\[Element] \\!\\(\\*SubscriptBox[\\(\[ScriptCapitalH]\\), \\(1\\)]\\)\
\[TensorProduct]\[Ellipsis]\[TensorProduct]\\!\\(\\*SubscriptBox[\\(\
\[ScriptCapitalH]\\), \\(n\\)]\\) over subspaces \\!\\(\\*SubscriptBox[\\(\
\[ScriptCapitalH]\\), \\(j\\)]\\), where all \
\\!\\(\\*FormBox[StyleBox[\\\"j\\\", Italic, Rule[StripOnInput, False]], \
TraditionalForm]\\)-s are specified by list \
\\!\\(\\*FormBox[StyleBox[\\\"subsp\\\", Italic, Rule[StripOnInput, False]], \
TraditionalForm]\\); \\!\\(\\*FormBox[StyleBox[\\\"vec\\\", Italic, \
Rule[StripOnInput, False]], TraditionalForm]\\) may be a linear combination \
of Kets or Ket**Bras. It is assumed that each character in \
\\!\\(\\*FormBox[StyleBox[\\\"vec\\\", Italic, Rule[StripOnInput, False]], \
TraditionalForm]\\) vector specifications corresponds to a single subsystem. \
Bases of subspaces over which the partial trace is done are identified \
automatically. If some vectors cannot be identified, an error is thrown. \
Indices in \\!\\(\\*FormBox[StyleBox[\\\"subsp\\\", Italic, \
Rule[StripOnInput, False]], TraditionalForm]\\) may also be specified by \
negative numbers. Instead of list \\!\\(\\*FormBox[StyleBox[\\\"subsp\\\", \
Italic, Rule[StripOnInput, False]], TraditionalForm]\\) one may use token \
All, in which case usual trace is performed over all subspaces. NOTE: for \
lin. comb. of \\!\\(\\*FormBox[StyleBox[TemplateBox[List[\\\"k__\\\"], \
\\\"Ket\\\"], Italic, Rule[StripOnInput, False]], TraditionalForm]\\)**\\!\\(\
\\*FormBox[StyleBox[TemplateBox[List[\\\"b__\\\"], \\\"Bra\\\"], Italic, \
Rule[StripOnInput, False]], TraditionalForm]\\), dimension \
\\!\\(\\*FormBox[StyleBox[\\\"dimk\\\", Italic, Rule[StripOnInput, False]], \
TraditionalForm]\\) of \\!\\(\\*FormBox[StyleBox[\\\"k\\\", Italic, \
Rule[StripOnInput, False]], TraditionalForm]\\)-s must be equal for all terms \
(analogously \\!\\(\\*FormBox[StyleBox[\\\"dimb\\\", Italic, \
Rule[StripOnInput, False]], TraditionalForm]\\) for \
\\!\\(\\*FormBox[StyleBox[\\\"b\\\", Italic, Rule[StripOnInput, False]], \
TraditionalForm]\\)-s), but \\!\\(\\*FormBox[StyleBox[\\\"dimk\\\", Italic, \
Rule[StripOnInput, False]], TraditionalForm]\\) does not need to be equal to \
\\!\\(\\*FormBox[StyleBox[\\\"dimb\\\", Italic, Rule[StripOnInput, False]], \
TraditionalForm]\\). In such a case \\!\\(\\*FormBox[StyleBox[\\\"subsp\\\", \
Italic, Rule[StripOnInput, False]], TraditionalForm]\\) must contain indices \
that are valid index specification of list of length \
Min[\\!\\(\\*FormBox[StyleBox[\\\"dimk\\\", Italic, Rule[StripOnInput, \
False]], TraditionalForm]\\),\\!\\(\\*FormBox[StyleBox[\\\"dimb\\\", Italic, \
Rule[StripOnInput, False]], \
TraditionalForm]\\)].\\npartTr[\\!\\(\\*FormBox[StyleBox[\\\"mat\\\", Italic, \
Rule[StripOnInput, False]], TraditionalForm]\\)_, \
\\!\\(\\*FormBox[StyleBox[\\\"subsp\\\", Italic, Rule[StripOnInput, False]], \
TraditionalForm]\\)_,\\!\\(\\*FormBox[StyleBox[\\\"dim\\\", Italic, \
Rule[StripOnInput, False]], TraditionalForm]\\)_]: Partial trace of matrix \
\\!\\(\\*FormBox[StyleBox[\\\"mat\\\", Italic, Rule[StripOnInput, False]], \
TraditionalForm]\\) corresponding to a state of \
\\!\\(\\*FormBox[StyleBox[\\\"dim\\\", Italic, Rule[StripOnInput, False]], \
TraditionalForm]\\)-dimensional subsystems (number of subsystems is derived \
from dimensions of \\!\\(\\*FormBox[StyleBox[\\\"mat\\\", Italic, \
Rule[StripOnInput, False]], TraditionalForm]\\) and dimension(s) \
\\!\\(\\*FormBox[StyleBox[\\\"dim\\\", Italic, Rule[StripOnInput, False]], \
TraditionalForm]\\)). For subsystems with different dimensions, \
\\!\\(\\*FormBox[StyleBox[\\\"dim\\\", Italic, Rule[StripOnInput, False]], \
TraditionalForm]\\) can be input as a list of dimensions. Only for square \
matrices the trace is calculated.\"\>"], "Print", "PrintUsage",
 CellChangeTimes->{3.760251171444604*^9},
 CellTags->
  "Info233760254771-4835498",ExpressionUUID->"961ee33e-fcc2-427e-b1b2-\
b53c27344f63"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"partTr", "[", 
   RowBox[{"mat", ",", 
    RowBox[{"{", "3", "}"}], ",", "2"}], "]"}], "//", "MatrixForm"}]], "Input",\

 CellChangeTimes->{{3.760172925825426*^9, 3.7601729288822536`*^9}, {
  3.7601729607670245`*^9, 3.76017296710005*^9}},
 CellLabel->"In[24]:=",ExpressionUUID->"f3131534-28c3-4a81-a21b-790c247db6f6"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         FractionBox["1", "4"], ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", 
         FractionBox["3", "16"]}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         FractionBox["3", "16"], ",", "0"}], "}"}]}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", 
         FractionBox["3", "16"]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         FractionBox["3", "16"], ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0"}], "}"}]}], "}"}]}], "}"}]}], "}"}]], "Echo",
 CellChangeTimes->{
  3.7602511716690035`*^9},ExpressionUUID->"2439a9b5-51b4-451a-aac2-\
4f8c182f30f2"],

Cell[BoxData["True"], "Echo",
 CellChangeTimes->{
  3.760251171689948*^9},ExpressionUUID->"8743edf1-0cb9-4355-921b-\
f06c45f85b31"]
}, Open  ]],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      FractionBox["1", "4"], "0", "0", "0"},
     {"0", 
      FractionBox["3", "16"], 
      FractionBox["3", "16"], "0"},
     {"0", 
      FractionBox["3", "16"], 
      FractionBox["3", "16"], "0"},
     {"0", "0", "0", "0"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.760172961356411*^9, 3.76017296744413*^9}, 
   3.7602511717587643`*^9},
 CellLabel->
  "Out[24]//MatrixForm=",ExpressionUUID->"173b241b-c0eb-437e-9e09-\
aa784ca8f6e6"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"partTr", "[", 
   RowBox[{"mat", ",", 
    RowBox[{"{", 
     RowBox[{"2", ",", "3"}], "}"}], ",", "2"}], "]"}], "//", 
  "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.760172925825426*^9, 3.7601729288822536`*^9}, {
  3.7601729607670245`*^9, 3.760172972380929*^9}},
 CellLabel->"In[25]:=",ExpressionUUID->"9fd986d3-e645-44cd-961a-3e25deed0706"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     FractionBox["7", "16"], ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", 
     FractionBox["3", "16"]}], "}"}]}], "}"}]], "Echo",
 CellChangeTimes->{
  3.7602511718225927`*^9},ExpressionUUID->"956334bf-0afd-4a74-b22d-\
579b6358fef6"],

Cell[BoxData["True"], "Echo",
 CellChangeTimes->{
  3.7602511718435383`*^9},ExpressionUUID->"2be26b13-112e-4218-92b8-\
d875999a26e2"]
}, Open  ]],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      FractionBox["7", "16"], "0"},
     {"0", 
      FractionBox["3", "16"]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.760172972805792*^9, 3.7602511719033775`*^9},
 CellLabel->
  "Out[25]//MatrixForm=",ExpressionUUID->"2db0d99e-2dc2-4ee1-bc1c-\
4bd7614adf9d"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"partTr", "[", 
   RowBox[{"mat", ",", 
    RowBox[{"{", 
     RowBox[{"1", ",", "2", ",", "3"}], "}"}], ",", "2"}], "]"}], "//", 
  "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.760172925825426*^9, 3.7601729288822536`*^9}, {
  3.7601729607670245`*^9, 3.760172977003566*^9}},
 CellLabel->"In[26]:=",ExpressionUUID->"2e71102b-5b01-4cad-a44b-1723f93e7124"],

Cell[CellGroupData[{

Cell[BoxData[
 FractionBox["5", "8"]], "Echo",
 CellChangeTimes->{
  3.7602511719791737`*^9},ExpressionUUID->"d605eddd-e442-40ce-92c7-\
8aaabf65d5f2"],

Cell[BoxData["False"], "Echo",
 CellChangeTimes->{
  3.7602511719991217`*^9},ExpressionUUID->"fbf78407-6a07-46b9-a2c9-\
41735fab640d"]
}, Open  ]],

Cell[BoxData[
 TagBox[
  FractionBox["5", "8"],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.7601729774214497`*^9, 3.760251172061953*^9},
 CellLabel->
  "Out[26]//MatrixForm=",ExpressionUUID->"44ad3b07-b024-482c-a0dc-\
ff407f0fac74"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"MatrixForm", "/@", 
  RowBox[{"FoldList", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"partTr", "[", 
      RowBox[{"#1", ",", 
       RowBox[{"{", "#2", "}"}], ",", "2"}], "]"}], "&"}], ",", "mat", ",", 
    RowBox[{"Table", "[", 
     RowBox[{"1", ",", "3"}], "]"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.7601729881866693`*^9, 3.7601731457802243`*^9}},
 CellLabel->"In[27]:=",ExpressionUUID->"3c5d6370-d880-486f-b825-6631799f017b"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         FractionBox["1", "4"], ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", 
         FractionBox["3", "16"]}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         FractionBox["3", "16"], ",", "0"}], "}"}]}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", 
         FractionBox["3", "16"]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         FractionBox["3", "16"], ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0"}], "}"}]}], "}"}]}], "}"}]}], "}"}]], "Echo",
 CellChangeTimes->{
  3.760251172122791*^9},ExpressionUUID->"42f5a883-2c47-4d91-9ad0-\
0707fefe7446"],

Cell[BoxData["True"], "Echo",
 CellChangeTimes->{
  3.7602511721427374`*^9},ExpressionUUID->"efda36e3-5bca-42cb-b32f-\
97d50ca86984"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     FractionBox["7", "16"], ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", 
     FractionBox["3", "16"]}], "}"}]}], "}"}]], "Echo",
 CellChangeTimes->{
  3.76025117220557*^9},ExpressionUUID->"6b88b2b6-f52d-4620-bb82-25acd9544231"],

Cell[BoxData["True"], "Echo",
 CellChangeTimes->{
  3.7602511722225237`*^9},ExpressionUUID->"cadf4e5e-1d8d-4c99-a317-\
1a4d083f3cc3"],

Cell[BoxData[
 FractionBox["5", "8"]], "Echo",
 CellChangeTimes->{
  3.760251172285356*^9},ExpressionUUID->"bbd6ad97-2e68-4b13-8670-\
b1974d9484f7"],

Cell[BoxData["False"], "Echo",
 CellChangeTimes->{
  3.760251172304305*^9},ExpressionUUID->"7a1444b5-194a-4ce4-a7a2-\
92336d2e8778"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {
        FractionBox["1", "16"], "0", "0", "0", "0", "0", "0", "0"},
       {"0", 
        FractionBox["3", "16"], 
        FractionBox["3", "16"], "0", 
        FractionBox["3", "16"], "0", "0", "0"},
       {"0", 
        FractionBox["3", "16"], 
        FractionBox["3", "16"], "0", 
        FractionBox["3", "16"], "0", "0", "0"},
       {"0", "0", "0", "0", "0", "0", "0", "0"},
       {"0", 
        FractionBox["3", "16"], 
        FractionBox["3", "16"], "0", 
        FractionBox["3", "16"], "0", "0", "0"},
       {"0", "0", "0", "0", "0", "0", "0", "0"},
       {"0", "0", "0", "0", "0", "0", "0", "0"},
       {"0", "0", "0", "0", "0", "0", "0", "0"}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
        "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[
     SparseArray[
      Automatic, {8, 8}, 0, {
       1, {{0, 1, 4, 7, 7, 10, 10, 10, 10}, {{1}, {2}, {3}, {5}, {2}, {3}, {
         5}, {2}, {3}, {5}}}, {
        Rational[1, 16], Rational[3, 16], Rational[3, 16], Rational[3, 16], 
         Rational[3, 16], Rational[3, 16], Rational[3, 16], Rational[3, 16], 
         Rational[3, 16], Rational[3, 16]}}]]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {
        FractionBox["1", "4"], "0", "0", "0"},
       {"0", 
        FractionBox["3", "16"], 
        FractionBox["3", "16"], "0"},
       {"0", 
        FractionBox["3", "16"], 
        FractionBox["3", "16"], "0"},
       {"0", "0", "0", "0"}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
        "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {
        FractionBox["7", "16"], "0"},
       {"0", 
        FractionBox["3", "16"]}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
        "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], ",", 
   TagBox[
    FractionBox["5", "8"],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]]}], "}"}]], "Output",
 CellChangeTimes->{{3.7601730438009367`*^9, 3.7601731461432514`*^9}, 
   3.760251172356166*^9},
 CellLabel->"Out[27]=",ExpressionUUID->"521b8c35-f658-4521-9137-c54535ff3033"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"SingularValueList", "/@", 
  RowBox[{"FoldList", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"partTr", "[", 
      RowBox[{"#1", ",", 
       RowBox[{"{", "#2", "}"}], ",", "2"}], "]"}], "&"}], ",", "mat", ",", 
    RowBox[{"Table", "[", 
     RowBox[{"1", ",", "3"}], "]"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.7601729881866693`*^9, 3.7601731716101494`*^9}},
 CellLabel->"In[28]:=",ExpressionUUID->"de9cdfb5-3e8d-4ebf-80d8-aa6c5374398d"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         FractionBox["1", "4"], ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", 
         FractionBox["3", "16"]}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         FractionBox["3", "16"], ",", "0"}], "}"}]}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", 
         FractionBox["3", "16"]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         FractionBox["3", "16"], ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0"}], "}"}]}], "}"}]}], "}"}]}], "}"}]], "Echo",
 CellChangeTimes->{
  3.760251172426977*^9},ExpressionUUID->"75aaf2e0-4065-4202-a911-\
6aaa181834ac"],

Cell[BoxData["True"], "Echo",
 CellChangeTimes->{
  3.7602511724459257`*^9},ExpressionUUID->"73d5c72c-e846-4982-8ca3-\
bc231370c692"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     FractionBox["7", "16"], ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", 
     FractionBox["3", "16"]}], "}"}]}], "}"}]], "Echo",
 CellChangeTimes->{
  3.760251172509755*^9},ExpressionUUID->"88b2568f-5695-4574-843a-\
28b34c526574"],

Cell[BoxData["True"], "Echo",
 CellChangeTimes->{
  3.760251172527707*^9},ExpressionUUID->"9cd38dac-e8e8-428e-b4f2-\
531b28245e22"],

Cell[BoxData[
 FractionBox["5", "8"]], "Echo",
 CellChangeTimes->{
  3.760251172587548*^9},ExpressionUUID->"b67242b2-4561-4a33-a20f-\
8c5110daea57"],

Cell[BoxData["False"], "Echo",
 CellChangeTimes->{
  3.760251172603504*^9},ExpressionUUID->"867f7132-c17a-4ffb-a403-\
eea434a758e4"]
}, Open  ]],

Cell[BoxData[
 TemplateBox[{
  "SingularValueList", "matrix", 
   "\"Argument \\!\\(\\*FractionBox[\\\"5\\\", \\\"8\\\"]\\) at position \
\\!\\(\\*RowBox[{\\\"1\\\"}]\\) is not a non-empty rectangular matrix.\"", 2, 
   28, 1, 26199406972372268019, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.760173171989134*^9, 3.7602511726603527`*^9},
 CellLabel->
  "During evaluation of \
In[28]:=",ExpressionUUID->"f08815c3-9249-438a-b638-026a823cafee"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     FractionBox["9", "16"], ",", 
     FractionBox["1", "16"]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     FractionBox["3", "8"], ",", 
     FractionBox["1", "4"]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     FractionBox["7", "16"], ",", 
     FractionBox["3", "16"]}], "}"}], ",", 
   RowBox[{"SingularValueList", "[", 
    FractionBox["5", "8"], "]"}]}], "}"}]], "Output",
 CellChangeTimes->{3.7601731719981112`*^9, 3.760251172718198*^9},
 CellLabel->"Out[28]=",ExpressionUUID->"8242cb60-7ee8-42a8-a5df-9a408d6e6ef6"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"MatrixForm", "/@", 
  RowBox[{"FoldList", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"partTr", "[", 
      RowBox[{"#1", ",", 
       RowBox[{"{", "#2", "}"}], ",", "2"}], "]"}], "&"}], ",", "matghz", ",", 
    RowBox[{"Table", "[", 
     RowBox[{"1", ",", "3"}], "]"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.7601729881866693`*^9, 3.7601731558184185`*^9}},
 CellLabel->"In[29]:=",ExpressionUUID->"82aa54da-9939-461a-92d6-563c42b1aafe"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         FractionBox["1", "4"], ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0"}], "}"}]}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", 
         FractionBox["1", "4"]}], "}"}]}], "}"}]}], "}"}]}], "}"}]], "Echo",
 CellChangeTimes->{
  3.7602511728757763`*^9},ExpressionUUID->"90d02e8d-4851-4d07-b138-\
aa621cb4434b"],

Cell[BoxData["True"], "Echo",
 CellChangeTimes->{
  3.760251172898717*^9},ExpressionUUID->"3b7f6e04-8013-498d-bf13-\
9ffc46898d03"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     FractionBox["1", "4"], ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", 
     FractionBox["1", "4"]}], "}"}]}], "}"}]], "Echo",
 CellChangeTimes->{
  3.7602511729655366`*^9},ExpressionUUID->"20a05933-8a6e-4718-82be-\
883cf080dce3"],

Cell[BoxData["True"], "Echo",
 CellChangeTimes->{
  3.760251172983489*^9},ExpressionUUID->"ddeca3b5-ef4b-4c3d-87ad-\
3b2a2260b2e3"],

Cell[BoxData[
 FractionBox["1", "2"]], "Echo",
 CellChangeTimes->{
  3.7602511730413337`*^9},ExpressionUUID->"275d43b3-c35e-441e-948f-\
9d8c7ddfeed2"],

Cell[BoxData["False"], "Echo",
 CellChangeTimes->{
  3.7602511730592856`*^9},ExpressionUUID->"66eafc11-2268-4628-a293-\
3dd93c2161b8"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {
        FractionBox["1", "4"], "0", "0", "0", "0", "0", "0", "0"},
       {"0", "0", "0", "0", "0", "0", "0", "0"},
       {"0", "0", "0", "0", "0", "0", "0", "0"},
       {"0", "0", "0", "0", "0", "0", "0", "0"},
       {"0", "0", "0", "0", "0", "0", "0", "0"},
       {"0", "0", "0", "0", "0", "0", "0", "0"},
       {"0", "0", "0", "0", "0", "0", "0", "0"},
       {"0", "0", "0", "0", "0", "0", "0", 
        FractionBox["1", "4"]}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
        "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[
     SparseArray[
      Automatic, {8, 8}, 0, {
       1, {{0, 1, 1, 1, 1, 1, 1, 1, 2}, {{1}, {8}}}, {
        Rational[1, 4], Rational[1, 4]}}]]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {
        FractionBox["1", "4"], "0", "0", "0"},
       {"0", "0", "0", "0"},
       {"0", "0", "0", "0"},
       {"0", "0", "0", 
        FractionBox["1", "4"]}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
        "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {
        FractionBox["1", "4"], "0"},
       {"0", 
        FractionBox["1", "4"]}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
        "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], ",", 
   TagBox[
    FractionBox["1", "2"],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]]}], "}"}]], "Output",
 CellChangeTimes->{3.7601731562373104`*^9, 3.7602511731141396`*^9},
 CellLabel->"Out[29]=",ExpressionUUID->"ed93bf6e-b74c-4677-a21a-627675f352a5"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"SingularValueList", "/@", 
  RowBox[{"FoldList", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"partTr", "[", 
      RowBox[{"#1", ",", 
       RowBox[{"{", "#2", "}"}], ",", "2"}], "]"}], "&"}], ",", "matghz", ",", 
    RowBox[{"Table", "[", 
     RowBox[{"1", ",", "3"}], "]"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.7601729881866693`*^9, 3.760173185124008*^9}},
 CellLabel->"In[30]:=",ExpressionUUID->"761b56c6-cce0-498c-bccb-7b2b165c9aef"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         FractionBox["1", "4"], ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0"}], "}"}]}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", 
         FractionBox["1", "4"]}], "}"}]}], "}"}]}], "}"}]}], "}"}]], "Echo",
 CellChangeTimes->{
  3.76025117318495*^9},ExpressionUUID->"9360e7fe-0396-4da5-a2d4-152236bd3680"],

Cell[BoxData["True"], "Echo",
 CellChangeTimes->{
  3.7602511732029014`*^9},ExpressionUUID->"c3427043-fba3-43cb-83e6-\
b23a29e93b85"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     FractionBox["1", "4"], ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", 
     FractionBox["1", "4"]}], "}"}]}], "}"}]], "Echo",
 CellChangeTimes->{
  3.760251173278699*^9},ExpressionUUID->"6bede6b1-e9dc-4164-85bd-\
53f979cc3493"],

Cell[BoxData["True"], "Echo",
 CellChangeTimes->{
  3.760251173297651*^9},ExpressionUUID->"42df802d-fccb-4cbe-9f3d-\
ab8fa628d523"],

Cell[BoxData[
 FractionBox["1", "2"]], "Echo",
 CellChangeTimes->{
  3.7602511733515043`*^9},ExpressionUUID->"8344b37a-993f-4830-a9d1-\
f9e5913c3166"],

Cell[BoxData["False"], "Echo",
 CellChangeTimes->{
  3.7602511733694572`*^9},ExpressionUUID->"28a1c232-d6f1-4efd-90c8-\
c2108edd0855"]
}, Open  ]],

Cell[BoxData[
 TemplateBox[{
  "SingularValueList", "matrix", 
   "\"Argument \\!\\(\\*FractionBox[\\\"1\\\", \\\"2\\\"]\\) at position \
\\!\\(\\*RowBox[{\\\"1\\\"}]\\) is not a non-empty rectangular matrix.\"", 2, 
   30, 2, 26199406972372268019, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.7601731855099764`*^9, 3.7602511734193225`*^9},
 CellLabel->
  "During evaluation of \
In[30]:=",ExpressionUUID->"3fe685d3-e3fc-448f-971d-5af58f411896"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     FractionBox["1", "4"], ",", 
     FractionBox["1", "4"]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     FractionBox["1", "4"], ",", 
     FractionBox["1", "4"]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     FractionBox["1", "4"], ",", 
     FractionBox["1", "4"]}], "}"}], ",", 
   RowBox[{"SingularValueList", "[", 
    FractionBox["1", "2"], "]"}]}], "}"}]], "Output",
 CellChangeTimes->{3.760173185517956*^9, 3.7602511734691896`*^9},
 CellLabel->"Out[30]=",ExpressionUUID->"ffb158b7-f935-40bf-af77-3afadb5a504a"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData["ghzstate"], "Input",
 CellChangeTimes->{{3.760185662532612*^9, 3.760185664275939*^9}},
 CellLabel->"In[31]:=",ExpressionUUID->"62788487-b49c-41e8-a317-b0a1b27ca7ae"],

Cell[BoxData[
 FractionBox[
  RowBox[{
   TemplateBox[{
     RowBox[{"0", ",", "0", ",", "0", ",", "0"}]},
    "Ket"], "+", 
   TemplateBox[{
     RowBox[{"1", ",", "1", ",", "1", ",", "1"}]},
    "Ket"]}], 
  SqrtBox["2"]]], "Output",
 CellChangeTimes->{3.7601856647097807`*^9, 3.7602511735140696`*^9},
 CellLabel->"Out[31]=",ExpressionUUID->"fc54e7c5-ab2f-4f45-ba80-aa8d0fc75102"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"?", "partTr changeBasis"}]], "Input",
 CellChangeTimes->{{3.760185687390127*^9, 3.760185712761278*^9}, 
   3.760186201529661*^9},
 CellLabel->"In[32]:=",ExpressionUUID->"6846f21c-d9e8-4a51-827e-a7ee9059c29f"],

Cell[CellGroupData[{

Cell[BoxData["\<\"partTr[\\!\\(\\*FormBox[StyleBox[\\\"vec\\\", Italic, \
Rule[StripOnInput, False]], TraditionalForm]\\)_, \
\\!\\(\\*FormBox[StyleBox[\\\"subsp\\\", Italic, Rule[StripOnInput, False]], \
TraditionalForm]\\)_]: Partial trace of expression \\!\\(\\*FormBox[StyleBox[\
\\\"vec\\\", Italic, Rule[StripOnInput, False]], TraditionalForm]\\) \
\[Element] \\!\\(\\*SubscriptBox[\\(\[ScriptCapitalH]\\), \\(1\\)]\\)\
\[TensorProduct]\[Ellipsis]\[TensorProduct]\\!\\(\\*SubscriptBox[\\(\
\[ScriptCapitalH]\\), \\(n\\)]\\) over subspaces \\!\\(\\*SubscriptBox[\\(\
\[ScriptCapitalH]\\), \\(j\\)]\\), where all \
\\!\\(\\*FormBox[StyleBox[\\\"j\\\", Italic, Rule[StripOnInput, False]], \
TraditionalForm]\\)-s are specified by list \
\\!\\(\\*FormBox[StyleBox[\\\"subsp\\\", Italic, Rule[StripOnInput, False]], \
TraditionalForm]\\); \\!\\(\\*FormBox[StyleBox[\\\"vec\\\", Italic, \
Rule[StripOnInput, False]], TraditionalForm]\\) may be a linear combination \
of Kets or Ket**Bras. It is assumed that each character in \
\\!\\(\\*FormBox[StyleBox[\\\"vec\\\", Italic, Rule[StripOnInput, False]], \
TraditionalForm]\\) vector specifications corresponds to a single subsystem. \
Bases of subspaces over which the partial trace is done are identified \
automatically. If some vectors cannot be identified, an error is thrown. \
Indices in \\!\\(\\*FormBox[StyleBox[\\\"subsp\\\", Italic, \
Rule[StripOnInput, False]], TraditionalForm]\\) may also be specified by \
negative numbers. Instead of list \\!\\(\\*FormBox[StyleBox[\\\"subsp\\\", \
Italic, Rule[StripOnInput, False]], TraditionalForm]\\) one may use token \
All, in which case usual trace is performed over all subspaces. NOTE: for \
lin. comb. of \\!\\(\\*FormBox[StyleBox[TemplateBox[List[\\\"k__\\\"], \
\\\"Ket\\\"], Italic, Rule[StripOnInput, False]], TraditionalForm]\\)**\\!\\(\
\\*FormBox[StyleBox[TemplateBox[List[\\\"b__\\\"], \\\"Bra\\\"], Italic, \
Rule[StripOnInput, False]], TraditionalForm]\\), dimension \
\\!\\(\\*FormBox[StyleBox[\\\"dimk\\\", Italic, Rule[StripOnInput, False]], \
TraditionalForm]\\) of \\!\\(\\*FormBox[StyleBox[\\\"k\\\", Italic, \
Rule[StripOnInput, False]], TraditionalForm]\\)-s must be equal for all terms \
(analogously \\!\\(\\*FormBox[StyleBox[\\\"dimb\\\", Italic, \
Rule[StripOnInput, False]], TraditionalForm]\\) for \
\\!\\(\\*FormBox[StyleBox[\\\"b\\\", Italic, Rule[StripOnInput, False]], \
TraditionalForm]\\)-s), but \\!\\(\\*FormBox[StyleBox[\\\"dimk\\\", Italic, \
Rule[StripOnInput, False]], TraditionalForm]\\) does not need to be equal to \
\\!\\(\\*FormBox[StyleBox[\\\"dimb\\\", Italic, Rule[StripOnInput, False]], \
TraditionalForm]\\). In such a case \\!\\(\\*FormBox[StyleBox[\\\"subsp\\\", \
Italic, Rule[StripOnInput, False]], TraditionalForm]\\) must contain indices \
that are valid index specification of list of length \
Min[\\!\\(\\*FormBox[StyleBox[\\\"dimk\\\", Italic, Rule[StripOnInput, \
False]], TraditionalForm]\\),\\!\\(\\*FormBox[StyleBox[\\\"dimb\\\", Italic, \
Rule[StripOnInput, False]], \
TraditionalForm]\\)].\\npartTr[\\!\\(\\*FormBox[StyleBox[\\\"mat\\\", Italic, \
Rule[StripOnInput, False]], TraditionalForm]\\)_, \
\\!\\(\\*FormBox[StyleBox[\\\"subsp\\\", Italic, Rule[StripOnInput, False]], \
TraditionalForm]\\)_,\\!\\(\\*FormBox[StyleBox[\\\"dim\\\", Italic, \
Rule[StripOnInput, False]], TraditionalForm]\\)_]: Partial trace of matrix \
\\!\\(\\*FormBox[StyleBox[\\\"mat\\\", Italic, Rule[StripOnInput, False]], \
TraditionalForm]\\) corresponding to a state of \
\\!\\(\\*FormBox[StyleBox[\\\"dim\\\", Italic, Rule[StripOnInput, False]], \
TraditionalForm]\\)-dimensional subsystems (number of subsystems is derived \
from dimensions of \\!\\(\\*FormBox[StyleBox[\\\"mat\\\", Italic, \
Rule[StripOnInput, False]], TraditionalForm]\\) and dimension(s) \
\\!\\(\\*FormBox[StyleBox[\\\"dim\\\", Italic, Rule[StripOnInput, False]], \
TraditionalForm]\\)). For subsystems with different dimensions, \
\\!\\(\\*FormBox[StyleBox[\\\"dim\\\", Italic, Rule[StripOnInput, False]], \
TraditionalForm]\\) can be input as a list of dimensions. Only for square \
matrices the trace is calculated.\"\>"], "Print", "PrintUsage",
 CellChangeTimes->{3.7602511737574186`*^9},
 CellTags->
  "Info323760254773-4835498",ExpressionUUID->"7d7400da-dbe4-465c-8922-\
a95ca0d7e686"],

Cell[BoxData["\<\"changeBasis[\\!\\(\\*FormBox[StyleBox[\\\"expr\\\", Italic, \
Rule[StripOnInput, False]], \
TraditionalForm]\\),\\!\\(\\*FormBox[StyleBox[\\\"frombasis\\\", Italic, \
Rule[StripOnInput, False]], \
TraditionalForm]\\)_String,\\!\\(\\*FormBox[StyleBox[\\\"tobasis\\\", Italic, \
Rule[StripOnInput, False]], \
TraditionalForm]\\)_String,\\!\\(\\*FormBox[StyleBox[\\\"sub\\\", Italic, \
Rule[StripOnInput, False]], TraditionalForm]\\)_:All]: In \
\\!\\(\\*FormBox[StyleBox[\\\"expr\\\", Italic, Rule[StripOnInput, False]], \
TraditionalForm]\\) replace kets from basis \
\\!\\(\\*FormBox[StyleBox[\\\"frombasis\\\", Italic, Rule[StripOnInput, \
False]], TraditionalForm]\\) with their form expressed in basis \
\\!\\(\\*FormBox[StyleBox[\\\"tobasis\\\", Italic, Rule[StripOnInput, \
False]], TraditionalForm]\\). If \\!\\(\\*FormBox[StyleBox[\\\"sub\\\", \
Italic, Rule[StripOnInput, False]], TraditionalForm]\\) is specified, then it \
should be the number of subspace(s) in which the substitution is to be made. \
For instance, \\!\\(\\*FormBox[StyleBox[\\\"sub\\\", Italic, \
Rule[StripOnInput, False]], TraditionalForm]\\)={1,3} means the substitution \
is made only for \\!\\(\\*FormBox[StyleBox[\\\"a1\\\", Italic, \
Rule[StripOnInput, False]], TraditionalForm]\\) and \
\\!\\(\\*FormBox[StyleBox[\\\"a3\\\", Italic, Rule[StripOnInput, False]], \
TraditionalForm]\\) in kets of the form \
\\!\\(\\*FormBox[StyleBox[TemplateBox[List[RowBox[List[\\\"a1\\\", \\\",\\\", \
\\\"a2\\\", \\\",\\\", \\\"a3\\\", \\\",\\\", \\\"etc\\\"]]], \\\"Ket\\\"], \
Italic, Rule[StripOnInput, False]], TraditionalForm]\\).\"\>"], "Print", \
"PrintUsage",
 CellChangeTimes->{3.7602511739528966`*^9},
 CellTags->
  "Info323760254773-4835498",ExpressionUUID->"dc5e0d82-1de6-4ff5-852c-\
380a962f3289"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"onBases", "[", "]"}]], "Input",
 CellChangeTimes->{{3.76018572526285*^9, 3.760185728872196*^9}},
 CellLabel->"In[14]:=",ExpressionUUID->"e1c53419-3d2c-4ff2-b35f-c9c95d4e8dc7"],

Cell[BoxData[
 RowBox[{"\[LeftAssociation]", 
  RowBox[{
   RowBox[{"\<\"Integral\"\>", "\[Rule]", 
    RowBox[{"infiniteBasis", "[", "None", "]"}]}], ",", 
   RowBox[{"\<\"IdentityKet\"\>", "\[Rule]", 
    RowBox[{"{", 
     TemplateBox[{"idket"},
      "Ket"], "}"}]}], ",", 
   RowBox[{"\<\"comp\"\>", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      TemplateBox[{"\"H\""},
       "Ket"], ",", 
      TemplateBox[{"\"V\""},
       "Ket"]}], "}"}]}], ",", 
   RowBox[{"\<\"diag\"\>", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      TemplateBox[{"\"D\""},
       "Ket"], ",", 
      TemplateBox[{"\"A\""},
       "Ket"]}], "}"}]}], ",", 
   RowBox[{"\<\"circ\"\>", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      TemplateBox[{"\"R\""},
       "Ket"], ",", 
      TemplateBox[{"\"L\""},
       "Ket"]}], "}"}]}], ",", 
   RowBox[{"\<\"coco\"\>", "\[Rule]", 
    RowBox[{"infiniteBasis", "[", "g", "]"}]}], ",", 
   RowBox[{"\<\"nono\"\>", "\[Rule]", 
    RowBox[{"infiniteBasis", "[", "\<\"no\"\>", "]"}]}]}], 
  "\[RightAssociation]"}]], "Output",
 CellChangeTimes->{3.76018572963017*^9, 3.7602511741324224`*^9, 
  3.760355423437851*^9},
 CellLabel->"Out[14]=",ExpressionUUID->"be76aeb9-f44d-440c-9924-139b0c995898"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ghzhv", "=", 
  RowBox[{"replaceKet", "[", 
   RowBox[{"ghzstate", ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"Ket", "[", "0", "]"}], "\[Rule]", 
       RowBox[{"Ket", "[", "\"\<H\>\"", "]"}]}], ",", 
      RowBox[{
       RowBox[{"Ket", "[", "1", "]"}], "\[Rule]", 
       RowBox[{"Ket", "[", "\"\<V\>\"", "]"}]}]}], "}"}]}], "]"}]}]], "Input",\

 CellChangeTimes->{{3.760185667271927*^9, 3.760185756167205*^9}},
 CellLabel->"In[15]:=",ExpressionUUID->"5515cc43-8f1e-489a-89e5-587b63add003"],

Cell[BoxData[
 RowBox[{"replaceKet", "[", 
  RowBox[{"ghzstate", ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      TemplateBox[{"0"},
       "Ket"], "\[Rule]", 
      TemplateBox[{"\"H\""},
       "Ket"]}], ",", 
     RowBox[{
      TemplateBox[{"1"},
       "Ket"], "\[Rule]", 
      TemplateBox[{"\"V\""},
       "Ket"]}]}], "}"}]}], "]"}]], "Output",
 CellChangeTimes->{{3.7601857481306996`*^9, 3.7601857566299715`*^9}, 
   3.760251174196245*^9, 3.7603554293171186`*^9},
 CellLabel->"Out[15]=",ExpressionUUID->"f95497fb-ef9e-4c66-bee7-9e4c4fba2824"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"changeBasis", "[", 
   RowBox[{"ghzhv", ",", "\"\<comp\>\"", ",", "\"\<diag\>\""}], "]"}], "//", 
  "Simplify"}]], "Input",
 CellChangeTimes->{{3.7601857576133385`*^9, 3.7601857750138035`*^9}},
 CellLabel->"In[35]:=",ExpressionUUID->"f0c38fd9-344c-4e52-a673-c7822923af5a"],

Cell[BoxData[
 FractionBox[
  RowBox[{
   TemplateBox[{
     RowBox[{"\"A\"", ",", "\"A\"", ",", "\"A\"", ",", "\"A\""}]},
    "Ket"], "+", 
   TemplateBox[{
     RowBox[{"\"A\"", ",", "\"A\"", ",", "\"D\"", ",", "\"D\""}]},
    "Ket"], "+", 
   TemplateBox[{
     RowBox[{"\"A\"", ",", "\"D\"", ",", "\"A\"", ",", "\"D\""}]},
    "Ket"], "+", 
   TemplateBox[{
     RowBox[{"\"A\"", ",", "\"D\"", ",", "\"D\"", ",", "\"A\""}]},
    "Ket"], "+", 
   TemplateBox[{
     RowBox[{"\"D\"", ",", "\"A\"", ",", "\"A\"", ",", "\"D\""}]},
    "Ket"], "+", 
   TemplateBox[{
     RowBox[{"\"D\"", ",", "\"A\"", ",", "\"D\"", ",", "\"A\""}]},
    "Ket"], "+", 
   TemplateBox[{
     RowBox[{"\"D\"", ",", "\"D\"", ",", "\"A\"", ",", "\"A\""}]},
    "Ket"], "+", 
   TemplateBox[{
     RowBox[{"\"D\"", ",", "\"D\"", ",", "\"D\"", ",", "\"D\""}]},
    "Ket"]}], 
  RowBox[{"2", " ", 
   SqrtBox["2"]}]]], "Output",
 CellChangeTimes->{{3.7601857699962225`*^9, 3.760185775531418*^9}, 
   3.7602511742710447`*^9},
 CellLabel->"Out[35]=",ExpressionUUID->"80694c94-fde1-47f9-946e-60adcb1c1a61"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"changeBasis", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Ket", "@@", 
      RowBox[{"Table", "[", 
       RowBox[{"\"\<H\>\"", ",", "3"}], "]"}]}], "+", 
     RowBox[{"Ket", "@@", 
      RowBox[{"Table", "[", 
       RowBox[{"\"\<V\>\"", ",", "3"}], "]"}]}]}], ",", "\"\<comp\>\"", ",", 
    "\"\<diag\>\""}], "]"}], "//", "Simplify"}]], "Input",
 CellChangeTimes->{{3.7601857576133385`*^9, 3.7601858036552444`*^9}},
 CellLabel->"In[36]:=",ExpressionUUID->"b5506f42-47ab-46a7-8bb7-cb7987704196"],

Cell[BoxData[
 FractionBox[
  RowBox[{
   TemplateBox[{
     RowBox[{"\"A\"", ",", "\"A\"", ",", "\"D\""}]},
    "Ket"], "+", 
   TemplateBox[{
     RowBox[{"\"A\"", ",", "\"D\"", ",", "\"A\""}]},
    "Ket"], "+", 
   TemplateBox[{
     RowBox[{"\"D\"", ",", "\"A\"", ",", "\"A\""}]},
    "Ket"], "+", 
   TemplateBox[{
     RowBox[{"\"D\"", ",", "\"D\"", ",", "\"D\""}]},
    "Ket"]}], 
  SqrtBox["2"]]], "Output",
 CellChangeTimes->{3.7601858041040087`*^9, 3.7602511743378663`*^9},
 CellLabel->"Out[36]=",ExpressionUUID->"20d4649d-b1c9-4594-9335-860b456da87f"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"d", "=", "4"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mm", "=", 
   RowBox[{"UpperTriangularize", "[", 
    RowBox[{"ConstantArray", "[", 
     RowBox[{"1", ",", 
      RowBox[{"{", 
       RowBox[{"d", ",", "d"}], "}"}]}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mm", "=", 
   RowBox[{"mm", "~", "Join", "~", 
    RowBox[{"{", 
     RowBox[{"ConstantArray", "[", 
      RowBox[{"0", ",", 
       RowBox[{"{", "d", "}"}]}], "]"}], "}"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"accstate", "=", 
  RowBox[{"Total", "[", 
   RowBox[{"Ket", "@@@", "mm"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"accstate", "=", 
  RowBox[{"replaceKet", "[", 
   RowBox[{"accstate", ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"Ket", "[", "0", "]"}], "\[Rule]", 
       RowBox[{"Ket", "[", "\"\<H\>\"", "]"}]}], ",", 
      RowBox[{
       RowBox[{"Ket", "[", "1", "]"}], "\[Rule]", 
       RowBox[{"Ket", "[", "\"\<V\>\"", "]"}]}]}], "}"}]}], "]"}]}]}], "Input",\

 CellChangeTimes->{{3.7601858418680205`*^9, 3.760185959067607*^9}, {
  3.7601860728709345`*^9, 3.7601860835543623`*^9}, {3.7601861259856815`*^9, 
  3.760186133884556*^9}},
 CellLabel->"In[37]:=",ExpressionUUID->"510896a3-90c4-4b77-8ae3-565ba79667cd"],

Cell[BoxData[
 RowBox[{
  TemplateBox[{
    RowBox[{"0", ",", "0", ",", "0", ",", "0"}]},
   "Ket"], "+", 
  TemplateBox[{
    RowBox[{"0", ",", "0", ",", "0", ",", "1"}]},
   "Ket"], "+", 
  TemplateBox[{
    RowBox[{"0", ",", "0", ",", "1", ",", "1"}]},
   "Ket"], "+", 
  TemplateBox[{
    RowBox[{"0", ",", "1", ",", "1", ",", "1"}]},
   "Ket"], "+", 
  TemplateBox[{
    RowBox[{"1", ",", "1", ",", "1", ",", "1"}]},
   "Ket"]}]], "Output",
 CellChangeTimes->{
  3.7601858818879995`*^9, {3.760185936582734*^9, 3.760185959570261*^9}, 
   3.760186135313737*^9, 3.7602511743967094`*^9},
 CellLabel->"Out[40]=",ExpressionUUID->"39c0a9ad-fa1f-4a94-abb2-56679f53d63c"],

Cell[BoxData[
 RowBox[{
  TemplateBox[{
    RowBox[{"\"H\"", ",", "\"H\"", ",", "\"H\"", ",", "\"H\""}]},
   "Ket"], "+", 
  TemplateBox[{
    RowBox[{"\"H\"", ",", "\"H\"", ",", "\"H\"", ",", "\"V\""}]},
   "Ket"], "+", 
  TemplateBox[{
    RowBox[{"\"H\"", ",", "\"H\"", ",", "\"V\"", ",", "\"V\""}]},
   "Ket"], "+", 
  TemplateBox[{
    RowBox[{"\"H\"", ",", "\"V\"", ",", "\"V\"", ",", "\"V\""}]},
   "Ket"], "+", 
  TemplateBox[{
    RowBox[{"\"V\"", ",", "\"V\"", ",", "\"V\"", ",", "\"V\""}]},
   "Ket"]}]], "Output",
 CellChangeTimes->{
  3.7601858818879995`*^9, {3.760185936582734*^9, 3.760185959570261*^9}, 
   3.760186135313737*^9, 3.7602511744116683`*^9},
 CellLabel->"Out[41]=",ExpressionUUID->"c3e92a26-90d9-48d3-8184-c7148a4c6072"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"{", 
    RowBox[{"mat", ",", "inb", ",", "outb"}], "}"}],
   FontSize->14], 
  StyleBox["=",
   FontSize->14], 
  RowBox[{"fromKetBra", "[", 
   RowBox[{"accstate", "**", 
    RowBox[{"(", 
     RowBox[{"accstate", "\[ConjugateTranspose]"}], ")"}]}], "]"}]}]], "Input",\

 CellChangeTimes->{{3.7601859850870647`*^9, 3.760186037064725*^9}},
 CellLabel->"In[42]:=",ExpressionUUID->"f40d1508-f131-4a64-aeea-b6a14ec58916"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   InterpretationBox[
    RowBox[{
     TagBox["SparseArray",
      "SummaryHead"], "[", 
     DynamicModuleBox[{Typeset`open$$ = False, Typeset`embedState$$ = 
      "Ready"}, 
      TemplateBox[{
        PaneSelectorBox[{False -> GridBox[{{
              PaneBox[
               ButtonBox[
                DynamicBox[
                 FEPrivate`FrontEndResource[
                 "FEBitmaps", "SquarePlusIconMedium"]], 
                ButtonFunction :> (Typeset`open$$ = True), Appearance -> None,
                 Evaluator -> Automatic, Method -> "Preemptive"], 
               Alignment -> {Center, Center}, ImageSize -> 
               Dynamic[{
                 Automatic, 
                  3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                   Magnification])}]], 
              GraphicsBox[
               RasterBox[CompressedData["
1:eJxTTMoPSmVmYGAQgGIQe2e3gevOLS/sb7gvX1cz7a39yYjcf/Ff39vjErcq
3x03S+mc/RzjRVvMf1yxf7FI8XHgqlckqydVnNbm01p8qLt/VHxUfFR8VHxU
fFR8VHxUfFR8eIiPtv9H2/+j4qPio+IjU3y0/B8t/0ey+Gj6H5zhPBr+9Al/
AOaX0P0=
                "], {{0, 0}, {16, 16}}, {0, 1}], AspectRatio -> 1, 
               Axes -> False, Frame -> False, FrameLabel -> {None, None}, 
               FrameStyle -> Directive[
                 Opacity[0.5], 
                 Thickness[Tiny], 
                 RGBColor[0.368417, 0.506779, 0.709798]], 
               FrameTicks -> {{None, None}, {None, None}}, GridLinesStyle -> 
               Directive[
                 GrayLevel[0.5, 0.4]], ImageSize -> 
               Dynamic[{
                 Automatic, 
                  3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                   Magnification])}], 
               Method -> {
                "AxisPadding" -> Scaled[0.02], "DefaultBoundaryStyle" -> 
                 Automatic, "DefaultPlotStyle" -> Automatic, "DomainPadding" -> 
                 Scaled[0.02], "RangePadding" -> Scaled[0.05]}], 
              GridBox[{{
                 RowBox[{
                   TagBox[
                   "\"Specified elements: \"", "SummaryItemAnnotation"], 
                   "\[InvisibleSpace]", 
                   TagBox["25", "SummaryItem"]}]}, {
                 RowBox[{
                   TagBox["\"Dimensions: \"", "SummaryItemAnnotation"], 
                   "\[InvisibleSpace]", 
                   TagBox[
                    RowBox[{"{", 
                    RowBox[{"16", ",", "16"}], "}"}], "SummaryItem"]}]}}, 
               GridBoxAlignment -> {
                "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
               False, GridBoxItemSize -> {
                "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
               GridBoxSpacings -> {
                "Columns" -> {{2}}, "Rows" -> {{Automatic}}}, 
               BaseStyle -> {
                ShowStringCharacters -> False, NumberMarks -> False, 
                 PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
            GridBoxAlignment -> {"Rows" -> {{Top}}}, AutoDelete -> False, 
            GridBoxItemSize -> {
             "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
            BaselinePosition -> {1, 1}], True -> GridBox[{{
              PaneBox[
               ButtonBox[
                DynamicBox[
                 FEPrivate`FrontEndResource[
                 "FEBitmaps", "SquareMinusIconMedium"]], 
                ButtonFunction :> (Typeset`open$$ = False), Appearance -> 
                None, Evaluator -> Automatic, Method -> "Preemptive"], 
               Alignment -> {Center, Center}, ImageSize -> 
               Dynamic[{
                 Automatic, 
                  3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                   Magnification])}]], 
              GraphicsBox[
               RasterBox[CompressedData["
1:eJxTTMoPSmVmYGAQgGIQe2e3gevOLS/sb7gvX1cz7a39yYjcf/Ff39vjErcq
3x03S+mc/RzjRVvMf1yxf7FI8XHgqlckqydVnNbm01p8qLt/VHxUfFR8VHxU
fFR8VHxUfFR8eIiPtv9H2/+j4qPio+IjU3y0/B8t/0ey+Gj6H5zhPBr+9Al/
AOaX0P0=
                "], {{0, 0}, {16, 16}}, {0, 1}], AspectRatio -> 1, 
               Axes -> False, Frame -> False, FrameLabel -> {None, None}, 
               FrameStyle -> Directive[
                 Opacity[0.5], 
                 Thickness[Tiny], 
                 RGBColor[0.368417, 0.506779, 0.709798]], 
               FrameTicks -> {{None, None}, {None, None}}, GridLinesStyle -> 
               Directive[
                 GrayLevel[0.5, 0.4]], ImageSize -> 
               Dynamic[{
                 Automatic, 
                  3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                   Magnification])}], 
               Method -> {
                "AxisPadding" -> Scaled[0.02], "DefaultBoundaryStyle" -> 
                 Automatic, "DefaultPlotStyle" -> Automatic, "DomainPadding" -> 
                 Scaled[0.02], "RangePadding" -> Scaled[0.05]}], 
              GridBox[{{
                 RowBox[{
                   TagBox[
                   "\"Specified elements: \"", "SummaryItemAnnotation"], 
                   "\[InvisibleSpace]", 
                   TagBox["25", "SummaryItem"]}]}, {
                 RowBox[{
                   TagBox["\"Dimensions: \"", "SummaryItemAnnotation"], 
                   "\[InvisibleSpace]", 
                   TagBox[
                    RowBox[{"{", 
                    RowBox[{"16", ",", "16"}], "}"}], "SummaryItem"]}]}, {
                 RowBox[{
                   TagBox["\"Default: \"", "SummaryItemAnnotation"], 
                   "\[InvisibleSpace]", 
                   TagBox["0", "SummaryItem"]}]}, {
                 RowBox[{
                   TagBox["\"Density: \"", "SummaryItemAnnotation"], 
                   "\[InvisibleSpace]", 
                   TagBox["0.09765625`", "SummaryItem"]}]}, {
                 RowBox[{
                   TagBox["\"Elements:\"", "SummaryItemAnnotation"], 
                   "\[InvisibleSpace]", 
                   TagBox["\"\"", "SummaryItem"]}]}, {
                 TagBox[
                  TagBox[
                   GridBox[{{
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"1", ",", "1"}], "}"}], "\[Rule]", 
                    StyleBox[
                    PaneBox[
                    "1", ContentPadding -> False, FrameMargins -> 0, 
                    StripOnInput -> True, BaselinePosition -> Baseline, 
                    ImageSize -> {{1, 300}, Automatic}], LineBreakWithin -> 
                    False]}]}, {
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"1", ",", "2"}], "}"}], "\[Rule]", 
                    StyleBox[
                    PaneBox[
                    "1", ContentPadding -> False, FrameMargins -> 0, 
                    StripOnInput -> True, BaselinePosition -> Baseline, 
                    ImageSize -> {{1, 300}, Automatic}], LineBreakWithin -> 
                    False]}]}, {
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"1", ",", "4"}], "}"}], "\[Rule]", 
                    StyleBox[
                    PaneBox[
                    "1", ContentPadding -> False, FrameMargins -> 0, 
                    StripOnInput -> True, BaselinePosition -> Baseline, 
                    ImageSize -> {{1, 300}, Automatic}], LineBreakWithin -> 
                    False]}]}, {
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"1", ",", "8"}], "}"}], "\[Rule]", 
                    StyleBox[
                    PaneBox[
                    "1", ContentPadding -> False, FrameMargins -> 0, 
                    StripOnInput -> True, BaselinePosition -> Baseline, 
                    ImageSize -> {{1, 300}, Automatic}], LineBreakWithin -> 
                    False]}]}, {
                    ItemBox[
                    "\"\[VerticalEllipsis]\"", Alignment -> Center, 
                    StripOnInput -> False]}}, 
                    GridBoxAlignment -> {"Columns" -> {{Left}}}, 
                    DefaultBaseStyle -> "Column", 
                    GridBoxItemSize -> {
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}], 
                   "Column"], "SummaryItem"]}}, 
               GridBoxAlignment -> {
                "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
               False, GridBoxItemSize -> {
                "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
               GridBoxSpacings -> {
                "Columns" -> {{2}}, "Rows" -> {{Automatic}}}, 
               BaseStyle -> {
                ShowStringCharacters -> False, NumberMarks -> False, 
                 PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
            GridBoxAlignment -> {"Rows" -> {{Top}}}, AutoDelete -> False, 
            GridBoxItemSize -> {
             "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
            BaselinePosition -> {1, 1}]}, 
         Dynamic[Typeset`open$$], ImageSize -> Automatic]},
       "SummaryPanel"],
      DynamicModuleValues:>{}], "]"}],
    SparseArray[
    Automatic, {16, 16}, 0, {
     1, {{0, 5, 10, 10, 15, 15, 15, 15, 20, 20, 20, 20, 20, 20, 20, 20, 
       25}, {{1}, {2}, {4}, {8}, {16}, {1}, {2}, {4}, {8}, {16}, {1}, {2}, {
       4}, {8}, {16}, {1}, {2}, {4}, {8}, {16}, {1}, {2}, {4}, {8}, {16}}}, {
      1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 
      1}}],
    Editable->False,
    SelectWithContents->True,
    Selectable->False], ",", 
   RowBox[{"{", 
    RowBox[{
     TemplateBox[{
       RowBox[{"\"H\"", ",", "\"H\"", ",", "\"H\"", ",", "\"H\""}]},
      "Ket"], ",", 
     TemplateBox[{
       RowBox[{"\"H\"", ",", "\"H\"", ",", "\"H\"", ",", "\"V\""}]},
      "Ket"], ",", 
     TemplateBox[{
       RowBox[{"\"H\"", ",", "\"H\"", ",", "\"V\"", ",", "\"H\""}]},
      "Ket"], ",", 
     TemplateBox[{
       RowBox[{"\"H\"", ",", "\"H\"", ",", "\"V\"", ",", "\"V\""}]},
      "Ket"], ",", 
     TemplateBox[{
       RowBox[{"\"H\"", ",", "\"V\"", ",", "\"H\"", ",", "\"H\""}]},
      "Ket"], ",", 
     TemplateBox[{
       RowBox[{"\"H\"", ",", "\"V\"", ",", "\"H\"", ",", "\"V\""}]},
      "Ket"], ",", 
     TemplateBox[{
       RowBox[{"\"H\"", ",", "\"V\"", ",", "\"V\"", ",", "\"H\""}]},
      "Ket"], ",", 
     TemplateBox[{
       RowBox[{"\"H\"", ",", "\"V\"", ",", "\"V\"", ",", "\"V\""}]},
      "Ket"], ",", 
     TemplateBox[{
       RowBox[{"\"V\"", ",", "\"H\"", ",", "\"H\"", ",", "\"H\""}]},
      "Ket"], ",", 
     TemplateBox[{
       RowBox[{"\"V\"", ",", "\"H\"", ",", "\"H\"", ",", "\"V\""}]},
      "Ket"], ",", 
     TemplateBox[{
       RowBox[{"\"V\"", ",", "\"H\"", ",", "\"V\"", ",", "\"H\""}]},
      "Ket"], ",", 
     TemplateBox[{
       RowBox[{"\"V\"", ",", "\"H\"", ",", "\"V\"", ",", "\"V\""}]},
      "Ket"], ",", 
     TemplateBox[{
       RowBox[{"\"V\"", ",", "\"V\"", ",", "\"H\"", ",", "\"H\""}]},
      "Ket"], ",", 
     TemplateBox[{
       RowBox[{"\"V\"", ",", "\"V\"", ",", "\"H\"", ",", "\"V\""}]},
      "Ket"], ",", 
     TemplateBox[{
       RowBox[{"\"V\"", ",", "\"V\"", ",", "\"V\"", ",", "\"H\""}]},
      "Ket"], ",", 
     TemplateBox[{
       RowBox[{"\"V\"", ",", "\"V\"", ",", "\"V\"", ",", "\"V\""}]},
      "Ket"]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     TemplateBox[{
       RowBox[{"\"H\"", ",", "\"H\"", ",", "\"H\"", ",", "\"H\""}]},
      "Ket"], ",", 
     TemplateBox[{
       RowBox[{"\"H\"", ",", "\"H\"", ",", "\"H\"", ",", "\"V\""}]},
      "Ket"], ",", 
     TemplateBox[{
       RowBox[{"\"H\"", ",", "\"H\"", ",", "\"V\"", ",", "\"H\""}]},
      "Ket"], ",", 
     TemplateBox[{
       RowBox[{"\"H\"", ",", "\"H\"", ",", "\"V\"", ",", "\"V\""}]},
      "Ket"], ",", 
     TemplateBox[{
       RowBox[{"\"H\"", ",", "\"V\"", ",", "\"H\"", ",", "\"H\""}]},
      "Ket"], ",", 
     TemplateBox[{
       RowBox[{"\"H\"", ",", "\"V\"", ",", "\"H\"", ",", "\"V\""}]},
      "Ket"], ",", 
     TemplateBox[{
       RowBox[{"\"H\"", ",", "\"V\"", ",", "\"V\"", ",", "\"H\""}]},
      "Ket"], ",", 
     TemplateBox[{
       RowBox[{"\"H\"", ",", "\"V\"", ",", "\"V\"", ",", "\"V\""}]},
      "Ket"], ",", 
     TemplateBox[{
       RowBox[{"\"V\"", ",", "\"H\"", ",", "\"H\"", ",", "\"H\""}]},
      "Ket"], ",", 
     TemplateBox[{
       RowBox[{"\"V\"", ",", "\"H\"", ",", "\"H\"", ",", "\"V\""}]},
      "Ket"], ",", 
     TemplateBox[{
       RowBox[{"\"V\"", ",", "\"H\"", ",", "\"V\"", ",", "\"H\""}]},
      "Ket"], ",", 
     TemplateBox[{
       RowBox[{"\"V\"", ",", "\"H\"", ",", "\"V\"", ",", "\"V\""}]},
      "Ket"], ",", 
     TemplateBox[{
       RowBox[{"\"V\"", ",", "\"V\"", ",", "\"H\"", ",", "\"H\""}]},
      "Ket"], ",", 
     TemplateBox[{
       RowBox[{"\"V\"", ",", "\"V\"", ",", "\"H\"", ",", "\"V\""}]},
      "Ket"], ",", 
     TemplateBox[{
       RowBox[{"\"V\"", ",", "\"V\"", ",", "\"V\"", ",", "\"H\""}]},
      "Ket"], ",", 
     TemplateBox[{
       RowBox[{"\"V\"", ",", "\"V\"", ",", "\"V\"", ",", "\"V\""}]},
      "Ket"]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.760186018899601*^9, 3.7601860380879507`*^9}, 
   3.760186139127536*^9, 3.76018616944147*^9, 3.7601862225145416`*^9, 
   3.760251174614128*^9},
 CellLabel->"Out[42]=",ExpressionUUID->"a5eec27b-c7d6-4444-9677-4c97795a12f2"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Normal", "@", "mat", 
  RowBox[{"(*", 
   RowBox[{"MatrixPlot", "[", "mat", "]"}], "*)"}]}]], "Input",
 CellChangeTimes->{{3.7601860444080477`*^9, 3.7601860517424335`*^9}, {
  3.7601862281444855`*^9, 3.760186235714246*^9}},
 CellLabel->"In[43]:=",ExpressionUUID->"7c8fc40d-88c1-490e-a817-af4d86624f0b"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
    "1", ",", "1", ",", "0", ",", "1", ",", "0", ",", "0", ",", "0", ",", "1",
      ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
     ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "1", ",", "1", ",", "0", ",", "1", ",", "0", ",", "0", ",", "0", ",", "1",
      ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
     ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0",
      ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
     ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "1", ",", "1", ",", "0", ",", "1", ",", "0", ",", "0", ",", "0", ",", "1",
      ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
     ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0",
      ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
     ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0",
      ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
     ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0",
      ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
     ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "1", ",", "1", ",", "0", ",", "1", ",", "0", ",", "0", ",", "0", ",", "1",
      ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
     ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0",
      ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
     ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0",
      ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
     ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0",
      ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
     ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0",
      ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
     ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0",
      ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
     ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0",
      ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
     ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0",
      ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
     ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "1", ",", "1", ",", "0", ",", "1", ",", "0", ",", "0", ",", "0", ",", "1",
      ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
     ",", "1"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.760186047483824*^9, 3.760186052294973*^9}, 
   3.7601861705594916`*^9, {3.7601862240873365`*^9, 3.760186236081261*^9}, 
   3.760193404631922*^9, 3.7602511747607355`*^9},
 CellLabel->"Out[43]=",ExpressionUUID->"d7170d14-7ec1-40ea-b990-546efee4bced"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"mat", "=", 
   RowBox[{"Normal", "@", "mat"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.760193410928266*^9, 3.7601934156145334`*^9}},
 CellLabel->"In[44]:=",ExpressionUUID->"6c3f02ea-5ab8-4dec-b39e-12e9dd575fbd"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"partTr", "[", 
  RowBox[{"mat", ",", 
   RowBox[{"{", "1", "}"}], ",", "4"}], "]"}]], "Input",
 CellChangeTimes->{{3.7601860605997477`*^9, 3.760186062033923*^9}, {
  3.760186174595688*^9, 3.760186183009187*^9}, {3.76018624946351*^9, 
  3.760186265503579*^9}},
 CellLabel->"In[45]:=",ExpressionUUID->"e8b27249-494d-4882-aeb4-6b67fd3265ee"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"1", ",", "1", ",", "0", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "1", ",", "0", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "1", ",", "0", ",", "3"}], "}"}]}], "}"}]], "Echo",
 CellChangeTimes->{
  3.7602511748534875`*^9},ExpressionUUID->"2d9d67f1-9791-4a0f-9a7b-\
23bf971a8e8a"],

Cell[BoxData["True"], "Echo",
 CellChangeTimes->{
  3.7602511748764267`*^9},ExpressionUUID->"0119d8c5-a99e-4d2b-be04-\
17253e55c677"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"1", ",", "1", ",", "0", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "1", ",", "0", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "1", ",", "0", ",", "3"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.7601862658506513`*^9, {3.760193310760922*^9, 3.7601933355797663`*^9}, {
   3.760193417451929*^9, 3.7601934649945755`*^9}, 3.7602511749452424`*^9},
 CellLabel->"Out[45]=",ExpressionUUID->"8213f156-fb7a-48dc-ac81-4383b1460ad3"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"res", "=", 
  RowBox[{"partTr", "[", 
   RowBox[{"mat", ",", 
    RowBox[{"{", "1", "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"2", ",", "2", ",", "2", ",", "2"}], "}"}]}], "]"}], 
  RowBox[{"(*", 
   RowBox[{"//", "ArrayQ"}], "*)"}]}]], "Input",
 CellChangeTimes->{{3.7601860605997477`*^9, 3.760186062033923*^9}, {
   3.760186174595688*^9, 3.760186183009187*^9}, {3.76018624946351*^9, 
   3.760186265503579*^9}, {3.760193323956053*^9, 3.7601933277985773`*^9}, {
   3.760193370882146*^9, 3.7601933853185415`*^9}, 3.7601934228592296`*^9, {
   3.7602514668715696`*^9, 3.760251467657509*^9}},
 CellLabel->"In[78]:=",ExpressionUUID->"2a4c2acb-de8a-4aaa-85f1-05978b9918cb"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"1", ",", "1"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"1", ",", "1"}], "}"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0", ",", "1"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "1"}], "}"}]}], "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"1", ",", "1"}], "}"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "1"}], "}"}]}], "}"}]}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0"}], "}"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0", ",", "1"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "1"}], "}"}]}], "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0"}], "}"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "1"}], "}"}]}], "}"}]}], "}"}]}], "}"}]}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0"}], "}"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0"}], "}"}]}], "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"1", ",", "1"}], "}"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "1"}], "}"}]}], "}"}]}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0"}], "}"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0"}], "}"}]}], "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0"}], "}"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "2"}], "}"}]}], "}"}]}], "}"}]}], "}"}]}], 
    "}"}]}], "}"}]], "Echo",
 CellChangeTimes->{
  3.760251468416438*^9},ExpressionUUID->"5e03dc00-fe06-4d29-befa-\
30d74dda9c82"],

Cell[BoxData["True"], "Echo",
 CellChangeTimes->{
  3.760251468440376*^9},ExpressionUUID->"b3ffc202-289f-4fa7-a437-\
4c3b085fa11d"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"1", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"1", ",", "1"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "1"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "1"}], "}"}]}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"1", ",", "1"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "1"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "1"}], "}"}]}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0"}], "}"}]}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"1", ",", "1"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "1"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "2"}], "}"}]}], "}"}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.7601933285722914`*^9, {3.760193373482192*^9, 3.76019338572645*^9}, {
   3.760193418766094*^9, 3.760193467671312*^9}, 3.7602511750948424`*^9, 
   3.7602514685121837`*^9},
 CellLabel->"Out[78]=",ExpressionUUID->"6ff0ff8a-19bf-4d7f-aa08-858a327b01b1"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"res", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"1", ",", "1"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"1", ",", "1"}], "}"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"0", ",", "1"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "1"}], "}"}]}], "}"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"0", ",", "0"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"1", ",", "1"}], "}"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"0", ",", "0"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "1"}], "}"}]}], "}"}]}], "}"}]}], "}"}], ",", 
       
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"0", ",", "0"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "0"}], "}"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"0", ",", "1"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "1"}], "}"}]}], "}"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"0", ",", "0"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "0"}], "}"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"0", ",", "0"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "1"}], "}"}]}], "}"}]}], "}"}]}], "}"}]}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"0", ",", "0"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "0"}], "}"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"0", ",", "0"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "0"}], "}"}]}], "}"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"0", ",", "0"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"1", ",", "1"}], "}"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"0", ",", "0"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "1"}], "}"}]}], "}"}]}], "}"}]}], "}"}], ",", 
       
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"0", ",", "0"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "0"}], "}"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"0", ",", "0"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "0"}], "}"}]}], "}"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"0", ",", "0"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "0"}], "}"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"0", ",", "0"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "2"}], "}"}]}], "}"}]}], "}"}]}], "}"}]}], 
      "}"}]}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.7602515011020308`*^9, 3.760251502478366*^9}},
 CellLabel->"In[83]:=",ExpressionUUID->"5f4dc000-3adb-4fa4-bed0-7a8c0316949f"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"ArrayFlatten", "[", 
   RowBox[{"res", ",", "1"}], "]"}], "//", "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.7602512996457663`*^9, 3.760251350578562*^9}, {
  3.7602514598862514`*^9, 3.7602514609913*^9}, {3.760251507127917*^9, 
  3.760251523588896*^9}},
 CellLabel->"In[91]:=",ExpressionUUID->"c442eb5f-9d92-46eb-a171-f13a4669da14"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{"(", "\[NoBreak]", GridBox[{
         {
          RowBox[{"(", "\[NoBreak]", 
           TagBox[GridBox[{
              {"1"},
              {"1"}
             },
             
             GridBoxAlignment->{
              "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
               "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
             GridBoxSpacings->{"Columns" -> {
                 Offset[0.27999999999999997`], {
                  Offset[0.5599999999999999]}, 
                 Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
               "Rows" -> {
                 Offset[0.2], {
                  Offset[0.4]}, 
                 Offset[0.2]}, "RowsIndexed" -> {}}],
            Column], "\[NoBreak]", ")"}], 
          RowBox[{"(", "\[NoBreak]", 
           TagBox[GridBox[{
              {"1"},
              {"1"}
             },
             
             GridBoxAlignment->{
              "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
               "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
             GridBoxSpacings->{"Columns" -> {
                 Offset[0.27999999999999997`], {
                  Offset[0.5599999999999999]}, 
                 Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
               "Rows" -> {
                 Offset[0.2], {
                  Offset[0.4]}, 
                 Offset[0.2]}, "RowsIndexed" -> {}}],
            Column], "\[NoBreak]", ")"}]},
         {
          RowBox[{"(", "\[NoBreak]", 
           TagBox[GridBox[{
              {"0"},
              {"1"}
             },
             
             GridBoxAlignment->{
              "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
               "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
             GridBoxSpacings->{"Columns" -> {
                 Offset[0.27999999999999997`], {
                  Offset[0.5599999999999999]}, 
                 Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
               "Rows" -> {
                 Offset[0.2], {
                  Offset[0.4]}, 
                 Offset[0.2]}, "RowsIndexed" -> {}}],
            Column], "\[NoBreak]", ")"}], 
          RowBox[{"(", "\[NoBreak]", 
           TagBox[GridBox[{
              {"0"},
              {"1"}
             },
             
             GridBoxAlignment->{
              "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
               "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
             GridBoxSpacings->{"Columns" -> {
                 Offset[0.27999999999999997`], {
                  Offset[0.5599999999999999]}, 
                 Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
               "Rows" -> {
                 Offset[0.2], {
                  Offset[0.4]}, 
                 Offset[0.2]}, "RowsIndexed" -> {}}],
            Column], "\[NoBreak]", ")"}]}
        },
        GridBoxAlignment->{
         "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
          "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.7]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.4]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}], 
      RowBox[{"(", "\[NoBreak]", GridBox[{
         {
          RowBox[{"(", "\[NoBreak]", 
           TagBox[GridBox[{
              {"0"},
              {"0"}
             },
             
             GridBoxAlignment->{
              "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
               "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
             GridBoxSpacings->{"Columns" -> {
                 Offset[0.27999999999999997`], {
                  Offset[0.5599999999999999]}, 
                 Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
               "Rows" -> {
                 Offset[0.2], {
                  Offset[0.4]}, 
                 Offset[0.2]}, "RowsIndexed" -> {}}],
            Column], "\[NoBreak]", ")"}], 
          RowBox[{"(", "\[NoBreak]", 
           TagBox[GridBox[{
              {"1"},
              {"1"}
             },
             
             GridBoxAlignment->{
              "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
               "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
             GridBoxSpacings->{"Columns" -> {
                 Offset[0.27999999999999997`], {
                  Offset[0.5599999999999999]}, 
                 Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
               "Rows" -> {
                 Offset[0.2], {
                  Offset[0.4]}, 
                 Offset[0.2]}, "RowsIndexed" -> {}}],
            Column], "\[NoBreak]", ")"}]},
         {
          RowBox[{"(", "\[NoBreak]", 
           TagBox[GridBox[{
              {"0"},
              {"0"}
             },
             
             GridBoxAlignment->{
              "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
               "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
             GridBoxSpacings->{"Columns" -> {
                 Offset[0.27999999999999997`], {
                  Offset[0.5599999999999999]}, 
                 Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
               "Rows" -> {
                 Offset[0.2], {
                  Offset[0.4]}, 
                 Offset[0.2]}, "RowsIndexed" -> {}}],
            Column], "\[NoBreak]", ")"}], 
          RowBox[{"(", "\[NoBreak]", 
           TagBox[GridBox[{
              {"0"},
              {"1"}
             },
             
             GridBoxAlignment->{
              "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
               "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
             GridBoxSpacings->{"Columns" -> {
                 Offset[0.27999999999999997`], {
                  Offset[0.5599999999999999]}, 
                 Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
               "Rows" -> {
                 Offset[0.2], {
                  Offset[0.4]}, 
                 Offset[0.2]}, "RowsIndexed" -> {}}],
            Column], "\[NoBreak]", ")"}]}
        },
        GridBoxAlignment->{
         "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
          "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.7]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.4]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}]},
     {
      RowBox[{"(", "\[NoBreak]", GridBox[{
         {
          RowBox[{"(", "\[NoBreak]", 
           TagBox[GridBox[{
              {"0"},
              {"0"}
             },
             
             GridBoxAlignment->{
              "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
               "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
             GridBoxSpacings->{"Columns" -> {
                 Offset[0.27999999999999997`], {
                  Offset[0.5599999999999999]}, 
                 Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
               "Rows" -> {
                 Offset[0.2], {
                  Offset[0.4]}, 
                 Offset[0.2]}, "RowsIndexed" -> {}}],
            Column], "\[NoBreak]", ")"}], 
          RowBox[{"(", "\[NoBreak]", 
           TagBox[GridBox[{
              {"0"},
              {"0"}
             },
             
             GridBoxAlignment->{
              "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
               "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
             GridBoxSpacings->{"Columns" -> {
                 Offset[0.27999999999999997`], {
                  Offset[0.5599999999999999]}, 
                 Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
               "Rows" -> {
                 Offset[0.2], {
                  Offset[0.4]}, 
                 Offset[0.2]}, "RowsIndexed" -> {}}],
            Column], "\[NoBreak]", ")"}]},
         {
          RowBox[{"(", "\[NoBreak]", 
           TagBox[GridBox[{
              {"0"},
              {"1"}
             },
             
             GridBoxAlignment->{
              "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
               "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
             GridBoxSpacings->{"Columns" -> {
                 Offset[0.27999999999999997`], {
                  Offset[0.5599999999999999]}, 
                 Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
               "Rows" -> {
                 Offset[0.2], {
                  Offset[0.4]}, 
                 Offset[0.2]}, "RowsIndexed" -> {}}],
            Column], "\[NoBreak]", ")"}], 
          RowBox[{"(", "\[NoBreak]", 
           TagBox[GridBox[{
              {"0"},
              {"1"}
             },
             
             GridBoxAlignment->{
              "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
               "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
             GridBoxSpacings->{"Columns" -> {
                 Offset[0.27999999999999997`], {
                  Offset[0.5599999999999999]}, 
                 Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
               "Rows" -> {
                 Offset[0.2], {
                  Offset[0.4]}, 
                 Offset[0.2]}, "RowsIndexed" -> {}}],
            Column], "\[NoBreak]", ")"}]}
        },
        GridBoxAlignment->{
         "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
          "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.7]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.4]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}], 
      RowBox[{"(", "\[NoBreak]", GridBox[{
         {
          RowBox[{"(", "\[NoBreak]", 
           TagBox[GridBox[{
              {"0"},
              {"0"}
             },
             
             GridBoxAlignment->{
              "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
               "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
             GridBoxSpacings->{"Columns" -> {
                 Offset[0.27999999999999997`], {
                  Offset[0.5599999999999999]}, 
                 Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
               "Rows" -> {
                 Offset[0.2], {
                  Offset[0.4]}, 
                 Offset[0.2]}, "RowsIndexed" -> {}}],
            Column], "\[NoBreak]", ")"}], 
          RowBox[{"(", "\[NoBreak]", 
           TagBox[GridBox[{
              {"0"},
              {"0"}
             },
             
             GridBoxAlignment->{
              "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
               "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
             GridBoxSpacings->{"Columns" -> {
                 Offset[0.27999999999999997`], {
                  Offset[0.5599999999999999]}, 
                 Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
               "Rows" -> {
                 Offset[0.2], {
                  Offset[0.4]}, 
                 Offset[0.2]}, "RowsIndexed" -> {}}],
            Column], "\[NoBreak]", ")"}]},
         {
          RowBox[{"(", "\[NoBreak]", 
           TagBox[GridBox[{
              {"0"},
              {"0"}
             },
             
             GridBoxAlignment->{
              "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
               "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
             GridBoxSpacings->{"Columns" -> {
                 Offset[0.27999999999999997`], {
                  Offset[0.5599999999999999]}, 
                 Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
               "Rows" -> {
                 Offset[0.2], {
                  Offset[0.4]}, 
                 Offset[0.2]}, "RowsIndexed" -> {}}],
            Column], "\[NoBreak]", ")"}], 
          RowBox[{"(", "\[NoBreak]", 
           TagBox[GridBox[{
              {"0"},
              {"1"}
             },
             
             GridBoxAlignment->{
              "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
               "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
             GridBoxSpacings->{"Columns" -> {
                 Offset[0.27999999999999997`], {
                  Offset[0.5599999999999999]}, 
                 Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
               "Rows" -> {
                 Offset[0.2], {
                  Offset[0.4]}, 
                 Offset[0.2]}, "RowsIndexed" -> {}}],
            Column], "\[NoBreak]", ")"}]}
        },
        GridBoxAlignment->{
         "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
          "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.7]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.4]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}]},
     {
      RowBox[{"(", "\[NoBreak]", GridBox[{
         {
          RowBox[{"(", "\[NoBreak]", 
           TagBox[GridBox[{
              {"0"},
              {"0"}
             },
             
             GridBoxAlignment->{
              "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
               "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
             GridBoxSpacings->{"Columns" -> {
                 Offset[0.27999999999999997`], {
                  Offset[0.5599999999999999]}, 
                 Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
               "Rows" -> {
                 Offset[0.2], {
                  Offset[0.4]}, 
                 Offset[0.2]}, "RowsIndexed" -> {}}],
            Column], "\[NoBreak]", ")"}], 
          RowBox[{"(", "\[NoBreak]", 
           TagBox[GridBox[{
              {"0"},
              {"0"}
             },
             
             GridBoxAlignment->{
              "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
               "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
             GridBoxSpacings->{"Columns" -> {
                 Offset[0.27999999999999997`], {
                  Offset[0.5599999999999999]}, 
                 Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
               "Rows" -> {
                 Offset[0.2], {
                  Offset[0.4]}, 
                 Offset[0.2]}, "RowsIndexed" -> {}}],
            Column], "\[NoBreak]", ")"}]},
         {
          RowBox[{"(", "\[NoBreak]", 
           TagBox[GridBox[{
              {"0"},
              {"0"}
             },
             
             GridBoxAlignment->{
              "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
               "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
             GridBoxSpacings->{"Columns" -> {
                 Offset[0.27999999999999997`], {
                  Offset[0.5599999999999999]}, 
                 Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
               "Rows" -> {
                 Offset[0.2], {
                  Offset[0.4]}, 
                 Offset[0.2]}, "RowsIndexed" -> {}}],
            Column], "\[NoBreak]", ")"}], 
          RowBox[{"(", "\[NoBreak]", 
           TagBox[GridBox[{
              {"0"},
              {"0"}
             },
             
             GridBoxAlignment->{
              "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
               "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
             GridBoxSpacings->{"Columns" -> {
                 Offset[0.27999999999999997`], {
                  Offset[0.5599999999999999]}, 
                 Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
               "Rows" -> {
                 Offset[0.2], {
                  Offset[0.4]}, 
                 Offset[0.2]}, "RowsIndexed" -> {}}],
            Column], "\[NoBreak]", ")"}]}
        },
        GridBoxAlignment->{
         "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
          "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.7]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.4]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}], 
      RowBox[{"(", "\[NoBreak]", GridBox[{
         {
          RowBox[{"(", "\[NoBreak]", 
           TagBox[GridBox[{
              {"0"},
              {"0"}
             },
             
             GridBoxAlignment->{
              "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
               "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
             GridBoxSpacings->{"Columns" -> {
                 Offset[0.27999999999999997`], {
                  Offset[0.5599999999999999]}, 
                 Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
               "Rows" -> {
                 Offset[0.2], {
                  Offset[0.4]}, 
                 Offset[0.2]}, "RowsIndexed" -> {}}],
            Column], "\[NoBreak]", ")"}], 
          RowBox[{"(", "\[NoBreak]", 
           TagBox[GridBox[{
              {"1"},
              {"1"}
             },
             
             GridBoxAlignment->{
              "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
               "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
             GridBoxSpacings->{"Columns" -> {
                 Offset[0.27999999999999997`], {
                  Offset[0.5599999999999999]}, 
                 Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
               "Rows" -> {
                 Offset[0.2], {
                  Offset[0.4]}, 
                 Offset[0.2]}, "RowsIndexed" -> {}}],
            Column], "\[NoBreak]", ")"}]},
         {
          RowBox[{"(", "\[NoBreak]", 
           TagBox[GridBox[{
              {"0"},
              {"0"}
             },
             
             GridBoxAlignment->{
              "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
               "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
             GridBoxSpacings->{"Columns" -> {
                 Offset[0.27999999999999997`], {
                  Offset[0.5599999999999999]}, 
                 Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
               "Rows" -> {
                 Offset[0.2], {
                  Offset[0.4]}, 
                 Offset[0.2]}, "RowsIndexed" -> {}}],
            Column], "\[NoBreak]", ")"}], 
          RowBox[{"(", "\[NoBreak]", 
           TagBox[GridBox[{
              {"0"},
              {"1"}
             },
             
             GridBoxAlignment->{
              "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
               "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
             GridBoxSpacings->{"Columns" -> {
                 Offset[0.27999999999999997`], {
                  Offset[0.5599999999999999]}, 
                 Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
               "Rows" -> {
                 Offset[0.2], {
                  Offset[0.4]}, 
                 Offset[0.2]}, "RowsIndexed" -> {}}],
            Column], "\[NoBreak]", ")"}]}
        },
        GridBoxAlignment->{
         "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
          "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.7]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.4]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}]},
     {
      RowBox[{"(", "\[NoBreak]", GridBox[{
         {
          RowBox[{"(", "\[NoBreak]", 
           TagBox[GridBox[{
              {"0"},
              {"0"}
             },
             
             GridBoxAlignment->{
              "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
               "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
             GridBoxSpacings->{"Columns" -> {
                 Offset[0.27999999999999997`], {
                  Offset[0.5599999999999999]}, 
                 Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
               "Rows" -> {
                 Offset[0.2], {
                  Offset[0.4]}, 
                 Offset[0.2]}, "RowsIndexed" -> {}}],
            Column], "\[NoBreak]", ")"}], 
          RowBox[{"(", "\[NoBreak]", 
           TagBox[GridBox[{
              {"0"},
              {"0"}
             },
             
             GridBoxAlignment->{
              "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
               "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
             GridBoxSpacings->{"Columns" -> {
                 Offset[0.27999999999999997`], {
                  Offset[0.5599999999999999]}, 
                 Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
               "Rows" -> {
                 Offset[0.2], {
                  Offset[0.4]}, 
                 Offset[0.2]}, "RowsIndexed" -> {}}],
            Column], "\[NoBreak]", ")"}]},
         {
          RowBox[{"(", "\[NoBreak]", 
           TagBox[GridBox[{
              {"0"},
              {"0"}
             },
             
             GridBoxAlignment->{
              "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
               "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
             GridBoxSpacings->{"Columns" -> {
                 Offset[0.27999999999999997`], {
                  Offset[0.5599999999999999]}, 
                 Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
               "Rows" -> {
                 Offset[0.2], {
                  Offset[0.4]}, 
                 Offset[0.2]}, "RowsIndexed" -> {}}],
            Column], "\[NoBreak]", ")"}], 
          RowBox[{"(", "\[NoBreak]", 
           TagBox[GridBox[{
              {"0"},
              {"0"}
             },
             
             GridBoxAlignment->{
              "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
               "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
             GridBoxSpacings->{"Columns" -> {
                 Offset[0.27999999999999997`], {
                  Offset[0.5599999999999999]}, 
                 Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
               "Rows" -> {
                 Offset[0.2], {
                  Offset[0.4]}, 
                 Offset[0.2]}, "RowsIndexed" -> {}}],
            Column], "\[NoBreak]", ")"}]}
        },
        GridBoxAlignment->{
         "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
          "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.7]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.4]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}], 
      RowBox[{"(", "\[NoBreak]", GridBox[{
         {
          RowBox[{"(", "\[NoBreak]", 
           TagBox[GridBox[{
              {"0"},
              {"0"}
             },
             
             GridBoxAlignment->{
              "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
               "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
             GridBoxSpacings->{"Columns" -> {
                 Offset[0.27999999999999997`], {
                  Offset[0.5599999999999999]}, 
                 Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
               "Rows" -> {
                 Offset[0.2], {
                  Offset[0.4]}, 
                 Offset[0.2]}, "RowsIndexed" -> {}}],
            Column], "\[NoBreak]", ")"}], 
          RowBox[{"(", "\[NoBreak]", 
           TagBox[GridBox[{
              {"0"},
              {"0"}
             },
             
             GridBoxAlignment->{
              "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
               "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
             GridBoxSpacings->{"Columns" -> {
                 Offset[0.27999999999999997`], {
                  Offset[0.5599999999999999]}, 
                 Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
               "Rows" -> {
                 Offset[0.2], {
                  Offset[0.4]}, 
                 Offset[0.2]}, "RowsIndexed" -> {}}],
            Column], "\[NoBreak]", ")"}]},
         {
          RowBox[{"(", "\[NoBreak]", 
           TagBox[GridBox[{
              {"0"},
              {"0"}
             },
             
             GridBoxAlignment->{
              "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
               "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
             GridBoxSpacings->{"Columns" -> {
                 Offset[0.27999999999999997`], {
                  Offset[0.5599999999999999]}, 
                 Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
               "Rows" -> {
                 Offset[0.2], {
                  Offset[0.4]}, 
                 Offset[0.2]}, "RowsIndexed" -> {}}],
            Column], "\[NoBreak]", ")"}], 
          RowBox[{"(", "\[NoBreak]", 
           TagBox[GridBox[{
              {"0"},
              {"2"}
             },
             
             GridBoxAlignment->{
              "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
               "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
             GridBoxSpacings->{"Columns" -> {
                 Offset[0.27999999999999997`], {
                  Offset[0.5599999999999999]}, 
                 Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
               "Rows" -> {
                 Offset[0.2], {
                  Offset[0.4]}, 
                 Offset[0.2]}, "RowsIndexed" -> {}}],
            Column], "\[NoBreak]", ")"}]}
        },
        GridBoxAlignment->{
         "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
          "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.7]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.4]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.760251305510085*^9, 3.76025135099844*^9}, 
   3.7602514697917614`*^9, {3.760251504403202*^9, 3.7602515239599047`*^9}},
 CellLabel->
  "Out[91]//MatrixForm=",ExpressionUUID->"e940eaea-5de6-43f6-a244-\
bc21f9477de3"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Dimensions", "[", "res", "]"}]], "Input",
 CellChangeTimes->{{3.760251479013101*^9, 3.7602514805210695`*^9}},
 CellLabel->"In[92]:=",ExpressionUUID->"caa56953-c8c4-45cb-a2e4-aa02bab255c9"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"2", ",", "2", ",", "2", ",", "2", ",", "2", ",", "2"}], 
  "}"}]], "Output",
 CellChangeTimes->{3.7602514808920774`*^9, 3.760251528281348*^9},
 CellLabel->"Out[92]=",ExpressionUUID->"74ce83bd-613c-47d6-9d5d-172e2460af99"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Flatten", "[", 
   RowBox[{"res", ",", 
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{"2", ",", "3", ",", "4", ",", "5"}], "}"}], "}"}]}], "]"}], "//",
   "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.7602512996457663`*^9, 3.760251440652685*^9}, {
  3.760251472746876*^9, 3.7602514729971895`*^9}, {3.7602515325170207`*^9, 
  3.760251551910162*^9}, {3.760251585564161*^9, 3.7602515925275393`*^9}},
 CellLabel->"In[95]:=",ExpressionUUID->"ae828fe8-9359-42ad-95a7-e016fcb1a642"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{"(", "\[NoBreak]", 
       TagBox[GridBox[{
          {"1"},
          {"1"}
         },
         GridBoxAlignment->{
          "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
           "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
         GridBoxSpacings->{"Columns" -> {
             Offset[0.27999999999999997`], {
              Offset[0.5599999999999999]}, 
             Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
             Offset[0.2], {
              Offset[0.4]}, 
             Offset[0.2]}, "RowsIndexed" -> {}}],
        Column], "\[NoBreak]", ")"}], 
      RowBox[{"(", "\[NoBreak]", 
       TagBox[GridBox[{
          {"0"},
          {"0"}
         },
         GridBoxAlignment->{
          "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
           "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
         GridBoxSpacings->{"Columns" -> {
             Offset[0.27999999999999997`], {
              Offset[0.5599999999999999]}, 
             Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
             Offset[0.2], {
              Offset[0.4]}, 
             Offset[0.2]}, "RowsIndexed" -> {}}],
        Column], "\[NoBreak]", ")"}]},
     {
      RowBox[{"(", "\[NoBreak]", 
       TagBox[GridBox[{
          {"1"},
          {"1"}
         },
         GridBoxAlignment->{
          "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
           "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
         GridBoxSpacings->{"Columns" -> {
             Offset[0.27999999999999997`], {
              Offset[0.5599999999999999]}, 
             Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
             Offset[0.2], {
              Offset[0.4]}, 
             Offset[0.2]}, "RowsIndexed" -> {}}],
        Column], "\[NoBreak]", ")"}], 
      RowBox[{"(", "\[NoBreak]", 
       TagBox[GridBox[{
          {"0"},
          {"0"}
         },
         GridBoxAlignment->{
          "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
           "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
         GridBoxSpacings->{"Columns" -> {
             Offset[0.27999999999999997`], {
              Offset[0.5599999999999999]}, 
             Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
             Offset[0.2], {
              Offset[0.4]}, 
             Offset[0.2]}, "RowsIndexed" -> {}}],
        Column], "\[NoBreak]", ")"}]},
     {
      RowBox[{"(", "\[NoBreak]", 
       TagBox[GridBox[{
          {"0"},
          {"1"}
         },
         GridBoxAlignment->{
          "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
           "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
         GridBoxSpacings->{"Columns" -> {
             Offset[0.27999999999999997`], {
              Offset[0.5599999999999999]}, 
             Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
             Offset[0.2], {
              Offset[0.4]}, 
             Offset[0.2]}, "RowsIndexed" -> {}}],
        Column], "\[NoBreak]", ")"}], 
      RowBox[{"(", "\[NoBreak]", 
       TagBox[GridBox[{
          {"0"},
          {"0"}
         },
         GridBoxAlignment->{
          "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
           "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
         GridBoxSpacings->{"Columns" -> {
             Offset[0.27999999999999997`], {
              Offset[0.5599999999999999]}, 
             Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
             Offset[0.2], {
              Offset[0.4]}, 
             Offset[0.2]}, "RowsIndexed" -> {}}],
        Column], "\[NoBreak]", ")"}]},
     {
      RowBox[{"(", "\[NoBreak]", 
       TagBox[GridBox[{
          {"0"},
          {"1"}
         },
         GridBoxAlignment->{
          "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
           "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
         GridBoxSpacings->{"Columns" -> {
             Offset[0.27999999999999997`], {
              Offset[0.5599999999999999]}, 
             Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
             Offset[0.2], {
              Offset[0.4]}, 
             Offset[0.2]}, "RowsIndexed" -> {}}],
        Column], "\[NoBreak]", ")"}], 
      RowBox[{"(", "\[NoBreak]", 
       TagBox[GridBox[{
          {"0"},
          {"0"}
         },
         GridBoxAlignment->{
          "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
           "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
         GridBoxSpacings->{"Columns" -> {
             Offset[0.27999999999999997`], {
              Offset[0.5599999999999999]}, 
             Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
             Offset[0.2], {
              Offset[0.4]}, 
             Offset[0.2]}, "RowsIndexed" -> {}}],
        Column], "\[NoBreak]", ")"}]},
     {
      RowBox[{"(", "\[NoBreak]", 
       TagBox[GridBox[{
          {"0"},
          {"0"}
         },
         GridBoxAlignment->{
          "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
           "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
         GridBoxSpacings->{"Columns" -> {
             Offset[0.27999999999999997`], {
              Offset[0.5599999999999999]}, 
             Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
             Offset[0.2], {
              Offset[0.4]}, 
             Offset[0.2]}, "RowsIndexed" -> {}}],
        Column], "\[NoBreak]", ")"}], 
      RowBox[{"(", "\[NoBreak]", 
       TagBox[GridBox[{
          {"0"},
          {"0"}
         },
         GridBoxAlignment->{
          "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
           "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
         GridBoxSpacings->{"Columns" -> {
             Offset[0.27999999999999997`], {
              Offset[0.5599999999999999]}, 
             Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
             Offset[0.2], {
              Offset[0.4]}, 
             Offset[0.2]}, "RowsIndexed" -> {}}],
        Column], "\[NoBreak]", ")"}]},
     {
      RowBox[{"(", "\[NoBreak]", 
       TagBox[GridBox[{
          {"1"},
          {"1"}
         },
         GridBoxAlignment->{
          "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
           "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
         GridBoxSpacings->{"Columns" -> {
             Offset[0.27999999999999997`], {
              Offset[0.5599999999999999]}, 
             Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
             Offset[0.2], {
              Offset[0.4]}, 
             Offset[0.2]}, "RowsIndexed" -> {}}],
        Column], "\[NoBreak]", ")"}], 
      RowBox[{"(", "\[NoBreak]", 
       TagBox[GridBox[{
          {"1"},
          {"1"}
         },
         GridBoxAlignment->{
          "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
           "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
         GridBoxSpacings->{"Columns" -> {
             Offset[0.27999999999999997`], {
              Offset[0.5599999999999999]}, 
             Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
             Offset[0.2], {
              Offset[0.4]}, 
             Offset[0.2]}, "RowsIndexed" -> {}}],
        Column], "\[NoBreak]", ")"}]},
     {
      RowBox[{"(", "\[NoBreak]", 
       TagBox[GridBox[{
          {"0"},
          {"0"}
         },
         GridBoxAlignment->{
          "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
           "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
         GridBoxSpacings->{"Columns" -> {
             Offset[0.27999999999999997`], {
              Offset[0.5599999999999999]}, 
             Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
             Offset[0.2], {
              Offset[0.4]}, 
             Offset[0.2]}, "RowsIndexed" -> {}}],
        Column], "\[NoBreak]", ")"}], 
      RowBox[{"(", "\[NoBreak]", 
       TagBox[GridBox[{
          {"0"},
          {"0"}
         },
         GridBoxAlignment->{
          "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
           "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
         GridBoxSpacings->{"Columns" -> {
             Offset[0.27999999999999997`], {
              Offset[0.5599999999999999]}, 
             Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
             Offset[0.2], {
              Offset[0.4]}, 
             Offset[0.2]}, "RowsIndexed" -> {}}],
        Column], "\[NoBreak]", ")"}]},
     {
      RowBox[{"(", "\[NoBreak]", 
       TagBox[GridBox[{
          {"0"},
          {"1"}
         },
         GridBoxAlignment->{
          "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
           "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
         GridBoxSpacings->{"Columns" -> {
             Offset[0.27999999999999997`], {
              Offset[0.5599999999999999]}, 
             Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
             Offset[0.2], {
              Offset[0.4]}, 
             Offset[0.2]}, "RowsIndexed" -> {}}],
        Column], "\[NoBreak]", ")"}], 
      RowBox[{"(", "\[NoBreak]", 
       TagBox[GridBox[{
          {"0"},
          {"1"}
         },
         GridBoxAlignment->{
          "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
           "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
         GridBoxSpacings->{"Columns" -> {
             Offset[0.27999999999999997`], {
              Offset[0.5599999999999999]}, 
             Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
             Offset[0.2], {
              Offset[0.4]}, 
             Offset[0.2]}, "RowsIndexed" -> {}}],
        Column], "\[NoBreak]", ")"}]},
     {
      RowBox[{"(", "\[NoBreak]", 
       TagBox[GridBox[{
          {"0"},
          {"0"}
         },
         GridBoxAlignment->{
          "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
           "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
         GridBoxSpacings->{"Columns" -> {
             Offset[0.27999999999999997`], {
              Offset[0.5599999999999999]}, 
             Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
             Offset[0.2], {
              Offset[0.4]}, 
             Offset[0.2]}, "RowsIndexed" -> {}}],
        Column], "\[NoBreak]", ")"}], 
      RowBox[{"(", "\[NoBreak]", 
       TagBox[GridBox[{
          {"0"},
          {"0"}
         },
         GridBoxAlignment->{
          "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
           "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
         GridBoxSpacings->{"Columns" -> {
             Offset[0.27999999999999997`], {
              Offset[0.5599999999999999]}, 
             Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
             Offset[0.2], {
              Offset[0.4]}, 
             Offset[0.2]}, "RowsIndexed" -> {}}],
        Column], "\[NoBreak]", ")"}]},
     {
      RowBox[{"(", "\[NoBreak]", 
       TagBox[GridBox[{
          {"0"},
          {"0"}
         },
         GridBoxAlignment->{
          "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
           "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
         GridBoxSpacings->{"Columns" -> {
             Offset[0.27999999999999997`], {
              Offset[0.5599999999999999]}, 
             Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
             Offset[0.2], {
              Offset[0.4]}, 
             Offset[0.2]}, "RowsIndexed" -> {}}],
        Column], "\[NoBreak]", ")"}], 
      RowBox[{"(", "\[NoBreak]", 
       TagBox[GridBox[{
          {"0"},
          {"0"}
         },
         GridBoxAlignment->{
          "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
           "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
         GridBoxSpacings->{"Columns" -> {
             Offset[0.27999999999999997`], {
              Offset[0.5599999999999999]}, 
             Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
             Offset[0.2], {
              Offset[0.4]}, 
             Offset[0.2]}, "RowsIndexed" -> {}}],
        Column], "\[NoBreak]", ")"}]},
     {
      RowBox[{"(", "\[NoBreak]", 
       TagBox[GridBox[{
          {"0"},
          {"1"}
         },
         GridBoxAlignment->{
          "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
           "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
         GridBoxSpacings->{"Columns" -> {
             Offset[0.27999999999999997`], {
              Offset[0.5599999999999999]}, 
             Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
             Offset[0.2], {
              Offset[0.4]}, 
             Offset[0.2]}, "RowsIndexed" -> {}}],
        Column], "\[NoBreak]", ")"}], 
      RowBox[{"(", "\[NoBreak]", 
       TagBox[GridBox[{
          {"0"},
          {"0"}
         },
         GridBoxAlignment->{
          "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
           "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
         GridBoxSpacings->{"Columns" -> {
             Offset[0.27999999999999997`], {
              Offset[0.5599999999999999]}, 
             Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
             Offset[0.2], {
              Offset[0.4]}, 
             Offset[0.2]}, "RowsIndexed" -> {}}],
        Column], "\[NoBreak]", ")"}]},
     {
      RowBox[{"(", "\[NoBreak]", 
       TagBox[GridBox[{
          {"0"},
          {"1"}
         },
         GridBoxAlignment->{
          "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
           "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
         GridBoxSpacings->{"Columns" -> {
             Offset[0.27999999999999997`], {
              Offset[0.5599999999999999]}, 
             Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
             Offset[0.2], {
              Offset[0.4]}, 
             Offset[0.2]}, "RowsIndexed" -> {}}],
        Column], "\[NoBreak]", ")"}], 
      RowBox[{"(", "\[NoBreak]", 
       TagBox[GridBox[{
          {"0"},
          {"0"}
         },
         GridBoxAlignment->{
          "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
           "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
         GridBoxSpacings->{"Columns" -> {
             Offset[0.27999999999999997`], {
              Offset[0.5599999999999999]}, 
             Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
             Offset[0.2], {
              Offset[0.4]}, 
             Offset[0.2]}, "RowsIndexed" -> {}}],
        Column], "\[NoBreak]", ")"}]},
     {
      RowBox[{"(", "\[NoBreak]", 
       TagBox[GridBox[{
          {"0"},
          {"0"}
         },
         GridBoxAlignment->{
          "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
           "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
         GridBoxSpacings->{"Columns" -> {
             Offset[0.27999999999999997`], {
              Offset[0.5599999999999999]}, 
             Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
             Offset[0.2], {
              Offset[0.4]}, 
             Offset[0.2]}, "RowsIndexed" -> {}}],
        Column], "\[NoBreak]", ")"}], 
      RowBox[{"(", "\[NoBreak]", 
       TagBox[GridBox[{
          {"0"},
          {"0"}
         },
         GridBoxAlignment->{
          "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
           "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
         GridBoxSpacings->{"Columns" -> {
             Offset[0.27999999999999997`], {
              Offset[0.5599999999999999]}, 
             Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
             Offset[0.2], {
              Offset[0.4]}, 
             Offset[0.2]}, "RowsIndexed" -> {}}],
        Column], "\[NoBreak]", ")"}]},
     {
      RowBox[{"(", "\[NoBreak]", 
       TagBox[GridBox[{
          {"0"},
          {"0"}
         },
         GridBoxAlignment->{
          "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
           "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
         GridBoxSpacings->{"Columns" -> {
             Offset[0.27999999999999997`], {
              Offset[0.5599999999999999]}, 
             Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
             Offset[0.2], {
              Offset[0.4]}, 
             Offset[0.2]}, "RowsIndexed" -> {}}],
        Column], "\[NoBreak]", ")"}], 
      RowBox[{"(", "\[NoBreak]", 
       TagBox[GridBox[{
          {"0"},
          {"0"}
         },
         GridBoxAlignment->{
          "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
           "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
         GridBoxSpacings->{"Columns" -> {
             Offset[0.27999999999999997`], {
              Offset[0.5599999999999999]}, 
             Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
             Offset[0.2], {
              Offset[0.4]}, 
             Offset[0.2]}, "RowsIndexed" -> {}}],
        Column], "\[NoBreak]", ")"}]},
     {
      RowBox[{"(", "\[NoBreak]", 
       TagBox[GridBox[{
          {"0"},
          {"0"}
         },
         GridBoxAlignment->{
          "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
           "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
         GridBoxSpacings->{"Columns" -> {
             Offset[0.27999999999999997`], {
              Offset[0.5599999999999999]}, 
             Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
             Offset[0.2], {
              Offset[0.4]}, 
             Offset[0.2]}, "RowsIndexed" -> {}}],
        Column], "\[NoBreak]", ")"}], 
      RowBox[{"(", "\[NoBreak]", 
       TagBox[GridBox[{
          {"0"},
          {"0"}
         },
         GridBoxAlignment->{
          "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
           "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
         GridBoxSpacings->{"Columns" -> {
             Offset[0.27999999999999997`], {
              Offset[0.5599999999999999]}, 
             Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
             Offset[0.2], {
              Offset[0.4]}, 
             Offset[0.2]}, "RowsIndexed" -> {}}],
        Column], "\[NoBreak]", ")"}]},
     {
      RowBox[{"(", "\[NoBreak]", 
       TagBox[GridBox[{
          {"0"},
          {"1"}
         },
         GridBoxAlignment->{
          "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
           "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
         GridBoxSpacings->{"Columns" -> {
             Offset[0.27999999999999997`], {
              Offset[0.5599999999999999]}, 
             Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
             Offset[0.2], {
              Offset[0.4]}, 
             Offset[0.2]}, "RowsIndexed" -> {}}],
        Column], "\[NoBreak]", ")"}], 
      RowBox[{"(", "\[NoBreak]", 
       TagBox[GridBox[{
          {"0"},
          {"2"}
         },
         GridBoxAlignment->{
          "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
           "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
         GridBoxSpacings->{"Columns" -> {
             Offset[0.27999999999999997`], {
              Offset[0.5599999999999999]}, 
             Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
             Offset[0.2], {
              Offset[0.4]}, 
             Offset[0.2]}, "RowsIndexed" -> {}}],
        Column], "\[NoBreak]", ")"}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.760251361147299*^9, 3.7602514411862574`*^9}, 
   3.760251473802037*^9, 3.760251552352976*^9, {3.760251589444784*^9, 
   3.7602515929464207`*^9}},
 CellLabel->
  "Out[95]//MatrixForm=",ExpressionUUID->"103d3145-d668-4fbb-8481-\
d5d61e9530db"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"mat", "//", "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.760251319003002*^9, 3.7602513211153517`*^9}},
 CellLabel->"In[81]:=",ExpressionUUID->"bd9ae655-ef81-4894-956b-5a65079934b6"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"1", "1", "0", "1", "0", "0", "0", "1", "0", "0", "0", "0", "0", "0", 
      "0", "1"},
     {"1", "1", "0", "1", "0", "0", "0", "1", "0", "0", "0", "0", "0", "0", 
      "0", "1"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"1", "1", "0", "1", "0", "0", "0", "1", "0", "0", "0", "0", "0", "0", 
      "0", "1"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"1", "1", "0", "1", "0", "0", "0", "1", "0", "0", "0", "0", "0", "0", 
      "0", "1"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"1", "1", "0", "1", "0", "0", "0", "1", "0", "0", "0", "0", "0", "0", 
      "0", "1"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.760251321636958*^9, 3.76025147580867*^9},
 CellLabel->
  "Out[81]//MatrixForm=",ExpressionUUID->"8d632afb-812f-43d1-be9e-\
b3b2772c9c09"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Dimensions", "[", "mat", "]"}]], "Input",
 CellChangeTimes->{{3.760193312104392*^9, 3.760193314369276*^9}},
 CellLabel->"In[47]:=",ExpressionUUID->"bf8e6c1b-9cc8-4569-b2d0-7f72a152e155"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"16", ",", "16"}], "}"}]], "Output",
 CellChangeTimes->{3.7601933148489914`*^9, 3.7602511752185106`*^9},
 CellLabel->"Out[47]=",ExpressionUUID->"ba0cdd36-d794-4815-b4aa-f7a39951af1a"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"SingularValueList", "@", 
  RowBox[{"partTr", "[", 
   RowBox[{",", 
    RowBox[{"{", "1", "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.7601859625173826`*^9, 3.7601859842053814`*^9}},
 CellLabel->"In[48]:=",ExpressionUUID->"22201efe-8488-499e-8962-dec2d7ce45da"],

Cell[BoxData[
 RowBox[{"SingularValueList", "[", 
  RowBox[{"partTr", "[", 
   RowBox[{"Null", ",", 
    RowBox[{"{", "1", "}"}]}], "]"}], "]"}]], "Output",
 CellChangeTimes->{{3.7601859669006577`*^9, 3.760185976729374*^9}, 
   3.7602511752773547`*^9},
 CellLabel->"Out[48]=",ExpressionUUID->"1f12e4d8-214b-415b-8dbb-e2d4f729ea64"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"SingularValueList", "[", "mat", "]"}]], "Input",
 CellChangeTimes->{{3.7601728342563133`*^9, 3.760172838636589*^9}},
 CellLabel->"In[49]:=",ExpressionUUID->"e91039b5-e781-44f0-b834-eb048c695394"],

Cell[BoxData[
 RowBox[{"{", "5", "}"}]], "Output",
 CellChangeTimes->{3.760172839080402*^9, 3.7602511753212357`*^9},
 CellLabel->"Out[49]=",ExpressionUUID->"a8300507-f002-47df-9503-605cde2191b4"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"SingularValueList", "[", "matghz", "]"}]], "Input",
 CellChangeTimes->{{3.7601728342563133`*^9, 3.7601728495394316`*^9}},
 CellLabel->"In[50]:=",ExpressionUUID->"437814e4-ad8b-40a0-8ad8-7cfa96e59970"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   FractionBox["1", "4"], ",", 
   FractionBox["1", "4"]}], "}"}]], "Output",
 CellChangeTimes->{3.760172849931384*^9, 3.760251175373098*^9},
 CellLabel->"Out[50]=",ExpressionUUID->"04009295-99dd-4bb5-9589-d9c013114d7a"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"matghz", "//", "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.760172686959738*^9, 3.760172689046154*^9}, {
  3.7601728168658066`*^9, 3.760172819463895*^9}},
 CellLabel->"In[51]:=",ExpressionUUID->"85af731d-c6e3-474e-b78d-6fbf9bcb673c"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      FractionBox["1", "4"], "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", 
      FractionBox["1", "4"]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[
   SparseArray[
    Automatic, {8, 8}, 0, {
     1, {{0, 1, 1, 1, 1, 1, 1, 1, 2}, {{1}, {8}}}, {
      Rational[1, 4], Rational[1, 4]}}]]]]], "Output",
 CellChangeTimes->{3.7601728200333366`*^9, 3.7602511754239616`*^9},
 CellLabel->
  "Out[51]//MatrixForm=",ExpressionUUID->"e4aeb277-78ba-478b-8922-\
07d9da1301c9"]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.760172686959738*^9, 3.760172689046154*^9}, {
  3.7601728168658066`*^9, 3.76017284643972*^9}},
 CellLabel->"In[52]:=",ExpressionUUID->"02ced233-747f-4cfc-a56d-a5dda66099b6"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Tr", "[", "mat", "]"}]], "Input",
 CellChangeTimes->{{3.760172692840008*^9, 3.76017269439884*^9}},
 CellLabel->"In[53]:=",ExpressionUUID->"f1ec25c9-b6a8-4d49-ba96-11ee0fbda1b7"],

Cell[BoxData["5"], "Output",
 CellChangeTimes->{3.760172695120908*^9, 3.7602511755117283`*^9},
 CellLabel->"Out[53]=",ExpressionUUID->"d2f2387a-23af-4b59-b845-e646f6ee7181"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"onBases", "[", "]"}]], "Input",
 CellChangeTimes->{{3.760251634421507*^9, 3.760251636186817*^9}},
 CellLabel->"In[96]:=",ExpressionUUID->"cd7b42d1-ce6b-40d9-9369-ac22b9c0078f"],

Cell[BoxData[
 RowBox[{"\[LeftAssociation]", 
  RowBox[{
   RowBox[{"\<\"Integral\"\>", "\[Rule]", 
    RowBox[{"infiniteBasis", "[", "None", "]"}]}], ",", 
   RowBox[{"\<\"IdentityKet\"\>", "\[Rule]", 
    RowBox[{"{", 
     TemplateBox[{"idket"},
      "Ket"], "}"}]}], ",", 
   RowBox[{"\<\"comp\"\>", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      TemplateBox[{"\"H\""},
       "Ket"], ",", 
      TemplateBox[{"\"V\""},
       "Ket"]}], "}"}]}], ",", 
   RowBox[{"\<\"diag\"\>", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      TemplateBox[{"\"D\""},
       "Ket"], ",", 
      TemplateBox[{"\"A\""},
       "Ket"]}], "}"}]}], ",", 
   RowBox[{"\<\"circ\"\>", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      TemplateBox[{"\"R\""},
       "Ket"], ",", 
      TemplateBox[{"\"L\""},
       "Ket"]}], "}"}]}], ",", 
   RowBox[{"\<\"coco\"\>", "\[Rule]", 
    RowBox[{"infiniteBasis", "[", "g", "]"}]}], ",", 
   RowBox[{"\<\"nono\"\>", "\[Rule]", 
    RowBox[{"infiniteBasis", "[", "\<\"no\"\>", "]"}]}]}], 
  "\[RightAssociation]"}]], "Output",
 CellChangeTimes->{3.7602516367103863`*^9},
 CellLabel->"Out[96]=",ExpressionUUID->"e18a2388-3607-448f-ab7b-e5f9fe96101d"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"init", "=", 
  RowBox[{
   RowBox[{"Ket", "[", 
    RowBox[{"\"\<s1\>\"", ",", "\"\<i1\>\""}], "]"}], "+", 
   RowBox[{"Ket", "[", 
    RowBox[{"\"\<s2\>\"", ",", "\"\<i2\>\""}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.7602516512385354`*^9, 3.7602516719621153`*^9}},
 CellLabel->"In[97]:=",ExpressionUUID->"25b29e1d-a565-4d7e-b396-931588c8e24c"],

Cell[BoxData[
 RowBox[{
  TemplateBox[{
    RowBox[{"\"s1\"", ",", "\"i1\""}]},
   "Ket"], "+", 
  TemplateBox[{
    RowBox[{"\"s2\"", ",", "\"i2\""}]},
   "Ket"]}]], "Output",
 CellChangeTimes->{3.760251672464771*^9},
 CellLabel->"Out[97]=",ExpressionUUID->"0c03250c-9026-4212-b215-dbdf4f23a0b6"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Names", "[", "\"\<Notebook$$15$250585`*beam*\>\"", "]"}]], "Input",
 CellChangeTimes->{{3.7602516765169473`*^9, 3.7602517287891474`*^9}},
 CellLabel->
  "In[105]:=",ExpressionUUID->"3c3b7a48-f4fe-4f48-bd0c-798142f905ec"],

Cell[BoxData[
 RowBox[{"{", "}"}]], "Output",
 CellChangeTimes->{{3.7602516859457207`*^9, 3.7602517293646092`*^9}},
 CellLabel->
  "Out[105]=",ExpressionUUID->"40f1ef3b-cfd5-4ebc-8e05-8691ed344b28"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"vec", "=", 
  RowBox[{
   FractionBox["1", 
    RowBox[{"2", 
     SqrtBox["2"]}]], 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"1", 
      RowBox[{"(", 
       RowBox[{"1", "-", 
        RowBox[{"Exp", "[", 
         RowBox[{"I", " ", "\[CurlyPhi]"}], "]"}]}], ")"}]}], ",", 
     RowBox[{"I", 
      RowBox[{"(", 
       RowBox[{"1", "+", 
        RowBox[{"Exp", "[", 
         RowBox[{"I", " ", "\[CurlyPhi]"}], "]"}]}], ")"}]}], ",", 
     RowBox[{"I", 
      RowBox[{"(", 
       RowBox[{"1", "+", 
        RowBox[{"Exp", "[", 
         RowBox[{"I", " ", "\[CurlyPhi]"}], "]"}]}], ")"}]}], ",", 
     RowBox[{
      RowBox[{"-", "1"}], 
      RowBox[{"(", 
       RowBox[{"1", "-", 
        RowBox[{"Exp", "[", 
         RowBox[{"I", " ", "\[CurlyPhi]"}], "]"}]}], ")"}]}]}], 
    "}"}]}]}]], "Input",
 CellChangeTimes->{{3.7602534815489035`*^9, 3.7602535168096094`*^9}},
 CellLabel->
  "In[106]:=",ExpressionUUID->"9567831c-49aa-4b9c-b07c-9836f3bae6f6"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   FractionBox[
    RowBox[{"1", "-", 
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{"\[ImaginaryI]", " ", "\[CurlyPhi]"}]]}], 
    RowBox[{"2", " ", 
     SqrtBox["2"]}]], ",", 
   FractionBox[
    RowBox[{"\[ImaginaryI]", " ", 
     RowBox[{"(", 
      RowBox[{"1", "+", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"\[ImaginaryI]", " ", "\[CurlyPhi]"}]]}], ")"}]}], 
    RowBox[{"2", " ", 
     SqrtBox["2"]}]], ",", 
   FractionBox[
    RowBox[{"\[ImaginaryI]", " ", 
     RowBox[{"(", 
      RowBox[{"1", "+", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"\[ImaginaryI]", " ", "\[CurlyPhi]"}]]}], ")"}]}], 
    RowBox[{"2", " ", 
     SqrtBox["2"]}]], ",", 
   FractionBox[
    RowBox[{
     RowBox[{"-", "1"}], "+", 
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{"\[ImaginaryI]", " ", "\[CurlyPhi]"}]]}], 
    RowBox[{"2", " ", 
     SqrtBox["2"]}]]}], "}"}]], "Output",
 CellChangeTimes->{3.7602535180871925`*^9},
 CellLabel->
  "Out[106]=",ExpressionUUID->"f673d261-edf9-4c3d-85e8-68eaafa5e52b"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"vecm", "=", 
   RowBox[{"Simplify", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"{", "vec", "}"}], "\[ConjugateTranspose]"}], ".", 
      RowBox[{"{", "vec", "}"}]}], ",", 
     RowBox[{"\[CurlyPhi]", "\[Element]", "Reals"}]}], "]"}]}], ";", 
  RowBox[{"vecm", "//", "MatrixForm"}]}]], "Input",
 CellChangeTimes->{{3.76025352091862*^9, 3.7602535773985825`*^9}},
 CellLabel->
  "In[128]:=",ExpressionUUID->"3d4b9882-67b8-40cf-853f-cd008841fef3"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{
       RowBox[{"-", 
        FractionBox["1", "8"]}], " ", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{
         RowBox[{"-", "\[ImaginaryI]"}], " ", "\[CurlyPhi]"}]], " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", 
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{"\[ImaginaryI]", " ", "\[CurlyPhi]"}]]}], ")"}], "2"]}], 
      RowBox[{
       FractionBox["1", "8"], " ", "\[ImaginaryI]", " ", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{
         RowBox[{"-", "\[ImaginaryI]"}], " ", "\[CurlyPhi]"}]], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", 
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{"2", " ", "\[ImaginaryI]", " ", "\[CurlyPhi]"}]]}], ")"}]}], 
      RowBox[{
       FractionBox["1", "8"], " ", "\[ImaginaryI]", " ", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{
         RowBox[{"-", "\[ImaginaryI]"}], " ", "\[CurlyPhi]"}]], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", 
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{"2", " ", "\[ImaginaryI]", " ", "\[CurlyPhi]"}]]}], ")"}]}], 
      RowBox[{
       FractionBox["1", "8"], " ", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{
         RowBox[{"-", "\[ImaginaryI]"}], " ", "\[CurlyPhi]"}]], " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", 
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{"\[ImaginaryI]", " ", "\[CurlyPhi]"}]]}], ")"}], "2"]}]},
     {
      RowBox[{
       FractionBox["1", "8"], " ", "\[ImaginaryI]", " ", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{
         RowBox[{"-", "\[ImaginaryI]"}], " ", "\[CurlyPhi]"}]], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", 
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{"2", " ", "\[ImaginaryI]", " ", "\[CurlyPhi]"}]]}], ")"}]}], 
      RowBox[{
       FractionBox["1", "8"], " ", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{
         RowBox[{"-", "\[ImaginaryI]"}], " ", "\[CurlyPhi]"}]], " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"1", "+", 
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{"\[ImaginaryI]", " ", "\[CurlyPhi]"}]]}], ")"}], "2"]}], 
      RowBox[{
       FractionBox["1", "8"], " ", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{
         RowBox[{"-", "\[ImaginaryI]"}], " ", "\[CurlyPhi]"}]], " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"1", "+", 
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{"\[ImaginaryI]", " ", "\[CurlyPhi]"}]]}], ")"}], "2"]}], 
      RowBox[{
       RowBox[{"-", 
        FractionBox["1", "8"]}], " ", "\[ImaginaryI]", " ", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{
         RowBox[{"-", "\[ImaginaryI]"}], " ", "\[CurlyPhi]"}]], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", 
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{"2", " ", "\[ImaginaryI]", " ", "\[CurlyPhi]"}]]}], ")"}]}]},
     {
      RowBox[{
       FractionBox["1", "8"], " ", "\[ImaginaryI]", " ", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{
         RowBox[{"-", "\[ImaginaryI]"}], " ", "\[CurlyPhi]"}]], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", 
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{"2", " ", "\[ImaginaryI]", " ", "\[CurlyPhi]"}]]}], ")"}]}], 
      RowBox[{
       FractionBox["1", "8"], " ", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{
         RowBox[{"-", "\[ImaginaryI]"}], " ", "\[CurlyPhi]"}]], " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"1", "+", 
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{"\[ImaginaryI]", " ", "\[CurlyPhi]"}]]}], ")"}], "2"]}], 
      RowBox[{
       FractionBox["1", "8"], " ", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{
         RowBox[{"-", "\[ImaginaryI]"}], " ", "\[CurlyPhi]"}]], " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"1", "+", 
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{"\[ImaginaryI]", " ", "\[CurlyPhi]"}]]}], ")"}], "2"]}], 
      RowBox[{
       RowBox[{"-", 
        FractionBox["1", "8"]}], " ", "\[ImaginaryI]", " ", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{
         RowBox[{"-", "\[ImaginaryI]"}], " ", "\[CurlyPhi]"}]], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", 
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{"2", " ", "\[ImaginaryI]", " ", "\[CurlyPhi]"}]]}], ")"}]}]},
     {
      RowBox[{
       FractionBox["1", "8"], " ", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{
         RowBox[{"-", "\[ImaginaryI]"}], " ", "\[CurlyPhi]"}]], " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", 
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{"\[ImaginaryI]", " ", "\[CurlyPhi]"}]]}], ")"}], "2"]}], 
      RowBox[{
       RowBox[{"-", 
        FractionBox["1", "8"]}], " ", "\[ImaginaryI]", " ", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{
         RowBox[{"-", "\[ImaginaryI]"}], " ", "\[CurlyPhi]"}]], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", 
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{"2", " ", "\[ImaginaryI]", " ", "\[CurlyPhi]"}]]}], ")"}]}], 
      RowBox[{
       RowBox[{"-", 
        FractionBox["1", "8"]}], " ", "\[ImaginaryI]", " ", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{
         RowBox[{"-", "\[ImaginaryI]"}], " ", "\[CurlyPhi]"}]], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", 
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{"2", " ", "\[ImaginaryI]", " ", "\[CurlyPhi]"}]]}], ")"}]}], 
      RowBox[{
       RowBox[{"-", 
        FractionBox["1", "8"]}], " ", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{
         RowBox[{"-", "\[ImaginaryI]"}], " ", "\[CurlyPhi]"}]], " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", 
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{"\[ImaginaryI]", " ", "\[CurlyPhi]"}]]}], ")"}], "2"]}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.7602535315960665`*^9, 3.760253578122645*^9}, 
   3.760255976062682*^9},
 CellLabel->
  "Out[128]//MatrixForm=",ExpressionUUID->"c7bb36dc-fb57-47ce-a615-\
50ebeaea73c2"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"vecm1", "=", 
   RowBox[{"partTr", "[", 
    RowBox[{"vecm", ",", 
     RowBox[{"{", "2", "}"}], ",", "2"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"vecm2", "=", 
   RowBox[{"partTr", "[", 
    RowBox[{"vecm", ",", 
     RowBox[{"{", "1", "}"}], ",", "2"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.760255977814996*^9, 3.7602559964820766`*^9}, {
  3.7602560642159424`*^9, 3.7602560715672827`*^9}},
 CellLabel->
  "In[134]:=",ExpressionUUID->"ad256ae4-8a8a-48f8-9cad-55ca201abbc8"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"-", 
        FractionBox["1", "8"]}], " ", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{
         RowBox[{"-", "\[ImaginaryI]"}], " ", "\[CurlyPhi]"}]], " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", 
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{"\[ImaginaryI]", " ", "\[CurlyPhi]"}]]}], ")"}], "2"]}], 
      "+", 
      RowBox[{
       FractionBox["1", "8"], " ", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{
         RowBox[{"-", "\[ImaginaryI]"}], " ", "\[CurlyPhi]"}]], " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"1", "+", 
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{"\[ImaginaryI]", " ", "\[CurlyPhi]"}]]}], ")"}], "2"]}]}], 
     ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", 
     RowBox[{
      RowBox[{
       RowBox[{"-", 
        FractionBox["1", "8"]}], " ", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{
         RowBox[{"-", "\[ImaginaryI]"}], " ", "\[CurlyPhi]"}]], " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", 
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{"\[ImaginaryI]", " ", "\[CurlyPhi]"}]]}], ")"}], "2"]}], 
      "+", 
      RowBox[{
       FractionBox["1", "8"], " ", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{
         RowBox[{"-", "\[ImaginaryI]"}], " ", "\[CurlyPhi]"}]], " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"1", "+", 
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{"\[ImaginaryI]", " ", "\[CurlyPhi]"}]]}], ")"}], 
        "2"]}]}]}], "}"}]}], "}"}]], "Echo",
 CellChangeTimes->{
  3.7602560719971333`*^9},ExpressionUUID->"19a702d3-465c-4ff3-8617-\
e29c02a3497c"],

Cell[BoxData["True"], "Echo",
 CellChangeTimes->{
  3.760256072030046*^9},ExpressionUUID->"7124e3ac-cccb-46ba-acf0-\
d12e3271d64e"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"-", 
        FractionBox["1", "8"]}], " ", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{
         RowBox[{"-", "\[ImaginaryI]"}], " ", "\[CurlyPhi]"}]], " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", 
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{"\[ImaginaryI]", " ", "\[CurlyPhi]"}]]}], ")"}], "2"]}], 
      "+", 
      RowBox[{
       FractionBox["1", "8"], " ", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{
         RowBox[{"-", "\[ImaginaryI]"}], " ", "\[CurlyPhi]"}]], " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"1", "+", 
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{"\[ImaginaryI]", " ", "\[CurlyPhi]"}]]}], ")"}], "2"]}]}], 
     ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", 
     RowBox[{
      RowBox[{
       RowBox[{"-", 
        FractionBox["1", "8"]}], " ", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{
         RowBox[{"-", "\[ImaginaryI]"}], " ", "\[CurlyPhi]"}]], " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", 
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{"\[ImaginaryI]", " ", "\[CurlyPhi]"}]]}], ")"}], "2"]}], 
      "+", 
      RowBox[{
       FractionBox["1", "8"], " ", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{
         RowBox[{"-", "\[ImaginaryI]"}], " ", "\[CurlyPhi]"}]], " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"1", "+", 
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{"\[ImaginaryI]", " ", "\[CurlyPhi]"}]]}], ")"}], 
        "2"]}]}]}], "}"}]}], "}"}]], "Echo",
 CellChangeTimes->{
  3.7602560720998583`*^9},ExpressionUUID->"a57c905c-ba30-49d2-b70d-\
64fb8a65f5e5"],

Cell[BoxData["True"], "Echo",
 CellChangeTimes->{
  3.760256072133768*^9},ExpressionUUID->"398ee900-aa90-466c-b2e1-\
ab8d541acc66"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Simplify", "[", 
  RowBox[{
   RowBox[{"SingularValueList", "[", "vecm1", "]"}], ",", 
   RowBox[{"\[CurlyPhi]", "\[Element]", "Reals"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.760253579616651*^9, 3.76025362276227*^9}, 
   3.760256079387371*^9},
 CellLabel->
  "In[137]:=",ExpressionUUID->"791e280f-6945-43e3-8006-b6b48b06df14"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   FractionBox["1", "2"], ",", 
   FractionBox["1", "2"]}], "}"}]], "Output",
 CellChangeTimes->{{3.760253586614935*^9, 3.760253623369646*^9}, {
  3.7602560753342085`*^9, 3.7602560798182173`*^9}},
 CellLabel->
  "Out[137]=",ExpressionUUID->"b8612045-a170-4b2a-ad05-631b80fa28e3"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Simplify", "[", 
  RowBox[{
   RowBox[{"SingularValueList", "[", "vecm2", "]"}], ",", 
   RowBox[{"\[CurlyPhi]", "\[Element]", "Reals"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.760253579616651*^9, 3.76025362276227*^9}, {
  3.760256079387371*^9, 3.76025608275636*^9}},
 CellLabel->
  "In[138]:=",ExpressionUUID->"f82ed799-c472-498d-b26e-1ba564f72bef"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   FractionBox["1", "2"], ",", 
   FractionBox["1", "2"]}], "}"}]], "Output",
 CellChangeTimes->{3.760256083102436*^9},
 CellLabel->
  "Out[138]=",ExpressionUUID->"58fca47c-d4d6-474c-8151-e2c7de1bda6c"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"u", ",", "w", ",", "v"}], "}"}], "=", 
   RowBox[{"SingularValueDecomposition", "[", "vecm1", "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{3.7602536943817434`*^9, 3.7602560180573807`*^9},
 CellLabel->
  "In[132]:=",ExpressionUUID->"607a8d84-109a-401b-ae5b-ee40db3a058c"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"u", ",", "w", ",", "v"}], "}"}], "=", 
   RowBox[{"SingularValueDecomposition", "[", 
    RowBox[{"vecm", "/.", 
     RowBox[{"\[CurlyPhi]", "\[Rule]", "0"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{
  3.7602536943817434`*^9, {3.760253734444645*^9, 3.760253737725833*^9}},
 CellLabel->
  "In[124]:=",ExpressionUUID->"7ce7f631-97d6-4571-bf5e-be76a0ac6873"],

Cell[CellGroupData[{

Cell[BoxData["w"], "Input",
 CellChangeTimes->{3.7602537406131115`*^9},
 CellLabel->
  "In[125]:=",ExpressionUUID->"e4d1c42c-3606-496e-ae45-78ad3f26bfc2"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"1", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.7602537409841194`*^9},
 CellLabel->
  "Out[125]=",ExpressionUUID->"af29ae94-d584-4e93-9411-5689ed89f206"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Simplify", "[", 
  RowBox[{"w", ",", 
   RowBox[{"\[CurlyPhi]", "\[Element]", "Reals"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.760253579616651*^9, 3.760253717123929*^9}},
 CellLabel->
  "In[133]:=",ExpressionUUID->"aaa18592-a7de-4a5b-acf1-aa4bc6367824"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     FractionBox["1", "2"], ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", 
     FractionBox["1", "2"]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.7602536390936317`*^9, 3.760253666620983*^9}, {
   3.7602536984069824`*^9, 3.7602537174550433`*^9}, 3.7602560226959753`*^9},
 CellLabel->
  "Out[133]=",ExpressionUUID->"600272e9-4db4-43ba-9726-a99f90cab1f9"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Solve", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"Abs", "[", 
     RowBox[{"1", "-", 
      RowBox[{"Exp", "[", 
       RowBox[{"I", " ", "\[CurlyPhi]"}], "]"}]}], "]"}], "\[Equal]", 
    RowBox[{"Abs", "[", 
     RowBox[{"1", "+", 
      RowBox[{"Exp", "[", 
       RowBox[{"I", " ", "\[CurlyPhi]"}], "]"}]}], "]"}]}], ",", 
   "\[CurlyPhi]"}], "]"}]], "Input",
 CellChangeTimes->{{3.760254198658204*^9, 3.7602542019115047`*^9}, {
  3.7602542581929975`*^9, 3.760254286048503*^9}},
 CellLabel->
  "In[127]:=",ExpressionUUID->"a723611a-356b-41dd-823d-737e6d177ab1"],

Cell[BoxData[
 RowBox[{"{", "}"}]], "Output",
 CellChangeTimes->{{3.7602542776699104`*^9, 3.760254286603022*^9}},
 CellLabel->
  "Out[127]=",ExpressionUUID->"4ef6762a-b2b4-44f3-8657-63f717a6bb6b"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["GHZ state", "Subchapter",
 CellChangeTimes->{{3.7603554485536757`*^9, 
  3.7603554497644405`*^9}},ExpressionUUID->"b849c283-06bf-4412-8477-\
da1d83231f05"],

Cell[BoxData[
 RowBox[{
  RowBox[{"getGHZ", "[", 
   RowBox[{"num_", ",", "dim_Integer"}], "]"}], ":=", 
  RowBox[{
   RowBox[{
    FractionBox["1", 
     SqrtBox["dim"]], 
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{"Ket", "@@", 
       RowBox[{"ConstantArray", "[", 
        RowBox[{
         RowBox[{"i", "-", "1"}], ",", "num"}], "]"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "dim"}], "}"}]}], "]"}]}], "/;", 
   RowBox[{"dim", ">", "0"}]}]}]], "Input",
 CellChangeTimes->{{3.7603554836705465`*^9, 3.760355578497957*^9}, {
  3.7603556375001726`*^9, 3.7603556376966486`*^9}},
 CellLabel->"In[25]:=",ExpressionUUID->"432ddc30-504e-4ae1-88f8-e121acf4e149"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"getGHZ", "[", 
  RowBox[{"4", ",", "2"}], "]"}]], "Input",
 CellChangeTimes->{{3.760355552665041*^9, 3.760355583448718*^9}, 
   3.7603558439502707`*^9},
 CellLabel->"In[30]:=",ExpressionUUID->"9dc9f61e-879f-4a30-80ff-cfd557d9e404"],

Cell[BoxData[
 FractionBox[
  RowBox[{
   TemplateBox[{
     RowBox[{"0", ",", "0", ",", "0", ",", "0"}]},
    "Ket"], "+", 
   TemplateBox[{
     RowBox[{"1", ",", "1", ",", "1", ",", "1"}]},
    "Ket"]}], 
  SqrtBox["2"]]], "Output",
 CellChangeTimes->{{3.7603555562075663`*^9, 3.760355583729967*^9}, 
   3.7603556390949078`*^9, 3.760355844284343*^9},
 CellLabel->"Out[30]=",ExpressionUUID->"4640a2d0-bffd-4c7b-9cd9-a251822f8379"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Labeled", "[", 
      RowBox[{
       RowBox[{"changeBasis", "[", 
        RowBox[{
         RowBox[{"replaceKet", "[", 
          RowBox[{
           RowBox[{"getGHZ", "[", 
            RowBox[{"num", ",", "2"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"Ket", "[", "0", "]"}], "\[Rule]", 
              RowBox[{"Ket", "[", "\"\<H\>\"", "]"}]}], ",", 
             RowBox[{
              RowBox[{"Ket", "[", "1", "]"}], "\[Rule]", 
              RowBox[{"Ket", "[", "\"\<V\>\"", "]"}]}]}], "}"}]}], "]"}], 
         ",", "\"\<comp\>\"", ",", "\"\<diag\>\""}], "]"}], ",", "num", ",", 
       "Left"}], "]"}], "//", "Simplify"}], ",", 
    RowBox[{"{", 
     RowBox[{"num", ",", "7"}], "}"}]}], "]"}], "//", "Column"}]], "Input",
 CellChangeTimes->{{3.760355616560171*^9, 3.760355702889311*^9}, {
   3.7603564516893206`*^9, 3.7603565024604025`*^9}, 3.760357655083871*^9, {
   3.7603771233896093`*^9, 3.760377144235058*^9}, {3.760377208275008*^9, 
   3.76037726541216*^9}},
 CellLabel->"In[55]:=",ExpressionUUID->"da7b9a63-e905-4cb8-a1d8-2ad058f082c0"],

Cell[BoxData[
 TagBox[GridBox[{
    {
     TemplateBox[{
       TemplateBox[{"\"D\""}, "Ket"], "1"},
      "Labeled",
      DisplayFunction->(GridBox[{{
          ItemBox[#2, DefaultBaseStyle -> "LabeledLabel"], 
          TagBox[
           ItemBox[
            PaneBox[
             TagBox[#, "SkipImageSizeLevel"], Alignment -> {Center, Baseline},
              BaselinePosition -> Baseline], DefaultBaseStyle -> "Labeled"], 
           "SkipImageSizeLevel"]}}, 
        GridBoxAlignment -> {"Columns" -> {{Center}}, "Rows" -> {{Center}}}, 
        AutoDelete -> False, 
        GridBoxItemSize -> {
         "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
        BaselinePosition -> {1, 2}]& ),
      InterpretationFunction->(RowBox[{"Labeled", "[", 
         RowBox[{#, ",", #2, ",", "Left"}], "]"}]& )]},
    {
     TemplateBox[{
       FractionBox[
        RowBox[{
          TemplateBox[{
            RowBox[{"\"A\"", ",", "\"A\""}]}, "Ket"], "+", 
          TemplateBox[{
            RowBox[{"\"D\"", ",", "\"D\""}]}, "Ket"]}], 
        SqrtBox["2"]], "2"},
      "Labeled",
      DisplayFunction->(GridBox[{{
          ItemBox[#2, DefaultBaseStyle -> "LabeledLabel"], 
          TagBox[
           ItemBox[
            PaneBox[
             TagBox[#, "SkipImageSizeLevel"], Alignment -> {Center, Baseline},
              BaselinePosition -> Baseline], DefaultBaseStyle -> "Labeled"], 
           "SkipImageSizeLevel"]}}, 
        GridBoxAlignment -> {"Columns" -> {{Center}}, "Rows" -> {{Center}}}, 
        AutoDelete -> False, 
        GridBoxItemSize -> {
         "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
        BaselinePosition -> {1, 2}]& ),
      InterpretationFunction->(RowBox[{"Labeled", "[", 
         RowBox[{#, ",", #2, ",", "Left"}], "]"}]& )]},
    {
     TemplateBox[{
       RowBox[{
         FractionBox["1", "2"], " ", 
         RowBox[{"(", 
           RowBox[{
             TemplateBox[{
               RowBox[{"\"A\"", ",", "\"A\"", ",", "\"D\""}]}, "Ket"], "+", 
             TemplateBox[{
               RowBox[{"\"A\"", ",", "\"D\"", ",", "\"A\""}]}, "Ket"], "+", 
             TemplateBox[{
               RowBox[{"\"D\"", ",", "\"A\"", ",", "\"A\""}]}, "Ket"], "+", 
             TemplateBox[{
               RowBox[{"\"D\"", ",", "\"D\"", ",", "\"D\""}]}, "Ket"]}], 
           ")"}]}], "3"},
      "Labeled",
      DisplayFunction->(GridBox[{{
          ItemBox[#2, DefaultBaseStyle -> "LabeledLabel"], 
          TagBox[
           ItemBox[
            PaneBox[
             TagBox[#, "SkipImageSizeLevel"], Alignment -> {Center, Baseline},
              BaselinePosition -> Baseline], DefaultBaseStyle -> "Labeled"], 
           "SkipImageSizeLevel"]}}, 
        GridBoxAlignment -> {"Columns" -> {{Center}}, "Rows" -> {{Center}}}, 
        AutoDelete -> False, 
        GridBoxItemSize -> {
         "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
        BaselinePosition -> {1, 2}]& ),
      InterpretationFunction->(RowBox[{"Labeled", "[", 
         RowBox[{#, ",", #2, ",", "Left"}], "]"}]& )]},
    {
     TemplateBox[{
       FractionBox[
        RowBox[{
          TemplateBox[{
            RowBox[{"\"A\"", ",", "\"A\"", ",", "\"A\"", ",", "\"A\""}]}, 
           "Ket"], "+", 
          TemplateBox[{
            RowBox[{"\"A\"", ",", "\"A\"", ",", "\"D\"", ",", "\"D\""}]}, 
           "Ket"], "+", 
          TemplateBox[{
            RowBox[{"\"A\"", ",", "\"D\"", ",", "\"A\"", ",", "\"D\""}]}, 
           "Ket"], "+", 
          TemplateBox[{
            RowBox[{"\"A\"", ",", "\"D\"", ",", "\"D\"", ",", "\"A\""}]}, 
           "Ket"], "+", 
          TemplateBox[{
            RowBox[{"\"D\"", ",", "\"A\"", ",", "\"A\"", ",", "\"D\""}]}, 
           "Ket"], "+", 
          TemplateBox[{
            RowBox[{"\"D\"", ",", "\"A\"", ",", "\"D\"", ",", "\"A\""}]}, 
           "Ket"], "+", 
          TemplateBox[{
            RowBox[{"\"D\"", ",", "\"D\"", ",", "\"A\"", ",", "\"A\""}]}, 
           "Ket"], "+", 
          TemplateBox[{
            RowBox[{"\"D\"", ",", "\"D\"", ",", "\"D\"", ",", "\"D\""}]}, 
           "Ket"]}], 
        RowBox[{"2", " ", 
          SqrtBox["2"]}]], "4"},
      "Labeled",
      DisplayFunction->(GridBox[{{
          ItemBox[#2, DefaultBaseStyle -> "LabeledLabel"], 
          TagBox[
           ItemBox[
            PaneBox[
             TagBox[#, "SkipImageSizeLevel"], Alignment -> {Center, Baseline},
              BaselinePosition -> Baseline], DefaultBaseStyle -> "Labeled"], 
           "SkipImageSizeLevel"]}}, 
        GridBoxAlignment -> {"Columns" -> {{Center}}, "Rows" -> {{Center}}}, 
        AutoDelete -> False, 
        GridBoxItemSize -> {
         "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
        BaselinePosition -> {1, 2}]& ),
      InterpretationFunction->(RowBox[{"Labeled", "[", 
         RowBox[{#, ",", #2, ",", "Left"}], "]"}]& )]},
    {
     TemplateBox[{
       RowBox[{
         FractionBox["1", "4"], " ", 
         RowBox[{"(", 
           RowBox[{
             TemplateBox[{
               
               RowBox[{
                "\"A\"", ",", "\"A\"", ",", "\"A\"", ",", "\"A\"", ",", 
                 "\"D\""}]}, "Ket"], "+", 
             TemplateBox[{
               
               RowBox[{
                "\"A\"", ",", "\"A\"", ",", "\"A\"", ",", "\"D\"", ",", 
                 "\"A\""}]}, "Ket"], "+", 
             TemplateBox[{
               
               RowBox[{
                "\"A\"", ",", "\"A\"", ",", "\"D\"", ",", "\"A\"", ",", 
                 "\"A\""}]}, "Ket"], "+", 
             TemplateBox[{
               
               RowBox[{
                "\"A\"", ",", "\"A\"", ",", "\"D\"", ",", "\"D\"", ",", 
                 "\"D\""}]}, "Ket"], "+", 
             TemplateBox[{
               
               RowBox[{
                "\"A\"", ",", "\"D\"", ",", "\"A\"", ",", "\"A\"", ",", 
                 "\"A\""}]}, "Ket"], "+", 
             TemplateBox[{
               
               RowBox[{
                "\"A\"", ",", "\"D\"", ",", "\"A\"", ",", "\"D\"", ",", 
                 "\"D\""}]}, "Ket"], "+", 
             TemplateBox[{
               
               RowBox[{
                "\"A\"", ",", "\"D\"", ",", "\"D\"", ",", "\"A\"", ",", 
                 "\"D\""}]}, "Ket"], "+", 
             TemplateBox[{
               
               RowBox[{
                "\"A\"", ",", "\"D\"", ",", "\"D\"", ",", "\"D\"", ",", 
                 "\"A\""}]}, "Ket"], "+", 
             TemplateBox[{
               
               RowBox[{
                "\"D\"", ",", "\"A\"", ",", "\"A\"", ",", "\"A\"", ",", 
                 "\"A\""}]}, "Ket"], "+", 
             TemplateBox[{
               
               RowBox[{
                "\"D\"", ",", "\"A\"", ",", "\"A\"", ",", "\"D\"", ",", 
                 "\"D\""}]}, "Ket"], "+", 
             TemplateBox[{
               
               RowBox[{
                "\"D\"", ",", "\"A\"", ",", "\"D\"", ",", "\"A\"", ",", 
                 "\"D\""}]}, "Ket"], "+", 
             TemplateBox[{
               
               RowBox[{
                "\"D\"", ",", "\"A\"", ",", "\"D\"", ",", "\"D\"", ",", 
                 "\"A\""}]}, "Ket"], "+", 
             TemplateBox[{
               
               RowBox[{
                "\"D\"", ",", "\"D\"", ",", "\"A\"", ",", "\"A\"", ",", 
                 "\"D\""}]}, "Ket"], "+", 
             TemplateBox[{
               
               RowBox[{
                "\"D\"", ",", "\"D\"", ",", "\"A\"", ",", "\"D\"", ",", 
                 "\"A\""}]}, "Ket"], "+", 
             TemplateBox[{
               
               RowBox[{
                "\"D\"", ",", "\"D\"", ",", "\"D\"", ",", "\"A\"", ",", 
                 "\"A\""}]}, "Ket"], "+", 
             TemplateBox[{
               
               RowBox[{
                "\"D\"", ",", "\"D\"", ",", "\"D\"", ",", "\"D\"", ",", 
                 "\"D\""}]}, "Ket"]}], ")"}]}], "5"},
      "Labeled",
      DisplayFunction->(GridBox[{{
          ItemBox[#2, DefaultBaseStyle -> "LabeledLabel"], 
          TagBox[
           ItemBox[
            PaneBox[
             TagBox[#, "SkipImageSizeLevel"], Alignment -> {Center, Baseline},
              BaselinePosition -> Baseline], DefaultBaseStyle -> "Labeled"], 
           "SkipImageSizeLevel"]}}, 
        GridBoxAlignment -> {"Columns" -> {{Center}}, "Rows" -> {{Center}}}, 
        AutoDelete -> False, 
        GridBoxItemSize -> {
         "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
        BaselinePosition -> {1, 2}]& ),
      InterpretationFunction->(RowBox[{"Labeled", "[", 
         RowBox[{#, ",", #2, ",", "Left"}], "]"}]& )]},
    {
     TemplateBox[{
       RowBox[{
         FractionBox["1", 
          RowBox[{"4", " ", 
            SqrtBox["2"]}]], 
         RowBox[{"(", 
           RowBox[{
             TemplateBox[{
               
               RowBox[{
                "\"A\"", ",", "\"A\"", ",", "\"A\"", ",", "\"A\"", ",", 
                 "\"A\"", ",", "\"A\""}]}, "Ket"], "+", 
             TemplateBox[{
               
               RowBox[{
                "\"A\"", ",", "\"A\"", ",", "\"A\"", ",", "\"A\"", ",", 
                 "\"D\"", ",", "\"D\""}]}, "Ket"], "+", 
             TemplateBox[{
               
               RowBox[{
                "\"A\"", ",", "\"A\"", ",", "\"A\"", ",", "\"D\"", ",", 
                 "\"A\"", ",", "\"D\""}]}, "Ket"], "+", 
             TemplateBox[{
               
               RowBox[{
                "\"A\"", ",", "\"A\"", ",", "\"A\"", ",", "\"D\"", ",", 
                 "\"D\"", ",", "\"A\""}]}, "Ket"], "+", 
             TemplateBox[{
               
               RowBox[{
                "\"A\"", ",", "\"A\"", ",", "\"D\"", ",", "\"A\"", ",", 
                 "\"A\"", ",", "\"D\""}]}, "Ket"], "+", 
             TemplateBox[{
               
               RowBox[{
                "\"A\"", ",", "\"A\"", ",", "\"D\"", ",", "\"A\"", ",", 
                 "\"D\"", ",", "\"A\""}]}, "Ket"], "+", 
             TemplateBox[{
               
               RowBox[{
                "\"A\"", ",", "\"A\"", ",", "\"D\"", ",", "\"D\"", ",", 
                 "\"A\"", ",", "\"A\""}]}, "Ket"], "+", 
             TemplateBox[{
               
               RowBox[{
                "\"A\"", ",", "\"A\"", ",", "\"D\"", ",", "\"D\"", ",", 
                 "\"D\"", ",", "\"D\""}]}, "Ket"], "+", 
             TemplateBox[{
               
               RowBox[{
                "\"A\"", ",", "\"D\"", ",", "\"A\"", ",", "\"A\"", ",", 
                 "\"A\"", ",", "\"D\""}]}, "Ket"], "+", 
             TemplateBox[{
               
               RowBox[{
                "\"A\"", ",", "\"D\"", ",", "\"A\"", ",", "\"A\"", ",", 
                 "\"D\"", ",", "\"A\""}]}, "Ket"], "+", 
             TemplateBox[{
               
               RowBox[{
                "\"A\"", ",", "\"D\"", ",", "\"A\"", ",", "\"D\"", ",", 
                 "\"A\"", ",", "\"A\""}]}, "Ket"], "+", 
             TemplateBox[{
               
               RowBox[{
                "\"A\"", ",", "\"D\"", ",", "\"A\"", ",", "\"D\"", ",", 
                 "\"D\"", ",", "\"D\""}]}, "Ket"], "+", 
             TemplateBox[{
               
               RowBox[{
                "\"A\"", ",", "\"D\"", ",", "\"D\"", ",", "\"A\"", ",", 
                 "\"A\"", ",", "\"A\""}]}, "Ket"], "+", 
             TemplateBox[{
               
               RowBox[{
                "\"A\"", ",", "\"D\"", ",", "\"D\"", ",", "\"A\"", ",", 
                 "\"D\"", ",", "\"D\""}]}, "Ket"], "+", 
             TemplateBox[{
               
               RowBox[{
                "\"A\"", ",", "\"D\"", ",", "\"D\"", ",", "\"D\"", ",", 
                 "\"A\"", ",", "\"D\""}]}, "Ket"], "+", 
             TemplateBox[{
               
               RowBox[{
                "\"A\"", ",", "\"D\"", ",", "\"D\"", ",", "\"D\"", ",", 
                 "\"D\"", ",", "\"A\""}]}, "Ket"], "+", 
             TemplateBox[{
               
               RowBox[{
                "\"D\"", ",", "\"A\"", ",", "\"A\"", ",", "\"A\"", ",", 
                 "\"A\"", ",", "\"D\""}]}, "Ket"], "+", 
             TemplateBox[{
               
               RowBox[{
                "\"D\"", ",", "\"A\"", ",", "\"A\"", ",", "\"A\"", ",", 
                 "\"D\"", ",", "\"A\""}]}, "Ket"], "+", 
             TemplateBox[{
               
               RowBox[{
                "\"D\"", ",", "\"A\"", ",", "\"A\"", ",", "\"D\"", ",", 
                 "\"A\"", ",", "\"A\""}]}, "Ket"], "+", 
             TemplateBox[{
               
               RowBox[{
                "\"D\"", ",", "\"A\"", ",", "\"A\"", ",", "\"D\"", ",", 
                 "\"D\"", ",", "\"D\""}]}, "Ket"], "+", 
             TemplateBox[{
               
               RowBox[{
                "\"D\"", ",", "\"A\"", ",", "\"D\"", ",", "\"A\"", ",", 
                 "\"A\"", ",", "\"A\""}]}, "Ket"], "+", 
             TemplateBox[{
               
               RowBox[{
                "\"D\"", ",", "\"A\"", ",", "\"D\"", ",", "\"A\"", ",", 
                 "\"D\"", ",", "\"D\""}]}, "Ket"], "+", 
             TemplateBox[{
               
               RowBox[{
                "\"D\"", ",", "\"A\"", ",", "\"D\"", ",", "\"D\"", ",", 
                 "\"A\"", ",", "\"D\""}]}, "Ket"], "+", 
             TemplateBox[{
               
               RowBox[{
                "\"D\"", ",", "\"A\"", ",", "\"D\"", ",", "\"D\"", ",", 
                 "\"D\"", ",", "\"A\""}]}, "Ket"], "+", 
             TemplateBox[{
               
               RowBox[{
                "\"D\"", ",", "\"D\"", ",", "\"A\"", ",", "\"A\"", ",", 
                 "\"A\"", ",", "\"A\""}]}, "Ket"], "+", 
             TemplateBox[{
               
               RowBox[{
                "\"D\"", ",", "\"D\"", ",", "\"A\"", ",", "\"A\"", ",", 
                 "\"D\"", ",", "\"D\""}]}, "Ket"], "+", 
             TemplateBox[{
               
               RowBox[{
                "\"D\"", ",", "\"D\"", ",", "\"A\"", ",", "\"D\"", ",", 
                 "\"A\"", ",", "\"D\""}]}, "Ket"], "+", 
             TemplateBox[{
               
               RowBox[{
                "\"D\"", ",", "\"D\"", ",", "\"A\"", ",", "\"D\"", ",", 
                 "\"D\"", ",", "\"A\""}]}, "Ket"], "+", 
             TemplateBox[{
               
               RowBox[{
                "\"D\"", ",", "\"D\"", ",", "\"D\"", ",", "\"A\"", ",", 
                 "\"A\"", ",", "\"D\""}]}, "Ket"], "+", 
             TemplateBox[{
               
               RowBox[{
                "\"D\"", ",", "\"D\"", ",", "\"D\"", ",", "\"A\"", ",", 
                 "\"D\"", ",", "\"A\""}]}, "Ket"], "+", 
             TemplateBox[{
               
               RowBox[{
                "\"D\"", ",", "\"D\"", ",", "\"D\"", ",", "\"D\"", ",", 
                 "\"A\"", ",", "\"A\""}]}, "Ket"], "+", 
             TemplateBox[{
               
               RowBox[{
                "\"D\"", ",", "\"D\"", ",", "\"D\"", ",", "\"D\"", ",", 
                 "\"D\"", ",", "\"D\""}]}, "Ket"]}], ")"}]}], "6"},
      "Labeled",
      DisplayFunction->(GridBox[{{
          ItemBox[#2, DefaultBaseStyle -> "LabeledLabel"], 
          TagBox[
           ItemBox[
            PaneBox[
             TagBox[#, "SkipImageSizeLevel"], Alignment -> {Center, Baseline},
              BaselinePosition -> Baseline], DefaultBaseStyle -> "Labeled"], 
           "SkipImageSizeLevel"]}}, 
        GridBoxAlignment -> {"Columns" -> {{Center}}, "Rows" -> {{Center}}}, 
        AutoDelete -> False, 
        GridBoxItemSize -> {
         "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
        BaselinePosition -> {1, 2}]& ),
      InterpretationFunction->(RowBox[{"Labeled", "[", 
         RowBox[{#, ",", #2, ",", "Left"}], "]"}]& )]},
    {
     TemplateBox[{
       RowBox[{
         FractionBox["1", "8"], " ", 
         RowBox[{"(", 
           RowBox[{
             TemplateBox[{
               
               RowBox[{
                "\"A\"", ",", "\"A\"", ",", "\"A\"", ",", "\"A\"", ",", 
                 "\"A\"", ",", "\"A\"", ",", "\"D\""}]}, "Ket"], "+", 
             TemplateBox[{
               
               RowBox[{
                "\"A\"", ",", "\"A\"", ",", "\"A\"", ",", "\"A\"", ",", 
                 "\"A\"", ",", "\"D\"", ",", "\"A\""}]}, "Ket"], "+", 
             TemplateBox[{
               
               RowBox[{
                "\"A\"", ",", "\"A\"", ",", "\"A\"", ",", "\"A\"", ",", 
                 "\"D\"", ",", "\"A\"", ",", "\"A\""}]}, "Ket"], "+", 
             TemplateBox[{
               
               RowBox[{
                "\"A\"", ",", "\"A\"", ",", "\"A\"", ",", "\"A\"", ",", 
                 "\"D\"", ",", "\"D\"", ",", "\"D\""}]}, "Ket"], "+", 
             TemplateBox[{
               
               RowBox[{
                "\"A\"", ",", "\"A\"", ",", "\"A\"", ",", "\"D\"", ",", 
                 "\"A\"", ",", "\"A\"", ",", "\"A\""}]}, "Ket"], "+", 
             TemplateBox[{
               
               RowBox[{
                "\"A\"", ",", "\"A\"", ",", "\"A\"", ",", "\"D\"", ",", 
                 "\"A\"", ",", "\"D\"", ",", "\"D\""}]}, "Ket"], "+", 
             TemplateBox[{
               
               RowBox[{
                "\"A\"", ",", "\"A\"", ",", "\"A\"", ",", "\"D\"", ",", 
                 "\"D\"", ",", "\"A\"", ",", "\"D\""}]}, "Ket"], "+", 
             TemplateBox[{
               
               RowBox[{
                "\"A\"", ",", "\"A\"", ",", "\"A\"", ",", "\"D\"", ",", 
                 "\"D\"", ",", "\"D\"", ",", "\"A\""}]}, "Ket"], "+", 
             TemplateBox[{
               
               RowBox[{
                "\"A\"", ",", "\"A\"", ",", "\"D\"", ",", "\"A\"", ",", 
                 "\"A\"", ",", "\"A\"", ",", "\"A\""}]}, "Ket"], "+", 
             TemplateBox[{
               
               RowBox[{
                "\"A\"", ",", "\"A\"", ",", "\"D\"", ",", "\"A\"", ",", 
                 "\"A\"", ",", "\"D\"", ",", "\"D\""}]}, "Ket"], "+", 
             TemplateBox[{
               
               RowBox[{
                "\"A\"", ",", "\"A\"", ",", "\"D\"", ",", "\"A\"", ",", 
                 "\"D\"", ",", "\"A\"", ",", "\"D\""}]}, "Ket"], "+", 
             TemplateBox[{
               
               RowBox[{
                "\"A\"", ",", "\"A\"", ",", "\"D\"", ",", "\"A\"", ",", 
                 "\"D\"", ",", "\"D\"", ",", "\"A\""}]}, "Ket"], "+", 
             TemplateBox[{
               
               RowBox[{
                "\"A\"", ",", "\"A\"", ",", "\"D\"", ",", "\"D\"", ",", 
                 "\"A\"", ",", "\"A\"", ",", "\"D\""}]}, "Ket"], "+", 
             TemplateBox[{
               
               RowBox[{
                "\"A\"", ",", "\"A\"", ",", "\"D\"", ",", "\"D\"", ",", 
                 "\"A\"", ",", "\"D\"", ",", "\"A\""}]}, "Ket"], "+", 
             TemplateBox[{
               
               RowBox[{
                "\"A\"", ",", "\"A\"", ",", "\"D\"", ",", "\"D\"", ",", 
                 "\"D\"", ",", "\"A\"", ",", "\"A\""}]}, "Ket"], "+", 
             TemplateBox[{
               
               RowBox[{
                "\"A\"", ",", "\"A\"", ",", "\"D\"", ",", "\"D\"", ",", 
                 "\"D\"", ",", "\"D\"", ",", "\"D\""}]}, "Ket"], "+", 
             TemplateBox[{
               
               RowBox[{
                "\"A\"", ",", "\"D\"", ",", "\"A\"", ",", "\"A\"", ",", 
                 "\"A\"", ",", "\"A\"", ",", "\"A\""}]}, "Ket"], "+", 
             TemplateBox[{
               
               RowBox[{
                "\"A\"", ",", "\"D\"", ",", "\"A\"", ",", "\"A\"", ",", 
                 "\"A\"", ",", "\"D\"", ",", "\"D\""}]}, "Ket"], "+", 
             TemplateBox[{
               
               RowBox[{
                "\"A\"", ",", "\"D\"", ",", "\"A\"", ",", "\"A\"", ",", 
                 "\"D\"", ",", "\"A\"", ",", "\"D\""}]}, "Ket"], "+", 
             TemplateBox[{
               
               RowBox[{
                "\"A\"", ",", "\"D\"", ",", "\"A\"", ",", "\"A\"", ",", 
                 "\"D\"", ",", "\"D\"", ",", "\"A\""}]}, "Ket"], "+", 
             TemplateBox[{
               
               RowBox[{
                "\"A\"", ",", "\"D\"", ",", "\"A\"", ",", "\"D\"", ",", 
                 "\"A\"", ",", "\"A\"", ",", "\"D\""}]}, "Ket"], "+", 
             TemplateBox[{
               
               RowBox[{
                "\"A\"", ",", "\"D\"", ",", "\"A\"", ",", "\"D\"", ",", 
                 "\"A\"", ",", "\"D\"", ",", "\"A\""}]}, "Ket"], "+", 
             TemplateBox[{
               
               RowBox[{
                "\"A\"", ",", "\"D\"", ",", "\"A\"", ",", "\"D\"", ",", 
                 "\"D\"", ",", "\"A\"", ",", "\"A\""}]}, "Ket"], "+", 
             TemplateBox[{
               
               RowBox[{
                "\"A\"", ",", "\"D\"", ",", "\"A\"", ",", "\"D\"", ",", 
                 "\"D\"", ",", "\"D\"", ",", "\"D\""}]}, "Ket"], "+", 
             TemplateBox[{
               
               RowBox[{
                "\"A\"", ",", "\"D\"", ",", "\"D\"", ",", "\"A\"", ",", 
                 "\"A\"", ",", "\"A\"", ",", "\"D\""}]}, "Ket"], "+", 
             TemplateBox[{
               
               RowBox[{
                "\"A\"", ",", "\"D\"", ",", "\"D\"", ",", "\"A\"", ",", 
                 "\"A\"", ",", "\"D\"", ",", "\"A\""}]}, "Ket"], "+", 
             TemplateBox[{
               
               RowBox[{
                "\"A\"", ",", "\"D\"", ",", "\"D\"", ",", "\"A\"", ",", 
                 "\"D\"", ",", "\"A\"", ",", "\"A\""}]}, "Ket"], "+", 
             TemplateBox[{
               
               RowBox[{
                "\"A\"", ",", "\"D\"", ",", "\"D\"", ",", "\"A\"", ",", 
                 "\"D\"", ",", "\"D\"", ",", "\"D\""}]}, "Ket"], "+", 
             TemplateBox[{
               
               RowBox[{
                "\"A\"", ",", "\"D\"", ",", "\"D\"", ",", "\"D\"", ",", 
                 "\"A\"", ",", "\"A\"", ",", "\"A\""}]}, "Ket"], "+", 
             TemplateBox[{
               
               RowBox[{
                "\"A\"", ",", "\"D\"", ",", "\"D\"", ",", "\"D\"", ",", 
                 "\"A\"", ",", "\"D\"", ",", "\"D\""}]}, "Ket"], "+", 
             TemplateBox[{
               
               RowBox[{
                "\"A\"", ",", "\"D\"", ",", "\"D\"", ",", "\"D\"", ",", 
                 "\"D\"", ",", "\"A\"", ",", "\"D\""}]}, "Ket"], "+", 
             TemplateBox[{
               
               RowBox[{
                "\"A\"", ",", "\"D\"", ",", "\"D\"", ",", "\"D\"", ",", 
                 "\"D\"", ",", "\"D\"", ",", "\"A\""}]}, "Ket"], "+", 
             TemplateBox[{
               
               RowBox[{
                "\"D\"", ",", "\"A\"", ",", "\"A\"", ",", "\"A\"", ",", 
                 "\"A\"", ",", "\"A\"", ",", "\"A\""}]}, "Ket"], "+", 
             TemplateBox[{
               
               RowBox[{
                "\"D\"", ",", "\"A\"", ",", "\"A\"", ",", "\"A\"", ",", 
                 "\"A\"", ",", "\"D\"", ",", "\"D\""}]}, "Ket"], "+", 
             TemplateBox[{
               
               RowBox[{
                "\"D\"", ",", "\"A\"", ",", "\"A\"", ",", "\"A\"", ",", 
                 "\"D\"", ",", "\"A\"", ",", "\"D\""}]}, "Ket"], "+", 
             TemplateBox[{
               
               RowBox[{
                "\"D\"", ",", "\"A\"", ",", "\"A\"", ",", "\"A\"", ",", 
                 "\"D\"", ",", "\"D\"", ",", "\"A\""}]}, "Ket"], "+", 
             TemplateBox[{
               
               RowBox[{
                "\"D\"", ",", "\"A\"", ",", "\"A\"", ",", "\"D\"", ",", 
                 "\"A\"", ",", "\"A\"", ",", "\"D\""}]}, "Ket"], "+", 
             TemplateBox[{
               
               RowBox[{
                "\"D\"", ",", "\"A\"", ",", "\"A\"", ",", "\"D\"", ",", 
                 "\"A\"", ",", "\"D\"", ",", "\"A\""}]}, "Ket"], "+", 
             TemplateBox[{
               
               RowBox[{
                "\"D\"", ",", "\"A\"", ",", "\"A\"", ",", "\"D\"", ",", 
                 "\"D\"", ",", "\"A\"", ",", "\"A\""}]}, "Ket"], "+", 
             TemplateBox[{
               
               RowBox[{
                "\"D\"", ",", "\"A\"", ",", "\"A\"", ",", "\"D\"", ",", 
                 "\"D\"", ",", "\"D\"", ",", "\"D\""}]}, "Ket"], "+", 
             TemplateBox[{
               
               RowBox[{
                "\"D\"", ",", "\"A\"", ",", "\"D\"", ",", "\"A\"", ",", 
                 "\"A\"", ",", "\"A\"", ",", "\"D\""}]}, "Ket"], "+", 
             TemplateBox[{
               
               RowBox[{
                "\"D\"", ",", "\"A\"", ",", "\"D\"", ",", "\"A\"", ",", 
                 "\"A\"", ",", "\"D\"", ",", "\"A\""}]}, "Ket"], "+", 
             TemplateBox[{
               
               RowBox[{
                "\"D\"", ",", "\"A\"", ",", "\"D\"", ",", "\"A\"", ",", 
                 "\"D\"", ",", "\"A\"", ",", "\"A\""}]}, "Ket"], "+", 
             TemplateBox[{
               
               RowBox[{
                "\"D\"", ",", "\"A\"", ",", "\"D\"", ",", "\"A\"", ",", 
                 "\"D\"", ",", "\"D\"", ",", "\"D\""}]}, "Ket"], "+", 
             TemplateBox[{
               
               RowBox[{
                "\"D\"", ",", "\"A\"", ",", "\"D\"", ",", "\"D\"", ",", 
                 "\"A\"", ",", "\"A\"", ",", "\"A\""}]}, "Ket"], "+", 
             TemplateBox[{
               
               RowBox[{
                "\"D\"", ",", "\"A\"", ",", "\"D\"", ",", "\"D\"", ",", 
                 "\"A\"", ",", "\"D\"", ",", "\"D\""}]}, "Ket"], "+", 
             TemplateBox[{
               
               RowBox[{
                "\"D\"", ",", "\"A\"", ",", "\"D\"", ",", "\"D\"", ",", 
                 "\"D\"", ",", "\"A\"", ",", "\"D\""}]}, "Ket"], "+", 
             TemplateBox[{
               
               RowBox[{
                "\"D\"", ",", "\"A\"", ",", "\"D\"", ",", "\"D\"", ",", 
                 "\"D\"", ",", "\"D\"", ",", "\"A\""}]}, "Ket"], "+", 
             TemplateBox[{
               
               RowBox[{
                "\"D\"", ",", "\"D\"", ",", "\"A\"", ",", "\"A\"", ",", 
                 "\"A\"", ",", "\"A\"", ",", "\"D\""}]}, "Ket"], "+", 
             TemplateBox[{
               
               RowBox[{
                "\"D\"", ",", "\"D\"", ",", "\"A\"", ",", "\"A\"", ",", 
                 "\"A\"", ",", "\"D\"", ",", "\"A\""}]}, "Ket"], "+", 
             TemplateBox[{
               
               RowBox[{
                "\"D\"", ",", "\"D\"", ",", "\"A\"", ",", "\"A\"", ",", 
                 "\"D\"", ",", "\"A\"", ",", "\"A\""}]}, "Ket"], "+", 
             TemplateBox[{
               
               RowBox[{
                "\"D\"", ",", "\"D\"", ",", "\"A\"", ",", "\"A\"", ",", 
                 "\"D\"", ",", "\"D\"", ",", "\"D\""}]}, "Ket"], "+", 
             TemplateBox[{
               
               RowBox[{
                "\"D\"", ",", "\"D\"", ",", "\"A\"", ",", "\"D\"", ",", 
                 "\"A\"", ",", "\"A\"", ",", "\"A\""}]}, "Ket"], "+", 
             TemplateBox[{
               
               RowBox[{
                "\"D\"", ",", "\"D\"", ",", "\"A\"", ",", "\"D\"", ",", 
                 "\"A\"", ",", "\"D\"", ",", "\"D\""}]}, "Ket"], "+", 
             TemplateBox[{
               
               RowBox[{
                "\"D\"", ",", "\"D\"", ",", "\"A\"", ",", "\"D\"", ",", 
                 "\"D\"", ",", "\"A\"", ",", "\"D\""}]}, "Ket"], "+", 
             TemplateBox[{
               
               RowBox[{
                "\"D\"", ",", "\"D\"", ",", "\"A\"", ",", "\"D\"", ",", 
                 "\"D\"", ",", "\"D\"", ",", "\"A\""}]}, "Ket"], "+", 
             TemplateBox[{
               
               RowBox[{
                "\"D\"", ",", "\"D\"", ",", "\"D\"", ",", "\"A\"", ",", 
                 "\"A\"", ",", "\"A\"", ",", "\"A\""}]}, "Ket"], "+", 
             TemplateBox[{
               
               RowBox[{
                "\"D\"", ",", "\"D\"", ",", "\"D\"", ",", "\"A\"", ",", 
                 "\"A\"", ",", "\"D\"", ",", "\"D\""}]}, "Ket"], "+", 
             TemplateBox[{
               
               RowBox[{
                "\"D\"", ",", "\"D\"", ",", "\"D\"", ",", "\"A\"", ",", 
                 "\"D\"", ",", "\"A\"", ",", "\"D\""}]}, "Ket"], "+", 
             TemplateBox[{
               
               RowBox[{
                "\"D\"", ",", "\"D\"", ",", "\"D\"", ",", "\"A\"", ",", 
                 "\"D\"", ",", "\"D\"", ",", "\"A\""}]}, "Ket"], "+", 
             TemplateBox[{
               
               RowBox[{
                "\"D\"", ",", "\"D\"", ",", "\"D\"", ",", "\"D\"", ",", 
                 "\"A\"", ",", "\"A\"", ",", "\"D\""}]}, "Ket"], "+", 
             TemplateBox[{
               
               RowBox[{
                "\"D\"", ",", "\"D\"", ",", "\"D\"", ",", "\"D\"", ",", 
                 "\"A\"", ",", "\"D\"", ",", "\"A\""}]}, "Ket"], "+", 
             TemplateBox[{
               
               RowBox[{
                "\"D\"", ",", "\"D\"", ",", "\"D\"", ",", "\"D\"", ",", 
                 "\"D\"", ",", "\"A\"", ",", "\"A\""}]}, "Ket"], "+", 
             TemplateBox[{
               
               RowBox[{
                "\"D\"", ",", "\"D\"", ",", "\"D\"", ",", "\"D\"", ",", 
                 "\"D\"", ",", "\"D\"", ",", "\"D\""}]}, "Ket"]}], ")"}]}], 
       "7"},
      "Labeled",
      DisplayFunction->(GridBox[{{
          ItemBox[#2, DefaultBaseStyle -> "LabeledLabel"], 
          TagBox[
           ItemBox[
            PaneBox[
             TagBox[#, "SkipImageSizeLevel"], Alignment -> {Center, Baseline},
              BaselinePosition -> Baseline], DefaultBaseStyle -> "Labeled"], 
           "SkipImageSizeLevel"]}}, 
        GridBoxAlignment -> {"Columns" -> {{Center}}, "Rows" -> {{Center}}}, 
        AutoDelete -> False, 
        GridBoxItemSize -> {
         "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
        BaselinePosition -> {1, 2}]& ),
      InterpretationFunction->(RowBox[{"Labeled", "[", 
         RowBox[{#, ",", #2, ",", "Left"}], "]"}]& )]}
   },
   DefaultBaseStyle->"Column",
   GridBoxAlignment->{"Columns" -> {{Left}}},
   GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
  "Column"]], "Output",
 CellChangeTimes->{{3.7603556804253826`*^9, 3.7603557032453575`*^9}, {
   3.760356462711398*^9, 3.760356472465481*^9}, 3.7603565029822574`*^9, 
   3.7603576565030775`*^9, {3.760377139853777*^9, 3.760377144963567*^9}, 
   3.760377177518471*^9, {3.7603772097962127`*^9, 3.7603772660821123`*^9}},
 CellLabel->"Out[55]=",ExpressionUUID->"37b34869-b94d-4729-b546-4b6c1da2832a"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"changeBasis", "[", 
       RowBox[{
        RowBox[{"replaceKet", "[", 
         RowBox[{
          RowBox[{"getGHZ", "[", 
           RowBox[{"num", ",", "2"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"Ket", "[", "0", "]"}], "\[Rule]", 
             RowBox[{"Ket", "[", "\"\<D\>\"", "]"}]}], ",", 
            RowBox[{
             RowBox[{"Ket", "[", "1", "]"}], "\[Rule]", 
             RowBox[{"Ket", "[", "\"\<A\>\"", "]"}]}]}], "}"}]}], "]"}], ",", 
        "\"\<diag\>\"", ",", "\"\<comp\>\""}], "]"}], "//", "Simplify"}], "//",
      "Sort"}], ",", 
    RowBox[{"{", 
     RowBox[{"num", ",", "3"}], "}"}]}], "]"}], "//", "Column"}]], "Input",
 CellChangeTimes->{{3.7603625179481616`*^9, 3.7603625297909727`*^9}},
 CellLabel->"In[47]:=",ExpressionUUID->"c1d16a91-b9ec-46ae-8884-64e6b04a9a07"],

Cell[BoxData[
 TagBox[GridBox[{
    {
     TemplateBox[{"\"H\""},
      "Ket"]},
    {
     FractionBox[
      RowBox[{
       TemplateBox[{
         RowBox[{"\"H\"", ",", "\"H\""}]},
        "Ket"], "+", 
       TemplateBox[{
         RowBox[{"\"V\"", ",", "\"V\""}]},
        "Ket"]}], 
      SqrtBox["2"]]},
    {
     RowBox[{
      FractionBox["1", "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        TemplateBox[{
          RowBox[{"\"H\"", ",", "\"H\"", ",", "\"H\""}]},
         "Ket"], "+", 
        TemplateBox[{
          RowBox[{"\"H\"", ",", "\"V\"", ",", "\"V\""}]},
         "Ket"], "+", 
        TemplateBox[{
          RowBox[{"\"V\"", ",", "\"H\"", ",", "\"V\""}]},
         "Ket"], "+", 
        TemplateBox[{
          RowBox[{"\"V\"", ",", "\"V\"", ",", "\"H\""}]},
         "Ket"]}], ")"}]}]}
   },
   DefaultBaseStyle->"Column",
   GridBoxAlignment->{"Columns" -> {{Left}}},
   GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
  "Column"]], "Output",
 CellChangeTimes->{3.760362530593826*^9},
 CellLabel->"Out[47]=",ExpressionUUID->"ed6b49c6-27c8-4b00-a774-e636aa586ceb"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"ghzfun", "[", "num_", "]"}], ":=", 
  RowBox[{
   FractionBox["1", 
    SuperscriptBox["2", 
     FractionBox[
      RowBox[{"num", "-", "1"}], "2"]]], 
   RowBox[{"Sum", "[", 
    RowBox[{
     RowBox[{
      SqrtBox[
       RowBox[{"Binomial", "[", 
        RowBox[{"num", ",", 
         RowBox[{"2", "l"}]}], "]"}]], 
      RowBox[{"With", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"twol", "=", 
          RowBox[{"2", "l"}]}], "}"}], ",", 
        RowBox[{"Ket", "[", 
         SubsuperscriptBox["D", "num", "twol"], "]"}]}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"l", ",", "0", ",", 
       RowBox[{"Floor", "[", 
        FractionBox["num", "2"], "]"}]}], "}"}]}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.760359832509648*^9, 3.7603599459573326`*^9}},
 CellLabel->"In[41]:=",ExpressionUUID->"0f2f36ee-63f4-43f1-b9cc-61faf15c8c12"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"ghzfun", "[", "18", "]"}], "//", "Magnify"}]], "Input",
 CellChangeTimes->{{3.7603599094180803`*^9, 3.76035991209788*^9}, {
  3.760360103461347*^9, 3.7603601354938397`*^9}},
 CellLabel->"In[46]:=",ExpressionUUID->"786a4102-6ee6-4912-babe-69b132427210"],

Cell[BoxData[
 StyleBox[
  RowBox[{
   FractionBox["1", 
    RowBox[{"256", " ", 
     SqrtBox["2"]}]], 
   RowBox[{"(", 
    RowBox[{
     TemplateBox[{
       SubsuperscriptBox["D", "18", "0"]},
      "Ket"], "+", 
     RowBox[{"3", " ", 
      SqrtBox["17"], " ", 
      TemplateBox[{
        SubsuperscriptBox["D", "18", "2"]},
       "Ket"]}], "+", 
     RowBox[{"6", " ", 
      SqrtBox["85"], " ", 
      TemplateBox[{
        SubsuperscriptBox["D", "18", "4"]},
       "Ket"]}], "+", 
     RowBox[{"2", " ", 
      SqrtBox["4641"], " ", 
      TemplateBox[{
        SubsuperscriptBox["D", "18", "6"]},
       "Ket"]}], "+", 
     RowBox[{"3", " ", 
      SqrtBox["4862"], " ", 
      TemplateBox[{
        SubsuperscriptBox["D", "18", "8"]},
       "Ket"]}], "+", 
     RowBox[{"3", " ", 
      SqrtBox["4862"], " ", 
      TemplateBox[{
        SubsuperscriptBox["D", "18", "10"]},
       "Ket"]}], "+", 
     RowBox[{"2", " ", 
      SqrtBox["4641"], " ", 
      TemplateBox[{
        SubsuperscriptBox["D", "18", "12"]},
       "Ket"]}], "+", 
     RowBox[{"6", " ", 
      SqrtBox["85"], " ", 
      TemplateBox[{
        SubsuperscriptBox["D", "18", "14"]},
       "Ket"]}], "+", 
     RowBox[{"3", " ", 
      SqrtBox["17"], " ", 
      TemplateBox[{
        SubsuperscriptBox["D", "18", "16"]},
       "Ket"]}], "+", 
     TemplateBox[{
       SubsuperscriptBox["D", "18", "18"]},
      "Ket"]}], ")"}]}],
  StripOnInput->False,
  Magnification->GoldenRatio Inherited]], "Output",
 CellChangeTimes->{{3.7603599125037947`*^9, 3.7603599479420257`*^9}, {
  3.7603601004683933`*^9, 3.760360135833929*^9}},
 CellLabel->"Out[46]=",ExpressionUUID->"4b829221-7f4a-4fd8-80d1-5d20f45647fa"]
}, Open  ]],

Cell[BoxData["k0"], "Input",
 CellChangeTimes->{{3.7619999798937416`*^9, 3.761999984867772*^9}},
 CellLabel->"In[15]:=",ExpressionUUID->"15ceaf62-3c41-4007-aff8-748a7cc6bd54"],

Cell[CellGroupData[{

Cell[BoxData["psiP"], "Input",
 CellChangeTimes->{{3.762002504502306*^9, 3.7620025071475525`*^9}},
 CellLabel->"In[17]:=",ExpressionUUID->"78a67807-0ffa-4869-a5d1-b885fabed25b"],

Cell[BoxData["psiP"], "Output",
 CellChangeTimes->{3.7620025075837574`*^9},
 CellLabel->"Out[17]=",ExpressionUUID->"966957d3-7894-49a2-9ad4-f9712f755d0d"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"s", "=", 
  RowBox[{"psip", "\[CircleTimes]", "psip"}]}]], "Input",
 CellChangeTimes->{{3.7620025093057685`*^9, 3.7620025684947233`*^9}, {
  3.762002691675763*^9, 3.7620026975665383`*^9}},
 CellLabel->"In[24]:=",ExpressionUUID->"6385cfac-cc5a-41f0-b2d6-d64d22b324fd"],

Cell[BoxData[
 RowBox[{
  FractionBox["1", "2"], " ", 
  RowBox[{"(", 
   RowBox[{
    TemplateBox[{
      RowBox[{"0", ",", "1", ",", "0", ",", "1"}]},
     "Ket"], "+", 
    TemplateBox[{
      RowBox[{"0", ",", "1", ",", "1", ",", "0"}]},
     "Ket"], "+", 
    TemplateBox[{
      RowBox[{"1", ",", "0", ",", "0", ",", "1"}]},
     "Ket"], "+", 
    TemplateBox[{
      RowBox[{"1", ",", "0", ",", "1", ",", "0"}]},
     "Ket"]}], ")"}]}]], "Output",
 CellChangeTimes->{{3.7620025112686872`*^9, 3.76200256897843*^9}, {
  3.762002693306548*^9, 3.7620026979895506`*^9}},
 CellLabel->"Out[24]=",ExpressionUUID->"9f260f3a-d33f-4bed-9dcc-61850d3acf40"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{
    RowBox[{"Ket", "[", "idket", "]"}], "\[CircleTimes]", "psip", 
    "\[CircleTimes]", 
    RowBox[{"Ket", "[", "idket", "]"}]}], ")"}], 
  "\[ConjugateTranspose]"}]], "Input",
 CellChangeTimes->{{3.7620027137451296`*^9, 3.762002784592081*^9}},
 CellLabel->"In[30]:=",ExpressionUUID->"f093a3cb-279e-4c3e-982c-846bf2aead10"],

Cell[BoxData[
 FractionBox[
  RowBox[{
   TemplateBox[{
     RowBox[{"idket", ",", "0", ",", "1", ",", "idket"}]},
    "Bra"], "+", 
   TemplateBox[{
     RowBox[{"idket", ",", "1", ",", "0", ",", "idket"}]},
    "Bra"]}], 
  SqrtBox["2"]]], "Output",
 CellChangeTimes->{
  3.762002714851263*^9, {3.76200275887078*^9, 3.762002785239085*^9}},
 CellLabel->"Out[30]=",ExpressionUUID->"6322de98-dbdd-414f-bc35-4377abb742bd"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Ket", "[", "idket", "]"}], "\[CircleTimes]", "psip", 
     "\[CircleTimes]", 
     RowBox[{"Ket", "[", "idket", "]"}]}], ")"}], "\[ConjugateTranspose]"}], "**", 
  RowBox[{"(", 
   RowBox[{"psip", "\[CircleTimes]", "psip"}], ")"}]}]], "Input",
 CellChangeTimes->{{3.7620027137451296`*^9, 3.762002811088975*^9}, {
  3.7620028531454988`*^9, 3.7620028591095486`*^9}},
 CellLabel->"In[32]:=",ExpressionUUID->"0ee2363f-bf04-4ee9-8c1d-5c4f301fe6c2"],

Cell[BoxData[
 FractionBox[
  RowBox[{
   TemplateBox[{"0"},
    "Ket"], " ", 
   TemplateBox[{"1"},
    "Ket"]}], 
  SqrtBox["2"]]], "Output",
 CellChangeTimes->{3.762002812207387*^9, 3.7620028597637587`*^9},
 CellLabel->"Out[32]=",ExpressionUUID->"b9881033-f535-41db-a69f-74196159ae3c"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   FractionBox[
    RowBox[{
     TemplateBox[{
       RowBox[{"idket", ",", "0", ",", "1", ",", "idket"}]},
      "Bra"], "+", 
     TemplateBox[{
       RowBox[{"idket", ",", "1", ",", "0", ",", "idket"}]},
      "Bra"]}], 
    SqrtBox["2"]], ")"}], "**", 
  RowBox[{"(", 
   RowBox[{
    FractionBox["1", "2"], " ", 
    RowBox[{"(", 
     RowBox[{
      TemplateBox[{
        RowBox[{"0", ",", "1", ",", "0", ",", "1"}]},
       "Ket"], "+", 
      TemplateBox[{
        RowBox[{"0", ",", "1", ",", "1", ",", "0"}]},
       "Ket"], "+", 
      TemplateBox[{
        RowBox[{"1", ",", "0", ",", "0", ",", "1"}]},
       "Ket"], "+", 
      TemplateBox[{
        RowBox[{"1", ",", "0", ",", "1", ",", "0"}]},
       "Ket"]}], ")"}]}], ")"}]}]], "Input",
 CellChangeTimes->{{3.7620027137451296`*^9, 3.762002811088975*^9}, {
  3.7620028531454988`*^9, 3.7620028591095486`*^9}, {3.7620029068858776`*^9, 
  3.7620029147488375`*^9}},
 CellLabel->"In[14]:=",ExpressionUUID->"4c2884d3-80f8-4fe0-93f6-1fc369fa7f4d"],

Cell[BoxData[
 RowBox[{
  FractionBox["1", 
   RowBox[{"2", " ", 
    SqrtBox["2"]}]], 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{"0", "\[CircleTimes]", "1"}], " ", 
     TemplateBox[{
       RowBox[{"0", ",", "0", ",", "KetsBras`Private`aux$3481"}]},
      "Ket"]}], "+", 
    RowBox[{
     RowBox[{"1", "\[CircleTimes]", "0"}], " ", 
     TemplateBox[{
       RowBox[{"0", ",", "0", ",", "KetsBras`Private`aux$3486"}]},
      "Ket"]}], "+", 
    RowBox[{
     RowBox[{"0", "\[CircleTimes]", "0"}], " ", 
     TemplateBox[{
       RowBox[{"0", ",", "1", ",", "KetsBras`Private`aux$3455"}]},
      "Ket"]}], "+", 
    RowBox[{
     RowBox[{"1", "\[CircleTimes]", "1"}], " ", 
     TemplateBox[{
       RowBox[{"0", ",", "1", ",", "KetsBras`Private`aux$3470"}]},
      "Ket"]}], "+", 
    RowBox[{
     RowBox[{"1", "\[CircleTimes]", "1"}], " ", 
     TemplateBox[{
       RowBox[{"1", ",", "0", ",", "KetsBras`Private`aux$3501"}]},
      "Ket"]}], "+", 
    RowBox[{
     RowBox[{"0", "\[CircleTimes]", "0"}], " ", 
     TemplateBox[{
       RowBox[{"1", ",", "0", ",", "KetsBras`Private`aux$3506"}]},
      "Ket"]}], "+", 
    RowBox[{
     RowBox[{"1", "\[CircleTimes]", "0"}], " ", 
     TemplateBox[{
       RowBox[{"1", ",", "1", ",", "KetsBras`Private`aux$3491"}]},
      "Ket"]}], "+", 
    RowBox[{
     RowBox[{"0", "\[CircleTimes]", "1"}], " ", 
     TemplateBox[{
       RowBox[{"1", ",", "1", ",", "KetsBras`Private`aux$3496"}]},
      "Ket"]}]}], ")"}]}]], "Output",
 CellChangeTimes->{
  3.7620046756849747`*^9, {3.76200473577085*^9, 3.762004739308907*^9}, 
   3.7620049453524466`*^9, {3.7620050517777853`*^9, 3.7620050639568205`*^9}, 
   3.7620051024535403`*^9},
 CellLabel->"Out[14]=",ExpressionUUID->"69eadb5e-7508-4f2b-9cd2-8b43920aa359"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 FractionBox[
  RowBox[{
   RowBox[{
    TemplateBox[{"0"},
     "Ket"], "**", 
    TemplateBox[{"1"},
     "Ket"]}], "+", 
   RowBox[{
    TemplateBox[{"1"},
     "Ket"], "**", 
    TemplateBox[{"0"},
     "Ket"]}]}], 
  RowBox[{"2", " ", 
   SqrtBox["2"]}]]], "Input",
 CellChangeTimes->{3.762004456977754*^9},
 CellLabel->"In[53]:=",ExpressionUUID->"2cb59d56-14a3-4d68-a413-1a118620e04a"],

Cell[BoxData[
 FractionBox[
  RowBox[{
   RowBox[{
    TemplateBox[{"0"},
     "Ket"], "**", 
    TemplateBox[{"1"},
     "Ket"]}], "+", 
   RowBox[{
    TemplateBox[{"1"},
     "Ket"], "**", 
    TemplateBox[{"0"},
     "Ket"]}]}], 
  RowBox[{"2", " ", 
   SqrtBox["2"]}]]], "Output",
 CellChangeTimes->{3.7620044571143417`*^9},
 CellLabel->"Out[53]=",ExpressionUUID->"7f1a680a-9369-4fa5-957b-d227c5b309f4"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   FractionBox[
    RowBox[{
     TemplateBox[{
       RowBox[{"idket", ",", "0", ",", "1", ",", "idket"}]},
      "Bra"], "+", 
     TemplateBox[{
       RowBox[{"idket", ",", "1", ",", "0", ",", "idket"}]},
      "Bra"]}], 
    SqrtBox["2"]], ")"}], "**", 
  RowBox[{"(", 
   RowBox[{
    FractionBox["1", "2"], " ", 
    RowBox[{"(", 
     TemplateBox[{
       RowBox[{"1", ",", "0", ",", "1", ",", "0"}]},
      "Ket"], ")"}]}], ")"}]}]], "Input",
 CellChangeTimes->{{3.7620027137451296`*^9, 3.762002811088975*^9}, {
  3.7620028531454988`*^9, 3.7620028591095486`*^9}, {3.7620029068858776`*^9, 
  3.76200294415373*^9}},
 CellLabel->"In[38]:=",ExpressionUUID->"5364319b-d922-4a16-9d46-4ee2a494c5e3"],

Cell[BoxData[
 FractionBox[
  RowBox[{
   TemplateBox[{"0"},
    "Ket"], " ", 
   TemplateBox[{"1"},
    "Ket"]}], 
  RowBox[{"2", " ", 
   SqrtBox["2"]}]]], "Output",
 CellChangeTimes->{3.762002945074267*^9},
 CellLabel->"Out[38]=",ExpressionUUID->"76dfaaef-e53c-4d38-bb66-a0166c6248cf"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"state", "=", 
  RowBox[{"Ket", "[", 
   RowBox[{"\"\<ha\>\"", ",", "\"\<vb\>\""}], "]"}]}]], "Input",
 CellChangeTimes->{{3.762002582740423*^9, 
  3.762002604852949*^9}},ExpressionUUID->"80297389-63a1-4120-9888-\
e7be9e5e89dc"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"init", "=", 
  RowBox[{"Sum", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"a", "[", 
      RowBox[{"i", ",", "j"}], "]"}], 
     RowBox[{"With", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"i", "=", "i"}], ",", 
         RowBox[{"j", "=", "j"}]}], "}"}], ",", 
       RowBox[{"Ket", "[", 
        RowBox[{"i", ",", "j"}], "]"}]}], "]"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", 
      RowBox[{"{", 
       RowBox[{"\"\<H\>\"", ",", "\"\<V\>\""}], "}"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"j", ",", 
      RowBox[{"{", 
       RowBox[{"\"\<H\>\"", ",", "\"\<V\>\""}], "}"}]}], "}"}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.762100458417477*^9, 3.762100528532728*^9}},
 CellLabel->"In[16]:=",ExpressionUUID->"8b2ddbf9-6ec9-40d3-8871-412f63605b0b"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"a", "[", 
    RowBox[{"\<\"H\"\>", ",", "\<\"H\"\>"}], "]"}], " ", 
   TemplateBox[{
     RowBox[{"\"H\"", ",", "\"H\""}]},
    "Ket"]}], "+", 
  RowBox[{
   RowBox[{"a", "[", 
    RowBox[{"\<\"H\"\>", ",", "\<\"V\"\>"}], "]"}], " ", 
   TemplateBox[{
     RowBox[{"\"H\"", ",", "\"V\""}]},
    "Ket"]}], "+", 
  RowBox[{
   RowBox[{"a", "[", 
    RowBox[{"\<\"V\"\>", ",", "\<\"H\"\>"}], "]"}], " ", 
   TemplateBox[{
     RowBox[{"\"V\"", ",", "\"H\""}]},
    "Ket"]}], "+", 
  RowBox[{
   RowBox[{"a", "[", 
    RowBox[{"\<\"V\"\>", ",", "\<\"V\"\>"}], "]"}], " ", 
   TemplateBox[{
     RowBox[{"\"V\"", ",", "\"V\""}]},
    "Ket"]}]}]], "Output",
 CellChangeTimes->{{3.762100512017828*^9, 3.7621005294407377`*^9}},
 CellLabel->"Out[16]=",ExpressionUUID->"e4336677-7b22-47ba-a111-d46691a19891"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"init", "=", 
  RowBox[{"Sum", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"a", "[", 
      RowBox[{"i", ",", "j"}], "]"}], 
     RowBox[{"With", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"i", "=", "i"}], ",", 
         RowBox[{"j", "=", "j"}]}], "}"}], ",", 
       RowBox[{"Ket", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"i", ",", "\"\<a1\>\""}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "\"\<a2\>\""}], "}"}]}], "]"}]}], "]"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", 
      RowBox[{"{", 
       RowBox[{"\"\<H\>\"", ",", "\"\<V\>\""}], "}"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"j", ",", 
      RowBox[{"{", 
       RowBox[{"\"\<H\>\"", ",", "\"\<V\>\""}], "}"}]}], "}"}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.762100458417477*^9, 3.762100528532728*^9}, {
  3.7621006553081527`*^9, 3.7621006783803635`*^9}},
 CellLabel->"In[23]:=",ExpressionUUID->"77053dae-8125-4da3-b931-60c641b7b0d5"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"a", "[", 
    RowBox[{"\<\"H\"\>", ",", "\<\"H\"\>"}], "]"}], " ", 
   TemplateBox[{
     RowBox[{
       RowBox[{"{", 
         RowBox[{"\"H\"", ",", "\"a1\""}], "}"}], ",", 
       RowBox[{"{", 
         RowBox[{"\"H\"", ",", "\"a2\""}], "}"}]}]},
    "Ket"]}], "+", 
  RowBox[{
   RowBox[{"a", "[", 
    RowBox[{"\<\"H\"\>", ",", "\<\"V\"\>"}], "]"}], " ", 
   TemplateBox[{
     RowBox[{
       RowBox[{"{", 
         RowBox[{"\"H\"", ",", "\"a1\""}], "}"}], ",", 
       RowBox[{"{", 
         RowBox[{"\"V\"", ",", "\"a2\""}], "}"}]}]},
    "Ket"]}], "+", 
  RowBox[{
   RowBox[{"a", "[", 
    RowBox[{"\<\"V\"\>", ",", "\<\"H\"\>"}], "]"}], " ", 
   TemplateBox[{
     RowBox[{
       RowBox[{"{", 
         RowBox[{"\"V\"", ",", "\"a1\""}], "}"}], ",", 
       RowBox[{"{", 
         RowBox[{"\"H\"", ",", "\"a2\""}], "}"}]}]},
    "Ket"]}], "+", 
  RowBox[{
   RowBox[{"a", "[", 
    RowBox[{"\<\"V\"\>", ",", "\<\"V\"\>"}], "]"}], " ", 
   TemplateBox[{
     RowBox[{
       RowBox[{"{", 
         RowBox[{"\"V\"", ",", "\"a1\""}], "}"}], ",", 
       RowBox[{"{", 
         RowBox[{"\"V\"", ",", "\"a2\""}], "}"}]}]},
    "Ket"]}]}]], "Output",
 CellChangeTimes->{3.762100678715471*^9},
 CellLabel->"Out[23]=",ExpressionUUID->"9836a186-48ef-4a8d-b8e9-7282c82a31fd"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"epr", "=", 
  RowBox[{"replaceKet", "[", 
   RowBox[{"phip", ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"Ket", "[", "0", "]"}], "\[Rule]", 
       RowBox[{"Ket", "[", "\"\<H\>\"", "]"}]}], ",", 
      RowBox[{
       RowBox[{"Ket", "[", "1", "]"}], "\[Rule]", 
       RowBox[{"Ket", "[", "\"\<V\>\"", "]"}]}]}], "}"}]}], "]"}]}]], "Input",\

 CellChangeTimes->{{3.762100532135002*^9, 3.762100589759004*^9}},
 CellLabel->"In[24]:=",ExpressionUUID->"765cb75b-a410-4103-b254-8484b09c8728"],

Cell[BoxData[
 FractionBox[
  RowBox[{
   TemplateBox[{
     RowBox[{"\"H\"", ",", "\"H\""}]},
    "Ket"], "+", 
   TemplateBox[{
     RowBox[{"\"V\"", ",", "\"V\""}]},
    "Ket"]}], 
  SqrtBox["2"]]], "Output",
 CellChangeTimes->{{3.762100584535265*^9, 3.7621005902038136`*^9}, 
   3.7621006829678707`*^9},
 CellLabel->"Out[24]=",ExpressionUUID->"4db6ab8d-d63b-4806-b5eb-d2992436cfa5"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"epr", "=", 
  RowBox[{"replaceKet", "[", 
   RowBox[{"phip", ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"Ket", "[", "0", "]"}], "\[Rule]", 
       RowBox[{"Ket", "[", 
        RowBox[{"{", 
         RowBox[{"\"\<H\>\"", ",", "\"\<a3\>\""}], "}"}], "]"}]}], ",", 
      RowBox[{
       RowBox[{"Ket", "[", "1", "]"}], "\[Rule]", 
       RowBox[{"Ket", "[", 
        RowBox[{"{", 
         RowBox[{"\"\<V\>\"", ",", "\"\<a4\>\""}], "}"}], "]"}]}]}], "}"}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.762100532135002*^9, 3.762100589759004*^9}, {
  3.7621006848849306`*^9, 3.7621006990391006`*^9}},
 CellLabel->"In[25]:=",ExpressionUUID->"32f28501-84b5-4671-87b5-5837a16c25e1"],

Cell[BoxData[
 FractionBox[
  RowBox[{
   TemplateBox[{
     RowBox[{
       RowBox[{"{", 
         RowBox[{"\"H\"", ",", "\"a3\""}], "}"}], ",", 
       RowBox[{"{", 
         RowBox[{"\"H\"", ",", "\"a3\""}], "}"}]}]},
    "Ket"], "+", 
   TemplateBox[{
     RowBox[{
       RowBox[{"{", 
         RowBox[{"\"V\"", ",", "\"a4\""}], "}"}], ",", 
       RowBox[{"{", 
         RowBox[{"\"V\"", ",", "\"a4\""}], "}"}]}]},
    "Ket"]}], 
  SqrtBox["2"]]], "Output",
 CellChangeTimes->{3.7621006999144135`*^9},
 CellLabel->"Out[25]=",ExpressionUUID->"fa9f6b28-055a-4977-9ee6-411a3b8e0c4a"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"init", "\[CircleTimes]", "epr"}]], "Input",
 CellChangeTimes->{{3.762100597878609*^9, 3.762100604427002*^9}},
 CellLabel->"In[26]:=",ExpressionUUID->"c4772dac-df8a-4ff9-a4e2-cc4081608445"],

Cell[BoxData[
 RowBox[{
  FractionBox["1", 
   SqrtBox["2"]], 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{"a", "[", 
      RowBox[{"\<\"H\"\>", ",", "\<\"H\"\>"}], "]"}], " ", 
     TemplateBox[{
       RowBox[{
         RowBox[{"{", 
           RowBox[{"\"H\"", ",", "\"a1\""}], "}"}], ",", 
         RowBox[{"{", 
           RowBox[{"\"H\"", ",", "\"a2\""}], "}"}], ",", 
         RowBox[{"{", 
           RowBox[{"\"H\"", ",", "\"a3\""}], "}"}], ",", 
         RowBox[{"{", 
           RowBox[{"\"H\"", ",", "\"a3\""}], "}"}]}]},
      "Ket"]}], "+", 
    RowBox[{
     RowBox[{"a", "[", 
      RowBox[{"\<\"H\"\>", ",", "\<\"H\"\>"}], "]"}], " ", 
     TemplateBox[{
       RowBox[{
         RowBox[{"{", 
           RowBox[{"\"H\"", ",", "\"a1\""}], "}"}], ",", 
         RowBox[{"{", 
           RowBox[{"\"H\"", ",", "\"a2\""}], "}"}], ",", 
         RowBox[{"{", 
           RowBox[{"\"V\"", ",", "\"a4\""}], "}"}], ",", 
         RowBox[{"{", 
           RowBox[{"\"V\"", ",", "\"a4\""}], "}"}]}]},
      "Ket"]}], "+", 
    RowBox[{
     RowBox[{"a", "[", 
      RowBox[{"\<\"H\"\>", ",", "\<\"V\"\>"}], "]"}], " ", 
     TemplateBox[{
       RowBox[{
         RowBox[{"{", 
           RowBox[{"\"H\"", ",", "\"a1\""}], "}"}], ",", 
         RowBox[{"{", 
           RowBox[{"\"V\"", ",", "\"a2\""}], "}"}], ",", 
         RowBox[{"{", 
           RowBox[{"\"H\"", ",", "\"a3\""}], "}"}], ",", 
         RowBox[{"{", 
           RowBox[{"\"H\"", ",", "\"a3\""}], "}"}]}]},
      "Ket"]}], "+", 
    RowBox[{
     RowBox[{"a", "[", 
      RowBox[{"\<\"H\"\>", ",", "\<\"V\"\>"}], "]"}], " ", 
     TemplateBox[{
       RowBox[{
         RowBox[{"{", 
           RowBox[{"\"H\"", ",", "\"a1\""}], "}"}], ",", 
         RowBox[{"{", 
           RowBox[{"\"V\"", ",", "\"a2\""}], "}"}], ",", 
         RowBox[{"{", 
           RowBox[{"\"V\"", ",", "\"a4\""}], "}"}], ",", 
         RowBox[{"{", 
           RowBox[{"\"V\"", ",", "\"a4\""}], "}"}]}]},
      "Ket"]}], "+", 
    RowBox[{
     RowBox[{"a", "[", 
      RowBox[{"\<\"V\"\>", ",", "\<\"H\"\>"}], "]"}], " ", 
     TemplateBox[{
       RowBox[{
         RowBox[{"{", 
           RowBox[{"\"V\"", ",", "\"a1\""}], "}"}], ",", 
         RowBox[{"{", 
           RowBox[{"\"H\"", ",", "\"a2\""}], "}"}], ",", 
         RowBox[{"{", 
           RowBox[{"\"H\"", ",", "\"a3\""}], "}"}], ",", 
         RowBox[{"{", 
           RowBox[{"\"H\"", ",", "\"a3\""}], "}"}]}]},
      "Ket"]}], "+", 
    RowBox[{
     RowBox[{"a", "[", 
      RowBox[{"\<\"V\"\>", ",", "\<\"H\"\>"}], "]"}], " ", 
     TemplateBox[{
       RowBox[{
         RowBox[{"{", 
           RowBox[{"\"V\"", ",", "\"a1\""}], "}"}], ",", 
         RowBox[{"{", 
           RowBox[{"\"H\"", ",", "\"a2\""}], "}"}], ",", 
         RowBox[{"{", 
           RowBox[{"\"V\"", ",", "\"a4\""}], "}"}], ",", 
         RowBox[{"{", 
           RowBox[{"\"V\"", ",", "\"a4\""}], "}"}]}]},
      "Ket"]}], "+", 
    RowBox[{
     RowBox[{"a", "[", 
      RowBox[{"\<\"V\"\>", ",", "\<\"V\"\>"}], "]"}], " ", 
     TemplateBox[{
       RowBox[{
         RowBox[{"{", 
           RowBox[{"\"V\"", ",", "\"a1\""}], "}"}], ",", 
         RowBox[{"{", 
           RowBox[{"\"V\"", ",", "\"a2\""}], "}"}], ",", 
         RowBox[{"{", 
           RowBox[{"\"H\"", ",", "\"a3\""}], "}"}], ",", 
         RowBox[{"{", 
           RowBox[{"\"H\"", ",", "\"a3\""}], "}"}]}]},
      "Ket"]}], "+", 
    RowBox[{
     RowBox[{"a", "[", 
      RowBox[{"\<\"V\"\>", ",", "\<\"V\"\>"}], "]"}], " ", 
     TemplateBox[{
       RowBox[{
         RowBox[{"{", 
           RowBox[{"\"V\"", ",", "\"a1\""}], "}"}], ",", 
         RowBox[{"{", 
           RowBox[{"\"V\"", ",", "\"a2\""}], "}"}], ",", 
         RowBox[{"{", 
           RowBox[{"\"V\"", ",", "\"a4\""}], "}"}], ",", 
         RowBox[{"{", 
           RowBox[{"\"V\"", ",", "\"a4\""}], "}"}]}]},
      "Ket"]}]}], ")"}]}]], "Output",
 CellChangeTimes->{3.7621006051231403`*^9, 3.762100701443977*^9},
 CellLabel->"Out[26]=",ExpressionUUID->"6b7e66ac-13d1-4932-985f-2c798ead66a8"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"afterPbs1", "=", 
  RowBox[{"replaceKet", "[", 
   RowBox[{
    RowBox[{"init", "\[CircleTimes]", "epr"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"Ket", "[", 
        RowBox[{"{", 
         RowBox[{"\"\<H\>\"", ",", "\"\<a1\>\""}], "}"}], "]"}], 
       "\[RuleDelayed]", 
       RowBox[{"Ket", "[", 
        RowBox[{"{", 
         RowBox[{"\"\<H\>\"", ",", "\"\<b1\>\""}], "}"}], "]"}]}], ",", 
      RowBox[{
       RowBox[{"Ket", "[", 
        RowBox[{"{", 
         RowBox[{"\"\<H\>\"", ",", "\"\<a3\>\""}], "}"}], "]"}], 
       "\[RuleDelayed]", 
       RowBox[{"Ket", "[", 
        RowBox[{"{", 
         RowBox[{"\"\<H\>\"", ",", "\"\<b3\>\""}], "}"}], "]"}]}], ",", 
      RowBox[{
       RowBox[{"Ket", "[", 
        RowBox[{"{", 
         RowBox[{"\"\<V\>\"", ",", "\"\<a1\>\""}], "}"}], "]"}], 
       "\[RuleDelayed]", 
       RowBox[{"Ket", "[", 
        RowBox[{"{", 
         RowBox[{"\"\<V\>\"", ",", "\"\<b3\>\""}], "}"}], "]"}]}], ",", 
      RowBox[{
       RowBox[{"Ket", "[", 
        RowBox[{"{", 
         RowBox[{"\"\<V\>\"", ",", "\"\<a3\>\""}], "}"}], "]"}], 
       "\[RuleDelayed]", 
       RowBox[{"Ket", "[", 
        RowBox[{"{", 
         RowBox[{"\"\<V\>\"", ",", "\"\<b1\>\""}], "}"}], "]"}]}]}], "}"}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.7621007101566496`*^9, 3.7621007160391145`*^9}, {
  3.7621008088778186`*^9, 3.7621009937267046`*^9}},
 CellLabel->"In[35]:=",ExpressionUUID->"c14cc870-99fa-4e76-8ae6-e77a77efa0e5"],

Cell[BoxData[
 TemplateBox[{
  "replaceKet", "invpatt", 
   "\"Some or all replacement rules are not of the form Ket[a_]->Ket[b_]. \
Calculation proceeds though.\"", 2, 35, 4, 26211530162705048985, "Local", 
   "KetsBras`replaceKet"},
  "MessageTemplate2"]], "Message", "MSG",
 CellChangeTimes->{
  3.762100869730883*^9, {3.7621009797436113`*^9, 3.762100994264197*^9}},
 CellLabel->
  "During evaluation of \
In[35]:=",ExpressionUUID->"f28d5d45-643e-4b66-ae1f-d1d2fd27a272"],

Cell[BoxData[
 RowBox[{
  FractionBox["1", 
   SqrtBox["2"]], 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{"a", "[", 
      RowBox[{"\<\"H\"\>", ",", "\<\"H\"\>"}], "]"}], " ", 
     TemplateBox[{
       RowBox[{
         RowBox[{"{", 
           RowBox[{"\"H\"", ",", "\"b1\""}], "}"}], ",", 
         RowBox[{"{", 
           RowBox[{"\"H\"", ",", "\"a2\""}], "}"}], ",", 
         RowBox[{"{", 
           RowBox[{"\"H\"", ",", "\"b3\""}], "}"}], ",", 
         RowBox[{"{", 
           RowBox[{"\"H\"", ",", "\"b3\""}], "}"}]}]},
      "Ket"]}], "+", 
    RowBox[{
     RowBox[{"a", "[", 
      RowBox[{"\<\"H\"\>", ",", "\<\"H\"\>"}], "]"}], " ", 
     TemplateBox[{
       RowBox[{
         RowBox[{"{", 
           RowBox[{"\"H\"", ",", "\"b1\""}], "}"}], ",", 
         RowBox[{"{", 
           RowBox[{"\"H\"", ",", "\"a2\""}], "}"}], ",", 
         RowBox[{"{", 
           RowBox[{"\"V\"", ",", "\"a4\""}], "}"}], ",", 
         RowBox[{"{", 
           RowBox[{"\"V\"", ",", "\"a4\""}], "}"}]}]},
      "Ket"]}], "+", 
    RowBox[{
     RowBox[{"a", "[", 
      RowBox[{"\<\"H\"\>", ",", "\<\"V\"\>"}], "]"}], " ", 
     TemplateBox[{
       RowBox[{
         RowBox[{"{", 
           RowBox[{"\"H\"", ",", "\"b1\""}], "}"}], ",", 
         RowBox[{"{", 
           RowBox[{"\"V\"", ",", "\"a2\""}], "}"}], ",", 
         RowBox[{"{", 
           RowBox[{"\"H\"", ",", "\"b3\""}], "}"}], ",", 
         RowBox[{"{", 
           RowBox[{"\"H\"", ",", "\"b3\""}], "}"}]}]},
      "Ket"]}], "+", 
    RowBox[{
     RowBox[{"a", "[", 
      RowBox[{"\<\"H\"\>", ",", "\<\"V\"\>"}], "]"}], " ", 
     TemplateBox[{
       RowBox[{
         RowBox[{"{", 
           RowBox[{"\"H\"", ",", "\"b1\""}], "}"}], ",", 
         RowBox[{"{", 
           RowBox[{"\"V\"", ",", "\"a2\""}], "}"}], ",", 
         RowBox[{"{", 
           RowBox[{"\"V\"", ",", "\"a4\""}], "}"}], ",", 
         RowBox[{"{", 
           RowBox[{"\"V\"", ",", "\"a4\""}], "}"}]}]},
      "Ket"]}], "+", 
    RowBox[{
     RowBox[{"a", "[", 
      RowBox[{"\<\"V\"\>", ",", "\<\"H\"\>"}], "]"}], " ", 
     TemplateBox[{
       RowBox[{
         RowBox[{"{", 
           RowBox[{"\"V\"", ",", "\"b3\""}], "}"}], ",", 
         RowBox[{"{", 
           RowBox[{"\"H\"", ",", "\"a2\""}], "}"}], ",", 
         RowBox[{"{", 
           RowBox[{"\"H\"", ",", "\"b3\""}], "}"}], ",", 
         RowBox[{"{", 
           RowBox[{"\"H\"", ",", "\"b3\""}], "}"}]}]},
      "Ket"]}], "+", 
    RowBox[{
     RowBox[{"a", "[", 
      RowBox[{"\<\"V\"\>", ",", "\<\"H\"\>"}], "]"}], " ", 
     TemplateBox[{
       RowBox[{
         RowBox[{"{", 
           RowBox[{"\"V\"", ",", "\"b3\""}], "}"}], ",", 
         RowBox[{"{", 
           RowBox[{"\"H\"", ",", "\"a2\""}], "}"}], ",", 
         RowBox[{"{", 
           RowBox[{"\"V\"", ",", "\"a4\""}], "}"}], ",", 
         RowBox[{"{", 
           RowBox[{"\"V\"", ",", "\"a4\""}], "}"}]}]},
      "Ket"]}], "+", 
    RowBox[{
     RowBox[{"a", "[", 
      RowBox[{"\<\"V\"\>", ",", "\<\"V\"\>"}], "]"}], " ", 
     TemplateBox[{
       RowBox[{
         RowBox[{"{", 
           RowBox[{"\"V\"", ",", "\"b3\""}], "}"}], ",", 
         RowBox[{"{", 
           RowBox[{"\"V\"", ",", "\"a2\""}], "}"}], ",", 
         RowBox[{"{", 
           RowBox[{"\"H\"", ",", "\"b3\""}], "}"}], ",", 
         RowBox[{"{", 
           RowBox[{"\"H\"", ",", "\"b3\""}], "}"}]}]},
      "Ket"]}], "+", 
    RowBox[{
     RowBox[{"a", "[", 
      RowBox[{"\<\"V\"\>", ",", "\<\"V\"\>"}], "]"}], " ", 
     TemplateBox[{
       RowBox[{
         RowBox[{"{", 
           RowBox[{"\"V\"", ",", "\"b3\""}], "}"}], ",", 
         RowBox[{"{", 
           RowBox[{"\"V\"", ",", "\"a2\""}], "}"}], ",", 
         RowBox[{"{", 
           RowBox[{"\"V\"", ",", "\"a4\""}], "}"}], ",", 
         RowBox[{"{", 
           RowBox[{"\"V\"", ",", "\"a4\""}], "}"}]}]},
      "Ket"]}]}], ")"}]}]], "Output",
 CellChangeTimes->{{3.7621008201776037`*^9, 3.762100869787732*^9}, {
  3.762100979841349*^9, 3.7621009943599186`*^9}},
 CellLabel->"Out[35]=",ExpressionUUID->"0e5c35bb-0dd2-46b8-8899-6944dc2514b2"]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.762101000066964*^9, 
  3.7621010018042088`*^9}},ExpressionUUID->"e2217487-37a3-449e-b3ed-\
65914688e54a"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"replaceKet", "[", 
  RowBox[{
   RowBox[{"init", "\[CircleTimes]", "epr"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Ket", "[", 
      RowBox[{"{", 
       RowBox[{"\"\<H\>\"", ",", "\"\<a1\>\""}], "}"}], "]"}], "\[Rule]", 
     RowBox[{"Ket", "[", "\"\<voser\>\"", "]"}]}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.7621007101566496`*^9, 3.7621007160391145`*^9}, {
  3.7621008088778186`*^9, 3.7621008489793205`*^9}},
 CellLabel->"In[31]:=",ExpressionUUID->"ca0061eb-65ed-42f6-9c45-fe7b75489d44"],

Cell[BoxData[
 RowBox[{
  FractionBox["1", 
   SqrtBox["2"]], 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{"a", "[", 
      RowBox[{"\<\"H\"\>", ",", "\<\"H\"\>"}], "]"}], " ", 
     TemplateBox[{
       RowBox[{"\"voser\"", ",", 
         RowBox[{"{", 
           RowBox[{"\"H\"", ",", "\"a2\""}], "}"}], ",", 
         RowBox[{"{", 
           RowBox[{"\"H\"", ",", "\"a3\""}], "}"}], ",", 
         RowBox[{"{", 
           RowBox[{"\"H\"", ",", "\"a3\""}], "}"}]}]},
      "Ket"]}], "+", 
    RowBox[{
     RowBox[{"a", "[", 
      RowBox[{"\<\"H\"\>", ",", "\<\"H\"\>"}], "]"}], " ", 
     TemplateBox[{
       RowBox[{"\"voser\"", ",", 
         RowBox[{"{", 
           RowBox[{"\"H\"", ",", "\"a2\""}], "}"}], ",", 
         RowBox[{"{", 
           RowBox[{"\"V\"", ",", "\"a4\""}], "}"}], ",", 
         RowBox[{"{", 
           RowBox[{"\"V\"", ",", "\"a4\""}], "}"}]}]},
      "Ket"]}], "+", 
    RowBox[{
     RowBox[{"a", "[", 
      RowBox[{"\<\"H\"\>", ",", "\<\"V\"\>"}], "]"}], " ", 
     TemplateBox[{
       RowBox[{"\"voser\"", ",", 
         RowBox[{"{", 
           RowBox[{"\"V\"", ",", "\"a2\""}], "}"}], ",", 
         RowBox[{"{", 
           RowBox[{"\"H\"", ",", "\"a3\""}], "}"}], ",", 
         RowBox[{"{", 
           RowBox[{"\"H\"", ",", "\"a3\""}], "}"}]}]},
      "Ket"]}], "+", 
    RowBox[{
     RowBox[{"a", "[", 
      RowBox[{"\<\"H\"\>", ",", "\<\"V\"\>"}], "]"}], " ", 
     TemplateBox[{
       RowBox[{"\"voser\"", ",", 
         RowBox[{"{", 
           RowBox[{"\"V\"", ",", "\"a2\""}], "}"}], ",", 
         RowBox[{"{", 
           RowBox[{"\"V\"", ",", "\"a4\""}], "}"}], ",", 
         RowBox[{"{", 
           RowBox[{"\"V\"", ",", "\"a4\""}], "}"}]}]},
      "Ket"]}], "+", 
    RowBox[{
     RowBox[{"a", "[", 
      RowBox[{"\<\"V\"\>", ",", "\<\"H\"\>"}], "]"}], " ", 
     TemplateBox[{
       RowBox[{
         RowBox[{"{", 
           RowBox[{"\"V\"", ",", "\"a1\""}], "}"}], ",", 
         RowBox[{"{", 
           RowBox[{"\"H\"", ",", "\"a2\""}], "}"}], ",", 
         RowBox[{"{", 
           RowBox[{"\"H\"", ",", "\"a3\""}], "}"}], ",", 
         RowBox[{"{", 
           RowBox[{"\"H\"", ",", "\"a3\""}], "}"}]}]},
      "Ket"]}], "+", 
    RowBox[{
     RowBox[{"a", "[", 
      RowBox[{"\<\"V\"\>", ",", "\<\"H\"\>"}], "]"}], " ", 
     TemplateBox[{
       RowBox[{
         RowBox[{"{", 
           RowBox[{"\"V\"", ",", "\"a1\""}], "}"}], ",", 
         RowBox[{"{", 
           RowBox[{"\"H\"", ",", "\"a2\""}], "}"}], ",", 
         RowBox[{"{", 
           RowBox[{"\"V\"", ",", "\"a4\""}], "}"}], ",", 
         RowBox[{"{", 
           RowBox[{"\"V\"", ",", "\"a4\""}], "}"}]}]},
      "Ket"]}], "+", 
    RowBox[{
     RowBox[{"a", "[", 
      RowBox[{"\<\"V\"\>", ",", "\<\"V\"\>"}], "]"}], " ", 
     TemplateBox[{
       RowBox[{
         RowBox[{"{", 
           RowBox[{"\"V\"", ",", "\"a1\""}], "}"}], ",", 
         RowBox[{"{", 
           RowBox[{"\"V\"", ",", "\"a2\""}], "}"}], ",", 
         RowBox[{"{", 
           RowBox[{"\"H\"", ",", "\"a3\""}], "}"}], ",", 
         RowBox[{"{", 
           RowBox[{"\"H\"", ",", "\"a3\""}], "}"}]}]},
      "Ket"]}], "+", 
    RowBox[{
     RowBox[{"a", "[", 
      RowBox[{"\<\"V\"\>", ",", "\<\"V\"\>"}], "]"}], " ", 
     TemplateBox[{
       RowBox[{
         RowBox[{"{", 
           RowBox[{"\"V\"", ",", "\"a1\""}], "}"}], ",", 
         RowBox[{"{", 
           RowBox[{"\"V\"", ",", "\"a2\""}], "}"}], ",", 
         RowBox[{"{", 
           RowBox[{"\"V\"", ",", "\"a4\""}], "}"}], ",", 
         RowBox[{"{", 
           RowBox[{"\"V\"", ",", "\"a4\""}], "}"}]}]},
      "Ket"]}]}], ")"}]}]], "Output",
 CellChangeTimes->{3.7621008495516987`*^9},
 CellLabel->"Out[31]=",ExpressionUUID->"0fbd6e61-bf9e-4027-885f-b66d5fc9afed"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Tomography", "Subchapter",
 CellChangeTimes->{{3.762599720296793*^9, 
  3.7625997222395973`*^9}},ExpressionUUID->"0170f49d-5ec9-4915-adfc-\
732ceb3c4901"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"state", "=", 
  RowBox[{
   RowBox[{"\[Alpha]", " ", 
    RowBox[{"Ket", "[", 
     RowBox[{"0", ",", "0"}], "]"}]}], "+", 
   RowBox[{"\[Beta]", " ", 
    RowBox[{"Ket", "[", 
     RowBox[{"1", ",", "1"}], "]"}]}], "+", 
   RowBox[{"\[Gamma]", " ", 
    RowBox[{"Ket", "[", 
     RowBox[{
      RowBox[{"-", "1"}], ",", 
      RowBox[{"-", "1"}]}], "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.762599732000414*^9, 3.7625997546331663`*^9}},
 CellLabel->"In[14]:=",ExpressionUUID->"47b01159-bef8-44e5-a653-ce79e0fa94e1"],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[Gamma]", " ", 
   TemplateBox[{
     RowBox[{
       RowBox[{"-", "1"}], ",", 
       RowBox[{"-", "1"}]}]},
    "Ket"]}], "+", 
  RowBox[{"\[Alpha]", " ", 
   TemplateBox[{
     RowBox[{"0", ",", "0"}]},
    "Ket"]}], "+", 
  RowBox[{"\[Beta]", " ", 
   TemplateBox[{
     RowBox[{"1", ",", "1"}]},
    "Ket"]}]}]], "Output",
 CellChangeTimes->{3.7625997581833153`*^9, 3.7626029528588653`*^9},
 CellLabel->"Out[14]=",ExpressionUUID->"414a717b-1ff3-42d9-b144-903ed84f13a9"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"supst", "[", 
   RowBox[{"phase_", ",", "mode1_", ",", "mode2_"}], "]"}], ":=", 
  RowBox[{
   FractionBox["1", 
    SqrtBox["2"]], 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Ket", "[", "mode1", "]"}], "+", 
     RowBox[{"phase", " ", 
      RowBox[{"Ket", "[", "mode2", "]"}]}]}], ")"}]}]}]], "Input",
 CellChangeTimes->{{3.7625997648610315`*^9, 3.7625998154723153`*^9}},
 CellLabel->"In[15]:=",ExpressionUUID->"49b82c46-388d-4a46-a780-27bacbc6575e"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"supst", "[", 
  RowBox[{"1", ",", "0", ",", "1"}], "]"}]], "Input",
 CellChangeTimes->{{3.7625998169503937`*^9, 3.762599826390622*^9}},
 CellLabel->"In[16]:=",ExpressionUUID->"358f3d09-c06d-42ed-8f3c-4b1297493b1a"],

Cell[BoxData[
 FractionBox[
  RowBox[{
   TemplateBox[{"0"},
    "Ket"], "+", 
   TemplateBox[{"1"},
    "Ket"]}], 
  SqrtBox["2"]]], "Output",
 CellChangeTimes->{{3.7625998221012464`*^9, 3.7625998276328278`*^9}, 
   3.7626029551725416`*^9},
 CellLabel->"Out[16]=",ExpressionUUID->"c920c9cc-e794-4ca5-b920-55683cab1f19"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{"state", "\[ConjugateTranspose]"}], ")"}], "**", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"supst", "[", 
     RowBox[{"1", ",", "0", ",", "1"}], "]"}], "\[CircleTimes]", 
    RowBox[{"supst", "[", 
     RowBox[{"1", ",", "0", ",", "1"}], "]"}]}], ")"}]}]], "Input",
 CellChangeTimes->{{3.7625998169503937`*^9, 3.762599887912047*^9}},
 CellLabel->"In[17]:=",ExpressionUUID->"bbb02ee0-78ef-476a-ba6c-6865dc4d3021"],

Cell[BoxData[
 RowBox[{
  FractionBox["1", "2"], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"Conjugate", "[", "\[Alpha]", "]"}], "+", 
    RowBox[{"Conjugate", "[", "\[Beta]", "]"}]}], ")"}]}]], "Output",
 CellChangeTimes->{{3.7625998415178285`*^9, 3.7625998885234127`*^9}, 
   3.7626029560193343`*^9},
 CellLabel->"Out[17]=",ExpressionUUID->"5f8149f3-bf26-465f-b33f-c6c2e4f70704"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"quartet", "[", 
    RowBox[{"ph1_", ",", "ph2_", ",", "m1_", ",", "m2_"}], "]"}], ":=", 
   RowBox[{"Flatten", "@", 
    RowBox[{"Outer", "[", 
     RowBox[{"CircleTimes", ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"supst", "[", 
         RowBox[{"ph1", ",", "m1", ",", "m2"}], "]"}], ",", 
        RowBox[{"supst", "[", 
         RowBox[{
          RowBox[{"-", "ph1"}], ",", "m1", ",", "m2"}], "]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"supst", "[", 
         RowBox[{"ph2", ",", "m1", ",", "m2"}], "]"}], ",", 
        RowBox[{"supst", "[", 
         RowBox[{
          RowBox[{"-", "ph2"}], ",", "m1", ",", "m2"}], "]"}]}], "}"}]}], 
     "]"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.7625998997186365`*^9, 3.762600037719323*^9}, {
  3.762600122171913*^9, 3.7626001276114197`*^9}, {3.762600169739932*^9, 
  3.7626002016482244`*^9}, {3.7626002413723426`*^9, 3.7626002461691475`*^9}, {
  3.762600281399768*^9, 3.7626003414033346`*^9}},
 CellLabel->"In[18]:=",ExpressionUUID->"3e61be8f-4862-4ea4-b8bd-e27df80adf33"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"quartet", "[", 
   RowBox[{"1", ",", "1", ",", "0", ",", "1"}], "]"}], 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"//", "Flatten"}], "//", "Simplify"}], "*)"}]}]], "Input",
 CellChangeTimes->{{3.762600039203354*^9, 3.762600056204844*^9}, 
   3.762600159275323*^9, {3.762600331350262*^9, 3.762600337430111*^9}},
 CellLabel->"In[19]:=",ExpressionUUID->"a420dec6-3c35-4cad-b2f5-29be4766ee3d"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    FractionBox["1", "2"], " ", 
    RowBox[{"(", 
     RowBox[{
      TemplateBox[{
        RowBox[{"0", ",", "0"}]},
       "Ket"], "+", 
      TemplateBox[{
        RowBox[{"0", ",", "1"}]},
       "Ket"], "+", 
      TemplateBox[{
        RowBox[{"1", ",", "0"}]},
       "Ket"], "+", 
      TemplateBox[{
        RowBox[{"1", ",", "1"}]},
       "Ket"]}], ")"}]}], ",", 
   RowBox[{
    FractionBox["1", "2"], " ", 
    RowBox[{"(", 
     RowBox[{
      TemplateBox[{
        RowBox[{"0", ",", "0"}]},
       "Ket"], "-", 
      TemplateBox[{
        RowBox[{"0", ",", "1"}]},
       "Ket"], "+", 
      TemplateBox[{
        RowBox[{"1", ",", "0"}]},
       "Ket"], "-", 
      TemplateBox[{
        RowBox[{"1", ",", "1"}]},
       "Ket"]}], ")"}]}], ",", 
   RowBox[{
    FractionBox["1", "2"], " ", 
    RowBox[{"(", 
     RowBox[{
      TemplateBox[{
        RowBox[{"0", ",", "0"}]},
       "Ket"], "+", 
      TemplateBox[{
        RowBox[{"0", ",", "1"}]},
       "Ket"], "-", 
      TemplateBox[{
        RowBox[{"1", ",", "0"}]},
       "Ket"], "-", 
      TemplateBox[{
        RowBox[{"1", ",", "1"}]},
       "Ket"]}], ")"}]}], ",", 
   RowBox[{
    FractionBox["1", "2"], " ", 
    RowBox[{"(", 
     RowBox[{
      TemplateBox[{
        RowBox[{"0", ",", "0"}]},
       "Ket"], "-", 
      TemplateBox[{
        RowBox[{"0", ",", "1"}]},
       "Ket"], "-", 
      TemplateBox[{
        RowBox[{"1", ",", "0"}]},
       "Ket"], "+", 
      TemplateBox[{
        RowBox[{"1", ",", "1"}]},
       "Ket"]}], ")"}]}]}], "}"}]], "Output",
 CellChangeTimes->{{3.7626000432473555`*^9, 3.7626000566017833`*^9}, {
   3.7626001306546044`*^9, 3.76260017212918*^9}, 3.7626002031911235`*^9, 
   3.7626002498392086`*^9, {3.762600287550827*^9, 3.7626003454394655`*^9}, 
   3.762602957506729*^9},
 CellLabel->"Out[19]=",ExpressionUUID->"0b17a480-6a06-4647-a5cb-01cd7ebb9854"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{"state", "\[ConjugateTranspose]"}], "**", "#"}], "&"}], ")"}], "/@", 
  RowBox[{"quartet", "[", 
   RowBox[{"1", ",", "1", ",", "0", ",", "1"}], "]"}], 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"//", "Flatten"}], "//", "Simplify"}], "*)"}]}]], "Input",
 CellChangeTimes->{{3.762600039203354*^9, 3.762600056204844*^9}, 
   3.762600159275323*^9, {3.762600331350262*^9, 3.762600337430111*^9}, {
   3.7626004197932663`*^9, 3.7626004469915676`*^9}},
 CellLabel->"In[20]:=",ExpressionUUID->"1d38044f-5f7e-4d32-b275-a608922a9558"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    FractionBox["1", "2"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"Conjugate", "[", "\[Alpha]", "]"}], "+", 
      RowBox[{"Conjugate", "[", "\[Beta]", "]"}]}], ")"}]}], ",", 
   RowBox[{
    FractionBox["1", "2"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"Conjugate", "[", "\[Alpha]", "]"}], "-", 
      RowBox[{"Conjugate", "[", "\[Beta]", "]"}]}], ")"}]}], ",", 
   RowBox[{
    FractionBox["1", "2"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"Conjugate", "[", "\[Alpha]", "]"}], "-", 
      RowBox[{"Conjugate", "[", "\[Beta]", "]"}]}], ")"}]}], ",", 
   RowBox[{
    FractionBox["1", "2"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"Conjugate", "[", "\[Alpha]", "]"}], "+", 
      RowBox[{"Conjugate", "[", "\[Beta]", "]"}]}], ")"}]}]}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.7626004294238105`*^9, 3.762600447593957*^9}, 
   3.7626029583215485`*^9},
 CellLabel->"Out[20]=",ExpressionUUID->"38d8df26-7f06-43d3-b559-8b268eade549"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"subspaceMeasurement", "[", 
   RowBox[{"state_", ",", "mode1_", ",", "mode2_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "fun", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"fun", "[", "x_", "]"}], ":=", 
      RowBox[{
       RowBox[{"Abs", "[", 
        RowBox[{
         RowBox[{"state", "\[ConjugateTranspose]"}], "**", "x"}], "]"}], "^", 
       "2"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{
        RowBox[{"fun", "[", "x_", "]"}], ":=", 
        RowBox[{
         RowBox[{"state", "\[ConjugateTranspose]"}], "**", "x"}]}], ";"}], 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"fun", "/@", 
        RowBox[{"quartet", "[", 
         RowBox[{"1", ",", "1", ",", "mode1", ",", "mode2"}], "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"fun", "/@", 
        RowBox[{"quartet", "[", 
         RowBox[{"1", ",", "I", ",", "mode1", ",", "mode2"}], "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"fun", "/@", 
        RowBox[{"quartet", "[", 
         RowBox[{"I", ",", "1", ",", "mode1", ",", "mode2"}], "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"fun", "/@", 
        RowBox[{"quartet", "[", 
         RowBox[{"I", ",", "I", ",", "mode1", ",", "mode2"}], "]"}]}]}], 
      "\[IndentingNewLine]", "}"}]}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.762600356370682*^9, 3.7626004059041214`*^9}, {
  3.7626004594112554`*^9, 3.7626005203861647`*^9}, {3.762600885292781*^9, 
  3.7626009307718973`*^9}, {3.7626011576656475`*^9, 3.7626011631454926`*^9}, {
  3.762602942661264*^9, 3.762602944755438*^9}, {3.7626030461678944`*^9, 
  3.7626030656869392`*^9}},
 CellLabel->"In[32]:=",ExpressionUUID->"9a28ec41-f7c5-4ca7-9b67-0b7155f809e2"],

Cell[BoxData[
 RowBox[{
  RowBox[{"subspaceMeasurementConj", "[", 
   RowBox[{"state_", ",", "mode1_", ",", "mode2_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "fun", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"fun", "[", "x_", "]"}], ":=", 
      RowBox[{
       RowBox[{"Abs", "[", 
        RowBox[{
         RowBox[{"state", "\[ConjugateTranspose]"}], "**", "x"}], "]"}], "^", 
       "2"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{
        RowBox[{"fun", "[", "x_", "]"}], ":=", 
        RowBox[{
         RowBox[{"state", "\[ConjugateTranspose]"}], "**", "x"}]}], ";"}], 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"fun", "/@", 
        RowBox[{"quartet", "[", 
         RowBox[{"1", ",", "1", ",", "mode1", ",", "mode2"}], "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"fun", "/@", 
        RowBox[{"quartet", "[", 
         RowBox[{"1", ",", 
          RowBox[{"-", "I"}], ",", "mode1", ",", "mode2"}], "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"fun", "/@", 
        RowBox[{"quartet", "[", 
         RowBox[{
          RowBox[{"-", "I"}], ",", "1", ",", "mode1", ",", "mode2"}], "]"}]}],
        ",", "\[IndentingNewLine]", 
       RowBox[{"fun", "/@", 
        RowBox[{"quartet", "[", 
         RowBox[{
          RowBox[{"-", "I"}], ",", 
          RowBox[{"-", "I"}], ",", "mode1", ",", "mode2"}], "]"}]}]}], 
      "\[IndentingNewLine]", "}"}]}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.762600356370682*^9, 3.7626004059041214`*^9}, {
   3.7626004594112554`*^9, 3.7626005203861647`*^9}, 3.7626006992573895`*^9, {
   3.76260076570578*^9, 3.7626008065636015`*^9}, {3.7626009447564497`*^9, 
   3.762600975498322*^9}, {3.7626011495259743`*^9, 3.7626011536806583`*^9}, {
   3.7626030581043987`*^9, 3.762603059904645*^9}},
 CellLabel->"In[33]:=",ExpressionUUID->"afe4ad7c-428c-4ba0-b1db-6b2a8888b288"],

Cell[BoxData[
 RowBox[{
  RowBox[{"measureNonConj", "[", "state_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"subspaceMeasurement", "[", 
       RowBox[{"state", ",", "0", ",", "1"}], "]"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"subspaceMeasurement", "[", 
       RowBox[{"state", ",", "0", ",", 
        RowBox[{"-", "1"}]}], "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{"subspaceMeasurement", "[", 
       RowBox[{"state", ",", "1", ",", 
        RowBox[{"-", "1"}]}], "]"}]}], "\[IndentingNewLine]", "}"}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.76260059519287*^9, 3.7626006422643375`*^9}},
 CellLabel->"In[23]:=",ExpressionUUID->"f8a41ce4-9dc4-4aa3-b683-ad781597313a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"measureConj", "[", "state_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"subspaceMeasurementConj", "[", 
       RowBox[{"state", ",", "0", ",", 
        RowBox[{"-", "1"}]}], "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{"subspaceMeasurementConj", "[", 
       RowBox[{"state", ",", "0", ",", "1"}], "]"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"subspaceMeasurementConj", "[", 
       RowBox[{"state", ",", 
        RowBox[{"-", "1"}], ",", "1"}], "]"}]}], "\[IndentingNewLine]", 
     "}"}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.76260059519287*^9, 3.7626006422643375`*^9}, {
  3.7626006840891304`*^9, 3.7626006952446327`*^9}, {3.762600731002225*^9, 
  3.7626007395543647`*^9}},
 CellLabel->"In[24]:=",ExpressionUUID->"751c7dd9-3233-4eff-a17a-1900c6ae832b"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[Alpha]", "=", 
  RowBox[{"\[Beta]", "=", 
   RowBox[{"\[Gamma]", "=", "1"}]}]}]], "Input",
 CellChangeTimes->{{3.7626008485490313`*^9, 3.7626008544577665`*^9}},
 CellLabel->"In[25]:=",ExpressionUUID->"9a1fce5d-1723-4a02-925c-8d64de945a4c"],

Cell[BoxData["1"], "Output",
 CellChangeTimes->{3.762600855431365*^9, 3.7626009862546115`*^9, 
  3.7626029644531217`*^9},
 CellLabel->"Out[25]=",ExpressionUUID->"e9d054e5-6d47-4d25-ad5c-8079c173a70c"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[Gamma]", "=", "0"}]], "Input",
 CellChangeTimes->{{3.7626015893828163`*^9, 3.7626015907843227`*^9}},
 CellLabel->"In[26]:=",ExpressionUUID->"ec574d6b-a9e9-416c-9eb7-f42c241638d9"],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{3.762601593033536*^9, 3.762602965434537*^9},
 CellLabel->"Out[26]=",ExpressionUUID->"7fd126fb-020b-4d31-89cd-9ac420414de3"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"TraditionalForm", "/@", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"measureNonConj", "[", "state", "]"}], "[", 
      RowBox[{"[", "1", "]"}], "]"}], ",", 
     RowBox[{
      RowBox[{"measureConj", "[", "state", "]"}], "[", 
      RowBox[{"[", "1", "]"}], "]"}]}], "}"}]}], "//", "Magnify"}]], "Input",
 CellChangeTimes->{{3.762600647789712*^9, 3.7626006678643665`*^9}, {
  3.7626010389116135`*^9, 3.76260104868307*^9}},
 CellLabel->"In[34]:=",ExpressionUUID->"c6c9ef67-158a-42d3-aca9-94ef8c47a197"],

Cell[BoxData[
 StyleBox[
  RowBox[{"{", 
   RowBox[{
    TagBox[
     FormBox[
      RowBox[{"(", "\[NoBreak]", GridBox[{
         {"1", "0", "0", "1"},
         {
          FractionBox["1", "2"], 
          FractionBox["1", "2"], 
          FractionBox["1", "2"], 
          FractionBox["1", "2"]},
         {
          FractionBox["1", "2"], 
          FractionBox["1", "2"], 
          FractionBox["1", "2"], 
          FractionBox["1", "2"]},
         {"0", "1", "1", "0"}
        },
        GridBoxAlignment->{
         "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
          "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.7]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.4]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
      TraditionalForm],
     TraditionalForm,
     Editable->True], ",", 
    TagBox[
     FormBox[
      RowBox[{"(", "\[NoBreak]", GridBox[{
         {
          FractionBox["1", "4"], 
          FractionBox["1", "4"], 
          FractionBox["1", "4"], 
          FractionBox["1", "4"]},
         {
          FractionBox["1", "4"], 
          FractionBox["1", "4"], 
          FractionBox["1", "4"], 
          FractionBox["1", "4"]},
         {
          FractionBox["1", "4"], 
          FractionBox["1", "4"], 
          FractionBox["1", "4"], 
          FractionBox["1", "4"]},
         {
          FractionBox["1", "4"], 
          FractionBox["1", "4"], 
          FractionBox["1", "4"], 
          FractionBox["1", "4"]}
        },
        GridBoxAlignment->{
         "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
          "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.7]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.4]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
      TraditionalForm],
     TraditionalForm,
     Editable->True]}], "}"}],
  StripOnInput->False,
  Magnification->GoldenRatio Inherited]], "Output",
 CellChangeTimes->{{3.7626006491185017`*^9, 3.762600668350068*^9}, 
   3.7626008568415923`*^9, 3.7626009880108967`*^9, 3.762601049407133*^9, 
   3.7626011703070216`*^9, 3.7626015953054867`*^9, 3.7626029666034455`*^9, {
   3.762603053565197*^9, 3.7626030706344876`*^9}},
 CellLabel->"Out[34]=",ExpressionUUID->"fec91ecc-a3c5-46f5-a650-360e130ce1df"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"TraditionalForm", "/@", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"measureNonConj", "[", "state", "]"}], "[", 
      RowBox[{"[", "2", "]"}], "]"}], ",", 
     RowBox[{
      RowBox[{"measureConj", "[", "state", "]"}], "[", 
      RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}], "//", "Magnify"}]], "Input",
 CellChangeTimes->{{3.762600647789712*^9, 3.7626006678643665`*^9}, {
  3.7626010389116135`*^9, 3.762601065611332*^9}},
 CellLabel->"In[35]:=",ExpressionUUID->"0295a671-b753-4890-800d-23fb299761b2"],

Cell[BoxData[
 StyleBox[
  RowBox[{"{", 
   RowBox[{
    TagBox[
     FormBox[
      RowBox[{"(", "\[NoBreak]", GridBox[{
         {
          FractionBox["1", "4"], 
          FractionBox["1", "4"], 
          FractionBox["1", "4"], 
          FractionBox["1", "4"]},
         {
          FractionBox["1", "4"], 
          FractionBox["1", "4"], 
          FractionBox["1", "4"], 
          FractionBox["1", "4"]},
         {
          FractionBox["1", "4"], 
          FractionBox["1", "4"], 
          FractionBox["1", "4"], 
          FractionBox["1", "4"]},
         {
          FractionBox["1", "4"], 
          FractionBox["1", "4"], 
          FractionBox["1", "4"], 
          FractionBox["1", "4"]}
        },
        GridBoxAlignment->{
         "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
          "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.7]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.4]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
      TraditionalForm],
     TraditionalForm,
     Editable->True], ",", 
    TagBox[
     FormBox[
      RowBox[{"(", "\[NoBreak]", GridBox[{
         {"1", "0", "0", "1"},
         {
          FractionBox["1", "2"], 
          FractionBox["1", "2"], 
          FractionBox["1", "2"], 
          FractionBox["1", "2"]},
         {
          FractionBox["1", "2"], 
          FractionBox["1", "2"], 
          FractionBox["1", "2"], 
          FractionBox["1", "2"]},
         {"0", "1", "1", "0"}
        },
        GridBoxAlignment->{
         "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
          "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.7]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.4]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
      TraditionalForm],
     TraditionalForm,
     Editable->True]}], "}"}],
  StripOnInput->False,
  Magnification->GoldenRatio Inherited]], "Output",
 CellChangeTimes->{3.762601066061129*^9, 3.7626011725159936`*^9, 
  3.7626015965970306`*^9, 3.7626030360247154`*^9, 3.7626030720051637`*^9},
 CellLabel->"Out[35]=",ExpressionUUID->"b0fe6555-926e-4548-bdbe-0fe6956a5b56"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"TraditionalForm", "/@", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"measureNonConj", "[", "state", "]"}], "[", 
      RowBox[{"[", "3", "]"}], "]"}], ",", 
     RowBox[{
      RowBox[{"measureConj", "[", "state", "]"}], "[", 
      RowBox[{"[", "3", "]"}], "]"}]}], "}"}]}], "//", "Magnify"}]], "Input",
 CellChangeTimes->{{3.762600647789712*^9, 3.7626006678643665`*^9}, {
  3.7626010389116135`*^9, 3.762601072367301*^9}},
 CellLabel->"In[36]:=",ExpressionUUID->"17fe4cce-e29b-41bc-b92d-74171069cf6b"],

Cell[BoxData[
 StyleBox[
  RowBox[{"{", 
   RowBox[{
    TagBox[
     FormBox[
      RowBox[{"(", "\[NoBreak]", GridBox[{
         {
          FractionBox["1", "4"], 
          FractionBox["1", "4"], 
          FractionBox["1", "4"], 
          FractionBox["1", "4"]},
         {
          FractionBox["1", "4"], 
          FractionBox["1", "4"], 
          FractionBox["1", "4"], 
          FractionBox["1", "4"]},
         {
          FractionBox["1", "4"], 
          FractionBox["1", "4"], 
          FractionBox["1", "4"], 
          FractionBox["1", "4"]},
         {
          FractionBox["1", "4"], 
          FractionBox["1", "4"], 
          FractionBox["1", "4"], 
          FractionBox["1", "4"]}
        },
        GridBoxAlignment->{
         "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
          "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.7]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.4]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
      TraditionalForm],
     TraditionalForm,
     Editable->True], ",", 
    TagBox[
     FormBox[
      RowBox[{"(", "\[NoBreak]", GridBox[{
         {
          FractionBox["1", "4"], 
          FractionBox["1", "4"], 
          FractionBox["1", "4"], 
          FractionBox["1", "4"]},
         {
          FractionBox["1", "4"], 
          FractionBox["1", "4"], 
          FractionBox["1", "4"], 
          FractionBox["1", "4"]},
         {
          FractionBox["1", "4"], 
          FractionBox["1", "4"], 
          FractionBox["1", "4"], 
          FractionBox["1", "4"]},
         {
          FractionBox["1", "4"], 
          FractionBox["1", "4"], 
          FractionBox["1", "4"], 
          FractionBox["1", "4"]}
        },
        GridBoxAlignment->{
         "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
          "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.7]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.4]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
      TraditionalForm],
     TraditionalForm,
     Editable->True]}], "}"}],
  StripOnInput->False,
  Magnification->GoldenRatio Inherited]], "Output",
 CellChangeTimes->{3.7626010728160996`*^9, 3.7626011735114307`*^9, 
  3.7626015978042407`*^9, 3.7626030372654243`*^9, 3.7626030729539046`*^9},
 CellLabel->"Out[36]=",ExpressionUUID->"25256e86-9b19-45c6-b6b7-963943cea92e"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"TraditionalForm", "/@", 
   RowBox[{"measureConj", "[", "state", "]"}]}], "//", "Magnify"}]], "Input",
 CellChangeTimes->{{3.7626031245215826`*^9, 3.7626031261628714`*^9}, {
  3.762603179246274*^9, 3.7626031795384927`*^9}},
 CellLabel->"In[38]:=",ExpressionUUID->"adde6a90-c4de-487a-9592-4d5ac97397c6"],

Cell[BoxData[
 StyleBox[
  RowBox[{"{", 
   RowBox[{
    TagBox[
     FormBox[
      RowBox[{"(", "\[NoBreak]", GridBox[{
         {
          FractionBox["1", "4"], 
          FractionBox["1", "4"], 
          FractionBox["1", "4"], 
          FractionBox["1", "4"]},
         {
          FractionBox["1", "4"], 
          FractionBox["1", "4"], 
          FractionBox["1", "4"], 
          FractionBox["1", "4"]},
         {
          FractionBox["1", "4"], 
          FractionBox["1", "4"], 
          FractionBox["1", "4"], 
          FractionBox["1", "4"]},
         {
          FractionBox["1", "4"], 
          FractionBox["1", "4"], 
          FractionBox["1", "4"], 
          FractionBox["1", "4"]}
        },
        GridBoxAlignment->{
         "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
          "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.7]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.4]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
      TraditionalForm],
     TraditionalForm,
     Editable->True], ",", 
    TagBox[
     FormBox[
      RowBox[{"(", "\[NoBreak]", GridBox[{
         {"1", "0", "0", "1"},
         {
          FractionBox["1", "2"], 
          FractionBox["1", "2"], 
          FractionBox["1", "2"], 
          FractionBox["1", "2"]},
         {
          FractionBox["1", "2"], 
          FractionBox["1", "2"], 
          FractionBox["1", "2"], 
          FractionBox["1", "2"]},
         {"0", "1", "1", "0"}
        },
        GridBoxAlignment->{
         "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
          "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.7]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.4]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
      TraditionalForm],
     TraditionalForm,
     Editable->True], ",", 
    TagBox[
     FormBox[
      RowBox[{"(", "\[NoBreak]", GridBox[{
         {
          FractionBox["1", "4"], 
          FractionBox["1", "4"], 
          FractionBox["1", "4"], 
          FractionBox["1", "4"]},
         {
          FractionBox["1", "4"], 
          FractionBox["1", "4"], 
          FractionBox["1", "4"], 
          FractionBox["1", "4"]},
         {
          FractionBox["1", "4"], 
          FractionBox["1", "4"], 
          FractionBox["1", "4"], 
          FractionBox["1", "4"]},
         {
          FractionBox["1", "4"], 
          FractionBox["1", "4"], 
          FractionBox["1", "4"], 
          FractionBox["1", "4"]}
        },
        GridBoxAlignment->{
         "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
          "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.7]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.4]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
      TraditionalForm],
     TraditionalForm,
     Editable->True]}], "}"}],
  StripOnInput->False,
  Magnification->GoldenRatio Inherited]], "Output",
 CellChangeTimes->{3.7626031270056176`*^9, 3.7626031805289783`*^9},
 CellLabel->"Out[38]=",ExpressionUUID->"205373cf-2203-4b63-8c98-84c88b10ec0d"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"TraditionalForm", "/@", 
   RowBox[{"measureNonConj", "[", "state", "]"}]}], "//", 
  "Magnify"}]], "Input",
 CellChangeTimes->{{3.7626031245215826`*^9, 3.7626031261628714`*^9}, 
   3.762603171073099*^9},
 CellLabel->"In[40]:=",ExpressionUUID->"44365d88-2761-4db6-95f3-ed876220a530"],

Cell[BoxData[
 StyleBox[
  RowBox[{"{", 
   RowBox[{
    TagBox[
     FormBox[
      RowBox[{"(", "\[NoBreak]", GridBox[{
         {"1", "0", "0", "1"},
         {
          FractionBox["1", "2"], 
          FractionBox["1", "2"], 
          FractionBox["1", "2"], 
          FractionBox["1", "2"]},
         {
          FractionBox["1", "2"], 
          FractionBox["1", "2"], 
          FractionBox["1", "2"], 
          FractionBox["1", "2"]},
         {"0", "1", "1", "0"}
        },
        GridBoxAlignment->{
         "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
          "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.7]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.4]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
      TraditionalForm],
     TraditionalForm,
     Editable->True], ",", 
    TagBox[
     FormBox[
      RowBox[{"(", "\[NoBreak]", GridBox[{
         {
          FractionBox["1", "4"], 
          FractionBox["1", "4"], 
          FractionBox["1", "4"], 
          FractionBox["1", "4"]},
         {
          FractionBox["1", "4"], 
          FractionBox["1", "4"], 
          FractionBox["1", "4"], 
          FractionBox["1", "4"]},
         {
          FractionBox["1", "4"], 
          FractionBox["1", "4"], 
          FractionBox["1", "4"], 
          FractionBox["1", "4"]},
         {
          FractionBox["1", "4"], 
          FractionBox["1", "4"], 
          FractionBox["1", "4"], 
          FractionBox["1", "4"]}
        },
        GridBoxAlignment->{
         "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
          "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.7]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.4]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
      TraditionalForm],
     TraditionalForm,
     Editable->True], ",", 
    TagBox[
     FormBox[
      RowBox[{"(", "\[NoBreak]", GridBox[{
         {
          FractionBox["1", "4"], 
          FractionBox["1", "4"], 
          FractionBox["1", "4"], 
          FractionBox["1", "4"]},
         {
          FractionBox["1", "4"], 
          FractionBox["1", "4"], 
          FractionBox["1", "4"], 
          FractionBox["1", "4"]},
         {
          FractionBox["1", "4"], 
          FractionBox["1", "4"], 
          FractionBox["1", "4"], 
          FractionBox["1", "4"]},
         {
          FractionBox["1", "4"], 
          FractionBox["1", "4"], 
          FractionBox["1", "4"], 
          FractionBox["1", "4"]}
        },
        GridBoxAlignment->{
         "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
          "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.7]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.4]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
      TraditionalForm],
     TraditionalForm,
     Editable->True]}], "}"}],
  StripOnInput->False,
  Magnification->GoldenRatio Inherited]], "Output",
 CellChangeTimes->{3.7626032068919587`*^9},
 CellLabel->"Out[40]=",ExpressionUUID->"812395e1-fcc5-4f27-98ad-5815e91a8d91"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"subspaceMeasurement", "[", 
    RowBox[{"state", ",", "0", ",", "1"}], "]"}], "//", "TraditionalForm"}], "//",
   "Magnify"}]], "Input",
 CellChangeTimes->{{3.762600501534397*^9, 3.7626005618392487`*^9}},
 CellLabel->"In[59]:=",ExpressionUUID->"c5000288-1bb3-4ed9-9ca5-b8011167739a"],

Cell[BoxData[
 StyleBox[
  TagBox[
   FormBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {
        FractionBox[
         RowBox[{
          TemplateBox[{"\[Alpha]"},
           "Conjugate"], "+", 
          TemplateBox[{"\[Beta]"},
           "Conjugate"]}], "2"], 
        FractionBox[
         RowBox[{
          TemplateBox[{"\[Alpha]"},
           "Conjugate"], "-", 
          TemplateBox[{"\[Beta]"},
           "Conjugate"]}], "2"], 
        FractionBox[
         RowBox[{
          TemplateBox[{"\[Alpha]"},
           "Conjugate"], "-", 
          TemplateBox[{"\[Beta]"},
           "Conjugate"]}], "2"], 
        FractionBox[
         RowBox[{
          TemplateBox[{"\[Alpha]"},
           "Conjugate"], "+", 
          TemplateBox[{"\[Beta]"},
           "Conjugate"]}], "2"]},
       {
        RowBox[{
         FractionBox["1", "2"], " ", 
         RowBox[{"(", 
          RowBox[{
           TemplateBox[{"\[Alpha]"},
            "Conjugate"], "+", 
           RowBox[{"\[ImaginaryI]", " ", 
            TemplateBox[{"\[Beta]"},
             "Conjugate"]}]}], ")"}]}], 
        RowBox[{
         FractionBox["1", "2"], " ", 
         RowBox[{"(", 
          RowBox[{
           TemplateBox[{"\[Alpha]"},
            "Conjugate"], "-", 
           RowBox[{"\[ImaginaryI]", " ", 
            TemplateBox[{"\[Beta]"},
             "Conjugate"]}]}], ")"}]}], 
        RowBox[{
         FractionBox["1", "2"], " ", 
         RowBox[{"(", 
          RowBox[{
           TemplateBox[{"\[Alpha]"},
            "Conjugate"], "-", 
           RowBox[{"\[ImaginaryI]", " ", 
            TemplateBox[{"\[Beta]"},
             "Conjugate"]}]}], ")"}]}], 
        RowBox[{
         FractionBox["1", "2"], " ", 
         RowBox[{"(", 
          RowBox[{
           TemplateBox[{"\[Alpha]"},
            "Conjugate"], "+", 
           RowBox[{"\[ImaginaryI]", " ", 
            TemplateBox[{"\[Beta]"},
             "Conjugate"]}]}], ")"}]}]},
       {
        RowBox[{
         FractionBox["1", "2"], " ", 
         RowBox[{"(", 
          RowBox[{
           TemplateBox[{"\[Alpha]"},
            "Conjugate"], "+", 
           RowBox[{"\[ImaginaryI]", " ", 
            TemplateBox[{"\[Beta]"},
             "Conjugate"]}]}], ")"}]}], 
        RowBox[{
         FractionBox["1", "2"], " ", 
         RowBox[{"(", 
          RowBox[{
           TemplateBox[{"\[Alpha]"},
            "Conjugate"], "-", 
           RowBox[{"\[ImaginaryI]", " ", 
            TemplateBox[{"\[Beta]"},
             "Conjugate"]}]}], ")"}]}], 
        RowBox[{
         FractionBox["1", "2"], " ", 
         RowBox[{"(", 
          RowBox[{
           TemplateBox[{"\[Alpha]"},
            "Conjugate"], "-", 
           RowBox[{"\[ImaginaryI]", " ", 
            TemplateBox[{"\[Beta]"},
             "Conjugate"]}]}], ")"}]}], 
        RowBox[{
         FractionBox["1", "2"], " ", 
         RowBox[{"(", 
          RowBox[{
           TemplateBox[{"\[Alpha]"},
            "Conjugate"], "+", 
           RowBox[{"\[ImaginaryI]", " ", 
            TemplateBox[{"\[Beta]"},
             "Conjugate"]}]}], ")"}]}]},
       {
        FractionBox[
         RowBox[{
          TemplateBox[{"\[Alpha]"},
           "Conjugate"], "-", 
          TemplateBox[{"\[Beta]"},
           "Conjugate"]}], "2"], 
        FractionBox[
         RowBox[{
          TemplateBox[{"\[Alpha]"},
           "Conjugate"], "+", 
          TemplateBox[{"\[Beta]"},
           "Conjugate"]}], "2"], 
        FractionBox[
         RowBox[{
          TemplateBox[{"\[Alpha]"},
           "Conjugate"], "+", 
          TemplateBox[{"\[Beta]"},
           "Conjugate"]}], "2"], 
        FractionBox[
         RowBox[{
          TemplateBox[{"\[Alpha]"},
           "Conjugate"], "-", 
          TemplateBox[{"\[Beta]"},
           "Conjugate"]}], "2"]}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
        "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
    TraditionalForm],
   TraditionalForm,
   Editable->True],
  StripOnInput->False,
  Magnification->GoldenRatio Inherited]], "Output",
 CellChangeTimes->{{3.762600508852292*^9, 3.762600562662047*^9}},
 CellLabel->"Out[59]=",ExpressionUUID->"19d37614-df53-47be-9e0d-54d1c8460f48"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"subspaceMeasurement", "[", 
    RowBox[{"state", ",", "0", ",", 
     RowBox[{"-", "1"}]}], "]"}], "//", "TraditionalForm"}], "//", 
  "Magnify"}]], "Input",
 CellChangeTimes->{{3.762600501534397*^9, 3.762600560850891*^9}},
 CellLabel->"In[60]:=",ExpressionUUID->"acb918e3-e472-4a22-ac85-edb27262e1c8"],

Cell[BoxData[
 StyleBox[
  TagBox[
   FormBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {
        FractionBox[
         RowBox[{
          TemplateBox[{"\[Alpha]"},
           "Conjugate"], "+", 
          TemplateBox[{"\[Gamma]"},
           "Conjugate"]}], "2"], 
        FractionBox[
         RowBox[{
          TemplateBox[{"\[Alpha]"},
           "Conjugate"], "-", 
          TemplateBox[{"\[Gamma]"},
           "Conjugate"]}], "2"], 
        FractionBox[
         RowBox[{
          TemplateBox[{"\[Alpha]"},
           "Conjugate"], "-", 
          TemplateBox[{"\[Gamma]"},
           "Conjugate"]}], "2"], 
        FractionBox[
         RowBox[{
          TemplateBox[{"\[Alpha]"},
           "Conjugate"], "+", 
          TemplateBox[{"\[Gamma]"},
           "Conjugate"]}], "2"]},
       {
        RowBox[{
         FractionBox["1", "2"], " ", 
         RowBox[{"(", 
          RowBox[{
           TemplateBox[{"\[Alpha]"},
            "Conjugate"], "+", 
           RowBox[{"\[ImaginaryI]", " ", 
            TemplateBox[{"\[Gamma]"},
             "Conjugate"]}]}], ")"}]}], 
        RowBox[{
         FractionBox["1", "2"], " ", 
         RowBox[{"(", 
          RowBox[{
           TemplateBox[{"\[Alpha]"},
            "Conjugate"], "-", 
           RowBox[{"\[ImaginaryI]", " ", 
            TemplateBox[{"\[Gamma]"},
             "Conjugate"]}]}], ")"}]}], 
        RowBox[{
         FractionBox["1", "2"], " ", 
         RowBox[{"(", 
          RowBox[{
           TemplateBox[{"\[Alpha]"},
            "Conjugate"], "-", 
           RowBox[{"\[ImaginaryI]", " ", 
            TemplateBox[{"\[Gamma]"},
             "Conjugate"]}]}], ")"}]}], 
        RowBox[{
         FractionBox["1", "2"], " ", 
         RowBox[{"(", 
          RowBox[{
           TemplateBox[{"\[Alpha]"},
            "Conjugate"], "+", 
           RowBox[{"\[ImaginaryI]", " ", 
            TemplateBox[{"\[Gamma]"},
             "Conjugate"]}]}], ")"}]}]},
       {
        RowBox[{
         FractionBox["1", "2"], " ", 
         RowBox[{"(", 
          RowBox[{
           TemplateBox[{"\[Alpha]"},
            "Conjugate"], "+", 
           RowBox[{"\[ImaginaryI]", " ", 
            TemplateBox[{"\[Gamma]"},
             "Conjugate"]}]}], ")"}]}], 
        RowBox[{
         FractionBox["1", "2"], " ", 
         RowBox[{"(", 
          RowBox[{
           TemplateBox[{"\[Alpha]"},
            "Conjugate"], "-", 
           RowBox[{"\[ImaginaryI]", " ", 
            TemplateBox[{"\[Gamma]"},
             "Conjugate"]}]}], ")"}]}], 
        RowBox[{
         FractionBox["1", "2"], " ", 
         RowBox[{"(", 
          RowBox[{
           TemplateBox[{"\[Alpha]"},
            "Conjugate"], "-", 
           RowBox[{"\[ImaginaryI]", " ", 
            TemplateBox[{"\[Gamma]"},
             "Conjugate"]}]}], ")"}]}], 
        RowBox[{
         FractionBox["1", "2"], " ", 
         RowBox[{"(", 
          RowBox[{
           TemplateBox[{"\[Alpha]"},
            "Conjugate"], "+", 
           RowBox[{"\[ImaginaryI]", " ", 
            TemplateBox[{"\[Gamma]"},
             "Conjugate"]}]}], ")"}]}]},
       {
        FractionBox[
         RowBox[{
          TemplateBox[{"\[Alpha]"},
           "Conjugate"], "-", 
          TemplateBox[{"\[Gamma]"},
           "Conjugate"]}], "2"], 
        FractionBox[
         RowBox[{
          TemplateBox[{"\[Alpha]"},
           "Conjugate"], "+", 
          TemplateBox[{"\[Gamma]"},
           "Conjugate"]}], "2"], 
        FractionBox[
         RowBox[{
          TemplateBox[{"\[Alpha]"},
           "Conjugate"], "+", 
          TemplateBox[{"\[Gamma]"},
           "Conjugate"]}], "2"], 
        FractionBox[
         RowBox[{
          TemplateBox[{"\[Alpha]"},
           "Conjugate"], "-", 
          TemplateBox[{"\[Gamma]"},
           "Conjugate"]}], "2"]}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
        "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
    TraditionalForm],
   TraditionalForm,
   Editable->True],
  StripOnInput->False,
  Magnification->GoldenRatio Inherited]], "Output",
 CellChangeTimes->{{3.7626005432518177`*^9, 3.7626005635936193`*^9}},
 CellLabel->"Out[60]=",ExpressionUUID->"6faa15ed-5153-42a8-98c8-b6ebaa3b12b0"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"subspaceMeasurement", "[", 
    RowBox[{"state", ",", "1", ",", 
     RowBox[{"-", "1"}]}], "]"}], "//", "TraditionalForm"}], "//", 
  "Magnify"}]], "Input",
 CellChangeTimes->{{3.762600501534397*^9, 3.7626005565666957`*^9}},
 CellLabel->"In[58]:=",ExpressionUUID->"9c416b71-f380-40f4-a723-02ebf580a33b"],

Cell[BoxData[
 StyleBox[
  TagBox[
   FormBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {
        FractionBox[
         RowBox[{
          TemplateBox[{"\[Beta]"},
           "Conjugate"], "+", 
          TemplateBox[{"\[Gamma]"},
           "Conjugate"]}], "2"], 
        FractionBox[
         RowBox[{
          TemplateBox[{"\[Beta]"},
           "Conjugate"], "-", 
          TemplateBox[{"\[Gamma]"},
           "Conjugate"]}], "2"], 
        FractionBox[
         RowBox[{
          TemplateBox[{"\[Beta]"},
           "Conjugate"], "-", 
          TemplateBox[{"\[Gamma]"},
           "Conjugate"]}], "2"], 
        FractionBox[
         RowBox[{
          TemplateBox[{"\[Beta]"},
           "Conjugate"], "+", 
          TemplateBox[{"\[Gamma]"},
           "Conjugate"]}], "2"]},
       {
        RowBox[{
         FractionBox["1", "2"], " ", 
         RowBox[{"(", 
          RowBox[{
           TemplateBox[{"\[Beta]"},
            "Conjugate"], "+", 
           RowBox[{"\[ImaginaryI]", " ", 
            TemplateBox[{"\[Gamma]"},
             "Conjugate"]}]}], ")"}]}], 
        RowBox[{
         FractionBox["1", "2"], " ", 
         RowBox[{"(", 
          RowBox[{
           TemplateBox[{"\[Beta]"},
            "Conjugate"], "-", 
           RowBox[{"\[ImaginaryI]", " ", 
            TemplateBox[{"\[Gamma]"},
             "Conjugate"]}]}], ")"}]}], 
        RowBox[{
         FractionBox["1", "2"], " ", 
         RowBox[{"(", 
          RowBox[{
           TemplateBox[{"\[Beta]"},
            "Conjugate"], "-", 
           RowBox[{"\[ImaginaryI]", " ", 
            TemplateBox[{"\[Gamma]"},
             "Conjugate"]}]}], ")"}]}], 
        RowBox[{
         FractionBox["1", "2"], " ", 
         RowBox[{"(", 
          RowBox[{
           TemplateBox[{"\[Beta]"},
            "Conjugate"], "+", 
           RowBox[{"\[ImaginaryI]", " ", 
            TemplateBox[{"\[Gamma]"},
             "Conjugate"]}]}], ")"}]}]},
       {
        RowBox[{
         FractionBox["1", "2"], " ", 
         RowBox[{"(", 
          RowBox[{
           TemplateBox[{"\[Beta]"},
            "Conjugate"], "+", 
           RowBox[{"\[ImaginaryI]", " ", 
            TemplateBox[{"\[Gamma]"},
             "Conjugate"]}]}], ")"}]}], 
        RowBox[{
         FractionBox["1", "2"], " ", 
         RowBox[{"(", 
          RowBox[{
           TemplateBox[{"\[Beta]"},
            "Conjugate"], "-", 
           RowBox[{"\[ImaginaryI]", " ", 
            TemplateBox[{"\[Gamma]"},
             "Conjugate"]}]}], ")"}]}], 
        RowBox[{
         FractionBox["1", "2"], " ", 
         RowBox[{"(", 
          RowBox[{
           TemplateBox[{"\[Beta]"},
            "Conjugate"], "-", 
           RowBox[{"\[ImaginaryI]", " ", 
            TemplateBox[{"\[Gamma]"},
             "Conjugate"]}]}], ")"}]}], 
        RowBox[{
         FractionBox["1", "2"], " ", 
         RowBox[{"(", 
          RowBox[{
           TemplateBox[{"\[Beta]"},
            "Conjugate"], "+", 
           RowBox[{"\[ImaginaryI]", " ", 
            TemplateBox[{"\[Gamma]"},
             "Conjugate"]}]}], ")"}]}]},
       {
        FractionBox[
         RowBox[{
          TemplateBox[{"\[Beta]"},
           "Conjugate"], "-", 
          TemplateBox[{"\[Gamma]"},
           "Conjugate"]}], "2"], 
        FractionBox[
         RowBox[{
          TemplateBox[{"\[Beta]"},
           "Conjugate"], "+", 
          TemplateBox[{"\[Gamma]"},
           "Conjugate"]}], "2"], 
        FractionBox[
         RowBox[{
          TemplateBox[{"\[Beta]"},
           "Conjugate"], "+", 
          TemplateBox[{"\[Gamma]"},
           "Conjugate"]}], "2"], 
        FractionBox[
         RowBox[{
          TemplateBox[{"\[Beta]"},
           "Conjugate"], "-", 
          TemplateBox[{"\[Gamma]"},
           "Conjugate"]}], "2"]}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
        "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
    TraditionalForm],
   TraditionalForm,
   Editable->True],
  StripOnInput->False,
  Magnification->GoldenRatio Inherited]], "Output",
 CellChangeTimes->{{3.762600548275466*^9, 3.7626005570474105`*^9}},
 CellLabel->"Out[58]=",ExpressionUUID->"f4a2b25a-ce7c-4528-bcf5-d3f4bf3d4da1"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Tests CNOT", "Subchapter",
 CellChangeTimes->{{3.76407953907279*^9, 
  3.7640795405121837`*^9}},ExpressionUUID->"35b50382-02db-49e4-a7aa-\
3a2e24e47649"],

Cell[BoxData[
 RowBox[{
  RowBox[{"state", "=", 
   RowBox[{
    RowBox[{
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"-", "1"}], ")"}], 
      RowBox[{"1", "/", "12"}]], " ", 
     SqrtBox["2"], " ", "g", " ", 
     TemplateBox[{
       RowBox[{"\"H\"", ",", 
         SuperscriptBox["\"H\"", "2"], ",", "0", ",", "\"V\""}]},
      "Ket"], " ", 
     SubscriptBox["\[Alpha]", 
      RowBox[{"\"\<H\>\"", ",", "\"\<H\>\""}]]}], "+", 
    RowBox[{
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"-", "1"}], ")"}], 
      RowBox[{"1", "/", "12"}]], " ", "g", " ", 
     TemplateBox[{
       RowBox[{"\"H\"", ",", 
         RowBox[{"\"H\"", "+", "\"V\""}], ",", "0", ",", "\"H\""}]},
      "Ket"], " ", 
     SubscriptBox["\[Alpha]", 
      RowBox[{"\"\<H\>\"", ",", "\"\<H\>\""}]]}], "+", 
    RowBox[{
     TemplateBox[{
       RowBox[{"\"H\"", ",", "\"H\"", ",", "\"H\"", ",", "\"V\""}]},
      "Ket"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", 
         FractionBox["1", "2"]}], " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"-", "1"}], ")"}], 
         RowBox[{"1", "/", "6"}]], " ", "g", " ", 
        SubscriptBox["\[Alpha]", 
         RowBox[{"\"\<H\>\"", ",", "\"\<H\>\""}]]}], "+", 
       RowBox[{
        FractionBox["1", "2"], " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"-", "1"}], ")"}], 
         RowBox[{"2", "/", "3"}]], " ", "g", " ", 
        SubscriptBox["\[Alpha]", 
         RowBox[{"\"\<H\>\"", ",", "\"\<H\>\""}]]}]}], ")"}]}], "+", 
    RowBox[{
     TemplateBox[{
       RowBox[{"\"H\"", ",", "\"H\"", ",", "\"V\"", ",", "\"H\""}]},
      "Ket"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", 
         FractionBox["1", "2"]}], " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"-", "1"}], ")"}], 
         RowBox[{"1", "/", "6"}]], " ", "g", " ", 
        SubscriptBox["\[Alpha]", 
         RowBox[{"\"\<H\>\"", ",", "\"\<H\>\""}]]}], "+", 
       RowBox[{
        FractionBox["1", "2"], " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"-", "1"}], ")"}], 
         RowBox[{"2", "/", "3"}]], " ", "g", " ", 
        SubscriptBox["\[Alpha]", 
         RowBox[{"\"\<H\>\"", ",", "\"\<H\>\""}]]}]}], ")"}]}], "+", 
    RowBox[{
     TemplateBox[{
       RowBox[{"\"H\"", ",", "\"H\"", ",", "\"H\"", ",", "\"H\""}]},
      "Ket"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        FractionBox["1", "2"], " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"-", "1"}], ")"}], 
         RowBox[{"1", "/", "6"}]], " ", "g", " ", 
        SubscriptBox["\[Alpha]", 
         RowBox[{"\"\<H\>\"", ",", "\"\<H\>\""}]]}], "+", 
       RowBox[{
        FractionBox["1", "2"], " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"-", "1"}], ")"}], 
         RowBox[{"2", "/", "3"}]], " ", "g", " ", 
        SubscriptBox["\[Alpha]", 
         RowBox[{"\"\<H\>\"", ",", "\"\<H\>\""}]]}]}], ")"}]}], "+", 
    RowBox[{
     TemplateBox[{
       RowBox[{"\"H\"", ",", "\"H\"", ",", "\"V\"", ",", "\"V\""}]},
      "Ket"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        FractionBox["1", "2"], " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"-", "1"}], ")"}], 
         RowBox[{"1", "/", "6"}]], " ", "g", " ", 
        SubscriptBox["\[Alpha]", 
         RowBox[{"\"\<H\>\"", ",", "\"\<H\>\""}]]}], "+", 
       RowBox[{
        FractionBox["1", "2"], " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"-", "1"}], ")"}], 
         RowBox[{"2", "/", "3"}]], " ", "g", " ", 
        SubscriptBox["\[Alpha]", 
         RowBox[{"\"\<H\>\"", ",", "\"\<H\>\""}]]}]}], ")"}]}], "+", 
    RowBox[{
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"-", "1"}], ")"}], 
      RowBox[{"1", "/", "12"}]], " ", 
     SqrtBox["2"], " ", "g", " ", 
     TemplateBox[{
       RowBox[{"\"H\"", ",", 
         SuperscriptBox["\"V\"", "2"], ",", "0", ",", "\"H\""}]},
      "Ket"], " ", 
     SubscriptBox["\[Alpha]", 
      RowBox[{"\"\<H\>\"", ",", "\"\<V\>\""}]]}], "+", 
    RowBox[{
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"-", "1"}], ")"}], 
      RowBox[{"1", "/", "12"}]], " ", "g", " ", 
     TemplateBox[{
       RowBox[{"\"H\"", ",", 
         RowBox[{"\"H\"", "+", "\"V\""}], ",", "0", ",", "\"V\""}]},
      "Ket"], " ", 
     SubscriptBox["\[Alpha]", 
      RowBox[{"\"\<H\>\"", ",", "\"\<V\>\""}]]}], "+", 
    RowBox[{
     TemplateBox[{
       RowBox[{"\"H\"", ",", "\"V\"", ",", "\"H\"", ",", "\"V\""}]},
      "Ket"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", 
         FractionBox["1", "2"]}], " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"-", "1"}], ")"}], 
         RowBox[{"1", "/", "6"}]], " ", "g", " ", 
        SubscriptBox["\[Alpha]", 
         RowBox[{"\"\<H\>\"", ",", "\"\<V\>\""}]]}], "+", 
       RowBox[{
        FractionBox["1", "2"], " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"-", "1"}], ")"}], 
         RowBox[{"2", "/", "3"}]], " ", "g", " ", 
        SubscriptBox["\[Alpha]", 
         RowBox[{"\"\<H\>\"", ",", "\"\<V\>\""}]]}]}], ")"}]}], "+", 
    RowBox[{
     TemplateBox[{
       RowBox[{"\"H\"", ",", "\"V\"", ",", "\"V\"", ",", "\"H\""}]},
      "Ket"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", 
         FractionBox["1", "2"]}], " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"-", "1"}], ")"}], 
         RowBox[{"1", "/", "6"}]], " ", "g", " ", 
        SubscriptBox["\[Alpha]", 
         RowBox[{"\"\<H\>\"", ",", "\"\<V\>\""}]]}], "+", 
       RowBox[{
        FractionBox["1", "2"], " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"-", "1"}], ")"}], 
         RowBox[{"2", "/", "3"}]], " ", "g", " ", 
        SubscriptBox["\[Alpha]", 
         RowBox[{"\"\<H\>\"", ",", "\"\<V\>\""}]]}]}], ")"}]}], "+", 
    RowBox[{
     TemplateBox[{
       RowBox[{"\"H\"", ",", "\"V\"", ",", "\"H\"", ",", "\"H\""}]},
      "Ket"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        FractionBox["1", "2"], " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"-", "1"}], ")"}], 
         RowBox[{"1", "/", "6"}]], " ", "g", " ", 
        SubscriptBox["\[Alpha]", 
         RowBox[{"\"\<H\>\"", ",", "\"\<V\>\""}]]}], "+", 
       RowBox[{
        FractionBox["1", "2"], " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"-", "1"}], ")"}], 
         RowBox[{"2", "/", "3"}]], " ", "g", " ", 
        SubscriptBox["\[Alpha]", 
         RowBox[{"\"\<H\>\"", ",", "\"\<V\>\""}]]}]}], ")"}]}], "+", 
    RowBox[{
     TemplateBox[{
       RowBox[{"\"H\"", ",", "\"V\"", ",", "\"V\"", ",", "\"V\""}]},
      "Ket"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        FractionBox["1", "2"], " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"-", "1"}], ")"}], 
         RowBox[{"1", "/", "6"}]], " ", "g", " ", 
        SubscriptBox["\[Alpha]", 
         RowBox[{"\"\<H\>\"", ",", "\"\<V\>\""}]]}], "+", 
       RowBox[{
        FractionBox["1", "2"], " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"-", "1"}], ")"}], 
         RowBox[{"2", "/", "3"}]], " ", "g", " ", 
        SubscriptBox["\[Alpha]", 
         RowBox[{"\"\<H\>\"", ",", "\"\<V\>\""}]]}]}], ")"}]}], "+", 
    RowBox[{
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"-", "1"}], ")"}], 
      RowBox[{"1", "/", "12"}]], " ", 
     SqrtBox["2"], " ", "g", " ", 
     TemplateBox[{
       RowBox[{"\"V\"", ",", 
         SuperscriptBox["\"H\"", "2"], ",", "0", ",", "\"V\""}]},
      "Ket"], " ", 
     SubscriptBox["\[Alpha]", 
      RowBox[{"\"\<V\>\"", ",", "\"\<H\>\""}]]}], "+", 
    RowBox[{
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"-", "1"}], ")"}], 
      RowBox[{"1", "/", "12"}]], " ", "g", " ", 
     TemplateBox[{
       RowBox[{"\"V\"", ",", 
         RowBox[{"\"H\"", "+", "\"V\""}], ",", "0", ",", "\"H\""}]},
      "Ket"], " ", 
     SubscriptBox["\[Alpha]", 
      RowBox[{"\"\<V\>\"", ",", "\"\<H\>\""}]]}], "+", 
    RowBox[{
     TemplateBox[{
       RowBox[{"\"V\"", ",", "\"H\"", ",", "\"H\"", ",", "\"V\""}]},
      "Ket"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", 
         FractionBox["1", "2"]}], " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"-", "1"}], ")"}], 
         RowBox[{"1", "/", "6"}]], " ", "g", " ", 
        SubscriptBox["\[Alpha]", 
         RowBox[{"\"\<V\>\"", ",", "\"\<H\>\""}]]}], "+", 
       RowBox[{
        FractionBox["1", "2"], " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"-", "1"}], ")"}], 
         RowBox[{"2", "/", "3"}]], " ", "g", " ", 
        SubscriptBox["\[Alpha]", 
         RowBox[{"\"\<V\>\"", ",", "\"\<H\>\""}]]}]}], ")"}]}], "+", 
    RowBox[{
     TemplateBox[{
       RowBox[{"\"V\"", ",", "\"H\"", ",", "\"V\"", ",", "\"H\""}]},
      "Ket"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", 
         FractionBox["1", "2"]}], " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"-", "1"}], ")"}], 
         RowBox[{"1", "/", "6"}]], " ", "g", " ", 
        SubscriptBox["\[Alpha]", 
         RowBox[{"\"\<V\>\"", ",", "\"\<H\>\""}]]}], "+", 
       RowBox[{
        FractionBox["1", "2"], " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"-", "1"}], ")"}], 
         RowBox[{"2", "/", "3"}]], " ", "g", " ", 
        SubscriptBox["\[Alpha]", 
         RowBox[{"\"\<V\>\"", ",", "\"\<H\>\""}]]}]}], ")"}]}], "+", 
    RowBox[{
     TemplateBox[{
       RowBox[{"\"V\"", ",", "\"H\"", ",", "\"H\"", ",", "\"H\""}]},
      "Ket"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        FractionBox["1", "2"], " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"-", "1"}], ")"}], 
         RowBox[{"1", "/", "6"}]], " ", "g", " ", 
        SubscriptBox["\[Alpha]", 
         RowBox[{"\"\<V\>\"", ",", "\"\<H\>\""}]]}], "+", 
       RowBox[{
        FractionBox["1", "2"], " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"-", "1"}], ")"}], 
         RowBox[{"2", "/", "3"}]], " ", "g", " ", 
        SubscriptBox["\[Alpha]", 
         RowBox[{"\"\<V\>\"", ",", "\"\<H\>\""}]]}]}], ")"}]}], "+", 
    RowBox[{
     TemplateBox[{
       RowBox[{"\"V\"", ",", "\"H\"", ",", "\"V\"", ",", "\"V\""}]},
      "Ket"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        FractionBox["1", "2"], " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"-", "1"}], ")"}], 
         RowBox[{"1", "/", "6"}]], " ", "g", " ", 
        SubscriptBox["\[Alpha]", 
         RowBox[{"\"\<V\>\"", ",", "\"\<H\>\""}]]}], "+", 
       RowBox[{
        FractionBox["1", "2"], " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"-", "1"}], ")"}], 
         RowBox[{"2", "/", "3"}]], " ", "g", " ", 
        SubscriptBox["\[Alpha]", 
         RowBox[{"\"\<V\>\"", ",", "\"\<H\>\""}]]}]}], ")"}]}], "+", 
    RowBox[{
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"-", "1"}], ")"}], 
      RowBox[{"1", "/", "12"}]], " ", 
     SqrtBox["2"], " ", "g", " ", 
     TemplateBox[{
       RowBox[{"\"V\"", ",", 
         SuperscriptBox["\"V\"", "2"], ",", "0", ",", "\"H\""}]},
      "Ket"], " ", 
     SubscriptBox["\[Alpha]", 
      RowBox[{"\"\<V\>\"", ",", "\"\<V\>\""}]]}], "+", 
    RowBox[{
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"-", "1"}], ")"}], 
      RowBox[{"1", "/", "12"}]], " ", "g", " ", 
     TemplateBox[{
       RowBox[{"\"V\"", ",", 
         RowBox[{"\"H\"", "+", "\"V\""}], ",", "0", ",", "\"V\""}]},
      "Ket"], " ", 
     SubscriptBox["\[Alpha]", 
      RowBox[{"\"\<V\>\"", ",", "\"\<V\>\""}]]}], "+", 
    RowBox[{
     TemplateBox[{
       RowBox[{"\"V\"", ",", "\"V\"", ",", "\"H\"", ",", "\"V\""}]},
      "Ket"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", 
         FractionBox["1", "2"]}], " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"-", "1"}], ")"}], 
         RowBox[{"1", "/", "6"}]], " ", "g", " ", 
        SubscriptBox["\[Alpha]", 
         RowBox[{"\"\<V\>\"", ",", "\"\<V\>\""}]]}], "+", 
       RowBox[{
        FractionBox["1", "2"], " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"-", "1"}], ")"}], 
         RowBox[{"2", "/", "3"}]], " ", "g", " ", 
        SubscriptBox["\[Alpha]", 
         RowBox[{"\"\<V\>\"", ",", "\"\<V\>\""}]]}]}], ")"}]}], "+", 
    RowBox[{
     TemplateBox[{
       RowBox[{"\"V\"", ",", "\"V\"", ",", "\"V\"", ",", "\"H\""}]},
      "Ket"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", 
         FractionBox["1", "2"]}], " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"-", "1"}], ")"}], 
         RowBox[{"1", "/", "6"}]], " ", "g", " ", 
        SubscriptBox["\[Alpha]", 
         RowBox[{"\"\<V\>\"", ",", "\"\<V\>\""}]]}], "+", 
       RowBox[{
        FractionBox["1", "2"], " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"-", "1"}], ")"}], 
         RowBox[{"2", "/", "3"}]], " ", "g", " ", 
        SubscriptBox["\[Alpha]", 
         RowBox[{"\"\<V\>\"", ",", "\"\<V\>\""}]]}]}], ")"}]}], "+", 
    RowBox[{
     TemplateBox[{
       RowBox[{"\"V\"", ",", "\"V\"", ",", "\"H\"", ",", "\"H\""}]},
      "Ket"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        FractionBox["1", "2"], " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"-", "1"}], ")"}], 
         RowBox[{"1", "/", "6"}]], " ", "g", " ", 
        SubscriptBox["\[Alpha]", 
         RowBox[{"\"\<V\>\"", ",", "\"\<V\>\""}]]}], "+", 
       RowBox[{
        FractionBox["1", "2"], " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"-", "1"}], ")"}], 
         RowBox[{"2", "/", "3"}]], " ", "g", " ", 
        SubscriptBox["\[Alpha]", 
         RowBox[{"\"\<V\>\"", ",", "\"\<V\>\""}]]}]}], ")"}]}], "+", 
    RowBox[{
     TemplateBox[{
       RowBox[{"\"V\"", ",", "\"V\"", ",", "\"V\"", ",", "\"V\""}]},
      "Ket"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        FractionBox["1", "2"], " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"-", "1"}], ")"}], 
         RowBox[{"1", "/", "6"}]], " ", "g", " ", 
        SubscriptBox["\[Alpha]", 
         RowBox[{"\"\<V\>\"", ",", "\"\<V\>\""}]]}], "+", 
       RowBox[{
        FractionBox["1", "2"], " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"-", "1"}], ")"}], 
         RowBox[{"2", "/", "3"}]], " ", "g", " ", 
        SubscriptBox["\[Alpha]", 
         RowBox[{"\"\<V\>\"", ",", "\"\<V\>\""}]]}]}], ")"}]}]}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.764079541789386*^9, 3.764079543997081*^9}},
 CellLabel->"In[14]:=",ExpressionUUID->"c6933e7f-4c34-40ae-9a17-1852a58eb7df"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"st", "=", 
  RowBox[{"state", "/.", 
   RowBox[{
    RowBox[{"Ket", "[", 
     RowBox[{"___", ",", 
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"\"\<H\>\"", "|", "\"\<V\>\""}], ")"}], "2"], "|", 
       RowBox[{"(", 
        RowBox[{"\"\<H\>\"", "+", "\"\<V\>\""}], ")"}]}], ",", "___"}], "]"}],
     "\[Rule]", "0"}]}]}]], "Input",
 CellChangeTimes->{{3.764079555224274*^9, 3.7640796359845552`*^9}},
 CellLabel->"In[20]:=",ExpressionUUID->"ca4d3f8d-6eae-4462-9778-875dc1479948"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   TemplateBox[{
     RowBox[{"\"H\"", ",", "\"H\"", ",", "\"H\"", ",", "\"V\""}]},
    "Ket"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"-", 
       FractionBox["1", "2"]}], " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"-", "1"}], ")"}], 
       RowBox[{"1", "/", "6"}]], " ", "g", " ", 
      SubscriptBox["\[Alpha]", 
       RowBox[{"\<\"H\"\>", ",", "\<\"H\"\>"}]]}], "+", 
     RowBox[{
      FractionBox["1", "2"], " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"-", "1"}], ")"}], 
       RowBox[{"2", "/", "3"}]], " ", "g", " ", 
      SubscriptBox["\[Alpha]", 
       RowBox[{"\<\"H\"\>", ",", "\<\"H\"\>"}]]}]}], ")"}]}], "+", 
  RowBox[{
   TemplateBox[{
     RowBox[{"\"H\"", ",", "\"H\"", ",", "\"V\"", ",", "\"H\""}]},
    "Ket"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"-", 
       FractionBox["1", "2"]}], " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"-", "1"}], ")"}], 
       RowBox[{"1", "/", "6"}]], " ", "g", " ", 
      SubscriptBox["\[Alpha]", 
       RowBox[{"\<\"H\"\>", ",", "\<\"H\"\>"}]]}], "+", 
     RowBox[{
      FractionBox["1", "2"], " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"-", "1"}], ")"}], 
       RowBox[{"2", "/", "3"}]], " ", "g", " ", 
      SubscriptBox["\[Alpha]", 
       RowBox[{"\<\"H\"\>", ",", "\<\"H\"\>"}]]}]}], ")"}]}], "+", 
  RowBox[{
   TemplateBox[{
     RowBox[{"\"H\"", ",", "\"H\"", ",", "\"H\"", ",", "\"H\""}]},
    "Ket"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      FractionBox["1", "2"], " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"-", "1"}], ")"}], 
       RowBox[{"1", "/", "6"}]], " ", "g", " ", 
      SubscriptBox["\[Alpha]", 
       RowBox[{"\<\"H\"\>", ",", "\<\"H\"\>"}]]}], "+", 
     RowBox[{
      FractionBox["1", "2"], " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"-", "1"}], ")"}], 
       RowBox[{"2", "/", "3"}]], " ", "g", " ", 
      SubscriptBox["\[Alpha]", 
       RowBox[{"\<\"H\"\>", ",", "\<\"H\"\>"}]]}]}], ")"}]}], "+", 
  RowBox[{
   TemplateBox[{
     RowBox[{"\"H\"", ",", "\"H\"", ",", "\"V\"", ",", "\"V\""}]},
    "Ket"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      FractionBox["1", "2"], " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"-", "1"}], ")"}], 
       RowBox[{"1", "/", "6"}]], " ", "g", " ", 
      SubscriptBox["\[Alpha]", 
       RowBox[{"\<\"H\"\>", ",", "\<\"H\"\>"}]]}], "+", 
     RowBox[{
      FractionBox["1", "2"], " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"-", "1"}], ")"}], 
       RowBox[{"2", "/", "3"}]], " ", "g", " ", 
      SubscriptBox["\[Alpha]", 
       RowBox[{"\<\"H\"\>", ",", "\<\"H\"\>"}]]}]}], ")"}]}], "+", 
  RowBox[{
   TemplateBox[{
     RowBox[{"\"H\"", ",", "\"V\"", ",", "\"H\"", ",", "\"V\""}]},
    "Ket"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"-", 
       FractionBox["1", "2"]}], " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"-", "1"}], ")"}], 
       RowBox[{"1", "/", "6"}]], " ", "g", " ", 
      SubscriptBox["\[Alpha]", 
       RowBox[{"\<\"H\"\>", ",", "\<\"V\"\>"}]]}], "+", 
     RowBox[{
      FractionBox["1", "2"], " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"-", "1"}], ")"}], 
       RowBox[{"2", "/", "3"}]], " ", "g", " ", 
      SubscriptBox["\[Alpha]", 
       RowBox[{"\<\"H\"\>", ",", "\<\"V\"\>"}]]}]}], ")"}]}], "+", 
  RowBox[{
   TemplateBox[{
     RowBox[{"\"H\"", ",", "\"V\"", ",", "\"V\"", ",", "\"H\""}]},
    "Ket"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"-", 
       FractionBox["1", "2"]}], " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"-", "1"}], ")"}], 
       RowBox[{"1", "/", "6"}]], " ", "g", " ", 
      SubscriptBox["\[Alpha]", 
       RowBox[{"\<\"H\"\>", ",", "\<\"V\"\>"}]]}], "+", 
     RowBox[{
      FractionBox["1", "2"], " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"-", "1"}], ")"}], 
       RowBox[{"2", "/", "3"}]], " ", "g", " ", 
      SubscriptBox["\[Alpha]", 
       RowBox[{"\<\"H\"\>", ",", "\<\"V\"\>"}]]}]}], ")"}]}], "+", 
  RowBox[{
   TemplateBox[{
     RowBox[{"\"H\"", ",", "\"V\"", ",", "\"H\"", ",", "\"H\""}]},
    "Ket"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      FractionBox["1", "2"], " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"-", "1"}], ")"}], 
       RowBox[{"1", "/", "6"}]], " ", "g", " ", 
      SubscriptBox["\[Alpha]", 
       RowBox[{"\<\"H\"\>", ",", "\<\"V\"\>"}]]}], "+", 
     RowBox[{
      FractionBox["1", "2"], " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"-", "1"}], ")"}], 
       RowBox[{"2", "/", "3"}]], " ", "g", " ", 
      SubscriptBox["\[Alpha]", 
       RowBox[{"\<\"H\"\>", ",", "\<\"V\"\>"}]]}]}], ")"}]}], "+", 
  RowBox[{
   TemplateBox[{
     RowBox[{"\"H\"", ",", "\"V\"", ",", "\"V\"", ",", "\"V\""}]},
    "Ket"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      FractionBox["1", "2"], " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"-", "1"}], ")"}], 
       RowBox[{"1", "/", "6"}]], " ", "g", " ", 
      SubscriptBox["\[Alpha]", 
       RowBox[{"\<\"H\"\>", ",", "\<\"V\"\>"}]]}], "+", 
     RowBox[{
      FractionBox["1", "2"], " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"-", "1"}], ")"}], 
       RowBox[{"2", "/", "3"}]], " ", "g", " ", 
      SubscriptBox["\[Alpha]", 
       RowBox[{"\<\"H\"\>", ",", "\<\"V\"\>"}]]}]}], ")"}]}], "+", 
  RowBox[{
   TemplateBox[{
     RowBox[{"\"V\"", ",", "\"H\"", ",", "\"H\"", ",", "\"V\""}]},
    "Ket"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"-", 
       FractionBox["1", "2"]}], " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"-", "1"}], ")"}], 
       RowBox[{"1", "/", "6"}]], " ", "g", " ", 
      SubscriptBox["\[Alpha]", 
       RowBox[{"\<\"V\"\>", ",", "\<\"H\"\>"}]]}], "+", 
     RowBox[{
      FractionBox["1", "2"], " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"-", "1"}], ")"}], 
       RowBox[{"2", "/", "3"}]], " ", "g", " ", 
      SubscriptBox["\[Alpha]", 
       RowBox[{"\<\"V\"\>", ",", "\<\"H\"\>"}]]}]}], ")"}]}], "+", 
  RowBox[{
   TemplateBox[{
     RowBox[{"\"V\"", ",", "\"H\"", ",", "\"V\"", ",", "\"H\""}]},
    "Ket"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"-", 
       FractionBox["1", "2"]}], " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"-", "1"}], ")"}], 
       RowBox[{"1", "/", "6"}]], " ", "g", " ", 
      SubscriptBox["\[Alpha]", 
       RowBox[{"\<\"V\"\>", ",", "\<\"H\"\>"}]]}], "+", 
     RowBox[{
      FractionBox["1", "2"], " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"-", "1"}], ")"}], 
       RowBox[{"2", "/", "3"}]], " ", "g", " ", 
      SubscriptBox["\[Alpha]", 
       RowBox[{"\<\"V\"\>", ",", "\<\"H\"\>"}]]}]}], ")"}]}], "+", 
  RowBox[{
   TemplateBox[{
     RowBox[{"\"V\"", ",", "\"H\"", ",", "\"H\"", ",", "\"H\""}]},
    "Ket"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      FractionBox["1", "2"], " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"-", "1"}], ")"}], 
       RowBox[{"1", "/", "6"}]], " ", "g", " ", 
      SubscriptBox["\[Alpha]", 
       RowBox[{"\<\"V\"\>", ",", "\<\"H\"\>"}]]}], "+", 
     RowBox[{
      FractionBox["1", "2"], " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"-", "1"}], ")"}], 
       RowBox[{"2", "/", "3"}]], " ", "g", " ", 
      SubscriptBox["\[Alpha]", 
       RowBox[{"\<\"V\"\>", ",", "\<\"H\"\>"}]]}]}], ")"}]}], "+", 
  RowBox[{
   TemplateBox[{
     RowBox[{"\"V\"", ",", "\"H\"", ",", "\"V\"", ",", "\"V\""}]},
    "Ket"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      FractionBox["1", "2"], " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"-", "1"}], ")"}], 
       RowBox[{"1", "/", "6"}]], " ", "g", " ", 
      SubscriptBox["\[Alpha]", 
       RowBox[{"\<\"V\"\>", ",", "\<\"H\"\>"}]]}], "+", 
     RowBox[{
      FractionBox["1", "2"], " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"-", "1"}], ")"}], 
       RowBox[{"2", "/", "3"}]], " ", "g", " ", 
      SubscriptBox["\[Alpha]", 
       RowBox[{"\<\"V\"\>", ",", "\<\"H\"\>"}]]}]}], ")"}]}], "+", 
  RowBox[{
   TemplateBox[{
     RowBox[{"\"V\"", ",", "\"V\"", ",", "\"H\"", ",", "\"V\""}]},
    "Ket"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"-", 
       FractionBox["1", "2"]}], " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"-", "1"}], ")"}], 
       RowBox[{"1", "/", "6"}]], " ", "g", " ", 
      SubscriptBox["\[Alpha]", 
       RowBox[{"\<\"V\"\>", ",", "\<\"V\"\>"}]]}], "+", 
     RowBox[{
      FractionBox["1", "2"], " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"-", "1"}], ")"}], 
       RowBox[{"2", "/", "3"}]], " ", "g", " ", 
      SubscriptBox["\[Alpha]", 
       RowBox[{"\<\"V\"\>", ",", "\<\"V\"\>"}]]}]}], ")"}]}], "+", 
  RowBox[{
   TemplateBox[{
     RowBox[{"\"V\"", ",", "\"V\"", ",", "\"V\"", ",", "\"H\""}]},
    "Ket"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"-", 
       FractionBox["1", "2"]}], " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"-", "1"}], ")"}], 
       RowBox[{"1", "/", "6"}]], " ", "g", " ", 
      SubscriptBox["\[Alpha]", 
       RowBox[{"\<\"V\"\>", ",", "\<\"V\"\>"}]]}], "+", 
     RowBox[{
      FractionBox["1", "2"], " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"-", "1"}], ")"}], 
       RowBox[{"2", "/", "3"}]], " ", "g", " ", 
      SubscriptBox["\[Alpha]", 
       RowBox[{"\<\"V\"\>", ",", "\<\"V\"\>"}]]}]}], ")"}]}], "+", 
  RowBox[{
   TemplateBox[{
     RowBox[{"\"V\"", ",", "\"V\"", ",", "\"H\"", ",", "\"H\""}]},
    "Ket"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      FractionBox["1", "2"], " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"-", "1"}], ")"}], 
       RowBox[{"1", "/", "6"}]], " ", "g", " ", 
      SubscriptBox["\[Alpha]", 
       RowBox[{"\<\"V\"\>", ",", "\<\"V\"\>"}]]}], "+", 
     RowBox[{
      FractionBox["1", "2"], " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"-", "1"}], ")"}], 
       RowBox[{"2", "/", "3"}]], " ", "g", " ", 
      SubscriptBox["\[Alpha]", 
       RowBox[{"\<\"V\"\>", ",", "\<\"V\"\>"}]]}]}], ")"}]}], "+", 
  RowBox[{
   TemplateBox[{
     RowBox[{"\"V\"", ",", "\"V\"", ",", "\"V\"", ",", "\"V\""}]},
    "Ket"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      FractionBox["1", "2"], " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"-", "1"}], ")"}], 
       RowBox[{"1", "/", "6"}]], " ", "g", " ", 
      SubscriptBox["\[Alpha]", 
       RowBox[{"\<\"V\"\>", ",", "\<\"V\"\>"}]]}], "+", 
     RowBox[{
      FractionBox["1", "2"], " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"-", "1"}], ")"}], 
       RowBox[{"2", "/", "3"}]], " ", "g", " ", 
      SubscriptBox["\[Alpha]", 
       RowBox[{"\<\"V\"\>", ",", "\<\"V\"\>"}]]}]}], ")"}]}]}]], "Output",
 CellChangeTimes->{{3.76407958514684*^9, 3.764079636509818*^9}},
 CellLabel->"Out[20]=",ExpressionUUID->"3dbba5bd-417d-490f-85c3-c737ca01158a"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"?", "changeBasis"}]], "Input",
 CellChangeTimes->{{3.7640796522909317`*^9, 3.76407965266407*^9}},
 CellLabel->"In[21]:=",ExpressionUUID->"e1e278a0-67c6-48e1-9a02-0e9527bb6017"],

Cell[BoxData["\<\"changeBasis[\\!\\(\\*FormBox[StyleBox[\\\"expr\\\", Italic, \
Rule[StripOnInput, False]], \
TraditionalForm]\\),\\!\\(\\*FormBox[StyleBox[\\\"frombasis\\\", Italic, \
Rule[StripOnInput, False]], \
TraditionalForm]\\)_String,\\!\\(\\*FormBox[StyleBox[\\\"tobasis\\\", Italic, \
Rule[StripOnInput, False]], \
TraditionalForm]\\)_String,\\!\\(\\*FormBox[StyleBox[\\\"sub\\\", Italic, \
Rule[StripOnInput, False]], TraditionalForm]\\)_:All]: In \
\\!\\(\\*FormBox[StyleBox[\\\"expr\\\", Italic, Rule[StripOnInput, False]], \
TraditionalForm]\\) replace kets from basis \
\\!\\(\\*FormBox[StyleBox[\\\"frombasis\\\", Italic, Rule[StripOnInput, \
False]], TraditionalForm]\\) with their form expressed in basis \
\\!\\(\\*FormBox[StyleBox[\\\"tobasis\\\", Italic, Rule[StripOnInput, \
False]], TraditionalForm]\\). If \\!\\(\\*FormBox[StyleBox[\\\"sub\\\", \
Italic, Rule[StripOnInput, False]], TraditionalForm]\\) is specified, then it \
should be the number of subspace(s) in which the substitution is to be made. \
For instance, \\!\\(\\*FormBox[StyleBox[\\\"sub\\\", Italic, \
Rule[StripOnInput, False]], TraditionalForm]\\)={1,3} means the substitution \
is made only for \\!\\(\\*FormBox[StyleBox[\\\"a1\\\", Italic, \
Rule[StripOnInput, False]], TraditionalForm]\\) and \
\\!\\(\\*FormBox[StyleBox[\\\"a3\\\", Italic, Rule[StripOnInput, False]], \
TraditionalForm]\\) in kets of the form \
\\!\\(\\*FormBox[StyleBox[TemplateBox[List[RowBox[List[\\\"a1\\\", \\\",\\\", \
\\\"a2\\\", \\\",\\\", \\\"a3\\\", \\\",\\\", \\\"etc\\\"]]], \\\"Ket\\\"], \
Italic, Rule[StripOnInput, False]], TraditionalForm]\\).\"\>"], "Print", \
"PrintUsage",
 CellChangeTimes->{3.7640796530489273`*^9},
 CellTags->
  "Info213764086852-9486297",ExpressionUUID->"790d0205-d29a-4c60-8a18-\
f7bb7278a103"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"st2", "=", 
  RowBox[{"Simplify", "[", 
   RowBox[{
    RowBox[{"changeBasis", "[", 
     RowBox[{"st", ",", "\"\<comp\>\"", ",", "\"\<diag\>\"", ",", "1"}], 
     "]"}], "/", 
    RowBox[{"(", 
     RowBox[{
      FractionBox["1", 
       SqrtBox["2"]], 
      RowBox[{"(", 
       RowBox[{
        FractionBox["1", "2"], "+", 
        FractionBox["\[ImaginaryI]", "2"]}], ")"}], " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"-", "1"}], ")"}], 
       RowBox[{"1", "/", "6"}]], " ", "g"}], ")"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.764079645339316*^9, 3.7640796768881826`*^9}, {
  3.764079765810231*^9, 3.764079799254149*^9}},
 CellLabel->"In[28]:=",ExpressionUUID->"a3de2d6a-3450-4e7c-8b61-b6abdce1d3fa"],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[ImaginaryI]", " ", 
   TemplateBox[{
     RowBox[{"\"A\"", ",", "\"H\"", ",", "\"V\"", ",", "\"H\""}]},
    "Ket"], " ", 
   SubscriptBox["\[Alpha]", 
    RowBox[{"\<\"H\"\>", ",", "\<\"H\"\>"}]]}], "+", 
  RowBox[{
   TemplateBox[{
     RowBox[{"\"A\"", ",", "\"H\"", ",", "\"V\"", ",", "\"V\""}]},
    "Ket"], " ", 
   SubscriptBox["\[Alpha]", 
    RowBox[{"\<\"H\"\>", ",", "\<\"H\"\>"}]]}], "+", 
  RowBox[{
   TemplateBox[{
     RowBox[{"\"D\"", ",", "\"H\"", ",", "\"H\"", ",", "\"H\""}]},
    "Ket"], " ", 
   SubscriptBox["\[Alpha]", 
    RowBox[{"\<\"H\"\>", ",", "\<\"H\"\>"}]]}], "+", 
  RowBox[{"\[ImaginaryI]", " ", 
   TemplateBox[{
     RowBox[{"\"D\"", ",", "\"H\"", ",", "\"H\"", ",", "\"V\""}]},
    "Ket"], " ", 
   SubscriptBox["\[Alpha]", 
    RowBox[{"\<\"H\"\>", ",", "\<\"H\"\>"}]]}], "+", 
  RowBox[{"\[ImaginaryI]", " ", 
   TemplateBox[{
     RowBox[{"\"D\"", ",", "\"H\"", ",", "\"V\"", ",", "\"H\""}]},
    "Ket"], " ", 
   SubscriptBox["\[Alpha]", 
    RowBox[{"\<\"H\"\>", ",", "\<\"H\"\>"}]]}], "+", 
  RowBox[{
   TemplateBox[{
     RowBox[{"\"D\"", ",", "\"H\"", ",", "\"V\"", ",", "\"V\""}]},
    "Ket"], " ", 
   SubscriptBox["\[Alpha]", 
    RowBox[{"\<\"H\"\>", ",", "\<\"H\"\>"}]]}], "+", 
  RowBox[{
   TemplateBox[{
     RowBox[{"\"A\"", ",", "\"V\"", ",", "\"H\"", ",", "\"H\""}]},
    "Ket"], " ", 
   SubscriptBox["\[Alpha]", 
    RowBox[{"\<\"H\"\>", ",", "\<\"V\"\>"}]]}], "+", 
  RowBox[{"\[ImaginaryI]", " ", 
   TemplateBox[{
     RowBox[{"\"A\"", ",", "\"V\"", ",", "\"H\"", ",", "\"V\""}]},
    "Ket"], " ", 
   SubscriptBox["\[Alpha]", 
    RowBox[{"\<\"H\"\>", ",", "\<\"V\"\>"}]]}], "+", 
  RowBox[{"\[ImaginaryI]", " ", 
   TemplateBox[{
     RowBox[{"\"A\"", ",", "\"V\"", ",", "\"V\"", ",", "\"H\""}]},
    "Ket"], " ", 
   SubscriptBox["\[Alpha]", 
    RowBox[{"\<\"H\"\>", ",", "\<\"V\"\>"}]]}], "+", 
  RowBox[{
   TemplateBox[{
     RowBox[{"\"A\"", ",", "\"V\"", ",", "\"V\"", ",", "\"V\""}]},
    "Ket"], " ", 
   SubscriptBox["\[Alpha]", 
    RowBox[{"\<\"H\"\>", ",", "\<\"V\"\>"}]]}], "+", 
  RowBox[{
   TemplateBox[{
     RowBox[{"\"D\"", ",", "\"V\"", ",", "\"H\"", ",", "\"H\""}]},
    "Ket"], " ", 
   SubscriptBox["\[Alpha]", 
    RowBox[{"\<\"H\"\>", ",", "\<\"V\"\>"}]]}], "+", 
  RowBox[{"\[ImaginaryI]", " ", 
   TemplateBox[{
     RowBox[{"\"D\"", ",", "\"V\"", ",", "\"H\"", ",", "\"V\""}]},
    "Ket"], " ", 
   SubscriptBox["\[Alpha]", 
    RowBox[{"\<\"H\"\>", ",", "\<\"V\"\>"}]]}], "+", 
  RowBox[{"\[ImaginaryI]", " ", 
   TemplateBox[{
     RowBox[{"\"D\"", ",", "\"V\"", ",", "\"V\"", ",", "\"H\""}]},
    "Ket"], " ", 
   SubscriptBox["\[Alpha]", 
    RowBox[{"\<\"H\"\>", ",", "\<\"V\"\>"}]]}], "+", 
  RowBox[{
   TemplateBox[{
     RowBox[{"\"D\"", ",", "\"V\"", ",", "\"V\"", ",", "\"V\""}]},
    "Ket"], " ", 
   SubscriptBox["\[Alpha]", 
    RowBox[{"\<\"H\"\>", ",", "\<\"V\"\>"}]]}], "+", 
  RowBox[{
   TemplateBox[{
     RowBox[{"\"A\"", ",", "\"H\"", ",", "\"H\"", ",", "\"H\""}]},
    "Ket"], " ", 
   RowBox[{"(", 
    RowBox[{
     SubscriptBox["\[Alpha]", 
      RowBox[{"\<\"H\"\>", ",", "\<\"H\"\>"}]], "-", 
     SubscriptBox["\[Alpha]", 
      RowBox[{"\<\"V\"\>", ",", "\<\"H\"\>"}]]}], ")"}]}], "+", 
  RowBox[{"\[ImaginaryI]", " ", 
   TemplateBox[{
     RowBox[{"\"A\"", ",", "\"H\"", ",", "\"H\"", ",", "\"V\""}]},
    "Ket"], " ", 
   RowBox[{"(", 
    RowBox[{
     SubscriptBox["\[Alpha]", 
      RowBox[{"\<\"H\"\>", ",", "\<\"H\"\>"}]], "-", 
     SubscriptBox["\[Alpha]", 
      RowBox[{"\<\"V\"\>", ",", "\<\"H\"\>"}]]}], ")"}]}], "-", 
  RowBox[{"\[ImaginaryI]", " ", 
   TemplateBox[{
     RowBox[{"\"A\"", ",", "\"H\"", ",", "\"V\"", ",", "\"H\""}]},
    "Ket"], " ", 
   SubscriptBox["\[Alpha]", 
    RowBox[{"\<\"V\"\>", ",", "\<\"H\"\>"}]]}], "-", 
  RowBox[{
   TemplateBox[{
     RowBox[{"\"A\"", ",", "\"H\"", ",", "\"V\"", ",", "\"V\""}]},
    "Ket"], " ", 
   SubscriptBox["\[Alpha]", 
    RowBox[{"\<\"V\"\>", ",", "\<\"H\"\>"}]]}], "+", 
  RowBox[{
   TemplateBox[{
     RowBox[{"\"D\"", ",", "\"H\"", ",", "\"H\"", ",", "\"H\""}]},
    "Ket"], " ", 
   SubscriptBox["\[Alpha]", 
    RowBox[{"\<\"V\"\>", ",", "\<\"H\"\>"}]]}], "+", 
  RowBox[{"\[ImaginaryI]", " ", 
   TemplateBox[{
     RowBox[{"\"D\"", ",", "\"H\"", ",", "\"H\"", ",", "\"V\""}]},
    "Ket"], " ", 
   SubscriptBox["\[Alpha]", 
    RowBox[{"\<\"V\"\>", ",", "\<\"H\"\>"}]]}], "+", 
  RowBox[{"\[ImaginaryI]", " ", 
   TemplateBox[{
     RowBox[{"\"D\"", ",", "\"H\"", ",", "\"V\"", ",", "\"H\""}]},
    "Ket"], " ", 
   SubscriptBox["\[Alpha]", 
    RowBox[{"\<\"V\"\>", ",", "\<\"H\"\>"}]]}], "+", 
  RowBox[{
   TemplateBox[{
     RowBox[{"\"D\"", ",", "\"H\"", ",", "\"V\"", ",", "\"V\""}]},
    "Ket"], " ", 
   SubscriptBox["\[Alpha]", 
    RowBox[{"\<\"V\"\>", ",", "\<\"H\"\>"}]]}], "-", 
  RowBox[{
   TemplateBox[{
     RowBox[{"\"A\"", ",", "\"V\"", ",", "\"H\"", ",", "\"H\""}]},
    "Ket"], " ", 
   SubscriptBox["\[Alpha]", 
    RowBox[{"\<\"V\"\>", ",", "\<\"V\"\>"}]]}], "-", 
  RowBox[{"\[ImaginaryI]", " ", 
   TemplateBox[{
     RowBox[{"\"A\"", ",", "\"V\"", ",", "\"H\"", ",", "\"V\""}]},
    "Ket"], " ", 
   SubscriptBox["\[Alpha]", 
    RowBox[{"\<\"V\"\>", ",", "\<\"V\"\>"}]]}], "-", 
  RowBox[{"\[ImaginaryI]", " ", 
   TemplateBox[{
     RowBox[{"\"A\"", ",", "\"V\"", ",", "\"V\"", ",", "\"H\""}]},
    "Ket"], " ", 
   SubscriptBox["\[Alpha]", 
    RowBox[{"\<\"V\"\>", ",", "\<\"V\"\>"}]]}], "-", 
  RowBox[{
   TemplateBox[{
     RowBox[{"\"A\"", ",", "\"V\"", ",", "\"V\"", ",", "\"V\""}]},
    "Ket"], " ", 
   SubscriptBox["\[Alpha]", 
    RowBox[{"\<\"V\"\>", ",", "\<\"V\"\>"}]]}], "+", 
  RowBox[{
   TemplateBox[{
     RowBox[{"\"D\"", ",", "\"V\"", ",", "\"H\"", ",", "\"H\""}]},
    "Ket"], " ", 
   SubscriptBox["\[Alpha]", 
    RowBox[{"\<\"V\"\>", ",", "\<\"V\"\>"}]]}], "+", 
  RowBox[{"\[ImaginaryI]", " ", 
   TemplateBox[{
     RowBox[{"\"D\"", ",", "\"V\"", ",", "\"H\"", ",", "\"V\""}]},
    "Ket"], " ", 
   SubscriptBox["\[Alpha]", 
    RowBox[{"\<\"V\"\>", ",", "\<\"V\"\>"}]]}], "+", 
  RowBox[{"\[ImaginaryI]", " ", 
   TemplateBox[{
     RowBox[{"\"D\"", ",", "\"V\"", ",", "\"V\"", ",", "\"H\""}]},
    "Ket"], " ", 
   SubscriptBox["\[Alpha]", 
    RowBox[{"\<\"V\"\>", ",", "\<\"V\"\>"}]]}], "+", 
  RowBox[{
   TemplateBox[{
     RowBox[{"\"D\"", ",", "\"V\"", ",", "\"V\"", ",", "\"V\""}]},
    "Ket"], " ", 
   SubscriptBox["\[Alpha]", 
    RowBox[{"\<\"V\"\>", ",", "\<\"V\"\>"}]]}]}]], "Output",
 CellChangeTimes->{{3.764079670436447*^9, 3.764079677557288*^9}, {
  3.764079767083845*^9, 3.764079800138169*^9}},
 CellLabel->"Out[28]=",ExpressionUUID->"2fb07b5d-b6df-4ac7-b9ca-f9ac8a1d3c4b"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Collect", "[", 
  RowBox[{"st2", ",", "_Ket", ",", "Factor"}], "]"}]], "Input",
 CellChangeTimes->{{3.7640797562610197`*^9, 3.7640797603774924`*^9}, {
  3.764079806674508*^9, 3.7640798245434327`*^9}},
 CellLabel->"In[30]:=",ExpressionUUID->"e19a33f5-2815-47e7-8a97-5f9a5585c8b2"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   TemplateBox[{
     RowBox[{"\"A\"", ",", "\"H\"", ",", "\"H\"", ",", "\"H\""}]},
    "Ket"], " ", 
   RowBox[{"(", 
    RowBox[{
     SubscriptBox["\[Alpha]", 
      RowBox[{"\<\"H\"\>", ",", "\<\"H\"\>"}]], "-", 
     SubscriptBox["\[Alpha]", 
      RowBox[{"\<\"V\"\>", ",", "\<\"H\"\>"}]]}], ")"}]}], "+", 
  RowBox[{"\[ImaginaryI]", " ", 
   TemplateBox[{
     RowBox[{"\"A\"", ",", "\"H\"", ",", "\"H\"", ",", "\"V\""}]},
    "Ket"], " ", 
   RowBox[{"(", 
    RowBox[{
     SubscriptBox["\[Alpha]", 
      RowBox[{"\<\"H\"\>", ",", "\<\"H\"\>"}]], "-", 
     SubscriptBox["\[Alpha]", 
      RowBox[{"\<\"V\"\>", ",", "\<\"H\"\>"}]]}], ")"}]}], "+", 
  RowBox[{"\[ImaginaryI]", " ", 
   TemplateBox[{
     RowBox[{"\"A\"", ",", "\"H\"", ",", "\"V\"", ",", "\"H\""}]},
    "Ket"], " ", 
   RowBox[{"(", 
    RowBox[{
     SubscriptBox["\[Alpha]", 
      RowBox[{"\<\"H\"\>", ",", "\<\"H\"\>"}]], "-", 
     SubscriptBox["\[Alpha]", 
      RowBox[{"\<\"V\"\>", ",", "\<\"H\"\>"}]]}], ")"}]}], "+", 
  RowBox[{
   TemplateBox[{
     RowBox[{"\"A\"", ",", "\"H\"", ",", "\"V\"", ",", "\"V\""}]},
    "Ket"], " ", 
   RowBox[{"(", 
    RowBox[{
     SubscriptBox["\[Alpha]", 
      RowBox[{"\<\"H\"\>", ",", "\<\"H\"\>"}]], "-", 
     SubscriptBox["\[Alpha]", 
      RowBox[{"\<\"V\"\>", ",", "\<\"H\"\>"}]]}], ")"}]}], "+", 
  RowBox[{
   TemplateBox[{
     RowBox[{"\"D\"", ",", "\"H\"", ",", "\"H\"", ",", "\"H\""}]},
    "Ket"], " ", 
   RowBox[{"(", 
    RowBox[{
     SubscriptBox["\[Alpha]", 
      RowBox[{"\<\"H\"\>", ",", "\<\"H\"\>"}]], "+", 
     SubscriptBox["\[Alpha]", 
      RowBox[{"\<\"V\"\>", ",", "\<\"H\"\>"}]]}], ")"}]}], "+", 
  RowBox[{"\[ImaginaryI]", " ", 
   TemplateBox[{
     RowBox[{"\"D\"", ",", "\"H\"", ",", "\"H\"", ",", "\"V\""}]},
    "Ket"], " ", 
   RowBox[{"(", 
    RowBox[{
     SubscriptBox["\[Alpha]", 
      RowBox[{"\<\"H\"\>", ",", "\<\"H\"\>"}]], "+", 
     SubscriptBox["\[Alpha]", 
      RowBox[{"\<\"V\"\>", ",", "\<\"H\"\>"}]]}], ")"}]}], "+", 
  RowBox[{"\[ImaginaryI]", " ", 
   TemplateBox[{
     RowBox[{"\"D\"", ",", "\"H\"", ",", "\"V\"", ",", "\"H\""}]},
    "Ket"], " ", 
   RowBox[{"(", 
    RowBox[{
     SubscriptBox["\[Alpha]", 
      RowBox[{"\<\"H\"\>", ",", "\<\"H\"\>"}]], "+", 
     SubscriptBox["\[Alpha]", 
      RowBox[{"\<\"V\"\>", ",", "\<\"H\"\>"}]]}], ")"}]}], "+", 
  RowBox[{
   TemplateBox[{
     RowBox[{"\"D\"", ",", "\"H\"", ",", "\"V\"", ",", "\"V\""}]},
    "Ket"], " ", 
   RowBox[{"(", 
    RowBox[{
     SubscriptBox["\[Alpha]", 
      RowBox[{"\<\"H\"\>", ",", "\<\"H\"\>"}]], "+", 
     SubscriptBox["\[Alpha]", 
      RowBox[{"\<\"V\"\>", ",", "\<\"H\"\>"}]]}], ")"}]}], "+", 
  RowBox[{
   TemplateBox[{
     RowBox[{"\"A\"", ",", "\"V\"", ",", "\"H\"", ",", "\"H\""}]},
    "Ket"], " ", 
   RowBox[{"(", 
    RowBox[{
     SubscriptBox["\[Alpha]", 
      RowBox[{"\<\"H\"\>", ",", "\<\"V\"\>"}]], "-", 
     SubscriptBox["\[Alpha]", 
      RowBox[{"\<\"V\"\>", ",", "\<\"V\"\>"}]]}], ")"}]}], "+", 
  RowBox[{"\[ImaginaryI]", " ", 
   TemplateBox[{
     RowBox[{"\"A\"", ",", "\"V\"", ",", "\"H\"", ",", "\"V\""}]},
    "Ket"], " ", 
   RowBox[{"(", 
    RowBox[{
     SubscriptBox["\[Alpha]", 
      RowBox[{"\<\"H\"\>", ",", "\<\"V\"\>"}]], "-", 
     SubscriptBox["\[Alpha]", 
      RowBox[{"\<\"V\"\>", ",", "\<\"V\"\>"}]]}], ")"}]}], "+", 
  RowBox[{"\[ImaginaryI]", " ", 
   TemplateBox[{
     RowBox[{"\"A\"", ",", "\"V\"", ",", "\"V\"", ",", "\"H\""}]},
    "Ket"], " ", 
   RowBox[{"(", 
    RowBox[{
     SubscriptBox["\[Alpha]", 
      RowBox[{"\<\"H\"\>", ",", "\<\"V\"\>"}]], "-", 
     SubscriptBox["\[Alpha]", 
      RowBox[{"\<\"V\"\>", ",", "\<\"V\"\>"}]]}], ")"}]}], "+", 
  RowBox[{
   TemplateBox[{
     RowBox[{"\"A\"", ",", "\"V\"", ",", "\"V\"", ",", "\"V\""}]},
    "Ket"], " ", 
   RowBox[{"(", 
    RowBox[{
     SubscriptBox["\[Alpha]", 
      RowBox[{"\<\"H\"\>", ",", "\<\"V\"\>"}]], "-", 
     SubscriptBox["\[Alpha]", 
      RowBox[{"\<\"V\"\>", ",", "\<\"V\"\>"}]]}], ")"}]}], "+", 
  RowBox[{
   TemplateBox[{
     RowBox[{"\"D\"", ",", "\"V\"", ",", "\"H\"", ",", "\"H\""}]},
    "Ket"], " ", 
   RowBox[{"(", 
    RowBox[{
     SubscriptBox["\[Alpha]", 
      RowBox[{"\<\"H\"\>", ",", "\<\"V\"\>"}]], "+", 
     SubscriptBox["\[Alpha]", 
      RowBox[{"\<\"V\"\>", ",", "\<\"V\"\>"}]]}], ")"}]}], "+", 
  RowBox[{"\[ImaginaryI]", " ", 
   TemplateBox[{
     RowBox[{"\"D\"", ",", "\"V\"", ",", "\"H\"", ",", "\"V\""}]},
    "Ket"], " ", 
   RowBox[{"(", 
    RowBox[{
     SubscriptBox["\[Alpha]", 
      RowBox[{"\<\"H\"\>", ",", "\<\"V\"\>"}]], "+", 
     SubscriptBox["\[Alpha]", 
      RowBox[{"\<\"V\"\>", ",", "\<\"V\"\>"}]]}], ")"}]}], "+", 
  RowBox[{"\[ImaginaryI]", " ", 
   TemplateBox[{
     RowBox[{"\"D\"", ",", "\"V\"", ",", "\"V\"", ",", "\"H\""}]},
    "Ket"], " ", 
   RowBox[{"(", 
    RowBox[{
     SubscriptBox["\[Alpha]", 
      RowBox[{"\<\"H\"\>", ",", "\<\"V\"\>"}]], "+", 
     SubscriptBox["\[Alpha]", 
      RowBox[{"\<\"V\"\>", ",", "\<\"V\"\>"}]]}], ")"}]}], "+", 
  RowBox[{
   TemplateBox[{
     RowBox[{"\"D\"", ",", "\"V\"", ",", "\"V\"", ",", "\"V\""}]},
    "Ket"], " ", 
   RowBox[{"(", 
    RowBox[{
     SubscriptBox["\[Alpha]", 
      RowBox[{"\<\"H\"\>", ",", "\<\"V\"\>"}]], "+", 
     SubscriptBox["\[Alpha]", 
      RowBox[{"\<\"V\"\>", ",", "\<\"V\"\>"}]]}], ")"}]}]}]], "Output",
 CellChangeTimes->{{3.764079813184372*^9, 3.764079824932828*^9}},
 CellLabel->"Out[30]=",ExpressionUUID->"09ef4a90-8dcf-4a4e-989c-9e163e26cfc1"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"replaceKet", "[", 
  RowBox[{
   RowBox[{"Simplify", "[", 
    RowBox[{"changeBasis", "[", 
     RowBox[{"st", ",", "\"\<comp\>\"", ",", "\"\<diag\>\"", ",", "1"}], 
     "]"}], "]"}], ",", 
   RowBox[{"Ket", "[", "\"\<A\>\"", "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.764079645339316*^9, 
  3.764079717295719*^9}},ExpressionUUID->"1aa93be0-c598-41f4-b3a9-\
bda58d7b1069"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"?", "replaceKet"}]], "Input",
 CellChangeTimes->{{3.7640797099633737`*^9, 3.764079710232701*^9}},
 CellLabel->"In[24]:=",ExpressionUUID->"e48f649c-f6e6-41be-9f9f-f9e3e38bba6a"],

Cell[BoxData["\<\"replaceKet[\\!\\(\\*FormBox[StyleBox[\\\"expr\\\", Italic, \
Rule[StripOnInput, False]], TraditionalForm]\\)_,\\!\\(\\*FormBox[StyleBox[\\\
\"patt\\\", Italic, Rule[StripOnInput, False]], \
TraditionalForm]\\)_,\\!\\(\\*FormBox[StyleBox[\\\"sub\\\", Italic, \
Rule[StripOnInput, False]], TraditionalForm]\\)_]: In a linear combination \
\\!\\(\\*FormBox[StyleBox[\\\"expr\\\", Italic, Rule[StripOnInput, False]], \
TraditionalForm]\\) of Kets of the form \
\\!\\(\\*FormBox[StyleBox[TemplateBox[List[RowBox[List[\\\"a1\\\", \\\",\\\", \
\\\"a2\\\", \\\",\\\", \\\"a3\\\", \\\",\\\", \\\"etc\\\"]]], \\\"Ket\\\"], \
Italic, Rule[StripOnInput, False]], TraditionalForm]\\) replaces expressions \
\\!\\(\\*FormBox[StyleBox[TemplateBox[List[\\\"ai\\\"], \\\"Ket\\\"], Italic, \
Rule[StripOnInput, False]], TraditionalForm]\\) according to pattern \
\\!\\(\\*FormBox[StyleBox[\\\"patt\\\", Italic, Rule[StripOnInput, False]], \
TraditionalForm]\\). The third, optional, argument specifies in which \
subsystem the replacement should be performed. For instance, \
replaceKet[\\!\\(\\*FormBox[StyleBox[TemplateBox[List[RowBox[List[\\\"1\\\", \
\\\",\\\", \\\"b\\\"]]], \\\"Ket\\\"], Italic, Rule[StripOnInput, False]], \
TraditionalForm]\\)+2.3 \
\\!\\(\\*FormBox[StyleBox[TemplateBox[List[RowBox[List[\\\"0\\\", \\\",\\\", \
\\\"2\\\", \\\",\\\", \\\"8\\\"]]], \\\"Ket\\\"], Italic, Rule[StripOnInput, \
False]], TraditionalForm]\\)+\\!\\(\\*FormBox[StyleBox[TemplateBox[List[\\\"b\
\\\"], \\\"Ket\\\"], Italic, Rule[StripOnInput, False]], \
TraditionalForm]\\),{\\!\\(\\*FormBox[StyleBox[TemplateBox[List[\\\"b\\\"], \
\\\"Ket\\\"], Italic, Rule[StripOnInput, False]], TraditionalForm]\\)->\\!\\(\
\\*FormBox[StyleBox[TemplateBox[List[RowBox[List[\\\"-\\\", \\\"5\\\"]]], \
\\\"Ket\\\"], Italic, Rule[StripOnInput, False]], \
TraditionalForm]\\),\\!\\(\\*FormBox[StyleBox[TemplateBox[List[\\\"8\\\"], \\\
\"Ket\\\"], Italic, Rule[StripOnInput, False]], \
TraditionalForm]\\)->\\!\\(\\*FormBox[StyleBox[TemplateBox[List[\\\"c\\\"], \
\\\"Ket\\\"], Italic, Rule[StripOnInput, False]], TraditionalForm]\\)},{1,3}] \
returns \\!\\(\\*FormBox[StyleBox[TemplateBox[List[RowBox[List[\\\"-\\\", \
\\\"5\\\"]]], \\\"Ket\\\"], Italic, Rule[StripOnInput, False]], \
TraditionalForm]\\)+\\!\\(\\*FormBox[StyleBox[TemplateBox[List[RowBox[List[\\\
\"1\\\", \\\",\\\", \\\"b\\\"]]], \\\"Ket\\\"], Italic, Rule[StripOnInput, \
False]], TraditionalForm]\\)+2.3 \
\\!\\(\\*FormBox[StyleBox[TemplateBox[List[RowBox[List[\\\"0\\\", \\\",\\\", \
\\\"2\\\", \\\",\\\", \\\"c\\\"]]], \\\"Ket\\\"], Italic, Rule[StripOnInput, \
False]], TraditionalForm]\\), since substitution is not done in the second \
subsystem. In \\!\\(\\*FormBox[StyleBox[\\\"patt\\\", Italic, \
Rule[StripOnInput, False]], TraditionalForm]\\) only unipartite replacement \
rules are allowed. If there is only one subsystem one wants to perform \
substitution in, one can omit braces and as \\!\\(\\*FormBox[StyleBox[\\\"sub\
\\\", Italic, Rule[StripOnInput, False]], TraditionalForm]\\) specify just \
the integral index. If the third argument is omitted, the substitutions are \
done in all subsystems.\"\>"], "Print", "PrintUsage",
 CellChangeTimes->{3.7640797105541096`*^9},
 CellTags->
  "Info243764086910-9486297",ExpressionUUID->"57457656-a1b5-4799-b4e1-\
2327dd6d8dc4"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"onBases", "[", "\"\<comp\>\"", "]"}]], "Input",
 CellChangeTimes->{{3.7640796197758107`*^9, 3.7640796237480464`*^9}},
 CellLabel->"In[18]:=",ExpressionUUID->"23cdec9a-5aa5-41c9-9b50-3695821dcd90"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   TemplateBox[{"\"H\""},
    "Ket"], ",", 
   TemplateBox[{"\"V\""},
    "Ket"]}], "}"}]], "Input",
 CellChangeTimes->{3.764079626552952*^9},
 CellLabel->"In[19]:=",ExpressionUUID->"03d7ddb2-0f4b-4e7f-97af-5e2d9b212d39"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   TemplateBox[{"\"H\""},
    "Ket"], ",", 
   TemplateBox[{"\"V\""},
    "Ket"]}], "}"}]], "Output",
 CellChangeTimes->{3.7640796266422358`*^9},
 CellLabel->"Out[19]=",ExpressionUUID->"ec0dd45d-b35d-4b83-8527-1729844495dc"]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1440., 837.75},
WindowMargins->{{-6, Automatic}, {Automatic, -6}},
CellContext->Notebook,
FrontEndVersion->"13.0 for Microsoft Windows (64-bit) (February 4, 2022)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"0f6a4b2c-6479-4906-9640-d3c4afc18320"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{
 "Info183759041935-1734034"->{
  Cell[188064, 4475, 3337, 48, 142, "Print",ExpressionUUID->"f1982d7e-6c52-472f-86b8-c37b56826b46",
   CellTags->"Info183759041935-1734034"]},
 "Info213764086852-9486297"->{
  Cell[664247, 18370, 1798, 29, 72, "Print",ExpressionUUID->"790d0205-d29a-4c60-8a18-f7bb7278a103",
   CellTags->"Info213764086852-9486297"]},
 "Info233760254771-4835498"->{
  Cell[367437, 9769, 4311, 62, 284, "Print",ExpressionUUID->"961ee33e-fcc2-427e-b1b2-b53c27344f63",
   CellTags->"Info233760254771-4835498"]},
 "Info243764086910-9486297"->{
  Cell[680056, 18816, 3339, 48, 128, "Print",ExpressionUUID->"57457656-a1b5-4799-b4e1-2327dd6d8dc4",
   CellTags->"Info243764086910-9486297"]},
 "Info323760254773-4835498"->{
  Cell[396227, 10655, 4313, 62, 284, "Print",ExpressionUUID->"7d7400da-dbe4-465c-8922-a95ca0d7e686",
   CellTags->"Info323760254773-4835498"],
  Cell[400543, 10719, 1798, 29, 121, "Print",ExpressionUUID->"dc5e0d82-1de6-4ff5-852c-380a962f3289",
   CellTags->"Info323760254773-4835498"]},
 "Info383759047348-6451956"->{
  Cell[243979, 6225, 1258, 19, 161, "Print",ExpressionUUID->"48a4e35b-06d9-415f-9e65-aa5f184161b2",
   CellTags->"Info383759047348-6451956"]},
 "Info393759047358-6451956"->{
  Cell[245480, 6254, 614, 10, 115, "Print",ExpressionUUID->"f5c11f5b-d8f2-4bad-bfc2-b1412e5f770a",
   CellTags->"Info393759047358-6451956"]},
 "Info713759048312-6451956"->{
  Cell[312860, 8332, 2558, 38, 184, "Print",ExpressionUUID->"30090bf1-f4f6-479a-bebd-758b18d2c4d9",
   CellTags->"Info713759048312-6451956"]},
 "Info823759048517-6451956"->{
  Cell[329057, 8721, 857, 14, 69, "Print",ExpressionUUID->"8fec7a12-6c58-4480-8207-8b32611b37df",
   CellTags->"Info823759048517-6451956"]}
 }
*)
(*CellTagsIndex
CellTagsIndex->{
 {"Info183759041935-1734034", 684606, 18908},
 {"Info213764086852-9486297", 684780, 18911},
 {"Info233760254771-4835498", 684954, 18914},
 {"Info243764086910-9486297", 685128, 18917},
 {"Info323760254773-4835498", 685303, 18920},
 {"Info383759047348-6451956", 685621, 18925},
 {"Info393759047358-6451956", 685795, 18928},
 {"Info713759048312-6451956", 685968, 18931},
 {"Info823759048517-6451956", 686142, 18934}
 }
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 153, 3, 64, "Subchapter",ExpressionUUID->"d0b53b6d-e066-4f42-bbe1-4d391f7a3fdf"],
Cell[CellGroupData[{
Cell[758, 29, 468, 7, 32, "Item",ExpressionUUID->"5bf424fb-f891-4ecf-95af-a1f9629d90cb"],
Cell[1229, 38, 598, 11, 26, "Subitem",ExpressionUUID->"8b7a10d6-e6f8-4c00-886a-817583a51d41"]
}, Open  ]],
Cell[1842, 52, 552, 10, 32, "Item",ExpressionUUID->"db9ce90a-bae4-4aea-aa58-ea924a9fe347"],
Cell[2397, 64, 633, 13, 32, "Item",ExpressionUUID->"f71d7921-5705-464f-8dd0-0c4da978b8b4"],
Cell[3033, 79, 593, 12, 32, "Item",ExpressionUUID->"42edc771-4486-4337-9287-3fe1bee3905e"],
Cell[3629, 93, 616, 12, 32, "Item",ExpressionUUID->"75d99aa9-f193-445a-b6b7-3fa7b286d13b"]
}, Open  ]],
Cell[CellGroupData[{
Cell[4282, 110, 168, 3, 64, "Subchapter",ExpressionUUID->"20f5accb-a5d8-42c6-b5b7-9417c1069edb"],
Cell[4453, 115, 422, 8, 32, "Item",ExpressionUUID->"a1023c4a-d282-44c7-b0ba-60986afa70bb"],
Cell[4878, 125, 410, 6, 32, "Item",ExpressionUUID->"9a2ddb8b-63e3-4656-8618-9111d70bbfca"],
Cell[5291, 133, 876, 14, 32, "Item",ExpressionUUID->"295c667d-9c5e-4364-986c-ca57de506a55"],
Cell[6170, 149, 891, 14, 32, "Item",ExpressionUUID->"aa1e027c-ab49-42a0-9e10-80d3462f2ac3"]
}, Open  ]],
Cell[CellGroupData[{
Cell[7098, 168, 165, 3, 64, "Subchapter",ExpressionUUID->"258f1250-0869-4f11-a085-c9facd6e309b"],
Cell[CellGroupData[{
Cell[7288, 175, 572, 10, 32, "Item",ExpressionUUID->"3ef78e35-6197-4f4f-80c6-c4d89df9f16d"],
Cell[CellGroupData[{
Cell[7885, 189, 651, 11, 26, "Subitem",ExpressionUUID->"26327439-eece-41c9-a8a3-843522db1cc2"],
Cell[8539, 202, 710, 12, 25, "Subsubitem",ExpressionUUID->"7ebe1380-5338-4447-8284-9b92675c7161"]
}, Open  ]],
Cell[9264, 217, 1027, 16, 26, "Subitem",ExpressionUUID->"03400859-2228-4b43-9ad8-1015276ebe00"]
}, Open  ]],
Cell[10306, 236, 540, 10, 32, "Item",ExpressionUUID->"80d9da1e-ec57-4b83-ae75-5d42ea6f8f47"],
Cell[CellGroupData[{
Cell[10871, 250, 868, 14, 74, "Item",ExpressionUUID->"2c8df846-e6b3-43b4-a9a1-ec8c93bd553f"],
Cell[11742, 266, 464, 8, 26, "Subitem",ExpressionUUID->"eadedbba-51f0-4009-aa68-4bd0f185b8c7"]
}, Open  ]],
Cell[CellGroupData[{
Cell[12243, 279, 614, 11, 53, "Item",ExpressionUUID->"ca331ff7-791f-4bb3-b699-e7b66e5fa192"],
Cell[12860, 292, 541, 10, 26, "Subitem",ExpressionUUID->"1d319b96-f891-41a2-9e59-fb8af3674ad5"]
}, Open  ]],
Cell[CellGroupData[{
Cell[13438, 307, 707, 12, 53, "Item",ExpressionUUID->"1361492b-a17c-4a04-ae31-a84ca85f8891"],
Cell[14148, 321, 366, 7, 26, "Subitem",ExpressionUUID->"a72493ce-9d04-4761-8651-5c744803d751"]
}, Open  ]],
Cell[14529, 331, 539, 10, 32, "Item",ExpressionUUID->"c30e5728-6a95-4645-a593-c3d9dd7923bc"],
Cell[15071, 343, 389, 6, 32, "Item",ExpressionUUID->"38927028-0e15-43f5-9fdf-53fa75604d7b"],
Cell[15463, 351, 1473, 22, 74, "Item",ExpressionUUID->"135348d4-576c-4f89-bb30-9fc28cf0c2cd"],
Cell[16939, 375, 583, 10, 32, "Item",ExpressionUUID->"8b316a05-0699-4302-86ab-74eb8c7b1fb7"],
Cell[17525, 387, 576, 10, 32, "Item",ExpressionUUID->"f0392353-8157-4a41-9983-345afef6a076"]
}, Closed]],
Cell[CellGroupData[{
Cell[18138, 402, 204, 4, 48, "Subchapter",ExpressionUUID->"522ef950-0f50-43c3-b263-493f79d011b6"],
Cell[CellGroupData[{
Cell[18367, 410, 509, 12, 64, "Input",ExpressionUUID->"0c3af534-d349-4b3b-b761-641003dff16a",
 InitializationCell->True],
Cell[18879, 424, 18019, 249, 32, "Output",ExpressionUUID->"0a1fea43-ae83-4e70-8d26-88b25f6ada1b"]
}, Open  ]],
Cell[36913, 676, 442, 8, 44, "Input",ExpressionUUID->"d1222107-3209-416b-889b-c796e65aeb64",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[37380, 688, 1093, 18, 44, "Input",ExpressionUUID->"f61ec165-efff-45dd-abac-2cbf5664dab2",
 InitializationCell->True],
Cell[38476, 708, 2490, 36, 58, "Print",ExpressionUUID->"4ceb7c3f-7ad2-499b-b05f-29895a851c0c"]
}, Open  ]],
Cell[CellGroupData[{
Cell[41003, 749, 273, 5, 44, "Input",ExpressionUUID->"67ff6624-183f-4f80-9667-57011f4d5af0",
 InitializationCell->True],
Cell[41279, 756, 20066, 475, 202, "Output",ExpressionUUID->"03980fbf-e48b-40a5-9059-8dee0ac79a22"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[61394, 1237, 203, 4, 64, "Subchapter",ExpressionUUID->"97dcbe59-9af0-405a-b764-d960d343cd86"],
Cell[CellGroupData[{
Cell[61622, 1245, 4718, 118, 345, "Input",ExpressionUUID->"740e1e74-44bf-4ee9-9442-345eec41e2c3",
 InitializationCell->True],
Cell[66343, 1365, 2370, 34, 58, "Print",ExpressionUUID->"8d5d9e06-1432-4c57-9202-95f277c834c2"]
}, Open  ]],
Cell[CellGroupData[{
Cell[68750, 1404, 1213, 36, 53, "Input",ExpressionUUID->"1aad7da6-d5dc-484a-92e0-45f23f79e76f"],
Cell[69966, 1442, 9600, 207, 65, "Output",ExpressionUUID->"0bf4224d-2874-491e-8183-e41d7ef41ae2"],
Cell[79569, 1651, 721, 21, 60, "Output",ExpressionUUID->"849814cf-280e-4057-95a2-d8d34de20ac4"]
}, Open  ]],
Cell[CellGroupData[{
Cell[80327, 1677, 199, 3, 28, "Input",ExpressionUUID->"a55fb1b7-d949-4d51-a43e-0e9560d1c0b8"],
Cell[80529, 1682, 25674, 550, 143, "Output",ExpressionUUID->"b0072373-45b5-4a16-88ea-0338095e0f5f"]
}, Open  ]],
Cell[CellGroupData[{
Cell[106240, 2237, 367, 9, 28, "Input",ExpressionUUID->"2ac60cb2-f977-4f06-bed1-57f6373b15cb"],
Cell[106610, 2248, 498, 17, 37, "Output",ExpressionUUID->"ed948eea-09eb-4367-9ab2-2c2ae8dd4827"]
}, Open  ]],
Cell[CellGroupData[{
Cell[107145, 2270, 636, 18, 28, "Input",ExpressionUUID->"c3cebedd-91bf-4b9d-ba93-af850b35bda1"],
Cell[107784, 2290, 733, 26, 37, "Output",ExpressionUUID->"af707b08-a06e-4366-8a75-fa5c5449e193"]
}, Open  ]],
Cell[CellGroupData[{
Cell[108554, 2321, 671, 18, 28, "Input",ExpressionUUID->"60206da7-c882-41ac-a9c8-3144774e612f"],
Cell[109228, 2341, 1231, 42, 37, "Output",ExpressionUUID->"3ccfcb73-ed7a-4583-8d78-b2964514c42f"]
}, Open  ]],
Cell[CellGroupData[{
Cell[110496, 2388, 386, 9, 28, "Input",ExpressionUUID->"ebd11e3e-8f1a-4d40-9156-3fc29d313f66"],
Cell[110885, 2399, 774, 27, 37, "Output",ExpressionUUID->"72d2f727-0db1-4dae-b0fd-59c11bf601bd"]
}, Open  ]],
Cell[CellGroupData[{
Cell[111696, 2431, 743, 14, 28, "Input",ExpressionUUID->"5dd00cb0-afd0-4974-a6bb-7daff12536f1"],
Cell[112442, 2447, 918, 19, 37, "Output",ExpressionUUID->"aaf4c34f-8aa0-46b5-b6d8-1bda020bce51"]
}, Open  ]],
Cell[CellGroupData[{
Cell[113397, 2471, 622, 14, 28, "Input",ExpressionUUID->"dd8aac6f-1ab4-491f-8100-0d2eece12a6b"],
Cell[114022, 2487, 823, 18, 37, "Output",ExpressionUUID->"336cfde8-673c-4b39-83fb-0975895f1e7b"]
}, Open  ]],
Cell[CellGroupData[{
Cell[114882, 2510, 218, 3, 28, "Input",ExpressionUUID->"49b48c0c-8138-418d-89e8-e30de87060e9"],
Cell[115103, 2515, 1409, 38, 37, "Output",ExpressionUUID->"7c4466c8-cbe3-4096-8838-1a3a7dfe5923"]
}, Open  ]],
Cell[CellGroupData[{
Cell[116549, 2558, 468, 8, 28, "Input",ExpressionUUID->"2b0d2cc7-ec06-4d2d-908e-6d89af35d2ba"],
Cell[117020, 2568, 353, 6, 37, "Output",ExpressionUUID->"a6cc7b5e-4f30-4a3d-8dad-61d136a80a21"]
}, Open  ]],
Cell[CellGroupData[{
Cell[117410, 2579, 365, 8, 28, "Input",ExpressionUUID->"57e3123a-4217-4ab8-a53f-07061b409115"],
Cell[117778, 2589, 251, 5, 32, "Output",ExpressionUUID->"ea85a96b-b364-482b-a7e0-3cccb141f226"]
}, Open  ]],
Cell[CellGroupData[{
Cell[118066, 2599, 978, 17, 28, "Input",ExpressionUUID->"be41ef45-1113-41ad-84e0-ef67dbc59c8c"],
Cell[119047, 2618, 1467, 40, 37, "Output",ExpressionUUID->"4c233e15-7dea-4b54-9ef8-bace2ef6cf4c"]
}, Open  ]],
Cell[CellGroupData[{
Cell[120551, 2663, 937, 32, 33, "Input",ExpressionUUID->"40ddf86b-1f91-4e53-9b5f-c857a5c46046"],
Cell[121491, 2697, 443, 12, 37, "Output",ExpressionUUID->"6ae42f8d-d608-44aa-812c-8352f4e939c7"]
}, Open  ]],
Cell[CellGroupData[{
Cell[121971, 2714, 583, 15, 28, "Input",ExpressionUUID->"46a11ce5-8184-461d-b515-65455f8918b5"],
Cell[122557, 2731, 1017, 39, 37, "Output",ExpressionUUID->"d7a4351d-3d1e-4bd3-aa47-8619dec98532"]
}, Open  ]],
Cell[CellGroupData[{
Cell[123611, 2775, 1117, 40, 33, "Input",ExpressionUUID->"5181bab5-0050-48d3-925b-1ee464edb121"],
Cell[124731, 2817, 611, 20, 37, "Output",ExpressionUUID->"d9de62d3-df9e-40ef-90c0-139b49cf32ee"]
}, Open  ]],
Cell[CellGroupData[{
Cell[125379, 2842, 1043, 19, 28, "Input",ExpressionUUID->"0d97859f-eee6-4626-8fd1-d414d1402a4e"],
Cell[126425, 2863, 589, 12, 23, "Message",ExpressionUUID->"ca4f0485-477f-4c93-9302-8b58032d3b08"]
}, Open  ]],
Cell[CellGroupData[{
Cell[127051, 2880, 802, 12, 28, "Input",ExpressionUUID->"43074308-4085-4833-9161-d5423dcc1e09"],
Cell[127856, 2894, 1036, 32, 37, "Output",ExpressionUUID->"af47dd7a-5357-4708-a8ee-9979314cd5d4"]
}, Open  ]],
Cell[CellGroupData[{
Cell[128929, 2931, 356, 8, 28, "Input",ExpressionUUID->"62aed573-7381-4d07-9c38-97d3f33b6c91"],
Cell[129288, 2941, 566, 15, 32, "Output",ExpressionUUID->"4500d38c-42b8-4830-938b-dc4ca6ad1b2b"]
}, Open  ]],
Cell[CellGroupData[{
Cell[129891, 2961, 1391, 26, 28, "Input",ExpressionUUID->"47a89d92-c240-4fca-b20e-dcb92bd45f6a"],
Cell[131285, 2989, 1087, 40, 37, "Output",ExpressionUUID->"62edda65-ae97-46c1-a885-c716f0c7f0eb"]
}, Open  ]],
Cell[CellGroupData[{
Cell[132409, 3034, 1014, 39, 33, "Input",ExpressionUUID->"3ba51152-6fbb-46fc-83ea-6d9c10b2b2a0"],
Cell[133426, 3075, 1017, 39, 37, "Output",ExpressionUUID->"6f4fa58b-5117-4754-8c61-c2eac18fe62c"]
}, Open  ]],
Cell[CellGroupData[{
Cell[134480, 3119, 453, 11, 28, "Input",ExpressionUUID->"8ff5dbe2-03c5-499b-a75c-72bd59b22164"],
Cell[134936, 3132, 330, 7, 32, "Output",ExpressionUUID->"7728741d-5370-4cd3-8a69-49699d084233"]
}, Open  ]],
Cell[CellGroupData[{
Cell[135303, 3144, 291, 6, 28, "Input",ExpressionUUID->"75b2a879-b196-402c-8b2a-d9dda77c65ae"],
Cell[135597, 3152, 173, 3, 32, "Output",ExpressionUUID->"1d5db951-42f0-41c8-8e11-811ef5039b25"]
}, Open  ]],
Cell[CellGroupData[{
Cell[135807, 3160, 396, 8, 28, "Input",ExpressionUUID->"160e1e90-de66-4033-8611-1243f2b088d9"],
Cell[136206, 3170, 555, 17, 37, "Output",ExpressionUUID->"a4d37279-6d7a-40a3-b804-87e07c568311"]
}, Open  ]],
Cell[CellGroupData[{
Cell[136798, 3192, 640, 17, 28, "Input",ExpressionUUID->"41bb3c6d-da70-4faf-8c0c-181194d6a567"],
Cell[137441, 3211, 771, 29, 37, "Output",ExpressionUUID->"39ec0bad-cb12-441d-a218-654469d0c279"]
}, Open  ]],
Cell[CellGroupData[{
Cell[138249, 3245, 278, 5, 28, "Input",ExpressionUUID->"1e10e4f0-73b4-42cf-bbc4-e53e2df55e60"],
Cell[138530, 3252, 735, 24, 37, "Output",ExpressionUUID->"a76fc3d0-04a9-471c-a73d-f5b4e0297dd4"]
}, Open  ]],
Cell[CellGroupData[{
Cell[139302, 3281, 246, 4, 28, "Input",ExpressionUUID->"3317e9c6-4887-459a-8cc3-81b89abb2c2b"],
Cell[139551, 3287, 401, 12, 37, "Output",ExpressionUUID->"2407746e-9620-41fb-9db7-7d121f655d5e"]
}, Open  ]],
Cell[CellGroupData[{
Cell[139989, 3304, 599, 15, 28, "Input",ExpressionUUID->"f18b38fd-c235-4743-9690-fd1af22fe92f"],
Cell[140591, 3321, 358, 11, 37, "Output",ExpressionUUID->"4a445c1f-4aeb-4192-84e0-6e8cf23726cc"]
}, Open  ]],
Cell[CellGroupData[{
Cell[140986, 3337, 204, 3, 28, "Input",ExpressionUUID->"f2f463f0-66f2-4183-9cda-9cf5d42e960d"],
Cell[141193, 3342, 248, 3, 32, "Output",ExpressionUUID->"0bc9b584-96ec-45f5-a85b-178c1dcc461a"]
}, Open  ]],
Cell[CellGroupData[{
Cell[141478, 3350, 196, 3, 28, "Input",ExpressionUUID->"2a0ab946-698e-4698-b93b-85344b3c8d76"],
Cell[141677, 3355, 173, 2, 32, "Output",ExpressionUUID->"a6926065-a75c-4fce-8f8a-5455a52125e3"],
Cell[141853, 3359, 458, 12, 37, "Output",ExpressionUUID->"e069aee4-3543-460b-b234-422ec16df820"]
}, Open  ]],
Cell[CellGroupData[{
Cell[142348, 3376, 803, 21, 28, "Input",ExpressionUUID->"25f0ae73-ca45-4d54-9211-ec021aed1dad"],
Cell[143154, 3399, 864, 23, 37, "Output",ExpressionUUID->"7e5645c5-2e6a-4c91-b1fa-32915ac2bda4"]
}, Open  ]],
Cell[CellGroupData[{
Cell[144055, 3427, 865, 22, 28, "Input",ExpressionUUID->"7493466b-5115-4f8a-8adb-87a401aeaf28"],
Cell[144923, 3451, 531, 18, 37, "Output",ExpressionUUID->"32bffc2e-80a8-435e-af3c-235758006196"]
}, Open  ]],
Cell[CellGroupData[{
Cell[145491, 3474, 202, 3, 28, "Input",ExpressionUUID->"76c63be2-d523-474d-8baf-2b9b53726114"],
Cell[145696, 3479, 34131, 704, 189, "Output",ExpressionUUID->"80477fb9-32fc-4297-9f04-f657e5384850"]
}, Open  ]],
Cell[CellGroupData[{
Cell[179864, 4188, 462, 10, 28, "Input",ExpressionUUID->"09a9261e-834e-4c0a-a092-c5d38c5c3c54"],
Cell[180329, 4200, 864, 29, 48, "Output",ExpressionUUID->"573679eb-4b8a-4d61-a9f6-4bf2d8506cf9"]
}, Open  ]],
Cell[CellGroupData[{
Cell[181230, 4234, 532, 12, 28, "Input",ExpressionUUID->"05712651-4094-4d2d-9100-06c532f91aeb"],
Cell[181765, 4248, 716, 27, 48, "Output",ExpressionUUID->"297a0e76-3af3-47b7-9189-abeb9a00a13b"]
}, Open  ]],
Cell[CellGroupData[{
Cell[182518, 4280, 922, 31, 46, "Input",ExpressionUUID->"54346fae-ebf3-4043-96af-63d5a925dcca"],
Cell[183443, 4313, 260, 7, 36, "Output",ExpressionUUID->"a29c3a62-b7c8-44ac-9ed0-aa0e04356f6f"]
}, Open  ]],
Cell[CellGroupData[{
Cell[183740, 4325, 746, 19, 28, "Input",ExpressionUUID->"3e3175fe-10b0-44e2-b61e-162f318c8dd2"],
Cell[184489, 4346, 1689, 64, 48, "Output",ExpressionUUID->"0a5bedce-5554-4151-b8eb-25df62350b1f"]
}, Open  ]],
Cell[CellGroupData[{
Cell[186215, 4415, 458, 11, 28, "Input",ExpressionUUID->"5c24f63e-65fd-4575-af98-f30ed6ea2779"],
Cell[186676, 4428, 341, 10, 36, "Output",ExpressionUUID->"93642daa-ed99-49d1-a530-98a37ecc40f0"]
}, Open  ]],
Cell[CellGroupData[{
Cell[187054, 4443, 425, 10, 28, "Input",ExpressionUUID->"8a4f14a5-6c50-4ba4-b0c9-67086029919d"],
Cell[187482, 4455, 344, 10, 36, "Output",ExpressionUUID->"87aca8d3-9d04-459a-b863-cab4b973bb2d"]
}, Open  ]],
Cell[CellGroupData[{
Cell[187863, 4470, 198, 3, 28, "Input",ExpressionUUID->"228eefac-db1d-4bc0-bec4-49892555b787"],
Cell[188064, 4475, 3337, 48, 142, "Print",ExpressionUUID->"f1982d7e-6c52-472f-86b8-c37b56826b46",
 CellTags->"Info183759041935-1734034"]
}, Open  ]],
Cell[CellGroupData[{
Cell[191438, 4528, 1247, 31, 28, "Input",ExpressionUUID->"c9961fda-15cd-4eeb-8d25-2c2f4a061173"],
Cell[192688, 4561, 731, 18, 39, "Output",ExpressionUUID->"61975075-fcc7-4e6b-a3af-ee7570128ddc"]
}, Open  ]],
Cell[CellGroupData[{
Cell[193456, 4584, 1321, 31, 28, "Input",ExpressionUUID->"be7c7510-c1e9-4ff3-8abc-63a1567b3dbc"],
Cell[194780, 4617, 719, 22, 39, "Output",ExpressionUUID->"e50e2f56-df98-4cf0-82b8-e973821017fb"]
}, Open  ]],
Cell[CellGroupData[{
Cell[195536, 4644, 1487, 53, 60, "Input",ExpressionUUID->"2978ccb9-bd83-46d4-93a3-6c47f39742d2"],
Cell[197026, 4699, 799, 21, 39, "Output",ExpressionUUID->"8b60abe9-a569-4b75-8f65-85e93b95f612"]
}, Open  ]],
Cell[CellGroupData[{
Cell[197862, 4725, 1191, 34, 35, "Input",ExpressionUUID->"45836032-c159-4a83-8daf-2942c3a8a0ca"],
Cell[199056, 4761, 573, 19, 39, "Output",ExpressionUUID->"b0092fd5-4951-4525-be5f-0f7d60174d90"]
}, Open  ]],
Cell[CellGroupData[{
Cell[199666, 4785, 1289, 35, 35, "Input",ExpressionUUID->"56c32b78-6b2e-4ce6-a263-f1d7e3f51a47"],
Cell[200958, 4822, 442, 16, 39, "Output",ExpressionUUID->"acb7a341-2509-47fd-87b5-41f3cded4bb5"]
}, Open  ]],
Cell[CellGroupData[{
Cell[201437, 4843, 811, 17, 28, "Input",ExpressionUUID->"b4695894-8182-426c-9420-cfff45c8b926"],
Cell[202251, 4862, 702, 20, 39, "Output",ExpressionUUID->"f818c36b-a354-47bd-8d35-7b7af3d899d0"]
}, Open  ]],
Cell[CellGroupData[{
Cell[202990, 4887, 709, 13, 28, "Input",ExpressionUUID->"8345484b-a082-4901-a1b5-82b34b8029eb"],
Cell[203702, 4902, 423, 12, 39, "Output",ExpressionUUID->"eb933660-ff4c-4f34-9eba-d25719cfff87"]
}, Open  ]],
Cell[CellGroupData[{
Cell[204162, 4919, 1166, 29, 48, "Input",ExpressionUUID->"94cb8bdc-6658-4087-869b-b50ec857bb6a"],
Cell[205331, 4950, 276, 8, 39, "Output",ExpressionUUID->"a4a6fc5e-8e8e-4e81-8bbb-3b92d776be75"]
}, Open  ]],
Cell[CellGroupData[{
Cell[205644, 4963, 1225, 29, 48, "Input",ExpressionUUID->"afc102ba-db28-414d-9722-50f897cf59bb"],
Cell[206872, 4994, 381, 9, 21, "Message",ExpressionUUID->"e4af1c90-00f3-4ace-9f5e-8df060a17431"]
}, Open  ]],
Cell[CellGroupData[{
Cell[207290, 5008, 814, 19, 28, "Input",ExpressionUUID->"216dcfd8-3324-464b-947b-2b08ee3e147c"],
Cell[208107, 5029, 1268, 51, 39, "Output",ExpressionUUID->"b8862061-1fc5-4dfd-b715-a90eddaf9269"]
}, Open  ]],
Cell[CellGroupData[{
Cell[209412, 5085, 180, 3, 28, "Input",ExpressionUUID->"1452597b-b404-42dd-b604-1763800bb2a8"],
Cell[209595, 5090, 1142, 49, 39, "Output",ExpressionUUID->"ba22069e-ffe7-4752-9f33-522efaef8537"]
}, Open  ]],
Cell[210752, 5142, 437, 9, 28, "Input",ExpressionUUID->"ada8f0ac-2f33-49e7-aee9-13789e1a81e1"],
Cell[CellGroupData[{
Cell[211214, 5155, 1385, 52, 60, "Input",ExpressionUUID->"cd71a3ab-8c33-4683-9096-2d525c1c973c"],
Cell[212602, 5209, 628, 19, 39, "Output",ExpressionUUID->"d9cb328a-1c3d-402b-880d-31ca1168d022"]
}, Open  ]],
Cell[CellGroupData[{
Cell[213267, 5233, 1424, 52, 60, "Input",ExpressionUUID->"0eba5460-d5da-41ab-803b-ef037d9efcfb"],
Cell[214694, 5287, 483, 11, 21, "Message",ExpressionUUID->"65c994da-5f15-4446-b612-0b68c426db64"]
}, Open  ]],
Cell[CellGroupData[{
Cell[215214, 5303, 485, 11, 28, "Input",ExpressionUUID->"7f809984-789c-4a78-9aaf-c4c159f0e7de"],
Cell[215702, 5316, 852, 31, 39, "Output",ExpressionUUID->"ed6520ba-9e0f-4466-9ff9-dbeb606049b7"]
}, Open  ]],
Cell[CellGroupData[{
Cell[216591, 5352, 340, 7, 28, "Input",ExpressionUUID->"10cd26b5-188d-481c-8d94-d3e622271481"],
Cell[216934, 5361, 434, 10, 23, "Message",ExpressionUUID->"db1f31c3-4e80-41af-9e77-0cb55097dc31"]
}, Open  ]],
Cell[217383, 5374, 88, 0, 28, "Input",ExpressionUUID->"1382b710-19f8-472f-abfe-38934103eb47"],
Cell[217474, 5376, 787, 21, 82, "Input",ExpressionUUID->"15c976e3-fa7b-4574-b273-2067baded4bf"],
Cell[CellGroupData[{
Cell[218286, 5401, 358, 8, 28, "Input",ExpressionUUID->"21ce367e-084e-4c0a-b950-01e6a1c175fa"],
Cell[218647, 5411, 596, 20, 39, "Output",ExpressionUUID->"6574b507-16ca-4997-8236-7b485ae877b9"]
}, Open  ]],
Cell[CellGroupData[{
Cell[219280, 5436, 529, 14, 45, "Input",ExpressionUUID->"4ad8ab4c-5e7a-4056-969c-67c702c60b28"],
Cell[219812, 5452, 506, 11, 23, "Message",ExpressionUUID->"8404039d-9edb-4818-9e75-45d34d4911da"]
}, Open  ]],
Cell[CellGroupData[{
Cell[220355, 5468, 1030, 27, 109, "Input",ExpressionUUID->"e3282641-83be-48ad-923f-98710b907439"],
Cell[221388, 5497, 1062, 30, 154, "Output",ExpressionUUID->"2bd31b07-d982-4f53-bf9b-c4f097505c7e"]
}, Open  ]],
Cell[CellGroupData[{
Cell[222487, 5532, 286, 6, 45, "Input",ExpressionUUID->"62014f1c-9b9e-4835-9e53-e2ff07861d69"],
Cell[222776, 5540, 357, 13, 39, "Output",ExpressionUUID->"9f808654-6703-40e6-a779-03ff5144d15f"]
}, Open  ]],
Cell[CellGroupData[{
Cell[223170, 5558, 633, 12, 45, "Input",ExpressionUUID->"5ba9f2cf-95ce-4c90-80e7-a4a8327a548e"],
Cell[223806, 5572, 798, 15, 41, "Message",ExpressionUUID->"cca128ea-4191-4ba9-ac6a-501415508484"],
Cell[224607, 5589, 510, 11, 46, "Output",ExpressionUUID->"9ffc4c06-4d75-4e1c-bf05-eccd0b6cd335"]
}, Open  ]],
Cell[CellGroupData[{
Cell[225154, 5605, 652, 12, 45, "Input",ExpressionUUID->"17314ed2-a6fe-4e22-b1b0-f52f27ec98a9"],
Cell[CellGroupData[{
Cell[225831, 5621, 321, 11, 47, "Echo",ExpressionUUID->"b39c13a5-0684-4060-877e-81f02d983b01"],
Cell[226155, 5634, 133, 3, 23, "Echo",ExpressionUUID->"78ce58f8-e500-489f-b0a4-05dcfb03cde6"]
}, Open  ]],
Cell[226303, 5640, 797, 23, 86, "Output",ExpressionUUID->"2a8f601e-5ae2-4758-afe6-2d6c48649296"]
}, Open  ]],
Cell[CellGroupData[{
Cell[227137, 5668, 813, 18, 45, "Input",ExpressionUUID->"193a0f46-dd1e-4ead-80ca-32afff1f7bcb"],
Cell[CellGroupData[{
Cell[227975, 5690, 1060, 36, 25, "Echo",ExpressionUUID->"1c7a8530-1990-4041-89ff-f644bcaf308c"],
Cell[229038, 5728, 133, 3, 23, "Echo",ExpressionUUID->"0e0816fb-4c4a-4066-9059-fc6335b01634"]
}, Open  ]],
Cell[229186, 5734, 1597, 50, 66, "Output",ExpressionUUID->"005a2c07-c445-43a3-a235-722951ad9f7b"]
}, Open  ]],
Cell[CellGroupData[{
Cell[230820, 5789, 866, 19, 45, "Input",ExpressionUUID->"41cf12d3-fdf4-4974-a56c-2e632f966a66"],
Cell[CellGroupData[{
Cell[231711, 5812, 1566, 56, 25, "Echo",ExpressionUUID->"34afb43e-251d-4091-8e68-69ec55756b5a"],
Cell[233280, 5870, 131, 3, 23, "Echo",ExpressionUUID->"4d6c3883-772b-4ee5-a377-85bae75dcf47"]
}, Open  ]],
Cell[233426, 5876, 2027, 67, 85, "Output",ExpressionUUID->"50da54e5-3d38-48ed-9a4f-4d6906cebd06"]
}, Open  ]],
Cell[CellGroupData[{
Cell[235490, 5948, 813, 18, 45, "Input",ExpressionUUID->"e369bad2-cf61-408e-801a-215ffd3b0fe3"],
Cell[236306, 5968, 2030, 67, 85, "Output",ExpressionUUID->"af27de84-e4f2-49c2-93e5-42a8c3d17e21"]
}, Open  ]],
Cell[CellGroupData[{
Cell[238373, 6040, 839, 19, 45, "Input",ExpressionUUID->"49ca1517-76c7-4e59-a81f-ff1c42015d94"],
Cell[239215, 6061, 581, 20, 49, "Output",ExpressionUUID->"9a2d93ce-df12-419d-bd89-240b56fee826"]
}, Open  ]],
Cell[239811, 6084, 214, 3, 45, "Input",ExpressionUUID->"097476fd-26d8-4ca2-94f9-1913987e52d1"],
Cell[240028, 6089, 351, 10, 45, "Input",ExpressionUUID->"44b9986d-3181-4f1e-862e-2d6021e376ba"],
Cell[240382, 6101, 368, 11, 45, "Input",ExpressionUUID->"ef089c63-8652-460a-aff2-0349ede50e9b"],
Cell[CellGroupData[{
Cell[240775, 6116, 144, 3, 28, "Input",ExpressionUUID->"7dd1f803-4e5b-475c-a1a0-63fcb2ce6793"],
Cell[240922, 6121, 279, 4, 52, "Output",ExpressionUUID->"6e31c476-8b24-48ab-932d-75223d098a63"]
}, Open  ]],
Cell[CellGroupData[{
Cell[241238, 6130, 967, 24, 35, "Input",ExpressionUUID->"4cc2668d-564f-4ce7-b9b2-2688a9fc77c3"],
Cell[242208, 6156, 1346, 53, 64, "Output",ExpressionUUID->"7de7852f-42b6-4f7a-8db9-da014e66f2fe"]
}, Open  ]],
Cell[243569, 6212, 184, 4, 28, "Input",ExpressionUUID->"dc2ef9e8-be3a-4d60-adc9-40674e27a7a4"],
Cell[CellGroupData[{
Cell[243778, 6220, 198, 3, 28, "Input",ExpressionUUID->"71ccc1a5-effe-4bf0-8479-98e13ac214d9"],
Cell[243979, 6225, 1258, 19, 161, "Print",ExpressionUUID->"48a4e35b-06d9-415f-9e65-aa5f184161b2",
 CellTags->"Info383759047348-6451956"]
}, Open  ]],
Cell[CellGroupData[{
Cell[245274, 6249, 203, 3, 28, "Input",ExpressionUUID->"f86c22e8-85ee-4b16-be8b-06eaa97c221d"],
Cell[245480, 6254, 614, 10, 115, "Print",ExpressionUUID->"f5c11f5b-d8f2-4bad-bfc2-b1412e5f770a",
 CellTags->"Info393759047358-6451956"]
}, Open  ]],
Cell[CellGroupData[{
Cell[246131, 6269, 1124, 22, 28, "Input",ExpressionUUID->"d2a8b549-5664-4aab-a0fc-63f0445cd06f"],
Cell[247258, 6293, 2216, 98, 89, "Output",ExpressionUUID->"b019f7ba-0923-472e-96e7-b1f564ed1438"]
}, Open  ]],
Cell[CellGroupData[{
Cell[249511, 6396, 849, 26, 45, "Input",ExpressionUUID->"e906b869-a184-486c-b86a-5df62e5b9496"],
Cell[250363, 6424, 205, 3, 32, "Output",ExpressionUUID->"2f4a416c-37a5-4f33-8b56-487d260efa99"]
}, Open  ]],
Cell[CellGroupData[{
Cell[250605, 6432, 636, 18, 46, "Input",ExpressionUUID->"a5a7e5a8-16e9-4a6b-932b-5552eb001a44"],
Cell[251244, 6452, 176, 2, 32, "Output",ExpressionUUID->"728f7014-19c4-416e-82c7-27f4adb61c85"]
}, Open  ]],
Cell[251435, 6457, 301, 9, 30, "Input",ExpressionUUID->"f5a8f286-b118-48c9-a2fc-674512878344"],
Cell[CellGroupData[{
Cell[251761, 6470, 634, 14, 28, "Input",ExpressionUUID->"03141970-fd2f-4694-88d2-d86d9250d2b2"],
Cell[252398, 6486, 415, 17, 30, "Echo",ExpressionUUID->"e6d9a0aa-9405-4092-ab1c-6d8d5caa1ae5"],
Cell[252816, 6505, 770, 22, 39, "Output",ExpressionUUID->"aa26a1af-21cd-4aa5-a76c-a842187078b7"]
}, Open  ]],
Cell[CellGroupData[{
Cell[253623, 6532, 624, 12, 28, "Input",ExpressionUUID->"0a5f1952-19de-4c8a-b8cf-1d9ecb2273d9"],
Cell[254250, 6546, 1265, 37, 64, "Output",ExpressionUUID->"e91f50be-0e56-4785-80f0-1e3a7125b1d5"]
}, Open  ]],
Cell[CellGroupData[{
Cell[255552, 6588, 738, 14, 28, "Input",ExpressionUUID->"1ce2a835-7576-4e19-8db2-eaced6055100"],
Cell[256293, 6604, 519, 18, 39, "Output",ExpressionUUID->"1dc4d3a1-53c2-4f54-9b3b-5886639aedc2"],
Cell[256815, 6624, 8967, 193, 71, "Output",ExpressionUUID->"fc376c7e-7052-4720-b003-ed11d6357a6f"],
Cell[265785, 6819, 1079, 27, 62, "Output",ExpressionUUID->"8035d1f9-9381-41cc-9de9-6f333352f5b0"]
}, Open  ]],
Cell[CellGroupData[{
Cell[266901, 6851, 1441, 44, 96, "Input",ExpressionUUID->"bcbf18bb-60f7-445c-b316-ef4184ecd7b0"],
Cell[268345, 6897, 390, 9, 23, "Message",ExpressionUUID->"478d16d5-b65f-4279-8327-eea7ee590e0e"],
Cell[268738, 6908, 482, 11, 23, "Message",ExpressionUUID->"efdf3c0d-4249-48a9-88b8-870668d84ab4"],
Cell[269223, 6921, 858, 24, 96, "Output",ExpressionUUID->"70007a01-69af-4a93-be4c-0331b46e3942"]
}, Open  ]],
Cell[270096, 6948, 1500, 45, 96, "Input",ExpressionUUID->"b9401360-23a3-489a-b3e2-d7885e7f147c"],
Cell[CellGroupData[{
Cell[271621, 6997, 1266, 28, 82, "Input",ExpressionUUID->"17fded39-4ce2-46c2-a661-168d6103a41a"],
Cell[272890, 7027, 386, 9, 21, "Message",ExpressionUUID->"e4adc815-ccbd-436b-9a73-5e4442e8bace"],
Cell[273279, 7038, 340, 7, 46, "Output",ExpressionUUID->"503ffb36-b7f6-4d11-8548-9b58c470eb82"]
}, Open  ]],
Cell[CellGroupData[{
Cell[273656, 7050, 1276, 28, 82, "Input",ExpressionUUID->"74549ebc-6cfb-42f6-be28-6d92db384fd5"],
Cell[274935, 7080, 655, 13, 62, "Output",ExpressionUUID->"9f4bc4bd-289f-48b2-8f59-91b4c4f53426"]
}, Open  ]],
Cell[CellGroupData[{
Cell[275627, 7098, 1326, 29, 82, "Input",ExpressionUUID->"a010abd8-e0c5-4e2c-9a02-6fd7d58ad91d"],
Cell[276956, 7129, 398, 9, 46, "Output",ExpressionUUID->"eeb60c6f-929b-456b-af5e-4baf9fba6c03"]
}, Open  ]],
Cell[CellGroupData[{
Cell[277391, 7143, 1258, 28, 82, "Input",ExpressionUUID->"5d916a63-b3d6-45c0-9c25-cbeebd6f9541"],
Cell[278652, 7173, 433, 9, 62, "Output",ExpressionUUID->"60f434ff-3c21-4f45-bda5-ea3a46dc4b94"]
}, Open  ]],
Cell[CellGroupData[{
Cell[279122, 7187, 1311, 29, 82, "Input",ExpressionUUID->"3546ad54-3f06-4972-bcfd-7e232d7ad38f"],
Cell[280436, 7218, 309, 8, 46, "Output",ExpressionUUID->"491a64f9-0385-41a7-b615-27275cd0c3df"]
}, Open  ]],
Cell[CellGroupData[{
Cell[280782, 7231, 1451, 31, 66, "Input",ExpressionUUID->"20caee17-872c-4fa6-83a1-231fe8e8fd2f"],
Cell[282236, 7264, 435, 10, 23, "Message",ExpressionUUID->"30159ed6-3e26-4e75-acc5-98a3cfa77a73"]
}, Open  ]],
Cell[CellGroupData[{
Cell[282708, 7279, 836, 19, 28, "Input",ExpressionUUID->"32b9b413-8aa2-49ed-af5d-a44342c9dd41"],
Cell[283547, 7300, 454, 13, 39, "Output",ExpressionUUID->"66cf6fed-7b4d-4021-8900-74e427bf5e26"]
}, Open  ]],
Cell[CellGroupData[{
Cell[284038, 7318, 519, 13, 45, "Input",ExpressionUUID->"177d4685-f100-4b17-9aa1-8bb510713189"],
Cell[284560, 7333, 595, 20, 39, "Output",ExpressionUUID->"b3619135-bd3c-43ab-a0f2-8db5453402ce"]
}, Open  ]],
Cell[285170, 7356, 879, 24, 48, "Input",ExpressionUUID->"c693902c-8c2a-4e4b-966f-19d585a9a134"],
Cell[CellGroupData[{
Cell[286074, 7384, 418, 11, 28, "Input",ExpressionUUID->"4012ccb8-409c-445b-a7ec-c06d4c43bdc3"],
Cell[286495, 7397, 214, 5, 32, "Output",ExpressionUUID->"2d2c76d7-ca66-4234-b246-4c4c93ddc2a8"]
}, Open  ]],
Cell[CellGroupData[{
Cell[286746, 7407, 607, 14, 28, "Input",ExpressionUUID->"b517f842-2be7-4cad-a908-fb1351bc6db9"],
Cell[287356, 7423, 436, 15, 23, "Echo",ExpressionUUID->"ad13792a-4155-4949-a21b-e3390aa320ee"],
Cell[287795, 7440, 362, 8, 39, "Output",ExpressionUUID->"1918f627-b70e-49a6-b30f-f885b562da2f"]
}, Open  ]],
Cell[CellGroupData[{
Cell[288194, 7453, 579, 13, 45, "Input",ExpressionUUID->"e0484c8b-c308-4e7a-b332-8b4215e95ff3"],
Cell[288776, 7468, 602, 18, 70, "Output",ExpressionUUID->"3c7d66b7-2821-45fa-8c73-8e09c0e1e1a8"]
}, Open  ]],
Cell[CellGroupData[{
Cell[289415, 7491, 266, 5, 28, "Input",ExpressionUUID->"cb93139f-5f7a-483a-ae72-0958b01e2f72"],
Cell[289684, 7498, 177, 4, 39, "Output",ExpressionUUID->"bcfd0b9e-26df-4fe2-a86a-bfe92efd40c4"]
}, Open  ]],
Cell[CellGroupData[{
Cell[289898, 7507, 282, 5, 28, "Input",ExpressionUUID->"102a1f7a-029a-4439-b7d2-51cdd83d84aa"],
Cell[290183, 7514, 178, 2, 32, "Output",ExpressionUUID->"9d433d86-6b1a-434f-b9e8-4e9f90484d5c"]
}, Open  ]],
Cell[CellGroupData[{
Cell[290398, 7521, 288, 5, 28, "Input",ExpressionUUID->"a0804f32-25a6-43ca-85e6-43260e2b0c75"],
Cell[290689, 7528, 154, 2, 32, "Output",ExpressionUUID->"ff3256b0-7e4a-4521-9c56-b16ddd53da60"]
}, Open  ]],
Cell[CellGroupData[{
Cell[290880, 7535, 341, 6, 28, "Input",ExpressionUUID->"6b2bac45-17bb-4a6e-89a3-39363c09d88e"],
Cell[291224, 7543, 155, 2, 32, "Output",ExpressionUUID->"3e1873b0-670f-4707-87f8-a6716ace0e1a"]
}, Open  ]],
Cell[CellGroupData[{
Cell[291416, 7550, 323, 8, 28, "Input",ExpressionUUID->"4985cf28-a8e0-489c-9ea9-59a8db8adb1d"],
Cell[291742, 7560, 4122, 195, 164, "Output",ExpressionUUID->"693c56d4-4889-4e02-9b70-e8e1c88830b0"]
}, Open  ]],
Cell[CellGroupData[{
Cell[295901, 7760, 315, 7, 28, "Input",ExpressionUUID->"a7b0e3a5-0465-433c-8173-f3a0c34479bc"],
Cell[296219, 7769, 791, 32, 39, "Output",ExpressionUUID->"31e0a6ea-e493-4619-8608-d268039730b3"]
}, Open  ]],
Cell[CellGroupData[{
Cell[297047, 7806, 344, 5, 28, "Input",ExpressionUUID->"709f13c2-1634-495d-9432-94ff75e2d141"],
Cell[297394, 7813, 1320, 38, 64, "Output",ExpressionUUID->"e19e9a4f-e321-419a-a2c8-81bba41f4ab0"]
}, Open  ]],
Cell[CellGroupData[{
Cell[298751, 7856, 430, 11, 28, "Input",ExpressionUUID->"b5d4a550-91dd-460c-8cd8-bc34ed5ae7e0"],
Cell[299184, 7869, 261, 6, 32, "Output",ExpressionUUID->"0a87c4c2-5005-4b82-900c-2c2f760c33fd"]
}, Open  ]],
Cell[CellGroupData[{
Cell[299482, 7880, 432, 11, 28, "Input",ExpressionUUID->"ace6c0f3-af80-40f3-977b-a71a534fe106"],
Cell[299917, 7893, 263, 6, 32, "Output",ExpressionUUID->"d8c4811a-18ff-4dd8-a80b-efef27b51e8f"]
}, Open  ]],
Cell[CellGroupData[{
Cell[300217, 7904, 439, 11, 28, "Input",ExpressionUUID->"45b7a5f9-0bad-4a5a-8e05-b8d9e83e9ba0"],
Cell[300659, 7917, 291, 7, 32, "Output",ExpressionUUID->"e5a8aed1-f3ed-46b1-bc21-7cf1a18a330d"]
}, Open  ]],
Cell[CellGroupData[{
Cell[300987, 7929, 485, 12, 28, "Input",ExpressionUUID->"0671bc70-ac36-4881-bb73-27c39669469f"],
Cell[301475, 7943, 257, 6, 32, "Output",ExpressionUUID->"ee3cf10a-32f9-47ad-9643-70ab92460de5"]
}, Open  ]],
Cell[CellGroupData[{
Cell[301769, 7954, 321, 8, 45, "Input",ExpressionUUID->"775fea38-3f19-4af6-8cc5-94595a9f6bf7"],
Cell[302093, 7964, 158, 3, 32, "Output",ExpressionUUID->"80dcd4fa-2abb-4cd0-8621-b2f8b1a893ef"]
}, Open  ]],
Cell[302266, 7970, 152, 3, 28, "Input",ExpressionUUID->"d64abccf-5274-4f15-9772-443251144b0f"],
Cell[CellGroupData[{
Cell[302443, 7977, 1033, 30, 149, "Input",ExpressionUUID->"90352c27-b98b-4abc-88a8-56582657066e"],
Cell[303479, 8009, 1069, 39, 70, "Output",ExpressionUUID->"4714d860-c2aa-41f3-86c6-c9ec61bb7150"]
}, Open  ]],
Cell[CellGroupData[{
Cell[304585, 8053, 375, 8, 28, "Input",ExpressionUUID->"4ca84c90-1d38-49c3-ad9b-eaddbbb3f27b"],
Cell[304963, 8063, 392, 9, 21, "Message",ExpressionUUID->"5fb177b7-df57-4df2-8d24-67b59add5438"]
}, Open  ]],
Cell[CellGroupData[{
Cell[305392, 8077, 394, 6, 45, "Input",ExpressionUUID->"5d6b39d9-0ccc-4350-b1da-35f9cd8be9e7"],
Cell[305789, 8085, 1497, 50, 96, "Output",ExpressionUUID->"8398f61a-35ff-43db-810f-f0fbd91b22e7"]
}, Open  ]],
Cell[CellGroupData[{
Cell[307323, 8140, 322, 7, 45, "Input",ExpressionUUID->"45813395-fa76-4bc8-b4ba-a3a3f1f57fcd"],
Cell[307648, 8149, 3478, 128, 141, "Output",ExpressionUUID->"84050c30-4f3d-4406-9924-944f7f04a7c0"]
}, Open  ]],
Cell[CellGroupData[{
Cell[311163, 8282, 631, 15, 45, "Input",ExpressionUUID->"c520313e-dd19-4d03-9fb0-2cf4f866e22b"],
Cell[311797, 8299, 825, 23, 96, "Output",ExpressionUUID->"ace3ccda-54a2-444a-8068-46668c03980b"]
}, Open  ]],
Cell[CellGroupData[{
Cell[312659, 8327, 198, 3, 28, "Input",ExpressionUUID->"25b808d7-da9d-478c-a1e5-1f29678d4590"],
Cell[312860, 8332, 2558, 38, 184, "Print",ExpressionUUID->"30090bf1-f4f6-479a-bebd-758b18d2c4d9",
 CellTags->"Info713759048312-6451956"]
}, Open  ]],
Cell[CellGroupData[{
Cell[315455, 8375, 363, 6, 28, "Input",ExpressionUUID->"86edc627-5cac-4186-982f-7d4fd71668cc"],
Cell[315821, 8383, 898, 32, 39, "Output",ExpressionUUID->"1a6ac40a-1124-4e6d-b71a-cced8c27dc8c"]
}, Open  ]],
Cell[316734, 8418, 1124, 37, 76, "Input",ExpressionUUID->"ec98a8cd-eccb-4cf3-a313-253c19ff1a3a"],
Cell[317861, 8457, 903, 33, 35, "Input",ExpressionUUID->"a26bfecd-100c-4eec-9bc3-dbbefc4798f6"],
Cell[CellGroupData[{
Cell[318789, 8494, 9190, 192, 83, "Input",ExpressionUUID->"51c71c4c-60d8-4b15-b8ae-3a0643bb13ea"],
Cell[327982, 8688, 823, 23, 96, "Output",ExpressionUUID->"798a73b8-b0cc-4e24-861b-2b7a3cd7a245"]
}, Open  ]],
Cell[CellGroupData[{
Cell[328842, 8716, 212, 3, 28, "Input",ExpressionUUID->"a8e4e8e0-575b-4c63-8531-909a3cca0bfc"],
Cell[329057, 8721, 857, 14, 69, "Print",ExpressionUUID->"8fec7a12-6c58-4480-8207-8b32611b37df",
 CellTags->"Info823759048517-6451956"]
}, Open  ]],
Cell[329929, 8738, 322, 5, 45, "Input",ExpressionUUID->"f4029a97-5cd2-46b7-ba00-e7c8972c3e18"],
Cell[CellGroupData[{
Cell[330276, 8747, 202, 3, 28, "Input",ExpressionUUID->"9b034ad0-9955-47a4-91f2-66e61a69cea9"],
Cell[330481, 8752, 1564, 49, 89, "Output",ExpressionUUID->"cc17ae34-8689-4f00-9351-b638bea1679d"]
}, Open  ]],
Cell[332060, 8804, 366, 8, 28, "Input",ExpressionUUID->"c085795d-a030-47f7-9810-11dc0ea9b43f"],
Cell[CellGroupData[{
Cell[332451, 8816, 1052, 32, 92, "Input",ExpressionUUID->"8c0e41fb-a98c-400b-b618-49624b3d3d80"],
Cell[333506, 8850, 727, 20, 55, "Output",ExpressionUUID->"5280bf79-3eff-450e-b8b4-9a7a23a3a6ae"]
}, Open  ]],
Cell[CellGroupData[{
Cell[334270, 8875, 802, 21, 67, "Input",ExpressionUUID->"f9df6cb1-1464-4cae-bfa4-c193ea560db6"],
Cell[335075, 8898, 151, 2, 32, "Output",ExpressionUUID->"8322166b-9108-4aea-b956-337c5196d41c"]
}, Open  ]],
Cell[CellGroupData[{
Cell[335263, 8905, 152, 3, 67, "Section",ExpressionUUID->"520d94ba-8d13-4855-b55b-c859dc84d32e"],
Cell[CellGroupData[{
Cell[335440, 8912, 857, 25, 169, "Input",ExpressionUUID->"6d26bfbd-a111-482e-8536-e4fee0875125"],
Cell[336300, 8939, 675, 19, 55, "Output",ExpressionUUID->"af2eddac-ebcb-462c-9df7-8533434b3040"],
Cell[336978, 8960, 456, 12, 70, "Output",ExpressionUUID->"4bc53bc3-daae-40da-8962-657a163badc4"]
}, Open  ]],
Cell[CellGroupData[{
Cell[337471, 8977, 555, 14, 82, "Input",ExpressionUUID->"5a44efd1-4dcd-42a2-a300-847704663503"],
Cell[338029, 8993, 2095, 77, 109, "Output",ExpressionUUID->"b11bff57-774c-4517-8079-1a923c3b35bb"],
Cell[340127, 9072, 657, 21, 55, "Output",ExpressionUUID->"e5fa728c-0edf-4aa6-8a6f-4191ef7cbe01"]
}, Open  ]],
Cell[CellGroupData[{
Cell[340821, 9098, 232, 4, 45, "Input",ExpressionUUID->"c7a9254d-68ff-4f2a-aafa-5adf567f2180"],
Cell[341056, 9104, 2473, 87, 113, "Output",ExpressionUUID->"2dfa2a25-744b-4a60-8715-8834ef624668"]
}, Open  ]],
Cell[CellGroupData[{
Cell[343566, 9196, 330, 7, 28, "Input",ExpressionUUID->"3a3decbf-6df8-432c-a550-611294734737"],
Cell[343899, 9205, 11169, 255, 129, "Output",ExpressionUUID->"18ae1de0-812a-4f2e-8d7f-db5e09995fbb"]
}, Open  ]],
Cell[CellGroupData[{
Cell[355105, 9465, 388, 8, 28, "Input",ExpressionUUID->"1e309074-3976-4c27-b712-23974f818b69"],
Cell[355496, 9475, 9777, 230, 129, "Output",ExpressionUUID->"cdf7f39a-6c54-45dd-9b0f-d157669384e4"]
}, Open  ]],
Cell[CellGroupData[{
Cell[365310, 9710, 206, 3, 45, "Input",ExpressionUUID->"a3135a81-0dba-4172-814e-6381150ccff3"],
Cell[365519, 9715, 1684, 44, 212, "Output",ExpressionUUID->"5cc3d608-e906-44dc-bce5-9f74c16e4cb7"]
}, Open  ]],
Cell[CellGroupData[{
Cell[367240, 9764, 194, 3, 28, "Input",ExpressionUUID->"a04beb75-c782-471a-b6bf-ae7644516b61"],
Cell[367437, 9769, 4311, 62, 284, "Print",ExpressionUUID->"961ee33e-fcc2-427e-b1b2-b53c27344f63",
 CellTags->"Info233760254771-4835498"]
}, Open  ]],
Cell[CellGroupData[{
Cell[371785, 9836, 352, 8, 45, "Input",ExpressionUUID->"f3131534-28c3-4a81-a21b-790c247db6f6"],
Cell[CellGroupData[{
Cell[372162, 9848, 1085, 38, 47, "Echo",ExpressionUUID->"2439a9b5-51b4-451a-aac2-4f8c182f30f2"],
Cell[373250, 9888, 131, 3, 23, "Echo",ExpressionUUID->"8743edf1-0cb9-4355-921b-f06c45f85b31"]
}, Open  ]],
Cell[373396, 9894, 977, 29, 132, "Output",ExpressionUUID->"173b241b-c0eb-437e-9e09-aa784ca8f6e6"]
}, Open  ]],
Cell[CellGroupData[{
Cell[374410, 9928, 380, 9, 45, "Input",ExpressionUUID->"9fd986d3-e645-44cd-961a-3e25deed0706"],
Cell[CellGroupData[{
Cell[374815, 9941, 323, 11, 47, "Echo",ExpressionUUID->"956334bf-0afd-4a74-b22d-579b6358fef6"],
Cell[375141, 9954, 133, 3, 23, "Echo",ExpressionUUID->"2be26b13-112e-4218-92b8-d875999a26e2"]
}, Open  ]],
Cell[375289, 9960, 799, 23, 86, "Output",ExpressionUUID->"2db0d99e-2dc2-4ee1-bc1c-4bd7614adf9d"]
}, Open  ]],
Cell[CellGroupData[{
Cell[376125, 9988, 390, 9, 45, "Input",ExpressionUUID->"2e71102b-5b01-4cad-a44b-1723f93e7124"],
Cell[CellGroupData[{
Cell[376540, 10001, 150, 4, 47, "Echo",ExpressionUUID->"d605eddd-e442-40ce-92c7-8aaabf65d5f2"],
Cell[376693, 10007, 134, 3, 23, "Echo",ExpressionUUID->"fbf78407-6a07-46b9-a2c9-41735fab640d"]
}, Open  ]],
Cell[376842, 10013, 273, 8, 69, "Output",ExpressionUUID->"44ad3b07-b024-482c-a0dc-ff407f0fac74"]
}, Open  ]],
Cell[CellGroupData[{
Cell[377152, 10026, 462, 11, 45, "Input",ExpressionUUID->"3c5d6370-d880-486f-b825-6631799f017b"],
Cell[CellGroupData[{
Cell[377639, 10041, 1083, 38, 47, "Echo",ExpressionUUID->"42f5a883-2c47-4d91-9ad0-0707fefe7446"],
Cell[378725, 10081, 133, 3, 23, "Echo",ExpressionUUID->"efda36e3-5bca-42cb-b32f-97d50ca86984"],
Cell[378861, 10086, 318, 10, 47, "Echo",ExpressionUUID->"6b88b2b6-f52d-4620-bb82-25acd9544231"],
Cell[379182, 10098, 133, 3, 23, "Echo",ExpressionUUID->"cadf4e5e-1d8d-4c99-a317-1a4d083f3cc3"],
Cell[379318, 10103, 148, 4, 47, "Echo",ExpressionUUID->"bbd6ad97-2e68-4b13-8670-b1974d9484f7"],
Cell[379469, 10109, 132, 3, 23, "Echo",ExpressionUUID->"7a1444b5-194a-4ce4-a7a2-92336d2e8778"]
}, Open  ]],
Cell[379616, 10115, 3386, 92, 198, "Output",ExpressionUUID->"521b8c35-f658-4521-9137-c54535ff3033"]
}, Open  ]],
Cell[CellGroupData[{
Cell[383039, 10212, 469, 11, 45, "Input",ExpressionUUID->"de9cdfb5-3e8d-4ebf-80d8-aa6c5374398d"],
Cell[CellGroupData[{
Cell[383533, 10227, 1083, 38, 47, "Echo",ExpressionUUID->"75aaf2e0-4065-4202-a911-6aaa181834ac"],
Cell[384619, 10267, 133, 3, 23, "Echo",ExpressionUUID->"73d5c72c-e846-4982-8ca3-bc231370c692"],
Cell[384755, 10272, 321, 11, 47, "Echo",ExpressionUUID->"88b2568f-5695-4574-843a-28b34c526574"],
Cell[385079, 10285, 131, 3, 23, "Echo",ExpressionUUID->"9cd38dac-e8e8-428e-b4f2-531b28245e22"],
Cell[385213, 10290, 148, 4, 47, "Echo",ExpressionUUID->"b67242b2-4561-4a33-a20f-8c5110daea57"],
Cell[385364, 10296, 132, 3, 23, "Echo",ExpressionUUID->"867f7132-c17a-4ffb-a403-eea434a758e4"]
}, Open  ]],
Cell[385511, 10302, 470, 10, 47, "Message",ExpressionUUID->"f08815c3-9249-438a-b638-026a823cafee"],
Cell[385984, 10314, 601, 18, 55, "Output",ExpressionUUID->"8242cb60-7ee8-42a8-a5df-9a408d6e6ef6"]
}, Open  ]],
Cell[CellGroupData[{
Cell[386622, 10337, 465, 11, 45, "Input",ExpressionUUID->"82aa54da-9939-461a-92d6-563c42b1aafe"],
Cell[CellGroupData[{
Cell[387112, 10352, 997, 35, 47, "Echo",ExpressionUUID->"90d02e8d-4851-4d07-b138-aa621cb4434b"],
Cell[388112, 10389, 131, 3, 23, "Echo",ExpressionUUID->"3b7f6e04-8013-498d-bf13-9ffc46898d03"],
Cell[388246, 10394, 321, 11, 47, "Echo",ExpressionUUID->"20a05933-8a6e-4718-82be-883cf080dce3"],
Cell[388570, 10407, 131, 3, 23, "Echo",ExpressionUUID->"ddeca3b5-ef4b-4c3d-87ad-3b2a2260b2e3"],
Cell[388704, 10412, 150, 4, 47, "Echo",ExpressionUUID->"275d43b3-c35e-441e-948f-9d8c7ddfeed2"],
Cell[388857, 10418, 134, 3, 23, "Echo",ExpressionUUID->"66eafc11-2268-4628-a293-3dd93c2161b8"]
}, Open  ]],
Cell[389006, 10424, 2833, 77, 174, "Output",ExpressionUUID->"ed93bf6e-b74c-4677-a21a-627675f352a5"]
}, Open  ]],
Cell[CellGroupData[{
Cell[391876, 10506, 470, 11, 45, "Input",ExpressionUUID->"761b56c6-cce0-498c-bccb-7b2b165c9aef"],
Cell[CellGroupData[{
Cell[392371, 10521, 992, 34, 47, "Echo",ExpressionUUID->"9360e7fe-0396-4da5-a2d4-152236bd3680"],
Cell[393366, 10557, 133, 3, 23, "Echo",ExpressionUUID->"c3427043-fba3-43cb-83e6-b23a29e93b85"],
Cell[393502, 10562, 319, 11, 47, "Echo",ExpressionUUID->"6bede6b1-e9dc-4164-85bd-53f979cc3493"],
Cell[393824, 10575, 131, 3, 23, "Echo",ExpressionUUID->"42df802d-fccb-4cbe-9f3d-ab8fa628d523"],
Cell[393958, 10580, 150, 4, 47, "Echo",ExpressionUUID->"8344b37a-993f-4830-a9d1-f9e5913c3166"],
Cell[394111, 10586, 134, 3, 23, "Echo",ExpressionUUID->"28a1c232-d6f1-4efd-90c8-c2108edd0855"]
}, Open  ]],
Cell[394260, 10592, 472, 10, 47, "Message",ExpressionUUID->"3fe685d3-e3fc-448f-971d-5af58f411896"],
Cell[394735, 10604, 597, 18, 55, "Output",ExpressionUUID->"ffb158b7-f935-40bf-af77-3afadb5a504a"]
}, Open  ]],
Cell[CellGroupData[{
Cell[395369, 10627, 179, 2, 28, "Input",ExpressionUUID->"62788487-b49c-41e8-a317-b0a1b27ca7ae"],
Cell[395551, 10631, 382, 11, 70, "Output",ExpressionUUID->"fc54e7c5-ab2f-4f45-ba80-aa8d0fc75102"]
}, Open  ]],
Cell[CellGroupData[{
Cell[395970, 10647, 232, 4, 28, "Input",ExpressionUUID->"6846f21c-d9e8-4a51-827e-a7ee9059c29f"],
Cell[CellGroupData[{
Cell[396227, 10655, 4313, 62, 284, "Print",ExpressionUUID->"7d7400da-dbe4-465c-8922-a95ca0d7e686",
 CellTags->"Info323760254773-4835498"],
Cell[400543, 10719, 1798, 29, 121, "Print",ExpressionUUID->"dc5e0d82-1de6-4ff5-852c-380a962f3289",
 CellTags->"Info323760254773-4835498"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[402390, 10754, 199, 3, 28, "Input",ExpressionUUID->"e1c53419-3d2c-4ff2-b35f-c9c95d4e8dc7"],
Cell[402592, 10759, 1222, 37, 64, "Output",ExpressionUUID->"be76aeb9-f44d-440c-9924-139b0c995898"]
}, Open  ]],
Cell[CellGroupData[{
Cell[403851, 10801, 541, 14, 28, "Input",ExpressionUUID->"5515cc43-8f1e-489a-89e5-587b63add003"],
Cell[404395, 10817, 558, 17, 39, "Output",ExpressionUUID->"f95497fb-ef9e-4c66-bee7-9e4c4fba2824"]
}, Open  ]],
Cell[CellGroupData[{
Cell[404990, 10839, 307, 6, 45, "Input",ExpressionUUID->"f0c38fd9-344c-4e52-a673-c7822923af5a"],
Cell[405300, 10847, 1078, 31, 91, "Output",ExpressionUUID->"80694c94-fde1-47f9-946e-60adcb1c1a61"]
}, Open  ]],
Cell[CellGroupData[{
Cell[406415, 10883, 532, 13, 45, "Input",ExpressionUUID->"b5506f42-47ab-46a7-8bb7-cb7987704196"],
Cell[406950, 10898, 562, 17, 70, "Output",ExpressionUUID->"20d4649d-b1c9-4594-9335-860b456da87f"]
}, Open  ]],
Cell[CellGroupData[{
Cell[407549, 10920, 1312, 37, 159, "Input",ExpressionUUID->"510896a3-90c4-4b77-8ae3-565ba79667cd"],
Cell[408864, 10959, 667, 20, 39, "Output",ExpressionUUID->"39c0a9ad-fa1f-4a94-abb2-56679f53d63c"],
Cell[409534, 10981, 747, 20, 39, "Output",ExpressionUUID->"c3e92a26-90d9-48d3-8184-c7148a4c6072"]
}, Open  ]],
Cell[CellGroupData[{
Cell[410318, 11006, 466, 14, 28, "Input",ExpressionUUID->"f40d1508-f131-4a64-aeea-b6a14ec58916"],
Cell[410787, 11022, 13388, 306, 204, "Output",ExpressionUUID->"a5eec27b-c7d6-4444-9677-4c97795a12f2"]
}, Open  ]],
Cell[CellGroupData[{
Cell[424212, 11333, 326, 6, 45, "Input",ExpressionUUID->"7c8fc40d-88c1-490e-a817-af4d86624f0b"],
Cell[424541, 11341, 3780, 86, 166, "Output",ExpressionUUID->"d7170d14-7ec1-40ea-b990-546efee4bced"]
}, Open  ]],
Cell[428336, 11430, 247, 5, 45, "Input",ExpressionUUID->"6c3f02ea-5ab8-4dec-b39e-12e9dd575fbd"],
Cell[CellGroupData[{
Cell[428608, 11439, 362, 7, 28, "Input",ExpressionUUID->"e8b27249-494d-4882-aeb4-6b67fd3265ee"],
Cell[CellGroupData[{
Cell[428995, 11450, 471, 13, 23, "Echo",ExpressionUUID->"2d9d67f1-9791-4a0f-9a7b-23bf971a8e8a"],
Cell[429469, 11465, 133, 3, 23, "Echo",ExpressionUUID->"0119d8c5-a99e-4d2b-be04-17253e55c677"]
}, Open  ]],
Cell[429617, 11471, 619, 14, 32, "Output",ExpressionUUID->"8213f156-fb7a-48dc-ac81-4383b1460ad3"]
}, Open  ]],
Cell[CellGroupData[{
Cell[430273, 11490, 693, 14, 28, "Input",ExpressionUUID->"2a4c2acb-de8a-4aaa-85f1-05978b9918cb"],
Cell[CellGroupData[{
Cell[430991, 11508, 4005, 131, 77, "Echo",ExpressionUUID->"5e03dc00-fe06-4d29-befa-30d74dda9c82"],
Cell[434999, 11641, 131, 3, 23, "Echo",ExpressionUUID->"b3ffc202-289f-4fa7-a437-4c3b085fa11d"]
}, Open  ]],
Cell[435145, 11647, 3314, 111, 90, "Output",ExpressionUUID->"6ff0ff8a-19bf-4d7f-aa08-858a327b01b1"]
}, Open  ]],
Cell[438474, 11761, 4365, 134, 86, "Input",ExpressionUUID->"5f4dc000-3adb-4fa4-bed0-7a8c0316949f"],
Cell[CellGroupData[{
Cell[442864, 11899, 369, 7, 45, "Input",ExpressionUUID->"c442eb5f-9d92-46eb-a171-f13a4669da14"],
Cell[443236, 11908, 27592, 720, 312, "Output",ExpressionUUID->"e940eaea-5de6-43f6-a244-bc21f9477de3"]
}, Open  ]],
Cell[CellGroupData[{
Cell[470865, 12633, 212, 3, 45, "Input",ExpressionUUID->"caa56953-c8c4-45cb-a2e4-aa02bab255c9"],
Cell[471080, 12638, 261, 5, 32, "Output",ExpressionUUID->"74ce83bd-613c-47d6-9d5d-172e2460af99"]
}, Open  ]],
Cell[CellGroupData[{
Cell[471378, 12648, 517, 11, 45, "Input",ExpressionUUID->"ae828fe8-9359-42ad-95a7-e016fcb1a642"],
Cell[471898, 12661, 20319, 549, 588, "Output",ExpressionUUID->"103d3145-d668-4fbb-8481-d5d61e9530db"]
}, Open  ]],
Cell[CellGroupData[{
Cell[492254, 13215, 208, 3, 45, "Input",ExpressionUUID->"bd9ae655-ef81-4894-956b-5a65079934b6"],
Cell[492465, 13220, 2214, 51, 300, "Output",ExpressionUUID->"8d632afb-812f-43d1-be9e-b3b2772c9c09"]
}, Open  ]],
Cell[CellGroupData[{
Cell[494716, 13276, 210, 3, 45, "Input",ExpressionUUID->"bf8e6c1b-9cc8-4569-b2d0-7f72a152e155"],
Cell[494929, 13281, 222, 4, 32, "Output",ExpressionUUID->"ba0cdd36-d794-4815-b4aa-f7a39951af1a"]
}, Open  ]],
Cell[CellGroupData[{
Cell[495188, 13290, 291, 6, 45, "Input",ExpressionUUID->"22201efe-8488-499e-8962-dec2d7ce45da"],
Cell[495482, 13298, 331, 7, 32, "Output",ExpressionUUID->"1f12e4d8-214b-415b-8dbb-e2d4f729ea64"]
}, Open  ]],
Cell[CellGroupData[{
Cell[495850, 13310, 219, 3, 45, "Input",ExpressionUUID->"e91039b5-e781-44f0-b834-eb048c695394"],
Cell[496072, 13315, 195, 3, 32, "Output",ExpressionUUID->"a8300507-f002-47df-9503-605cde2191b4"]
}, Open  ]],
Cell[CellGroupData[{
Cell[496304, 13323, 224, 3, 45, "Input",ExpressionUUID->"437814e4-ad8b-40a0-8ad8-7cfa96e59970"],
Cell[496531, 13328, 260, 6, 55, "Output",ExpressionUUID->"04009295-99dd-4bb5-9589-d9c013114d7a"]
}, Open  ]],
Cell[CellGroupData[{
Cell[496828, 13339, 260, 4, 45, "Input",ExpressionUUID->"85af731d-c6e3-474e-b78d-6fbf9bcb673c"],
Cell[497091, 13345, 1268, 33, 188, "Output",ExpressionUUID->"e4aeb277-78ba-478b-8922-07d9da1301c9"]
}, Open  ]],
Cell[498374, 13381, 221, 3, 28, "Input",ExpressionUUID->"02ced233-747f-4cfc-a56d-a5dda66099b6"],
Cell[CellGroupData[{
Cell[498620, 13388, 201, 3, 45, "Input",ExpressionUUID->"f1ec25c9-b6a8-4d49-ba96-11ee0fbda1b7"],
Cell[498824, 13393, 173, 2, 32, "Output",ExpressionUUID->"d2f2387a-23af-4b59-b845-e646f6ee7181"]
}, Open  ]],
Cell[CellGroupData[{
Cell[499034, 13400, 200, 3, 28, "Input",ExpressionUUID->"cd7b42d1-ce6b-40d9-9369-ac22b9c0078f"],
Cell[499237, 13405, 1176, 36, 64, "Output",ExpressionUUID->"e18a2388-3607-448f-ab7b-e5f9fe96101d"]
}, Open  ]],
Cell[CellGroupData[{
Cell[500450, 13446, 372, 8, 28, "Input",ExpressionUUID->"25b29e1d-a565-4d7e-b396-931588c8e24c"],
Cell[500825, 13456, 297, 9, 39, "Output",ExpressionUUID->"0c03250c-9026-4212-b215-dbdf4f23a0b6"]
}, Open  ]],
Cell[CellGroupData[{
Cell[501159, 13470, 244, 4, 45, "Input",ExpressionUUID->"3c3b7a48-f4fe-4f48-bd0c-798142f905ec"],
Cell[501406, 13476, 198, 4, 32, "Output",ExpressionUUID->"40f1ef3b-cfd5-4ebc-8e05-8691ed344b28"]
}, Open  ]],
Cell[CellGroupData[{
Cell[501641, 13485, 983, 32, 76, "Input",ExpressionUUID->"9567831c-49aa-4b9c-b07c-9836f3bae6f6"],
Cell[502627, 13519, 1087, 34, 66, "Output",ExpressionUUID->"f673d261-edf9-4c3d-85e8-68eaafa5e52b"]
}, Open  ]],
Cell[CellGroupData[{
Cell[503751, 13558, 498, 13, 45, "Input",ExpressionUUID->"3d4b9882-67b8-40cf-853f-cd008841fef3"],
Cell[504252, 13573, 7210, 194, 144, "Output",ExpressionUUID->"c7bb36dc-fb57-47ce-a615-50ebeaea73c2"]
}, Open  ]],
Cell[CellGroupData[{
Cell[511499, 13772, 548, 15, 48, "Input",ExpressionUUID->"ad256ae4-8a8a-48f8-9cad-55ca201abbc8"],
Cell[CellGroupData[{
Cell[512072, 13791, 1934, 59, 47, "Echo",ExpressionUUID->"19a702d3-465c-4ff3-8617-e29c02a3497c"],
Cell[514009, 13852, 131, 3, 23, "Echo",ExpressionUUID->"7124e3ac-cccb-46ba-acf0-d12e3271d64e"],
Cell[514143, 13857, 1934, 59, 47, "Echo",ExpressionUUID->"a57c905c-ba30-49d2-b70d-64fb8a65f5e5"],
Cell[516080, 13918, 131, 3, 23, "Echo",ExpressionUUID->"398ee900-aa90-466c-b2e1-ab8d541acc66"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[516260, 13927, 354, 8, 45, "Input",ExpressionUUID->"791e280f-6945-43e3-8006-b6b48b06df14"],
Cell[516617, 13937, 319, 8, 55, "Output",ExpressionUUID->"b8612045-a170-4b2a-ad05-631b80fa28e3"]
}, Open  ]],
Cell[CellGroupData[{
Cell[516973, 13950, 376, 8, 45, "Input",ExpressionUUID->"f82ed799-c472-498d-b26e-1ba564f72bef"],
Cell[517352, 13960, 242, 7, 55, "Output",ExpressionUUID->"58fca47c-d4d6-474c-8151-e2c7de1bda6c"]
}, Open  ]],
Cell[517609, 13970, 338, 9, 45, "Input",ExpressionUUID->"607a8d84-109a-401b-ae5b-ee40db3a058c"],
Cell[517950, 13981, 427, 11, 45, "Input",ExpressionUUID->"7ce7f631-97d6-4571-bf5e-be76a0ac6873"],
Cell[CellGroupData[{
Cell[518402, 13996, 154, 3, 28, "Input",ExpressionUUID->"e4d1c42c-3606-496e-ae45-78ad3f26bfc2"],
Cell[518559, 14001, 496, 13, 32, "Output",ExpressionUUID->"af29ae94-d584-4e93-9411-5689ed89f206"]
}, Open  ]],
Cell[CellGroupData[{
Cell[519092, 14019, 280, 6, 45, "Input",ExpressionUUID->"aaa18592-a7de-4a5b-acf1-aa4bc6367824"],
Cell[519375, 14027, 448, 12, 55, "Output",ExpressionUUID->"600272e9-4db4-43ba-9726-a99f90cab1f9"]
}, Open  ]],
Cell[CellGroupData[{
Cell[519860, 14044, 588, 16, 45, "Input",ExpressionUUID->"a723611a-356b-41dd-823d-737e6d177ab1"],
Cell[520451, 14062, 196, 4, 32, "Output",ExpressionUUID->"4ef6762a-b2b4-44f3-8657-63f717a6bb6b"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[520708, 14073, 161, 3, 64, "Subchapter",ExpressionUUID->"b849c283-06bf-4412-8477-da1d83231f05"],
Cell[520872, 14078, 680, 19, 76, "Input",ExpressionUUID->"432ddc30-504e-4ae1-88f8-e121acf4e149"],
Cell[CellGroupData[{
Cell[521577, 14101, 255, 5, 28, "Input",ExpressionUUID->"9dc9f61e-879f-4a30-80ff-cfd557d9e404"],
Cell[521835, 14108, 432, 12, 70, "Output",ExpressionUUID->"4640a2d0-bffd-4c7b-9cd9-a251822f8379"]
}, Open  ]],
Cell[CellGroupData[{
Cell[522304, 14125, 1201, 29, 119, "Input",ExpressionUUID->"da7b9a63-e905-4cb8-a1d8-2ad058f082c0"],
Cell[523508, 14156, 30800, 761, 806, "Output",ExpressionUUID->"37b34869-b94d-4729-b546-4b6c1da2832a"]
}, Open  ]],
Cell[CellGroupData[{
Cell[554345, 14922, 962, 25, 82, "Input",ExpressionUUID->"c1d16a91-b9ec-46ae-8884-64e6b04a9a07"],
Cell[555310, 14949, 1122, 38, 104, "Output",ExpressionUUID->"ed6b49c6-27c8-4b00-a774-e636aa586ceb"]
}, Open  ]],
Cell[556447, 14990, 901, 27, 80, "Input",ExpressionUUID->"0f2f36ee-63f4-43f1-b9cc-61faf15c8c12"],
Cell[CellGroupData[{
Cell[557373, 15021, 287, 5, 45, "Input",ExpressionUUID->"786a4102-6ee6-4912-babe-69b132427210"],
Cell[557663, 15028, 1695, 58, 166, "Output",ExpressionUUID->"4b829221-7f4a-4fd8-80d1-5d20f45647fa"]
}, Open  ]],
Cell[559373, 15089, 175, 2, 28, "Input",ExpressionUUID->"15ceaf62-3c41-4007-aff8-748a7cc6bd54"],
Cell[CellGroupData[{
Cell[559573, 15095, 177, 2, 28, "Input",ExpressionUUID->"78a67807-0ffa-4869-a5d1-b885fabed25b"],
Cell[559753, 15099, 154, 2, 32, "Output",ExpressionUUID->"966957d3-7894-49a2-9ad4-f9712f755d0d"]
}, Open  ]],
Cell[CellGroupData[{
Cell[559944, 15106, 291, 5, 28, "Input",ExpressionUUID->"6385cfac-cc5a-41f0-b2d6-d64d22b324fd"],
Cell[560238, 15113, 651, 19, 55, "Output",ExpressionUUID->"9f260f3a-d33f-4bed-9dcc-61850d3acf40"]
}, Open  ]],
Cell[CellGroupData[{
Cell[560926, 15137, 377, 9, 28, "Input",ExpressionUUID->"f093a3cb-279e-4c3e-982c-846bf2aead10"],
Cell[561306, 15148, 420, 12, 70, "Output",ExpressionUUID->"6322de98-dbdd-414f-bc35-4377abb742bd"]
}, Open  ]],
Cell[CellGroupData[{
Cell[561763, 15165, 522, 12, 28, "Input",ExpressionUUID->"0ee2363f-bf04-4ee9-8c1d-5c4f301fe6c2"],
Cell[562288, 15179, 288, 9, 70, "Output",ExpressionUUID->"b9881033-f535-41db-a69f-74196159ae3c"]
}, Open  ]],
Cell[CellGroupData[{
Cell[562613, 15193, 1048, 32, 67, "Input",ExpressionUUID->"4c2884d3-80f8-4fe0-93f6-1fc369fa7f4d"],
Cell[563664, 15227, 1768, 51, 141, "Output",ExpressionUUID->"69eadb5e-7508-4f2b-9cd2-8b43920aa359"]
}, Open  ]],
Cell[CellGroupData[{
Cell[565469, 15283, 405, 16, 67, "Input",ExpressionUUID->"2cb59d56-14a3-4d68-a413-1a118620e04a"],
Cell[565877, 15301, 408, 16, 70, "Output",ExpressionUUID->"7f1a680a-9369-4fa5-957b-d227c5b309f4"]
}, Open  ]],
Cell[CellGroupData[{
Cell[566322, 15322, 741, 22, 67, "Input",ExpressionUUID->"5364319b-d922-4a16-9d46-4ee2a494c5e3"],
Cell[567066, 15346, 288, 10, 70, "Output",ExpressionUUID->"76dfaaef-e53c-4d38-bb66-a0166c6248cf"]
}, Open  ]],
Cell[567369, 15359, 251, 6, 28, "Input",ExpressionUUID->"80297389-63a1-4120-9888-e7be9e5e89dc"],
Cell[CellGroupData[{
Cell[567645, 15369, 829, 25, 45, "Input",ExpressionUUID->"8b2ddbf9-6ec9-40d3-8871-412f63605b0b"],
Cell[568477, 15396, 845, 27, 39, "Output",ExpressionUUID->"e4336677-7b22-47ba-a111-d46691a19891"]
}, Open  ]],
Cell[CellGroupData[{
Cell[569359, 15428, 1022, 30, 45, "Input",ExpressionUUID->"77053dae-8125-4da3-b931-60c641b7b0d5"],
Cell[570384, 15460, 1323, 43, 64, "Output",ExpressionUUID->"9836a186-48ef-4a8d-b8e9-7282c82a31fd"]
}, Open  ]],
Cell[CellGroupData[{
Cell[571744, 15508, 535, 14, 28, "Input",ExpressionUUID->"765cb75b-a410-4103-b254-8484b09c8728"],
Cell[572282, 15524, 386, 12, 70, "Output",ExpressionUUID->"4db6ab8d-d63b-4806-b5eb-d2992436cfa5"]
}, Open  ]],
Cell[CellGroupData[{
Cell[572705, 15541, 726, 19, 28, "Input",ExpressionUUID->"32f28501-84b5-4671-87b5-5837a16c25e1"],
Cell[573434, 15562, 586, 19, 70, "Output",ExpressionUUID->"fa9f6b28-055a-4977-9ee6-411a3b8e0c4a"]
}, Open  ]],
Cell[CellGroupData[{
Cell[574057, 15586, 212, 3, 28, "Input",ExpressionUUID->"c4772dac-df8a-4ff9-a4e2-cc4081608445"],
Cell[574272, 15591, 4051, 119, 141, "Output",ExpressionUUID->"6b7e66ac-13d1-4932-985f-2c798ead66a8"]
}, Open  ]],
Cell[CellGroupData[{
Cell[578360, 15715, 1518, 42, 67, "Input",ExpressionUUID->"c14cc870-99fa-4e76-8ae6-e77a77efa0e5"],
Cell[579881, 15759, 474, 11, 23, "Message",ExpressionUUID->"f28d5d45-643e-4b66-ae1f-d1d2fd27a272"],
Cell[580358, 15772, 4104, 120, 141, "Output",ExpressionUUID->"0e5c35bb-0dd2-46b8-8899-6944dc2514b2"]
}, Open  ]],
Cell[584477, 15895, 154, 3, 28, "Input",ExpressionUUID->"e2217487-37a3-449e-b3ed-65914688e54a"],
Cell[CellGroupData[{
Cell[584656, 15902, 535, 12, 28, "Input",ExpressionUUID->"ca0061eb-65ed-42f6-9c45-fe7b75489d44"],
Cell[585194, 15916, 3777, 111, 141, "Output",ExpressionUUID->"0fbd6e61-bf9e-4027-885f-b66d5fc9afed"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[589020, 16033, 160, 3, 48, "Subchapter",ExpressionUUID->"0170f49d-5ec9-4915-adfc-732ceb3c4901"],
Cell[CellGroupData[{
Cell[589205, 16040, 543, 15, 28, "Input",ExpressionUUID->"47b01159-bef8-44e5-a653-ce79e0fa94e1"],
Cell[589751, 16057, 510, 17, 39, "Output",ExpressionUUID->"414a717b-1ff3-42d9-b144-903ed84f13a9"]
}, Open  ]],
Cell[590276, 16077, 488, 13, 60, "Input",ExpressionUUID->"49b82c46-388d-4a46-a780-27bacbc6575e"],
Cell[CellGroupData[{
Cell[590789, 16094, 238, 4, 28, "Input",ExpressionUUID->"358f3d09-c06d-42ed-8f3c-4b1297493b1a"],
Cell[591030, 16100, 320, 10, 70, "Output",ExpressionUUID->"c920c9cc-e794-4ca5-b920-55683cab1f19"]
}, Open  ]],
Cell[CellGroupData[{
Cell[591387, 16115, 463, 11, 28, "Input",ExpressionUUID->"bbb02ee0-78ef-476a-ba6c-6865dc4d3021"],
Cell[591853, 16128, 384, 9, 55, "Output",ExpressionUUID->"5f8149f3-bf26-465f-b33f-c6c2e4f70704"]
}, Open  ]],
Cell[592252, 16140, 1114, 27, 45, "Input",ExpressionUUID->"3e61be8f-4862-4ea4-b8bd-e27df80adf33"],
Cell[CellGroupData[{
Cell[593391, 16171, 423, 9, 28, "Input",ExpressionUUID->"a420dec6-3c35-4cad-b2f5-29be4766ee3d"],
Cell[593817, 16182, 1931, 71, 55, "Output",ExpressionUUID->"0b17a480-6a06-4647-a5cb-01cd7ebb9854"]
}, Open  ]],
Cell[CellGroupData[{
Cell[595785, 16258, 601, 14, 28, "Input",ExpressionUUID->"1d38044f-5f7e-4d32-b275-a608922a9558"],
Cell[596389, 16274, 1035, 30, 55, "Output",ExpressionUUID->"38d8df26-7f06-43d3-b559-8b268eade549"]
}, Open  ]],
Cell[597439, 16307, 1929, 46, 309, "Input",ExpressionUUID->"9a28ec41-f7c5-4ca7-9b67-0b7155f809e2"],
Cell[599371, 16355, 2064, 50, 309, "Input",ExpressionUUID->"afe4ad7c-428c-4ba0-b1db-6b2a8888b288"],
Cell[601438, 16407, 853, 19, 161, "Input",ExpressionUUID->"f8a41ce4-9dc4-4aa3-b683-ad781597313a"],
Cell[602294, 16428, 968, 21, 161, "Input",ExpressionUUID->"751c7dd9-3233-4eff-a17a-1900c6ae832b"],
Cell[CellGroupData[{
Cell[603287, 16453, 265, 5, 28, "Input",ExpressionUUID->"9a1fce5d-1723-4a02-925c-8d64de945a4c"],
Cell[603555, 16460, 200, 3, 32, "Output",ExpressionUUID->"e9d054e5-6d47-4d25-ad5c-8079c173a70c"]
}, Open  ]],
Cell[CellGroupData[{
Cell[603792, 16468, 205, 3, 28, "Input",ExpressionUUID->"ec574d6b-a9e9-416c-9eb7-f42c241638d9"],
Cell[604000, 16473, 171, 2, 32, "Output",ExpressionUUID->"7fd126fb-020b-4d31-89cd-9ac420414de3"]
}, Open  ]],
Cell[CellGroupData[{
Cell[604208, 16480, 551, 13, 45, "Input",ExpressionUUID->"c6c9ef67-158a-42d3-aca9-94ef8c47a197"],
Cell[604762, 16495, 2671, 78, 179, "Output",ExpressionUUID->"fec91ecc-a3c5-46f5-a650-360e130ce1df"]
}, Open  ]],
Cell[CellGroupData[{
Cell[607470, 16578, 552, 13, 45, "Input",ExpressionUUID->"0295a671-b753-4890-800d-23fb299761b2"],
Cell[608025, 16593, 2542, 76, 179, "Output",ExpressionUUID->"b0fe6555-926e-4548-bdbe-0fe6956a5b56"]
}, Open  ]],
Cell[CellGroupData[{
Cell[610604, 16674, 552, 13, 45, "Input",ExpressionUUID->"17fe4cce-e29b-41bc-b92d-74171069cf6b"],
Cell[611159, 16689, 2776, 84, 179, "Output",ExpressionUUID->"25256e86-9b19-45c6-b6b7-963943cea92e"]
}, Open  ]],
Cell[CellGroupData[{
Cell[613972, 16778, 337, 6, 45, "Input",ExpressionUUID->"adde6a90-c4de-487a-9592-4d5ac97397c6"],
Cell[614312, 16786, 3681, 113, 179, "Output",ExpressionUUID->"205373cf-2203-4b63-8c98-84c88b10ec0d"]
}, Open  ]],
Cell[CellGroupData[{
Cell[618030, 16904, 318, 7, 45, "Input",ExpressionUUID->"44365d88-2761-4db6-95f3-ed876220a530"],
Cell[618351, 16913, 3657, 113, 179, "Output",ExpressionUUID->"812395e1-fcc5-4f27-98ad-5815e91a8d91"]
}, Open  ]],
Cell[CellGroupData[{
Cell[622045, 17031, 330, 7, 45, "Input",ExpressionUUID->"c5000288-1bb3-4ed9-9ca5-b8011167739a"],
Cell[622378, 17040, 4541, 146, 183, "Output",ExpressionUUID->"19d37614-df53-47be-9e0d-54d1c8460f48"]
}, Open  ]],
Cell[CellGroupData[{
Cell[626956, 17191, 349, 8, 45, "Input",ExpressionUUID->"acb918e3-e472-4a22-ac85-edb27262e1c8"],
Cell[627308, 17201, 4561, 146, 183, "Output",ExpressionUUID->"6faa15ed-5153-42a8-98c8-b6ebaa3b12b0"]
}, Open  ]],
Cell[CellGroupData[{
Cell[631906, 17352, 351, 8, 45, "Input",ExpressionUUID->"9c416b71-f380-40f4-a723-02ebf580a33b"],
Cell[632260, 17362, 4543, 146, 183, "Output",ExpressionUUID->"f4a2b25a-ce7c-4528-bcf5-d3f4bf3d4da1"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[636852, 17514, 159, 3, 64, "Subchapter",ExpressionUUID->"35b50382-02db-49e4-a7aa-3a2e24e47649"],
Cell[637014, 17519, 15095, 458, 313, "Input",ExpressionUUID->"c6933e7f-4c34-40ae-9a17-1852a58eb7df"],
Cell[CellGroupData[{
Cell[652134, 17981, 536, 14, 31, "Input",ExpressionUUID->"ca4d3f8d-6eae-4462-9778-875dc1479948"],
Cell[652673, 17997, 11334, 363, 159, "Output",ExpressionUUID->"3dbba5bd-417d-490f-85c3-c737ca01158a"]
}, Open  ]],
Cell[CellGroupData[{
Cell[664044, 18365, 200, 3, 28, "Input",ExpressionUUID->"e1e278a0-67c6-48e1-9a02-0e9527bb6017"],
Cell[664247, 18370, 1798, 29, 72, "Print",ExpressionUUID->"790d0205-d29a-4c60-8a18-f7bb7278a103",
 CellTags->"Info213764086852-9486297"]
}, Open  ]],
Cell[CellGroupData[{
Cell[666082, 18404, 758, 21, 55, "Input",ExpressionUUID->"a3de2d6a-3450-4e7c-8b61-b6abdce1d3fa"],
Cell[666843, 18427, 6690, 192, 108, "Output",ExpressionUUID->"2fb07b5d-b6df-4ac7-b9ca-f9ac8a1d3c4b"]
}, Open  ]],
Cell[CellGroupData[{
Cell[673570, 18624, 303, 5, 28, "Input",ExpressionUUID->"e19a33f5-2815-47e7-8a97-5f9a5585c8b2"],
Cell[673876, 18631, 5535, 163, 84, "Output",ExpressionUUID->"09ef4a90-8dcf-4a4e-989c-9e163e26cfc1"]
}, Open  ]],
Cell[679426, 18797, 402, 10, 28, "Input",ExpressionUUID->"1aa93be0-c598-41f4-b3a9-bda58d7b1069"],
Cell[CellGroupData[{
Cell[679853, 18811, 200, 3, 28, "Input",ExpressionUUID->"e48f649c-f6e6-41be-9f9f-f9e3e38bba6a"],
Cell[680056, 18816, 3339, 48, 128, "Print",ExpressionUUID->"57457656-a1b5-4799-b4e1-2327dd6d8dc4",
 CellTags->"Info243764086910-9486297"]
}, Open  ]],
Cell[683410, 18867, 220, 3, 28, "Input",ExpressionUUID->"23cdec9a-5aa5-41c9-9b50-3695821dcd90"],
Cell[CellGroupData[{
Cell[683655, 18874, 261, 8, 33, "Input",ExpressionUUID->"03d7ddb2-0f4b-4e7f-97af-5e2d9b212d39"],
Cell[683919, 18884, 264, 8, 37, "Output",ExpressionUUID->"ec0dd45d-b35d-4b83-8527-1729844495dc"]
}, Open  ]]
}, Open  ]]
}
]
*)

